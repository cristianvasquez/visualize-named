<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Trig Visualization</title><style>#container{border:1px solid #ccc;width:100%;height:100vh;margin-top:10px}#message{color:#555;margin-top:10px;font-family:Arial,sans-serif;font-size:14px}#message a{color:#06c;text-decoration:none}#message a:hover{text-decoration:underline}</style></head><body> <div id="controls"> <input type="text" id="urlInput" placeholder=".trig file URL" style="width:70%"> <button id="renderButton">Render</button> <div id="message"></div> </div> <div id="container"></div> <script type="module">let t,e,r;function n(t,e,r,n){Object.defineProperty(t,e,{get:r,set:n,enumerable:!0,configurable:!0})}var i,a,o,s,l,u,h,d,c=globalThis;function f(t){return t&&t.__esModule?t.default:t}var p={},g={},y=c.parcelRequire94c2;null==y&&((y=function(t){if(t in p)return p[t].exports;if(t in g){var e=g[t];delete g[t];var r={id:t,exports:{}};return p[t]=r,e.call(r.exports,r,r.exports),r.exports}var n=Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(t,e){g[t]=e},c.parcelRequire94c2=y);var v=y.register;v("e93qE",function(t,e){t.exports={ArrayIsArray:t=>Array.isArray(t),ArrayPrototypeIncludes:(t,e)=>t.includes(e),ArrayPrototypeIndexOf:(t,e)=>t.indexOf(e),ArrayPrototypeJoin:(t,e)=>t.join(e),ArrayPrototypeMap:(t,e)=>t.map(e),ArrayPrototypePop:(t,e)=>t.pop(e),ArrayPrototypePush:(t,e)=>t.push(e),ArrayPrototypeSlice:(t,e,r)=>t.slice(e,r),Error:Error,FunctionPrototypeCall:(t,e,...r)=>t.call(e,...r),FunctionPrototypeSymbolHasInstance:(t,e)=>Function.prototype[Symbol.hasInstance].call(t,e),MathFloor:Math.floor,Number:Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(t,e)=>Object.defineProperties(t,e),ObjectDefineProperty:(t,e,r)=>Object.defineProperty(t,e,r),ObjectGetOwnPropertyDescriptor:(t,e)=>Object.getOwnPropertyDescriptor(t,e),ObjectKeys:t=>Object.keys(t),ObjectSetPrototypeOf:(t,e)=>Object.setPrototypeOf(t,e),Promise:Promise,PromisePrototypeCatch:(t,e)=>t.catch(e),PromisePrototypeThen:(t,e,r)=>t.then(e,r),PromiseReject:t=>Promise.reject(t),PromiseResolve:t=>Promise.resolve(t),ReflectApply:Reflect.apply,RegExpPrototypeTest:(t,e)=>t.test(e),SafeSet:Set,String:String,StringPrototypeSlice:(t,e,r)=>t.slice(e,r),StringPrototypeToLowerCase:t=>t.toLowerCase(),StringPrototypeToUpperCase:t=>t.toUpperCase(),StringPrototypeTrim:t=>t.trim(),Symbol:Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:(t,e,r)=>t.set(e,r),Boolean:Boolean,Uint8Array:Uint8Array}}),v("3OYnt",function(t,e){var r=y("6ZWSX"),n=y("e93qE"),i=n.kResistStopPropagation,a=n.SymbolDispose;let o=globalThis.AbortSignal||y("bHKGd").AbortSignal,s=globalThis.AbortController||y("bHKGd").AbortController,l=Object.getPrototypeOf(async function(){}).constructor,u=globalThis.Blob||r.Blob,h=(t,e)=>{if(void 0!==t&&(null===t||"object"!=typeof t||!("aborted"in t)))throw new ERR_INVALID_ARG_TYPE(e,"AbortSignal",t)},d=(t,e)=>{if("function"!=typeof t)throw new ERR_INVALID_ARG_TYPE(e,"Function",t)};t.exports={AggregateError:class extends Error{constructor(t){if(!Array.isArray(t))throw TypeError(`Expected input to be an Array, got ${typeof t}`);let e="";for(let r=0;r<t.length;r++)e+=`    ${t[r].stack}
`;super(e),this.name="AggregateError",this.errors=t}},kEmptyObject:Object.freeze({}),once(t){let e=!1;return function(...r){e||(e=!0,t.apply(this,r))}},createDeferredPromise:function(){let t,e;return{promise:new Promise((r,n)=>{t=r,e=n}),resolve:t,reject:e}},promisify:t=>new Promise((e,r)=>{t((t,...n)=>t?r(t):e(...n))}),debuglog:()=>function(){},format:(t,...e)=>t.replace(/%([sdifj])/g,function(...[t,r]){let n=e.shift();if("f"===r)return n.toFixed(6);if("j"===r)return JSON.stringify(n);if("s"!==r||"object"!=typeof n)return n.toString();{let t=n.constructor!==Object?n.constructor.name:"";return`${t} {}`.trim()}}),inspect(t){switch(typeof t){case"string":if(t.includes("'")){if(!t.includes('"'))return`"${t}"`;if(!t.includes("`")&&!t.includes("${"))return`\`${t}\``}return`'${t}'`;case"number":if(isNaN(t))return"NaN";if(Object.is(t,-0))return String(t);return t;case"bigint":return`${String(t)}n`;case"boolean":case"undefined":return String(t);case"object":return"{}"}},types:{isAsyncFunction:t=>t instanceof l,isArrayBufferView:t=>ArrayBuffer.isView(t)},isBlob:void 0!==u?function(t){return t instanceof u}:function(t){return!1},deprecate:(t,e)=>t,addAbortListener:y("7etJZ").addAbortListener||function(t,e){let r;if(void 0===t)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",t);return h(t,"signal"),d(e,"listener"),t.aborted?queueMicrotask(()=>e()):(t.addEventListener("abort",e,{__proto__:null,once:!0,[i]:!0}),r=()=>{t.removeEventListener("abort",e)}),{__proto__:null,[a](){var t;null===(t=r)||void 0===t||t()}}},AbortSignalAny:o.any||function(t){if(1===t.length)return t[0];let e=new s,r=()=>e.abort();return t.forEach(t=>{h(t,"signals"),t.addEventListener("abort",r,{once:!0})}),e.signal.addEventListener("abort",()=>{t.forEach(t=>t.removeEventListener("abort",r))},{once:!0}),e.signal}},t.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}),v("6ZWSX",function(t,e){n(t.exports,"Buffer",()=>r,t=>r=t),n(t.exports,"SlowBuffer",()=>i,t=>i=t),n(t.exports,"INSPECT_MAX_BYTES",()=>a,t=>a=t),n(t.exports,"kMaxLength",()=>o,t=>o=t);var r,i,a,o,s=y("kuxul"),l=y("9NvM5");let u="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function h(t){if(t>0x7fffffff)throw RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,d.prototype),e}function d(t,e,r){if("number"==typeof t){if("string"==typeof e)throw TypeError('The "string" argument must be of type string. Received type number');return p(t)}return c(t,e,r)}function c(t,e,r){if("string"==typeof t)return function(t,e){if(("string"!=typeof e||""===e)&&(e="utf8"),!d.isEncoding(e))throw TypeError("Unknown encoding: "+e);let r=0|b(t,e),n=h(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(G(t,Uint8Array)){let e=new Uint8Array(t);return v(e.buffer,e.byteOffset,e.byteLength)}return g(t)}(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(G(t,ArrayBuffer)||t&&G(t.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(G(t,SharedArrayBuffer)||t&&G(t.buffer,SharedArrayBuffer)))return v(t,e,r);if("number"==typeof t)throw TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return d.from(n,e,r);let i=function(t){var e;if(d.isBuffer(t)){let e=0|m(t.length),r=h(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||(e=t.length)!=e?h(0):g(t):"Buffer"===t.type&&Array.isArray(t.data)?g(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return d.from(t[Symbol.toPrimitive]("string"),e,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function f(t){if("number"!=typeof t)throw TypeError('"size" argument must be of type number');if(t<0)throw RangeError('The value "'+t+'" is invalid for option "size"')}function p(t){return f(t),h(t<0?0:0|m(t))}function g(t){let e=t.length<0?0:0|m(t.length),r=h(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function v(t,e,r){let n;if(e<0||t.byteLength<e)throw RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),d.prototype),n}function m(t){if(t>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|t}function b(t,e){if(d.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||G(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return B(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(t).length;default:if(i)return n?-1:B(t).length;e=(""+e).toLowerCase(),i=!0}}function x(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(e>>>=0)))return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=e;n<r;++n)i+=$[t[n]];return i}(this,e,r);case"utf8":case"utf-8":return S(this,e,r);case"ascii":return function(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}(this,e,r);case"latin1":case"binary":return function(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}(this,e,r);case"base64":var i,a;return i=e,a=r,0===i&&a===this.length?s.fromByteArray(this):s.fromByteArray(this.slice(i,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,r){let n=t.slice(e,r),i="";for(let t=0;t<n.length-1;t+=2)i+=String.fromCharCode(n[t]+256*n[t+1]);return i}(this,e,r);default:if(n)throw TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function E(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}function w(t,e,r,n,i){var a;if(0===t.length)return -1;if("string"==typeof r?(n=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(a=r=+r)!=a&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return -1;r=t.length-1}else if(r<0){if(!i)return -1;r=0}if("string"==typeof e&&(e=d.from(e,n)),d.isBuffer(e))return 0===e.length?-1:_(t,e,r,n,i);if("number"==typeof e)return(e&=255,"function"==typeof Uint8Array.prototype.indexOf)?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):_(t,[e],r,n,i);throw TypeError("val must be string, number or Buffer")}function _(t,e,r,n,i){let a,o=1,s=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return -1;o=2,s/=2,l/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){let n=-1;for(a=r;a<s;a++)if(u(t,a)===u(e,-1===n?0:a-n)){if(-1===n&&(n=a),a-n+1===l)return n*o}else -1!==n&&(a-=a-n),n=-1}else for(r+l>s&&(r=s-l),a=r;a>=0;a--){let r=!0;for(let n=0;n<l;n++)if(u(t,a+n)!==u(e,n)){r=!1;break}if(r)return a}return -1}function S(t,e,r){r=Math.min(t.length,r);let n=[],i=e;for(;i<r;){let e=t[i],a=null,o=e>239?4:e>223?3:e>191?2:1;if(i+o<=r){let r,n,s,l;switch(o){case 1:e<128&&(a=e);break;case 2:(192&(r=t[i+1]))==128&&(l=(31&e)<<6|63&r)>127&&(a=l);break;case 3:r=t[i+1],n=t[i+2],(192&r)==128&&(192&n)==128&&(l=(15&e)<<12|(63&r)<<6|63&n)>2047&&(l<55296||l>57343)&&(a=l);break;case 4:r=t[i+1],n=t[i+2],s=t[i+3],(192&r)==128&&(192&n)==128&&(192&s)==128&&(l=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&s)>65535&&l<1114112&&(a=l)}}null===a?(a=65533,o=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=o}return function(t){let e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return r}(n)}function k(t,e,r){if(t%1!=0||t<0)throw RangeError("offset is not uint");if(t+e>r)throw RangeError("Trying to access beyond buffer length")}function N(t,e,r,n,i,a){if(!d.isBuffer(t))throw TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw RangeError('"value" argument is out of bounds');if(r+n>t.length)throw RangeError("Index out of range")}function O(t,e,r,n,i){D(e,n,i,t,r,7);let a=Number(e&BigInt(0xffffffff));t[r++]=a,a>>=8,t[r++]=a,a>>=8,t[r++]=a,a>>=8,t[r++]=a;let o=Number(e>>BigInt(32)&BigInt(0xffffffff));return t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,r}function T(t,e,r,n,i){D(e,n,i,t,r,7);let a=Number(e&BigInt(0xffffffff));t[r+7]=a,a>>=8,t[r+6]=a,a>>=8,t[r+5]=a,a>>=8,t[r+4]=a;let o=Number(e>>BigInt(32)&BigInt(0xffffffff));return t[r+3]=o,o>>=8,t[r+2]=o,o>>=8,t[r+1]=o,o>>=8,t[r]=o,r+8}function M(t,e,r,n,i,a){if(r+n>t.length||r<0)throw RangeError("Index out of range")}function A(t,e,r,n,i){return e=+e,r>>>=0,i||M(t,e,r,4,34028234663852886e22,-34028234663852886e22),l.write(t,e,r,n,23,4),r+4}function C(t,e,r,n,i){return e=+e,r>>>=0,i||M(t,e,r,8,17976931348623157e292,-17976931348623157e292),l.write(t,e,r,n,52,8),r+8}r=d,i=function(t){return+t!=t&&(t=0),d.alloc(+t)},a=50,o=0x7fffffff,d.TYPED_ARRAY_SUPPORT=function(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),d.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),d.poolSize=8192,d.from=function(t,e,r){return c(t,e,r)},Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array),d.alloc=function(t,e,r){return(f(t),t<=0)?h(t):void 0!==e?"string"==typeof r?h(t).fill(e,r):h(t).fill(e):h(t)},d.allocUnsafe=function(t){return p(t)},d.allocUnsafeSlow=function(t){return p(t)},d.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==d.prototype},d.compare=function(t,e){if(G(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),G(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(t)||!d.isBuffer(e))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let i=0,a=Math.min(r,n);i<a;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},d.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(t,e){let r;if(!Array.isArray(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return d.alloc(0);if(void 0===e)for(r=0,e=0;r<t.length;++r)e+=t[r].length;let n=d.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){let e=t[r];if(G(e,Uint8Array))i+e.length>n.length?(d.isBuffer(e)||(e=d.from(e)),e.copy(n,i)):Uint8Array.prototype.set.call(n,e,i);else if(d.isBuffer(e))e.copy(n,i);else throw TypeError('"list" argument must be an Array of Buffers');i+=e.length}return n},d.byteLength=b,d.prototype._isBuffer=!0,d.prototype.swap16=function(){let t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)E(this,e,e+1);return this},d.prototype.swap32=function(){let t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)E(this,e,e+3),E(this,e+1,e+2);return this},d.prototype.swap64=function(){let t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)E(this,e,e+7),E(this,e+1,e+6),E(this,e+2,e+5),E(this,e+3,e+4);return this},d.prototype.toString=function(){let t=this.length;return 0===t?"":0==arguments.length?S(this,0,t):x.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(t){if(!d.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===d.compare(this,t)},d.prototype.inspect=function(){let t="",e=a;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},u&&(d.prototype[u]=d.prototype.inspect),d.prototype.compare=function(t,e,r,n,i){if(G(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(t))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return -1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,i>>>=0,this===t)return 0;let a=i-n,o=r-e,s=Math.min(a,o),l=this.slice(n,i),u=t.slice(e,r);for(let t=0;t<s;++t)if(l[t]!==u[t]){a=l[t],o=u[t];break}return a<o?-1:o<a?1:0},d.prototype.includes=function(t,e,r){return -1!==this.indexOf(t,e,r)},d.prototype.indexOf=function(t,e,r){return w(this,t,e,r,!0)},d.prototype.lastIndexOf=function(t,e,r){return w(this,t,e,r,!1)},d.prototype.write=function(t,e,r,n){var i,a,o,s,l,u,h,d;if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else if(isFinite(e))e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let c=this.length-e;if((void 0===r||r>c)&&(r=c),t.length>0&&(r<0||e<0)||e>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let f=!1;for(;;)switch(n){case"hex":return function(t,e,r,n){let i;r=Number(r)||0;let a=t.length-r;n?(n=Number(n))>a&&(n=a):n=a;let o=e.length;for(n>o/2&&(n=o/2),i=0;i<n;++i){let n=parseInt(e.substr(2*i,2),16);if(n!=n)break;t[r+i]=n}return i}(this,t,e,r);case"utf8":case"utf-8":return i=e,a=r,V(B(t,this.length-i),this,i,a);case"ascii":case"latin1":case"binary":return o=e,s=r,V(function(t){let e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(t),this,o,s);case"base64":return l=e,u=r,V(z(t),this,l,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h=e,d=r,V(function(t,e){let r,n;let i=[];for(let a=0;a<t.length&&!((e-=2)<0);++a)n=(r=t.charCodeAt(a))>>8,i.push(r%256),i.push(n);return i}(t,this.length-h),this,h,d);default:if(f)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.slice=function(t,e){let r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);let n=this.subarray(t,e);return Object.setPrototypeOf(n,d.prototype),n},d.prototype.readUintLE=d.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||k(t,e,this.length);let n=this[t],i=1,a=0;for(;++a<e&&(i*=256);)n+=this[t+a]*i;return n},d.prototype.readUintBE=d.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||k(t,e,this.length);let n=this[t+--e],i=1;for(;e>0&&(i*=256);)n+=this[t+--e]*i;return n},d.prototype.readUint8=d.prototype.readUInt8=function(t,e){return t>>>=0,e||k(t,1,this.length),this[t]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(t,e){return t>>>=0,e||k(t,2,this.length),this[t]|this[t+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(t,e){return t>>>=0,e||k(t,2,this.length),this[t]<<8|this[t+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(t,e){return t>>>=0,e||k(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+0x1000000*this[t+3]},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(t,e){return t>>>=0,e||k(t,4,this.length),0x1000000*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},d.prototype.readBigUInt64LE=U(function(t){L(t>>>=0,"offset");let e=this[t],r=this[t+7];(void 0===e||void 0===r)&&j(t,this.length-8);let n=e+256*this[++t]+65536*this[++t]+0x1000000*this[++t],i=this[++t]+256*this[++t]+65536*this[++t]+0x1000000*r;return BigInt(n)+(BigInt(i)<<BigInt(32))}),d.prototype.readBigUInt64BE=U(function(t){L(t>>>=0,"offset");let e=this[t],r=this[t+7];(void 0===e||void 0===r)&&j(t,this.length-8);let n=0x1000000*e+65536*this[++t]+256*this[++t]+this[++t],i=0x1000000*this[++t]+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),d.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||k(t,e,this.length);let n=this[t],i=1,a=0;for(;++a<e&&(i*=256);)n+=this[t+a]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},d.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||k(t,e,this.length);let n=e,i=1,a=this[t+--n];for(;n>0&&(i*=256);)a+=this[t+--n]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*e)),a},d.prototype.readInt8=function(t,e){return(t>>>=0,e||k(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},d.prototype.readInt16LE=function(t,e){t>>>=0,e||k(t,2,this.length);let r=this[t]|this[t+1]<<8;return 32768&r?0xffff0000|r:r},d.prototype.readInt16BE=function(t,e){t>>>=0,e||k(t,2,this.length);let r=this[t+1]|this[t]<<8;return 32768&r?0xffff0000|r:r},d.prototype.readInt32LE=function(t,e){return t>>>=0,e||k(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},d.prototype.readInt32BE=function(t,e){return t>>>=0,e||k(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},d.prototype.readBigInt64LE=U(function(t){L(t>>>=0,"offset");let e=this[t],r=this[t+7];return(void 0===e||void 0===r)&&j(t,this.length-8),(BigInt(this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24))<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+0x1000000*this[++t])}),d.prototype.readBigInt64BE=U(function(t){L(t>>>=0,"offset");let e=this[t],r=this[t+7];return(void 0===e||void 0===r)&&j(t,this.length-8),(BigInt((e<<24)+65536*this[++t]+256*this[++t]+this[++t])<<BigInt(32))+BigInt(0x1000000*this[++t]+65536*this[++t]+256*this[++t]+r)}),d.prototype.readFloatLE=function(t,e){return t>>>=0,e||k(t,4,this.length),l.read(this,t,!0,23,4)},d.prototype.readFloatBE=function(t,e){return t>>>=0,e||k(t,4,this.length),l.read(this,t,!1,23,4)},d.prototype.readDoubleLE=function(t,e){return t>>>=0,e||k(t,8,this.length),l.read(this,t,!0,52,8)},d.prototype.readDoubleBE=function(t,e){return t>>>=0,e||k(t,8,this.length),l.read(this,t,!1,52,8)},d.prototype.writeUintLE=d.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;N(this,t,e,r,n,0)}let i=1,a=0;for(this[e]=255&t;++a<r&&(i*=256);)this[e+a]=t/i&255;return e+r},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;N(this,t,e,r,n,0)}let i=r-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+r},d.prototype.writeUint8=d.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||N(this,t,e,1,255,0),this[e]=255&t,e+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||N(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||N(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||N(this,t,e,4,0xffffffff,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||N(this,t,e,4,0xffffffff,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},d.prototype.writeBigUInt64LE=U(function(t,e=0){return O(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),d.prototype.writeBigUInt64BE=U(function(t,e=0){return T(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),d.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){let n=Math.pow(2,8*r-1);N(this,t,e,r,n-1,-n)}let i=0,a=1,o=0;for(this[e]=255&t;++i<r&&(a*=256);)t<0&&0===o&&0!==this[e+i-1]&&(o=1),this[e+i]=(t/a>>0)-o&255;return e+r},d.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){let n=Math.pow(2,8*r-1);N(this,t,e,r,n-1,-n)}let i=r-1,a=1,o=0;for(this[e+i]=255&t;--i>=0&&(a*=256);)t<0&&0===o&&0!==this[e+i+1]&&(o=1),this[e+i]=(t/a>>0)-o&255;return e+r},d.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||N(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},d.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||N(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},d.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||N(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},d.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||N(this,t,e,4,0x7fffffff,-0x80000000),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},d.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||N(this,t,e,4,0x7fffffff,-0x80000000),t<0&&(t=0xffffffff+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},d.prototype.writeBigInt64LE=U(function(t,e=0){return O(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),d.prototype.writeBigInt64BE=U(function(t,e=0){return T(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),d.prototype.writeFloatLE=function(t,e,r){return A(this,t,e,!0,r)},d.prototype.writeFloatBE=function(t,e,r){return A(this,t,e,!1,r)},d.prototype.writeDoubleLE=function(t,e,r){return C(this,t,e,!0,r)},d.prototype.writeDoubleBE=function(t,e,r){return C(this,t,e,!1,r)},d.prototype.copy=function(t,e,r,n){if(!d.isBuffer(t))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r||0===t.length||0===this.length)return 0;if(e<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);let i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},d.prototype.fill=function(t,e,r,n){let i;if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!d.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===t.length){let e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw RangeError("Out of range index");if(r<=e)return this;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{let a=d.isBuffer(t)?t:d.from(t,n),o=a.length;if(0===o)throw TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=a[i%o]}return this};let R={};function I(t,e,r){R[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function P(t){let e="",r=t.length,n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function D(t,e,r,n,i,a){if(t>r||t<e){let n;let i="bigint"==typeof e?"n":"";throw n=a>3?0===e||e===BigInt(0)?`>= 0${i} and < 2${i} ** ${(a+1)*8}${i}`:`>= -(2${i} ** ${(a+1)*8-1}${i}) and < 2 ** ${(a+1)*8-1}${i}`:`>= ${e}${i} and <= ${r}${i}`,new R.ERR_OUT_OF_RANGE("value",n,t)}L(i,"offset"),(void 0===n[i]||void 0===n[i+a])&&j(i,n.length-(a+1))}function L(t,e){if("number"!=typeof t)throw new R.ERR_INVALID_ARG_TYPE(e,"number",t)}function j(t,e,r){if(Math.floor(t)!==t)throw L(t,r),new R.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new R.ERR_BUFFER_OUT_OF_BOUNDS;throw new R.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}I("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),I("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError),I("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>0x100000000?i=P(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=P(i)),i+="n"),n+=` It must be ${e}. Received ${i}`},RangeError);let F=/[^+/0-9A-Za-z-_]/g;function B(t,e){let r;e=e||1/0;let n=t.length,i=null,a=[];for(let o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319||o+1===n){(e-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&a.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;a.push(r)}else if(r<2048){if((e-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((e-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return a}function z(t){return s.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length)&&!(i>=t.length);++i)e[i+r]=t[i];return i}function G(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}let $=function(){let t="0123456789abcdef",e=Array(256);for(let r=0;r<16;++r){let n=16*r;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function U(t){return"undefined"==typeof BigInt?H:t}function H(){throw Error("BigInt not supported")}}),v("kuxul",function(t,e){n(t.exports,"toByteArray",()=>r,t=>r=t),n(t.exports,"fromByteArray",()=>i,t=>i=t),r=function(t){var e,r,n=function(t){var e=t.length;if(e%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");-1===r&&(r=e);var n=r===e?0:4-r%4;return[r,n]}(t),i=n[0],a=n[1],l=new s((i+a)*3/4-a),u=0,h=a>0?i-4:i;for(r=0;r<h;r+=4)e=o[t.charCodeAt(r)]<<18|o[t.charCodeAt(r+1)]<<12|o[t.charCodeAt(r+2)]<<6|o[t.charCodeAt(r+3)],l[u++]=e>>16&255,l[u++]=e>>8&255,l[u++]=255&e;return 2===a&&(e=o[t.charCodeAt(r)]<<2|o[t.charCodeAt(r+1)]>>4,l[u++]=255&e),1===a&&(e=o[t.charCodeAt(r)]<<10|o[t.charCodeAt(r+1)]<<4|o[t.charCodeAt(r+2)]>>2,l[u++]=e>>8&255,l[u++]=255&e),l},i=function(t){for(var e,r=t.length,n=r%3,i=[],o=0,s=r-n;o<s;o+=16383)i.push(function(t,e,r){for(var n,i=[],o=e;o<r;o+=3)i.push(a[(n=(t[o]<<16&0xff0000)+(t[o+1]<<8&65280)+(255&t[o+2]))>>18&63]+a[n>>12&63]+a[n>>6&63]+a[63&n]);return i.join("")}(t,o,o+16383>s?s:o+16383));return 1===n?i.push(a[(e=t[r-1])>>2]+a[e<<4&63]+"=="):2===n&&i.push(a[(e=(t[r-2]<<8)+t[r-1])>>10]+a[e>>4&63]+a[e<<2&63]+"="),i.join("")};for(var r,i,a=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,h=l.length;u<h;++u)a[u]=l[u],o[l.charCodeAt(u)]=u;o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63}),v("9NvM5",function(t,e){var r,i;n(t.exports,"read",()=>r,t=>r=t),n(t.exports,"write",()=>i,t=>i=t),r=function(t,e,r,n,i){var a,o,s=8*i-n-1,l=(1<<s)-1,u=l>>1,h=-7,d=r?i-1:0,c=r?-1:1,f=t[e+d];for(d+=c,a=f&(1<<-h)-1,f>>=-h,h+=s;h>0;a=256*a+t[e+d],d+=c,h-=8);for(o=a&(1<<-h)-1,a>>=-h,h+=n;h>0;o=256*o+t[e+d],d+=c,h-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),a-=u}return(f?-1:1)*o*Math.pow(2,a-n)},i=function(t,e,r,n,i,a){var o,s,l,u=8*a-i-1,h=(1<<u)-1,d=h>>1,c=23===i?5960464477539062e-23:0,f=n?0:a-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(isNaN(e=Math.abs(e))||e===1/0?(s=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+d>=1?e+=c/l:e+=c*Math.pow(2,1-d),e*l>=2&&(o++,l/=2),o+d>=h?(s=0,o=h):o+d>=1?(s=(e*l-1)*Math.pow(2,i),o+=d):(s=e*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;t[r+f]=255&s,f+=p,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;t[r+f]=255&o,f+=p,o/=256,u-=8);t[r+f-p]|=128*g}}),v("bHKGd",function(t,e){let{AbortController:r,AbortSignal:n}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;t.exports=r,t.exports.AbortSignal=n,t.exports.default=r}),v("7etJZ",function(t,e){var r,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};r=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise(function(r,n){var i;function a(r){t.removeListener(e,o),n(r)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",a),r([].slice.call(arguments))}y(t,e,o,{once:!0}),"error"!==e&&(i={once:!0},"function"==typeof t.on&&y(t,"error",a,i))})},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function l(t){if("function"!=typeof t)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function u(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function h(t,e,r,n){if(l(r),void 0===(a=t._events)?(a=t._events=Object.create(null),t._eventsCount=0):(void 0!==a.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),a=t._events),o=a[e]),void 0===o)o=a[e]=r,++t._eventsCount;else if("function"==typeof o?o=a[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(i=u(t))>0&&o.length>i&&!o.warned){o.warned=!0;var i,a,o,s=Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=o.length,console&&console.warn&&console.warn(s)}return t}function d(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=d.bind(n);return i.listener=r,n.wrapFn=i,i}function f(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(t){for(var e=Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):g(i,i.length)}function p(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function g(t,e){for(var r=Array(e),n=0;n<e;++n)r[n]=t[n];return r}function y(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else if("function"==typeof t.addEventListener)t.addEventListener(e,function i(a){n.once&&t.removeEventListener(e,i),r(a)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||a(t))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,a=this._events;if(void 0!==a)n=n&&void 0===a.error;else if(!n)return!1;if(n){if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var o,s=Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[t];if(void 0===l)return!1;if("function"==typeof l)i(l,this,e);else for(var u=l.length,h=g(l,u),r=0;r<u;++r)i(h[r],this,e);return!0},o.prototype.addListener=function(t,e){return h(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return h(this,t,e,!0)},o.prototype.once=function(t,e){return l(e),this.on(t,c(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return l(e),this.prependListener(t,c(this,t,e)),this},o.prototype.removeListener=function(t,e){var r,n,i,a,o;if(l(e),void 0===(n=this._events)||void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===e||r[a].listener===e){o=r[a].listener,i=a;break}if(i<0)return this;0===i?r.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,o||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0==arguments.length){var i,a=Object.keys(r);for(n=0;n<a.length;++n)"removeListener"!==(i=a[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},o.prototype.listeners=function(t){return f(this,t,!0)},o.prototype.rawListeners=function(t){return f(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}}),v("aAPdh",function(t,e){let r,n;var i=y("e93qE"),a=i.ObjectDefineProperties,o=i.ObjectGetOwnPropertyDescriptor,s=i.ObjectKeys,l=i.ObjectSetPrototypeOf;t.exports=d;var u=y("2HCgn"),h=y("e6GFj");l(d.prototype,u.prototype),l(d,u);{let t=s(h.prototype);for(let e=0;e<t.length;e++){let r=t[e];d.prototype[r]||(d.prototype[r]=h.prototype[r])}}function d(t){if(!(this instanceof d))return new d(t);u.call(this,t),h.call(this,t),t?(this.allowHalfOpen=!1!==t.allowHalfOpen,!1===t.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===t.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}function c(){return void 0===r&&(r={}),r}a(d.prototype,{writable:{__proto__:null,...o(h.prototype,"writable")},writableHighWaterMark:{__proto__:null,...o(h.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...o(h.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...o(h.prototype,"writableBuffer")},writableLength:{__proto__:null,...o(h.prototype,"writableLength")},writableFinished:{__proto__:null,...o(h.prototype,"writableFinished")},writableCorked:{__proto__:null,...o(h.prototype,"writableCorked")},writableEnded:{__proto__:null,...o(h.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...o(h.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set(t){this._readableState&&this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}}),d.fromWeb=function(t,e){return c().newStreamDuplexFromReadableWritablePair(t,e)},d.toWeb=function(t){return c().newReadableWritablePairFromDuplex(t)},d.from=function(t){return n||(n=y("6gVeK")),n(t,"body")}}),v("2HCgn",function(t,e){let r;var n=y("hPtJY"),i=y("e93qE"),a=i.ArrayPrototypeIndexOf,o=i.NumberIsInteger,s=i.NumberIsNaN,l=i.NumberParseInt,u=i.ObjectDefineProperties,h=i.ObjectKeys,d=i.ObjectSetPrototypeOf,c=i.Promise,f=i.SafeSet,p=i.SymbolAsyncDispose,g=i.SymbolAsyncIterator,v=i.Symbol;t.exports=W,W.ReadableState=H;var m=y("7etJZ").EventEmitter,b=y("1B0VZ"),x=b.Stream,E=b.prependListener,w=y("6ZWSX").Buffer,_=y("19AFn").addAbortSignal,S=y("fiCvv");let k=y("3OYnt").debuglog("stream",t=>{k=t});var N=y("bF5dL"),O=y("fMCbt"),T=y("04a3B"),M=T.getHighWaterMark,A=T.getDefaultHighWaterMark;let{aggregateTwoErrors:C,codes:{ERR_INVALID_ARG_TYPE:R,ERR_METHOD_NOT_IMPLEMENTED:I,ERR_OUT_OF_RANGE:P,ERR_STREAM_PUSH_AFTER_EOF:D,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:L},AbortError:j}=y("aqMop");var F=y("aTBkv").validateObject;let B=v("kPaused");var z=y("eNRCS").StringDecoder,V=y("t3dlL");d(W.prototype,x.prototype),d(W,x);let G=()=>{},{errorOrDestroy:$}=O;function U(t){return{enumerable:!1,get(){return(this.state&t)!=0},set(e){e?this.state|=t:this.state&=~t}}}function H(t,e,r){"boolean"!=typeof r&&(r=e instanceof y("aAPdh")),this.state=6192,t&&t.objectMode&&(this.state|=1),r&&t&&t.readableObjectMode&&(this.state|=1),this.highWaterMark=t?M(this,t,"readableHighWaterMark",r):A(!1),this.buffer=new N,this.length=0,this.pipes=[],this.flowing=null,this[B]=null,t&&!1===t.emitClose&&(this.state&=-2049),t&&!1===t.autoDestroy&&(this.state&=-4097),this.errored=null,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,t&&t.encoding&&(this.decoder=new z(t.encoding),this.encoding=t.encoding)}function W(t){if(!(this instanceof W))return new W(t);let e=this instanceof y("aAPdh");this._readableState=new H(t,this,e),t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.construct&&(this._construct=t.construct),t.signal&&!e&&_(t.signal,this)),x.call(this,t),O.construct(this,()=>{this._readableState.needReadable&&Z(this,this._readableState)})}function q(t,e,r,n){let i;k("readableAddChunk",e);let a=t._readableState;if((1&a.state)==0&&("string"==typeof e?(r=r||a.defaultEncoding,a.encoding!==r&&(n&&a.encoding?e=w.from(e,r).toString(a.encoding):(e=w.from(e,r),r=""))):e instanceof w?r="":x._isUint8Array(e)?(e=x._uint8ArrayToBuffer(e),r=""):null!=e&&(i=new R("chunk",["string","Buffer","Uint8Array"],e))),i)$(t,i);else if(null===e)a.state&=-9,function(t,e){if(k("onEofChunk"),!e.ended){if(e.decoder){let t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,e.sync?X(t):(e.needReadable=!1,e.emittedReadable=!0,J(t))}}(t,a);else if((1&a.state)!=0||e&&e.length>0){if(n){if((4&a.state)!=0)$(t,new L);else{if(a.destroyed||a.errored)return!1;Y(t,a,e,!0)}}else if(a.ended)$(t,new D);else{if(a.destroyed||a.errored)return!1;a.state&=-9,a.decoder&&!r?(e=a.decoder.write(e),a.objectMode||0!==e.length?Y(t,a,e,!1):Z(t,a)):Y(t,a,e,!1)}}else n||(a.state&=-9,Z(t,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function Y(t,e,r,n){e.flowing&&0===e.length&&!e.sync&&t.listenerCount("data")>0?((65536&e.state)!=0?e.awaitDrainWriters.clear():e.awaitDrainWriters=null,e.dataEmitted=!0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),(64&e.state)!=0&&X(t)),Z(t,e)}function K(t,e){return t<=0||0===e.length&&e.ended?0:(1&e.state)!=0?1:s(t)?e.flowing&&e.length?e.buffer.first().length:e.length:t<=e.length?t:e.ended?e.length:0}function X(t){let e=t._readableState;k("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(k("emitReadable",e.flowing),e.emittedReadable=!0,n.nextTick(J,t))}function J(t){let e=t._readableState;k("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&!e.errored&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,tn(t)}function Z(t,e){!e.readingMore&&e.constructed&&(e.readingMore=!0,n.nextTick(Q,t,e))}function Q(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){let r=e.length;if(k("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}function tt(t){let e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!1===e[B]?e.flowing=!0:t.listenerCount("data")>0?t.resume():e.readableListening||(e.flowing=null)}function te(t){k("readable nexttick read 0"),t.read(0)}function tr(t,e){k("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),tn(t),e.flowing&&!e.reading&&t.read(0)}function tn(t){let e=t._readableState;for(k("flow",e.flowing);e.flowing&&null!==t.read(););}function ti(t,e){"function"!=typeof t.read&&(t=W.wrap(t,{objectMode:!0}));let r=ta(t,e);return r.stream=t,r}async function*ta(t,e){let r,n=G;function i(e){this===t?(n(),n=G):n=e}t.on("readable",i);let a=S(t,{writable:!1},t=>{r=t?C(r,t):null,n(),n=G});try{for(;;){let e=t.destroyed?null:t.read();if(null!==e)yield e;else if(r)throw r;else{if(null===r)return;await new c(i)}}}catch(t){throw r=C(r,t)}finally{(r||(null==e?void 0:e.destroyOnReturn)!==!1)&&(void 0===r||t._readableState.autoDestroy)?O.destroyer(t,null):(t.off("readable",i),a())}}function to(t,e){let r;return 0===e.length?null:(e.objectMode?r=e.buffer.shift():!t||t>=e.length?(r=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r)}function ts(t){let e=t._readableState;k("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,n.nextTick(tl,e,t))}function tl(t,e){if(k("endReadableNT",t.endEmitted,t.length),!t.errored&&!t.closeEmitted&&!t.endEmitted&&0===t.length){if(t.endEmitted=!0,e.emit("end"),e.writable&&!1===e.allowHalfOpen)n.nextTick(tu,e);else if(t.autoDestroy){let t=e._writableState;(!t||t.autoDestroy&&(t.finished||!1===t.writable))&&e.destroy()}}}function tu(t){!t.writable||t.writableEnded||t.destroyed||t.end()}function th(){return void 0===r&&(r={}),r}u(H.prototype,{objectMode:U(1),ended:U(2),endEmitted:U(4),reading:U(8),constructed:U(16),sync:U(32),needReadable:U(64),emittedReadable:U(128),readableListening:U(256),resumeScheduled:U(512),errorEmitted:U(1024),emitClose:U(2048),autoDestroy:U(4096),destroyed:U(8192),closed:U(16384),closeEmitted:U(32768),multiAwaitDrain:U(65536),readingMore:U(131072),dataEmitted:U(262144)}),W.prototype.destroy=O.destroy,W.prototype._undestroy=O.undestroy,W.prototype._destroy=function(t,e){e(t)},W.prototype[m.captureRejectionSymbol]=function(t){this.destroy(t)},W.prototype[p]=function(){let t;return this.destroyed||(t=this.readableEnded?null:new j,this.destroy(t)),new c((e,r)=>S(this,n=>n&&n!==t?r(n):e(null)))},W.prototype.push=function(t,e){return q(this,t,e,!1)},W.prototype.unshift=function(t,e){return q(this,t,e,!0)},W.prototype.isPaused=function(){let t=this._readableState;return!0===t[B]||!1===t.flowing},W.prototype.setEncoding=function(t){let e=new z(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;let r=this._readableState.buffer,n="";for(let t of r)n+=e.write(t);return r.clear(),""!==n&&r.push(n),this._readableState.length=n.length,this},W.prototype.read=function(t){let e;k("read",t),void 0===t?t=NaN:o(t)||(t=l(t,10));let r=this._readableState,n=t;if(t>r.highWaterMark&&(r.highWaterMark=function(t){if(t>0x40000000)throw new P("size","<= 1GiB",t);return t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,++t}(t)),0!==t&&(r.state&=-129),0===t&&r.needReadable&&((0!==r.highWaterMark?r.length>=r.highWaterMark:r.length>0)||r.ended))return k("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?ts(this):X(this),null;if(0===(t=K(t,r))&&r.ended)return 0===r.length&&ts(this),null;let i=(64&r.state)!=0;if(k("need readable",i),(0===r.length||r.length-t<r.highWaterMark)&&k("length less than watermark",i=!0),r.ended||r.reading||r.destroyed||r.errored||!r.constructed)k("reading, ended or constructing",i=!1);else if(i){k("do read"),r.state|=40,0===r.length&&(r.state|=64);try{this._read(r.highWaterMark)}catch(t){$(this,t)}r.state&=-33,r.reading||(t=K(n,r))}return null===(e=t>0?to(t,r):null)?(r.needReadable=r.length<=r.highWaterMark,t=0):(r.length-=t,r.multiAwaitDrain?r.awaitDrainWriters.clear():r.awaitDrainWriters=null),0===r.length&&(r.ended||(r.needReadable=!0),n!==t&&r.ended&&ts(this)),null===e||r.errorEmitted||r.closeEmitted||(r.dataEmitted=!0,this.emit("data",e)),e},W.prototype._read=function(t){throw new I("_read()")},W.prototype.pipe=function(t,e){let r;let i=this,a=this._readableState;1!==a.pipes.length||a.multiAwaitDrain||(a.multiAwaitDrain=!0,a.awaitDrainWriters=new f(a.awaitDrainWriters?[a.awaitDrainWriters]:[])),a.pipes.push(t),k("pipe count=%d opts=%j",a.pipes.length,e);let o=e&&!1===e.end||t===n.stdout||t===n.stderr?g:s;function s(){k("onend"),t.end()}a.endEmitted?n.nextTick(o):i.once("end",o),t.on("unpipe",function e(n,o){k("onunpipe"),n===i&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,k("cleanup"),t.removeListener("close",c),t.removeListener("finish",p),r&&t.removeListener("drain",r),t.removeListener("error",d),t.removeListener("unpipe",e),i.removeListener("end",s),i.removeListener("end",g),i.removeListener("data",h),l=!0,r&&a.awaitDrainWriters&&(!t._writableState||t._writableState.needDrain)&&r())});let l=!1;function u(){l||(1===a.pipes.length&&a.pipes[0]===t?(k("false write response, pause",0),a.awaitDrainWriters=t,a.multiAwaitDrain=!1):a.pipes.length>1&&a.pipes.includes(t)&&(k("false write response, pause",a.awaitDrainWriters.size),a.awaitDrainWriters.add(t)),i.pause()),r||(r=function(){let e=i._readableState;e.awaitDrainWriters===t?(k("pipeOnDrain",1),e.awaitDrainWriters=null):e.multiAwaitDrain&&(k("pipeOnDrain",e.awaitDrainWriters.size),e.awaitDrainWriters.delete(t)),(!e.awaitDrainWriters||0===e.awaitDrainWriters.size)&&i.listenerCount("data")&&i.resume()},t.on("drain",r))}function h(e){k("ondata");let r=t.write(e);k("dest.write",r),!1===r&&u()}function d(e){if(k("onerror",e),g(),t.removeListener("error",d),0===t.listenerCount("error")){let r=t._writableState||t._readableState;r&&!r.errorEmitted?$(t,e):t.emit("error",e)}}function c(){t.removeListener("finish",p),g()}function p(){k("onfinish"),t.removeListener("close",c),g()}function g(){k("unpipe"),i.unpipe(t)}return i.on("data",h),E(t,"error",d),t.once("close",c),t.once("finish",p),t.emit("pipe",i),!0===t.writableNeedDrain?u():a.flowing||(k("pipe resume"),i.resume()),t},W.prototype.unpipe=function(t){let e=this._readableState;if(0===e.pipes.length)return this;if(!t){let t=e.pipes;e.pipes=[],this.pause();for(let e=0;e<t.length;e++)t[e].emit("unpipe",this,{hasUnpiped:!1});return this}let r=a(e.pipes,t);return -1===r||(e.pipes.splice(r,1),0===e.pipes.length&&this.pause(),t.emit("unpipe",this,{hasUnpiped:!1})),this},W.prototype.on=function(t,e){let r=x.prototype.on.call(this,t,e),i=this._readableState;return"data"===t?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"!==t||i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,k("on readable",i.length,i.reading),i.length?X(this):i.reading||n.nextTick(te,this)),r},W.prototype.addListener=W.prototype.on,W.prototype.removeListener=function(t,e){let r=x.prototype.removeListener.call(this,t,e);return"readable"===t&&n.nextTick(tt,this),r},W.prototype.off=W.prototype.removeListener,W.prototype.removeAllListeners=function(t){let e=x.prototype.removeAllListeners.apply(this,arguments);return("readable"===t||void 0===t)&&n.nextTick(tt,this),e},W.prototype.resume=function(){let t=this._readableState;return t.flowing||(k("resume"),t.flowing=!t.readableListening,t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(tr,this,t))),t[B]=!1,this},W.prototype.pause=function(){return k("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(k("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[B]=!0,this},W.prototype.wrap=function(t){let e=!1;t.on("data",r=>{!this.push(r)&&t.pause&&(e=!0,t.pause())}),t.on("end",()=>{this.push(null)}),t.on("error",t=>{$(this,t)}),t.on("close",()=>{this.destroy()}),t.on("destroy",()=>{this.destroy()}),this._read=()=>{e&&t.resume&&(e=!1,t.resume())};let r=h(t);for(let e=1;e<r.length;e++){let n=r[e];void 0===this[n]&&"function"==typeof t[n]&&(this[n]=t[n].bind(t))}return this},W.prototype[g]=function(){return ti(this)},W.prototype.iterator=function(t){return void 0!==t&&F(t,"options"),ti(this,t)},u(W.prototype,{readable:{__proto__:null,get(){let t=this._readableState;return!!t&&!1!==t.readable&&!t.destroyed&&!t.errorEmitted&&!t.endEmitted},set(t){this._readableState&&(this._readableState.readable=!!t)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(!1!==this._readableState.readable&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(t){this._readableState&&(this._readableState.destroyed=t)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),u(H.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[B]},set(t){this[B]=!!t}}}),W._fromList=to,W.from=function(t,e){return V(W,t,e)},W.fromWeb=function(t,e){return th().newStreamReadableFromReadableStream(t,e)},W.toWeb=function(t,e){return th().newReadableStreamFromStreamReadable(t,e)},W.wrap=function(t,e){var r,n;return new W({objectMode:null===(r=null!==(n=t.readableObjectMode)&&void 0!==n?n:t.objectMode)||void 0===r||r,...e,destroy(e,r){O.destroyer(t,e),r(e)}}).wrap(t)}}),v("hPtJY",function(t,e){var r,n,i,a=t.exports={};function o(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function l(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var u=[],h=!1,d=-1;function c(){h&&i&&(h=!1,i.length?u=i.concat(u):d=-1,u.length&&f())}function f(){if(!h){var t=l(c);h=!0;for(var e=u.length;e;){for(i=u,u=[];++d<e;)i&&i[d].run();d=-1,e=u.length}i=null,h=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}a.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new p(t,e)),1!==u.length||h||l(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(t){return[]},a.binding=function(t){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}),v("1B0VZ",function(t,e){var r=y("e93qE"),n=r.ArrayIsArray,i=r.ObjectSetPrototypeOf,a=y("7etJZ").EventEmitter;function o(t){a.call(this,t)}function s(t,e,r){if("function"==typeof t.prependListener)return t.prependListener(e,r);t._events&&t._events[e]?n(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]:t.on(e,r)}i(o.prototype,a.prototype),i(o,a),o.prototype.pipe=function(t,e){let r=this;function n(e){t.writable&&!1===t.write(e)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),t.on("drain",i),t._isStdio||e&&!1===e.end||(r.on("end",l),r.on("close",u));let o=!1;function l(){o||(o=!0,t.end())}function u(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function h(t){d(),0===a.listenerCount(this,"error")&&this.emit("error",t)}function d(){r.removeListener("data",n),t.removeListener("drain",i),r.removeListener("end",l),r.removeListener("close",u),r.removeListener("error",h),t.removeListener("error",h),r.removeListener("end",d),r.removeListener("close",d),t.removeListener("close",d)}return s(r,"error",h),s(t,"error",h),r.on("end",d),r.on("close",d),t.on("close",d),t.emit("pipe",r),t},t.exports={Stream:o,prependListener:s}}),v("19AFn",function(t,e){let r;n(t.exports,"addAbortSignal",()=>i,t=>i=t),n(t.exports,"addAbortSignalNoValidate",()=>a,t=>a=t);var i,a,o=y("e93qE").SymbolDispose,s=y("aqMop"),l=s.AbortError,u=s.codes,h=y("b0Zn2"),d=h.isNodeStream,c=h.isWebStream,f=h.kControllerErrorFunction,p=y("fiCvv");let{ERR_INVALID_ARG_TYPE:g}=u,v=(t,e)=>{if("object"!=typeof t||!("aborted"in t))throw new g(e,"AbortSignal",t)};i=function(t,e){if(v(t,"signal"),!d(e)&&!c(e))throw new g("stream",["ReadableStream","WritableStream","Stream"],e);return a(t,e)},a=function(t,e){if("object"!=typeof t||!("aborted"in t))return e;let n=d(e)?()=>{e.destroy(new l(void 0,{cause:t.reason}))}:()=>{e[f](new l(void 0,{cause:t.reason}))};return t.aborted?n():p(e,(r=r||y("3OYnt").addAbortListener)(t,n)[o]),e}}),v("aqMop",function(t,e){var r=y("3OYnt"),n=r.format,i=r.inspect,a=r.AggregateError;let o=globalThis.AggregateError||a,s=Symbol("kIsNodeError"),l=["string","function","number","object","Function","Object","boolean","bigint","symbol"],u=/^([A-Z][a-z0-9]*)+$/,h={};function d(t,e){if(!t)throw new h.ERR_INTERNAL_ASSERTION(e)}function c(t){let e="",r=t.length,n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function f(t,e,r){r||(r=Error);class i extends r{constructor(...r){super(function(t,e,r){if("function"==typeof e)return d(e.length<=r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${e.length}).`),e(...r);let i=(e.match(/%[dfijoOs]/g)||[]).length;return(d(i===r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${i}).`),0===r.length)?e:n(e,...r)}(t,e,r))}toString(){return`${this.name} [${t}]: ${this.message}`}}Object.defineProperties(i.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${t}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),i.prototype.code=t,i.prototype[s]=!0,h[t]=i}function p(t){let e="__node_internal_"+t.name;return Object.defineProperty(t,"name",{value:e}),t}f("ERR_ASSERTION","%s",Error),f("ERR_INVALID_ARG_TYPE",(t,e,r)=>{d("string"==typeof t,"'name' must be a string"),Array.isArray(e)||(e=[e]);let n="The ";t.endsWith(" argument")?n+=`${t} `:n+=`"${t}" ${t.includes(".")?"property":"argument"} `,n+="must be ";let a=[],o=[],s=[];for(let t of e)d("string"==typeof t,"All expected entries have to be of type string"),l.includes(t)?a.push(t.toLowerCase()):u.test(t)?o.push(t):(d("object"!==t,'The value "object" should be written as "Object"'),s.push(t));if(o.length>0){let t=a.indexOf("object");-1!==t&&(a.splice(a,t,1),o.push("Object"))}if(a.length>0){switch(a.length){case 1:n+=`of type ${a[0]}`;break;case 2:n+=`one of type ${a[0]} or ${a[1]}`;break;default:{let t=a.pop();n+=`one of type ${a.join(", ")}, or ${t}`}}(o.length>0||s.length>0)&&(n+=" or ")}if(o.length>0){switch(o.length){case 1:n+=`an instance of ${o[0]}`;break;case 2:n+=`an instance of ${o[0]} or ${o[1]}`;break;default:{let t=o.pop();n+=`an instance of ${o.join(", ")}, or ${t}`}}s.length>0&&(n+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(n+="an "),n+=`${s[0]}`;break;case 2:n+=`one of ${s[0]} or ${s[1]}`;break;default:{let t=s.pop();n+=`one of ${s.join(", ")}, or ${t}`}}if(null==r)n+=`. Received ${r}`;else if("function"==typeof r&&r.name)n+=`. Received function ${r.name}`;else if("object"==typeof r){var h;if(null!==(h=r.constructor)&&void 0!==h&&h.name)n+=`. Received an instance of ${r.constructor.name}`;else{let t=i(r,{depth:-1});n+=`. Received ${t}`}}else{let t=i(r,{colors:!1});t.length>25&&(t=`${t.slice(0,25)}...`),n+=`. Received type ${typeof r} (${t})`}return n},TypeError),f("ERR_INVALID_ARG_VALUE",(t,e,r="is invalid")=>{let n=i(e);n.length>128&&(n=n.slice(0,128)+"...");let a=t.includes(".")?"property":"argument";return`The ${a} '${t}' ${r}. Received ${n}`},TypeError),f("ERR_INVALID_RETURN_VALUE",(t,e,r)=>{var n;let i=null!=r&&null!==(n=r.constructor)&&void 0!==n&&n.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${t} to be returned from the "${e}" function but got ${i}.`},TypeError),f("ERR_MISSING_ARGS",(...t)=>{let e;d(t.length>0,"At least one arg needs to be specified");let r=t.length;switch(t=(Array.isArray(t)?t:[t]).map(t=>`"${t}"`).join(" or "),r){case 1:e+=`The ${t[0]} argument`;break;case 2:e+=`The ${t[0]} and ${t[1]} arguments`;break;default:{let r=t.pop();e+=`The ${t.join(", ")}, and ${r} arguments`}}return`${e} must be specified`},TypeError),f("ERR_OUT_OF_RANGE",(t,e,r)=>{let n;return d(e,'Missing "range" argument'),Number.isInteger(r)&&Math.abs(r)>0x100000000?n=c(String(r)):"bigint"==typeof r?(n=String(r),(r>2n**32n||r<-(2n**32n))&&(n=c(n)),n+="n"):n=i(r),`The value of "${t}" is out of range. It must be ${e}. Received ${n}`},RangeError),f("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),f("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),f("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),f("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),f("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),f("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),f("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),f("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),f("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),f("ERR_STREAM_WRITE_AFTER_END","write after end",Error),f("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),t.exports={AbortError:class extends Error{constructor(t="The operation was aborted",e){if(void 0!==e&&"object"!=typeof e)throw new h.ERR_INVALID_ARG_TYPE("options","Object",e);super(t,e),this.code="ABORT_ERR",this.name="AbortError"}},aggregateTwoErrors:p(function(t,e){if(t&&e&&t!==e){if(Array.isArray(e.errors))return e.errors.push(t),e;let r=new o([e,t],e.message);return r.code=e.code,r}return t||e}),hideStackFrames:p,codes:h}}),v("b0Zn2",function(t,e){var r=y("e93qE"),n=r.SymbolAsyncIterator,i=r.SymbolIterator,a=r.SymbolFor;let o=a("nodejs.stream.destroyed"),s=a("nodejs.stream.errored"),l=a("nodejs.stream.readable"),u=a("nodejs.stream.writable"),h=a("nodejs.stream.disturbed"),d=a("nodejs.webstream.isClosedPromise"),c=a("nodejs.webstream.controllerErrorFunction");function f(t,e=!1){var r;return!!(t&&"function"==typeof t.pipe&&"function"==typeof t.on&&(!e||"function"==typeof t.pause&&"function"==typeof t.resume)&&(!t._writableState||(null===(r=t._readableState)||void 0===r?void 0:r.readable)!==!1)&&(!t._writableState||t._readableState))}function p(t){var e;return!!(t&&"function"==typeof t.write&&"function"==typeof t.on&&(!t._readableState||(null===(e=t._writableState)||void 0===e?void 0:e.writable)!==!1))}function g(t){return t&&(t._readableState||t._writableState||"function"==typeof t.write&&"function"==typeof t.on||"function"==typeof t.pipe&&"function"==typeof t.on)}function v(t){return!!(t&&!g(t)&&"function"==typeof t.pipeThrough&&"function"==typeof t.getReader&&"function"==typeof t.cancel)}function m(t){return!!(t&&!g(t)&&"function"==typeof t.getWriter&&"function"==typeof t.abort)}function b(t){return!!(t&&!g(t)&&"object"==typeof t.readable&&"object"==typeof t.writable)}function x(t){if(!g(t))return null;let e=t._writableState,r=t._readableState,n=e||r;return!!(t.destroyed||t[o]||null!=n&&n.destroyed)}function E(t){if(!p(t))return null;if(!0===t.writableEnded)return!0;let e=t._writableState;return(null==e||!e.errored)&&("boolean"!=typeof(null==e?void 0:e.ended)?null:e.ended)}function w(t,e){if(!f(t))return null;let r=t._readableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.endEmitted)?null:!!(r.endEmitted||!1===e&&!0===r.ended&&0===r.length))}function _(t){return t&&null!=t[l]?t[l]:"boolean"!=typeof(null==t?void 0:t.readable)?null:!x(t)&&f(t)&&t.readable&&!w(t)}function S(t){return t&&null!=t[u]?t[u]:"boolean"!=typeof(null==t?void 0:t.writable)?null:!x(t)&&p(t)&&t.writable&&!E(t)}function k(t){return"boolean"==typeof t._closed&&"boolean"==typeof t._defaultKeepAlive&&"boolean"==typeof t._removedConnection&&"boolean"==typeof t._removedContLen}function N(t){return"boolean"==typeof t._sent100&&k(t)}t.exports={isDestroyed:x,kIsDestroyed:o,isDisturbed:function(t){var e;return!!(t&&(null!==(e=t[h])&&void 0!==e?e:t.readableDidRead||t.readableAborted))},kIsDisturbed:h,isErrored:function(t){var e,r,n,i,a,o,l,u,h,d;return!!(t&&(null!==(e=null!==(r=null!==(n=null!==(i=null!==(a=null!==(o=t[s])&&void 0!==o?o:t.readableErrored)&&void 0!==a?a:t.writableErrored)&&void 0!==i?i:null===(l=t._readableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==n?n:null===(u=t._writableState)||void 0===u?void 0:u.errorEmitted)&&void 0!==r?r:null===(h=t._readableState)||void 0===h?void 0:h.errored)&&void 0!==e?e:null===(d=t._writableState)||void 0===d?void 0:d.errored))},kIsErrored:s,isReadable:_,kIsReadable:l,kIsClosedPromise:d,kControllerErrorFunction:c,kIsWritable:u,isClosed:function(t){if(!g(t))return null;if("boolean"==typeof t.closed)return t.closed;let e=t._writableState,r=t._readableState;return"boolean"==typeof(null==e?void 0:e.closed)||"boolean"==typeof(null==r?void 0:r.closed)?(null==e?void 0:e.closed)||(null==r?void 0:r.closed):"boolean"==typeof t._closed&&k(t)?t._closed:null},isDuplexNodeStream:function(t){return!!(t&&"function"==typeof t.pipe&&t._readableState&&"function"==typeof t.on&&"function"==typeof t.write)},isFinished:function(t,e){return g(t)?!!x(t)||!((null==e?void 0:e.readable)!==!1&&_(t)||(null==e?void 0:e.writable)!==!1&&S(t)):null},isIterable:function(t,e){return null!=t&&(!0===e?"function"==typeof t[n]:!1===e?"function"==typeof t[i]:"function"==typeof t[n]||"function"==typeof t[i])},isReadableNodeStream:f,isReadableStream:v,isReadableEnded:function(t){if(!f(t))return null;if(!0===t.readableEnded)return!0;let e=t._readableState;return!!e&&!e.errored&&("boolean"!=typeof(null==e?void 0:e.ended)?null:e.ended)},isReadableFinished:w,isReadableErrored:function(t){var e,r;return g(t)?t.readableErrored?t.readableErrored:null!==(e=null===(r=t._readableState)||void 0===r?void 0:r.errored)&&void 0!==e?e:null:null},isNodeStream:g,isWebStream:function(t){return v(t)||m(t)||b(t)},isWritable:S,isWritableNodeStream:p,isWritableStream:m,isWritableEnded:E,isWritableFinished:function(t,e){if(!p(t))return null;if(!0===t.writableFinished)return!0;let r=t._writableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.finished)?null:!!(r.finished||!1===e&&!0===r.ended&&0===r.length))},isWritableErrored:function(t){var e,r;return g(t)?t.writableErrored?t.writableErrored:null!==(e=null===(r=t._writableState)||void 0===r?void 0:r.errored)&&void 0!==e?e:null:null},isServerRequest:function(t){var e;return"boolean"==typeof t._consuming&&"boolean"==typeof t._dumped&&(null===(e=t.req)||void 0===e?void 0:e.upgradeOrConnect)===void 0},isServerResponse:N,willEmitClose:function(t){if(!g(t))return null;let e=t._writableState,r=t._readableState,n=e||r;return!n&&N(t)||!!(n&&n.autoDestroy&&n.emitClose&&!1===n.closed)},isTransformStream:b}}),v("fiCvv",function(t,e){let r;var n=y("hPtJY"),i=y("aqMop"),a=i.AbortError;let{ERR_INVALID_ARG_TYPE:o,ERR_STREAM_PREMATURE_CLOSE:s}=i.codes;var l=y("3OYnt").kEmptyObject,u=y("3OYnt").once,h=y("aTBkv"),d=h.validateAbortSignal,c=h.validateFunction,f=h.validateObject,p=h.validateBoolean,g=y("e93qE"),v=g.Promise,m=g.PromisePrototypeThen,b=g.SymbolDispose,x=y("b0Zn2"),E=x.isClosed,w=x.isReadable,_=x.isReadableNodeStream,S=x.isReadableStream,k=x.isReadableFinished,N=x.isReadableErrored,O=x.isWritable,T=x.isWritableNodeStream,M=x.isWritableStream,A=x.isWritableFinished,C=x.isWritableErrored,R=x.isNodeStream,I=x.willEmitClose,P=x.kIsClosedPromise;let D=()=>{};function L(t,e,i){var h,p;if(2==arguments.length?(i=e,e=l):null==e?e=l:f(e,"options"),c(i,"callback"),d(e.signal,"options.signal"),i=u(i),S(t)||M(t))return function(t,e,i){let o=!1,s=D;if(e.signal){if(s=()=>{o=!0,i.call(t,new a(void 0,{cause:e.signal.reason}))},e.signal.aborted)n.nextTick(s);else{let n=(r=r||y("3OYnt").addAbortListener)(e.signal,s),a=i;i=u((...e)=>{n[b](),a.apply(t,e)})}}let l=(...e)=>{o||n.nextTick(()=>i.apply(t,e))};return m(t[P].promise,l,l),D}(t,e,i);if(!R(t))throw new o("stream",["ReadableStream","WritableStream","Stream"],t);let g=null!==(h=e.readable)&&void 0!==h?h:_(t),v=null!==(p=e.writable)&&void 0!==p?p:T(t),x=t._writableState,L=t._readableState,j=()=>{t.writable||z()},F=I(t)&&_(t)===g&&T(t)===v,B=A(t,!1),z=()=>{B=!0,t.destroyed&&(F=!1),F&&(!t.readable||g)||g&&!V||i.call(t)},V=k(t,!1),G=()=>{V=!0,t.destroyed&&(F=!1),F&&(!t.writable||v)||v&&!B||i.call(t)},$=e=>{i.call(t,e)},U=E(t),H=()=>{U=!0;let e=C(t)||N(t);return e&&"boolean"!=typeof e?i.call(t,e):g&&!V&&_(t,!0)&&!k(t,!1)||v&&!B&&!A(t,!1)?i.call(t,new s):void i.call(t)},W=()=>{U=!0;let e=C(t)||N(t);if(e&&"boolean"!=typeof e)return i.call(t,e);i.call(t)},q=()=>{t.req.on("finish",z)};t.setHeader&&"function"==typeof t.abort?(t.on("complete",z),F||t.on("abort",H),t.req?q():t.on("request",q)):v&&!x&&(t.on("end",j),t.on("close",j)),F||"boolean"!=typeof t.aborted||t.on("aborted",H),t.on("end",G),t.on("finish",z),!1!==e.error&&t.on("error",$),t.on("close",H),U?n.nextTick(H):null!=x&&x.errorEmitted||null!=L&&L.errorEmitted?F||n.nextTick(W):!g&&(!F||w(t))&&(B||!1===O(t))?n.nextTick(W):!v&&(!F||O(t))&&(V||!1===w(t))?n.nextTick(W):L&&t.req&&t.aborted&&n.nextTick(W);let Y=()=>{i=D,t.removeListener("aborted",H),t.removeListener("complete",z),t.removeListener("abort",H),t.removeListener("request",q),t.req&&t.req.removeListener("finish",z),t.removeListener("end",j),t.removeListener("close",j),t.removeListener("finish",z),t.removeListener("end",G),t.removeListener("error",$),t.removeListener("close",H)};if(e.signal&&!U){let o=()=>{let r=i;Y(),r.call(t,new a(void 0,{cause:e.signal.reason}))};if(e.signal.aborted)n.nextTick(o);else{let n=(r=r||y("3OYnt").addAbortListener)(e.signal,o),a=i;i=u((...e)=>{n[b](),a.apply(t,e)})}}return Y}t.exports=L,t.exports.finished=function(t,e){var r;let n=!1;return null===e&&(e=l),null!==(r=e)&&void 0!==r&&r.cleanup&&(p(e.cleanup,"cleanup"),n=e.cleanup),new v((r,i)=>{let a=L(t,e,t=>{n&&a(),t?i(t):r()})})}}),v("aTBkv",function(t,e){var r=y("e93qE"),n=r.ArrayIsArray,i=r.ArrayPrototypeIncludes,a=r.ArrayPrototypeJoin,o=r.ArrayPrototypeMap,s=r.NumberIsInteger,l=r.NumberIsNaN,u=r.NumberMAX_SAFE_INTEGER,h=r.NumberMIN_SAFE_INTEGER,d=r.NumberParseInt,c=r.ObjectPrototypeHasOwnProperty,f=r.RegExpPrototypeExec,p=r.String,g=r.StringPrototypeToUpperCase,v=r.StringPrototypeTrim;let{hideStackFrames:m,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:x,ERR_INVALID_ARG_VALUE:E,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:_}}=y("aqMop");var S=y("3OYnt");let{normalizeEncoding:k}=S;var S=y("3OYnt");let{isAsyncFunction:N,isArrayBufferView:O}=S.types,T={},M=/^[0-7]+$/,A=m((t,e,r=h,n=u)=>{if("number"!=typeof t)throw new x(e,"number",t);if(!s(t))throw new w(e,"an integer",t);if(t<r||t>n)throw new w(e,`>= ${r} && <= ${n}`,t)}),C=m((t,e,r=-0x80000000,n=0x7fffffff)=>{if("number"!=typeof t)throw new x(e,"number",t);if(!s(t))throw new w(e,"an integer",t);if(t<r||t>n)throw new w(e,`>= ${r} && <= ${n}`,t)}),R=m((t,e,r=!1)=>{if("number"!=typeof t)throw new x(e,"number",t);if(!s(t))throw new w(e,"an integer",t);let n=r?1:0;if(t<n||t>0xffffffff)throw new w(e,`>= ${n} && <= 4294967295`,t)});function I(t,e){if("string"!=typeof t)throw new x(e,"string",t)}let P=m((t,e,r)=>{if(!i(r,t))throw new E(e,t,"must be one of: "+a(o(r,t=>"string"==typeof t?`'${t}'`:p(t)),", "))});function D(t,e){if("boolean"!=typeof t)throw new x(e,"boolean",t)}function L(t,e,r){return null!=t&&c(t,e)?t[e]:r}let j=m((t,e,r=null)=>{let i=L(r,"allowArray",!1),a=L(r,"allowFunction",!1);if(!L(r,"nullable",!1)&&null===t||!i&&n(t)||"object"!=typeof t&&(!a||"function"!=typeof t))throw new x(e,"Object",t)}),F=m((t,e)=>{if(null!=t&&"object"!=typeof t&&"function"!=typeof t)throw new x(e,"a dictionary",t)}),B=m((t,e,r=0)=>{if(!n(t))throw new x(e,"Array",t);if(t.length<r)throw new E(e,t,`must be longer than ${r}`)}),z=m((t,e="buffer")=>{if(!O(t))throw new x(e,["Buffer","TypedArray","DataView"],t)}),V=m((t,e)=>{if(void 0!==t&&(null===t||"object"!=typeof t||!("aborted"in t)))throw new x(e,"AbortSignal",t)}),G=m((t,e)=>{if("function"!=typeof t)throw new x(e,"Function",t)}),$=m((t,e)=>{if("function"!=typeof t||N(t))throw new x(e,"Function",t)}),U=m((t,e)=>{if(void 0!==t)throw new x(e,"undefined",t)}),H=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function W(t,e){if(void 0===t||!f(H,t))throw new E(e,t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}t.exports={isInt32:function(t){return t===(0|t)},isUint32:function(t){return t===t>>>0},parseFileMode:function(t,e,r){if(void 0===t&&(t=r),"string"==typeof t){if(null===f(M,t))throw new E(e,t,"must be a 32-bit unsigned integer or an octal string");t=d(t,8)}return R(t,e),t},validateArray:B,validateStringArray:function(t,e){B(t,e);for(let r=0;r<t.length;r++)I(t[r],`${e}[${r}]`)},validateBooleanArray:function(t,e){B(t,e);for(let r=0;r<t.length;r++)D(t[r],`${e}[${r}]`)},validateAbortSignalArray:function(t,e){B(t,e);for(let r=0;r<t.length;r++){let n=t[r],i=`${e}[${r}]`;if(null==n)throw new x(i,"AbortSignal",n);V(n,i)}},validateBoolean:D,validateBuffer:z,validateDictionary:F,validateEncoding:function(t,e){let r=k(e),n=t.length;if("hex"===r&&n%2!=0)throw new E("encoding",e,`is invalid for data of length ${n}`)},validateFunction:G,validateInt32:C,validateInteger:A,validateNumber:function(t,e,r,n){if("number"!=typeof t)throw new x(e,"number",t);if(null!=r&&t<r||null!=n&&t>n||(null!=r||null!=n)&&l(t))throw new w(e,`${null!=r?`>= ${r}`:""}${null!=r&&null!=n?" && ":""}${null!=n?`<= ${n}`:""}`,t)},validateObject:j,validateOneOf:P,validatePlainFunction:$,validatePort:function(t,e="Port",r=!0){if("number"!=typeof t&&"string"!=typeof t||"string"==typeof t&&0===v(t).length||+t!=+t>>>0||t>65535||0===t&&!r)throw new b(e,t,r);return 0|t},validateSignalName:function(t,e="signal"){if(I(t,e),void 0===T[t]){if(void 0!==T[g(t)])throw new _(t+" (signals must use all capital letters)");throw new _(t)}},validateString:I,validateUint32:R,validateUndefined:U,validateUnion:function(t,e,r){if(!i(r,t))throw new x(e,`('${a(r,"|")}')`,t)},validateAbortSignal:V,validateLinkHeaderValue:function(t){if("string"==typeof t)return W(t,"hints"),t;if(n(t)){let e=t.length,r="";if(0===e)return r;for(let n=0;n<e;n++){let i=t[n];W(i,"hints"),r+=i,n!==e-1&&(r+=", ")}return r}throw new E("hints",t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}}),v("bF5dL",function(t,e){var r=y("e93qE"),n=r.StringPrototypeSlice,i=r.SymbolIterator,a=r.TypedArrayPrototypeSet,o=r.Uint8Array,s=y("6ZWSX").Buffer,l=y("3OYnt").inspect;t.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){let e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}unshift(t){let e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}shift(){if(0===this.length)return;let t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(0===this.length)return"";let e=this.head,r=""+e.data;for(;null!==(e=e.next);)r+=t+e.data;return r}concat(t){if(0===this.length)return s.alloc(0);let e=s.allocUnsafe(t>>>0),r=this.head,n=0;for(;r;)a(e,r.data,n),n+=r.data.length,r=r.next;return e}consume(t,e){let r=this.head.data;if(t<r.length){let e=r.slice(0,t);return this.head.data=r.slice(t),e}return t===r.length?this.shift():e?this._getString(t):this._getBuffer(t)}first(){return this.head.data}*[i](){for(let t=this.head;t;t=t.next)yield t.data}_getString(t){let e="",r=this.head,i=0;do{let a=r.data;if(t>a.length)e+=a,t-=a.length;else{t===a.length?(e+=a,++i,r.next?this.head=r.next:this.head=this.tail=null):(e+=n(a,0,t),this.head=r,r.data=n(a,t));break}++i}while(null!==(r=r.next))return this.length-=i,e}_getBuffer(t){let e=s.allocUnsafe(t),r=t,n=this.head,i=0;do{let s=n.data;if(t>s.length)a(e,s,r-t),t-=s.length;else{t===s.length?(a(e,s,r-t),++i,n.next?this.head=n.next:this.head=this.tail=null):(a(e,new o(s.buffer,s.byteOffset,t),r-t),this.head=n,n.data=s.slice(t));break}++i}while(null!==(n=n.next))return this.length-=i,e}[Symbol.for("nodejs.util.inspect.custom")](t,e){return l(this,{...e,depth:0,customInspect:!1})}}}),v("fMCbt",function(t,e){var r=y("hPtJY");let{aggregateTwoErrors:n,codes:{ERR_MULTIPLE_CALLBACK:i},AbortError:a}=y("aqMop");var o=y("e93qE").Symbol,s=y("b0Zn2"),l=s.kIsDestroyed,u=s.isDestroyed,h=s.isFinished,d=s.isServerRequest;let c=o("kDestroy"),f=o("kConstruct");function p(t,e,r){t&&(t.stack,e&&!e.errored&&(e.errored=t),r&&!r.errored&&(r.errored=t))}function g(t,e,n){let i=!1;function a(e){if(i)return;i=!0;let a=t._readableState,o=t._writableState;p(e,o,a),o&&(o.closed=!0),a&&(a.closed=!0),"function"==typeof n&&n(e),e?r.nextTick(v,t,e):r.nextTick(m,t)}try{t._destroy(e||null,a)}catch(t){a(t)}}function v(t,e){b(t,e),m(t)}function m(t){let e=t._readableState,r=t._writableState;r&&(r.closeEmitted=!0),e&&(e.closeEmitted=!0),(null!=r&&r.emitClose||null!=e&&e.emitClose)&&t.emit("close")}function b(t,e){let r=t._readableState,n=t._writableState;null!=n&&n.errorEmitted||null!=r&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),t.emit("error",e))}function x(t,e,n){let i=t._readableState,a=t._writableState;if(null!=a&&a.destroyed||null!=i&&i.destroyed)return this;null!=i&&i.autoDestroy||null!=a&&a.autoDestroy?t.destroy(e):e&&(e.stack,a&&!a.errored&&(a.errored=e),i&&!i.errored&&(i.errored=e),n?r.nextTick(b,t,e):b(t,e))}function E(t){let e=!1;function n(n){if(e){x(t,null!=n?n:new i);return}e=!0;let a=t._readableState,o=t._writableState,s=o||a;a&&(a.constructed=!0),o&&(o.constructed=!0),s.destroyed?t.emit(c,n):n?x(t,n,!0):r.nextTick(w,t)}try{t._construct(t=>{r.nextTick(n,t)})}catch(t){r.nextTick(n,t)}}function w(t){t.emit(f)}function _(t){return(null==t?void 0:t.setHeader)&&"function"==typeof t.abort}function S(t){t.emit("close")}function k(t,e){t.emit("error",e),r.nextTick(S,t)}t.exports={construct:function(t,e){if("function"!=typeof t._construct)return;let n=t._readableState,i=t._writableState;n&&(n.constructed=!1),i&&(i.constructed=!1),t.once(f,e),t.listenerCount(f)>1||r.nextTick(E,t)},destroyer:function(t,e){!t||u(t)||(e||h(t)||(e=new a),d(t)?(t.socket=null,t.destroy(e)):_(t)?t.abort():_(t.req)?t.req.abort():"function"==typeof t.destroy?t.destroy(e):"function"==typeof t.close?t.close():e?r.nextTick(k,t,e):r.nextTick(S,t),t.destroyed||(t[l]=!0))},destroy:function(t,e){let r=this._readableState,i=this._writableState,a=i||r;return null!=i&&i.destroyed||null!=r&&r.destroyed?"function"==typeof e&&e():(p(t,i,r),i&&(i.destroyed=!0),r&&(r.destroyed=!0),a.constructed?g(this,t,e):this.once(c,function(r){g(this,n(r,t),e)})),this},undestroy:function(){let t=this._readableState,e=this._writableState;t&&(t.constructed=!0,t.closed=!1,t.closeEmitted=!1,t.destroyed=!1,t.errored=null,t.errorEmitted=!1,t.reading=!1,t.ended=!1===t.readable,t.endEmitted=!1===t.readable),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=!1===e.writable,e.ending=!1===e.writable,e.finished=!1===e.writable)},errorOrDestroy:x}}),v("04a3B",function(t,e){var r=y("e93qE"),n=r.MathFloor,i=r.NumberIsInteger,a=y("aTBkv").validateInteger;let{ERR_INVALID_ARG_VALUE:o}=y("aqMop").codes,s=16384,l=16;function u(t){return t?l:s}t.exports={getHighWaterMark:function(t,e,r,a){let s=null!=e.highWaterMark?e.highWaterMark:a?e[r]:null;if(null!=s){if(!i(s)||s<0)throw new o(a?`options.${r}`:"options.highWaterMark",s);return n(s)}return u(t.objectMode)},getDefaultHighWaterMark:u,setDefaultHighWaterMark:function(t,e){a(e,"value",0),t?l=e:s=e}}}),v("eNRCS",function(t,e){n(t.exports,"StringDecoder",()=>r,t=>r=t);var r,i=y("1U9GM").Buffer,a=i.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){var e;if(!t)return"utf8";for(;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(i.isEncoding===a||!a(t)))throw Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=u,this.end=h,e=4;break;case"utf8":this.fillLast=l,e=4;break;case"base64":this.text=d,this.end=c,e=3;break;default:this.write=f,this.end=p;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function l(t){var e=this.lastTotal-this.lastNeed,r=function(t,e,r){if((192&e[0])!=128)return t.lastNeed=0,"";if(t.lastNeed>1&&e.length>1){if((192&e[1])!=128)return t.lastNeed=1,"";if(t.lastNeed>2&&e.length>2&&(192&e[2])!=128)return t.lastNeed=2,""}}(this,t,0);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length)}function u(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function h(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function d(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function c(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}r=o,o.prototype.write=function(t){var e,r;if(0===t.length)return"";if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"":e},o.prototype.text=function(t,e){var r=function(t,e,r){var n=e.length-1;if(n<r)return 0;var i=s(e[n]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--n<r||-2===i?0:(i=s(e[n]))>=0?(i>0&&(t.lastNeed=i-2),i):--n<r||-2===i?0:(i=s(e[n]))>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}}),v("1U9GM",function(t,e){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var r=y("6ZWSX"),n=r.Buffer;function i(t,e){for(var r in t)e[r]=t[r]}function a(t,e,r){return n(t,e,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(i(r,t.exports),t.exports.Buffer=a),a.prototype=Object.create(n.prototype),i(n,a),a.from=function(t,e,r){if("number"==typeof t)throw TypeError("Argument must not be a number");return n(t,e,r)},a.alloc=function(t,e,r){if("number"!=typeof t)throw TypeError("Argument must be a number");var i=n(t);return void 0!==e?"string"==typeof r?i.fill(e,r):i.fill(e):i.fill(0),i},a.allocUnsafe=function(t){if("number"!=typeof t)throw TypeError("Argument must be a number");return n(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw TypeError("Argument must be a number");return r.SlowBuffer(t)}}),v("t3dlL",function(t,e){var r=y("hPtJY"),n=y("e93qE"),i=n.PromisePrototypeThen,a=n.SymbolAsyncIterator,o=n.SymbolIterator,s=y("6ZWSX").Buffer;let{ERR_INVALID_ARG_TYPE:l,ERR_STREAM_NULL_VALUES:u}=y("aqMop").codes;t.exports=function(t,e,n){let h,d;if("string"==typeof e||e instanceof s)return new t({objectMode:!0,...n,read(){this.push(e),this.push(null)}});if(e&&e[a])d=!0,h=e[a]();else if(e&&e[o])d=!1,h=e[o]();else throw new l("iterable",["Iterable"],e);let c=new t({objectMode:!0,highWaterMark:1,...n}),f=!1;async function p(t){let e=null!=t,r="function"==typeof h.throw;if(e&&r){let{value:e,done:r}=await h.throw(t);if(await e,r)return}if("function"==typeof h.return){let{value:t}=await h.return();await t}}async function g(){for(;;){try{let{value:t,done:e}=d?await h.next():h.next();if(e)c.push(null);else{let e=t&&"function"==typeof t.then?await t:t;if(null===e)throw f=!1,new u;if(c.push(e))continue;f=!1}}catch(t){c.destroy(t)}break}}return c._read=function(){f||(f=!0,g())},c._destroy=function(t,e){i(p(t),()=>r.nextTick(e,t),n=>r.nextTick(e,n||t))},c}}),v("e6GFj",function(t,e){let r;var n=y("hPtJY"),i=y("e93qE"),a=i.ArrayPrototypeSlice,o=i.Error,s=i.FunctionPrototypeSymbolHasInstance,l=i.ObjectDefineProperty,u=i.ObjectDefineProperties,h=i.ObjectSetPrototypeOf,d=i.StringPrototypeToLowerCase,c=i.Symbol,f=i.SymbolHasInstance;t.exports=j,j.WritableState=D;var p=y("7etJZ").EventEmitter,g=y("1B0VZ").Stream,v=y("6ZWSX").Buffer,m=y("fMCbt"),b=y("19AFn").addAbortSignal,x=y("04a3B"),E=x.getHighWaterMark,w=x.getDefaultHighWaterMark;let{ERR_INVALID_ARG_TYPE:_,ERR_METHOD_NOT_IMPLEMENTED:S,ERR_MULTIPLE_CALLBACK:k,ERR_STREAM_CANNOT_PIPE:N,ERR_STREAM_DESTROYED:O,ERR_STREAM_ALREADY_FINISHED:T,ERR_STREAM_NULL_VALUES:M,ERR_STREAM_WRITE_AFTER_END:A,ERR_UNKNOWN_ENCODING:C}=y("aqMop").codes,{errorOrDestroy:R}=m;function I(){}h(j.prototype,g.prototype),h(j,g);let P=c("kOnFinished");function D(t,e,r){"boolean"!=typeof r&&(r=e instanceof y("aAPdh")),this.objectMode=!!(t&&t.objectMode),r&&(this.objectMode=this.objectMode||!!(t&&t.writableObjectMode)),this.highWaterMark=t?E(this,t,"writableHighWaterMark",r):w(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let n=!!(t&&!1===t.decodeStrings);this.decodeStrings=!n,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=V.bind(void 0,e),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,L(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!t||!1!==t.emitClose,this.autoDestroy=!t||!1!==t.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[P]=[]}function L(t){t.buffered=[],t.bufferedIndex=0,t.allBuffers=!0,t.allNoop=!0}function j(t){let e=this instanceof y("aAPdh");if(!e&&!s(j,this))return new j(t);this._writableState=new D(t,this,e),t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final),"function"==typeof t.construct&&(this._construct=t.construct),t.signal&&b(t.signal,this)),g.call(this,t),m.construct(this,()=>{let t=this._writableState;t.writing||H(this,t),q(this,t)})}function F(t,e,r,i){let a;let o=t._writableState;if("function"==typeof r)i=r,r=o.defaultEncoding;else{if(r){if("buffer"!==r&&!v.isEncoding(r))throw new C(r)}else r=o.defaultEncoding;"function"!=typeof i&&(i=I)}if(null===e)throw new M;if(!o.objectMode){if("string"==typeof e)!1!==o.decodeStrings&&(e=v.from(e,r),r="buffer");else if(e instanceof v)r="buffer";else if(g._isUint8Array(e))e=g._uint8ArrayToBuffer(e),r="buffer";else throw new _("chunk",["string","Buffer","Uint8Array"],e)}return(o.ending?a=new A:o.destroyed&&(a=new O("write")),a)?(n.nextTick(i,a),R(t,a,!0),a):(o.pendingcb++,function(t,e,r,n,i){let a=e.objectMode?1:r.length;e.length+=a;let o=e.length<e.highWaterMark;return o||(e.needDrain=!0),e.writing||e.corked||e.errored||!e.constructed?(e.buffered.push({chunk:r,encoding:n,callback:i}),e.allBuffers&&"buffer"!==n&&(e.allBuffers=!1),e.allNoop&&i!==I&&(e.allNoop=!1)):(e.writelen=a,e.writecb=i,e.writing=!0,e.sync=!0,t._write(r,n,e.onwrite),e.sync=!1),o&&!e.errored&&!e.destroyed}(t,o,e,r,i))}function B(t,e,r,n,i,a,o){e.writelen=n,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new O("write")):r?t._writev(i,e.onwrite):t._write(i,a,e.onwrite),e.sync=!1}function z(t,e,r,n){--e.pendingcb,n(r),U(e),R(t,r)}function V(t,e){let r=t._writableState,i=r.sync,a=r.writecb;if("function"!=typeof a){R(t,new k);return}r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,e?(e.stack,r.errored||(r.errored=e),t._readableState&&!t._readableState.errored&&(t._readableState.errored=e),i?n.nextTick(z,t,r,e,a):z(t,r,e,a)):(r.buffered.length>r.bufferedIndex&&H(t,r),i?null!==r.afterWriteTickInfo&&r.afterWriteTickInfo.cb===a?r.afterWriteTickInfo.count++:(r.afterWriteTickInfo={count:1,cb:a,stream:t,state:r},n.nextTick(G,r.afterWriteTickInfo)):$(t,r,1,a))}function G({stream:t,state:e,count:r,cb:n}){return e.afterWriteTickInfo=null,$(t,e,r,n)}function $(t,e,r,n){for(e.ending||t.destroyed||0!==e.length||!e.needDrain||(e.needDrain=!1,t.emit("drain"));r-- >0;)e.pendingcb--,n();e.destroyed&&U(e),q(t,e)}function U(t){var e,r;if(t.writing)return;for(let r=t.bufferedIndex;r<t.buffered.length;++r){let{chunk:n,callback:i}=t.buffered[r],a=t.objectMode?1:n.length;t.length-=a,i(null!==(e=t.errored)&&void 0!==e?e:new O("write"))}let n=t[P].splice(0);for(let e=0;e<n.length;e++)n[e](null!==(r=t.errored)&&void 0!==r?r:new O("end"));L(t)}function H(t,e){if(e.corked||e.bufferProcessing||e.destroyed||!e.constructed)return;let{buffered:r,bufferedIndex:n,objectMode:i}=e,o=r.length-n;if(!o)return;let s=n;if(e.bufferProcessing=!0,o>1&&t._writev){e.pendingcb-=o-1;let n=e.allNoop?I:t=>{for(let e=s;e<r.length;++e)r[e].callback(t)},i=e.allNoop&&0===s?r:a(r,s);i.allBuffers=e.allBuffers,B(t,e,!0,e.length,i,"",n),L(e)}else{do{let{chunk:n,encoding:a,callback:o}=r[s];r[s++]=null,B(t,e,!1,i?1:n.length,n,a,o)}while(s<r.length&&!e.writing)s===r.length?L(e):s>256?(r.splice(0,s),e.bufferedIndex=0):e.bufferedIndex=s}e.bufferProcessing=!1}function W(t){return t.ending&&!t.destroyed&&t.constructed&&0===t.length&&!t.errored&&0===t.buffered.length&&!t.finished&&!t.writing&&!t.errorEmitted&&!t.closeEmitted}function q(t,e,r){W(e)&&(e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.finalCalled=!0,function(t,e){let r=!1;function i(i){if(r){R(t,null!=i?i:k());return}if(r=!0,e.pendingcb--,i){let r=e[P].splice(0);for(let t=0;t<r.length;t++)r[t](i);R(t,i,e.sync)}else W(e)&&(e.prefinished=!0,t.emit("prefinish"),e.pendingcb++,n.nextTick(Y,t,e))}e.sync=!0,e.pendingcb++;try{t._final(i)}catch(t){i(t)}e.sync=!1}(t,e))),0===e.pendingcb&&(r?(e.pendingcb++,n.nextTick((t,e)=>{W(e)?Y(t,e):e.pendingcb--},t,e)):W(e)&&(e.pendingcb++,Y(t,e))))}function Y(t,e){e.pendingcb--,e.finished=!0;let r=e[P].splice(0);for(let t=0;t<r.length;t++)r[t]();if(t.emit("finish"),e.autoDestroy){let e=t._readableState;(!e||e.autoDestroy&&(e.endEmitted||!1===e.readable))&&t.destroy()}}D.prototype.getBuffer=function(){return a(this.buffered,this.bufferedIndex)},l(D.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),l(j,f,{__proto__:null,value:function(t){return!!s(this,t)||this===j&&t&&t._writableState instanceof D}}),j.prototype.pipe=function(){R(this,new N)},j.prototype.write=function(t,e,r){return!0===F(this,t,e,r)},j.prototype.cork=function(){this._writableState.corked++},j.prototype.uncork=function(){let t=this._writableState;t.corked&&(t.corked--,t.writing||H(this,t))},j.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=d(t)),!v.isEncoding(t))throw new C(t);return this._writableState.defaultEncoding=t,this},j.prototype._write=function(t,e,r){if(this._writev)this._writev([{chunk:t,encoding:e}],r);else throw new S("_write()")},j.prototype._writev=null,j.prototype.end=function(t,e,r){let i;let a=this._writableState;if("function"==typeof t?(r=t,t=null,e=null):"function"==typeof e&&(r=e,e=null),null!=t){let r=F(this,t,e);r instanceof o&&(i=r)}return a.corked&&(a.corked=1,this.uncork()),i||(a.errored||a.ending?a.finished?i=new T("end"):a.destroyed&&(i=new O("end")):(a.ending=!0,q(this,a,!0),a.ended=!0)),"function"==typeof r&&(i||a.finished?n.nextTick(r,i):a[P].push(r)),this},u(j.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(t){this._writableState&&(this._writableState.destroyed=t)}},writable:{__proto__:null,get(){let t=this._writableState;return!!t&&!1!==t.writable&&!t.destroyed&&!t.errored&&!t.ending&&!t.ended},set(t){this._writableState&&(this._writableState.writable=!!t)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){let t=this._writableState;return!!t&&!t.destroyed&&!t.ending&&t.needDrain}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(!1!==this._writableState.writable&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});let K=m.destroy;function X(){return void 0===r&&(r={}),r}j.prototype.destroy=function(t,e){let r=this._writableState;return!r.destroyed&&(r.bufferedIndex<r.buffered.length||r[P].length)&&n.nextTick(U,r),K.call(this,t,e),this},j.prototype._undestroy=m.undestroy,j.prototype._destroy=function(t,e){e(t)},j.prototype[p.captureRejectionSymbol]=function(t){this.destroy(t)},j.fromWeb=function(t,e){return X().newStreamWritableFromWritableStream(t,e)},j.toWeb=function(t){return X().newWritableStreamFromStreamWritable(t)}}),v("6gVeK",function(t,e){var r=y("hPtJY"),n=y("6ZWSX"),i=y("b0Zn2"),a=i.isReadable,o=i.isWritable,s=i.isIterable,l=i.isNodeStream,u=i.isReadableNodeStream,h=i.isWritableNodeStream,d=i.isDuplexNodeStream,c=i.isReadableStream,f=i.isWritableStream,p=y("fiCvv");let{AbortError:g,codes:{ERR_INVALID_ARG_TYPE:v,ERR_INVALID_RETURN_VALUE:m}}=y("aqMop");var b=y("fMCbt").destroyer,x=y("aAPdh"),E=y("2HCgn"),w=y("e6GFj"),_=y("3OYnt").createDeferredPromise,S=y("t3dlL");let k=globalThis.Blob||n.Blob,N=void 0!==k?function(t){return t instanceof k}:function(t){return!1},O=globalThis.AbortController||y("bHKGd").AbortController;var T=y("e93qE").FunctionPrototypeCall;class M extends x{constructor(t){super(t),(null==t?void 0:t.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(null==t?void 0:t.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function A(t){let e,r,n,i,s;let l=t.readable&&"function"!=typeof t.readable.read?E.wrap(t.readable):t.readable,u=t.writable,h=!!a(l),d=!!o(u);function c(t){let e=i;i=null,e?e(t):t&&s.destroy(t)}return s=new M({readableObjectMode:!!(null!=l&&l.readableObjectMode),writableObjectMode:!!(null!=u&&u.writableObjectMode),readable:h,writable:d}),d&&(p(u,t=>{d=!1,t&&b(l,t),c(t)}),s._write=function(t,r,n){u.write(t,r)?n():e=n},s._final=function(t){u.end(),r=t},u.on("drain",function(){if(e){let t=e;e=null,t()}}),u.on("finish",function(){if(r){let t=r;r=null,t()}})),h&&(p(l,t=>{h=!1,t&&b(l,t),c(t)}),l.on("readable",function(){if(n){let t=n;n=null,t()}}),l.on("end",function(){s.push(null)}),s._read=function(){for(;;){let t=l.read();if(null===t){n=s._read;return}if(!s.push(t))return}}),s._destroy=function(t,a){t||null===i||(t=new g),n=null,e=null,r=null,null===i?a(t):(i=a,b(u,t),b(l,t))},s}t.exports=function t(e,n){if(d(e))return e;if(u(e))return A({readable:e});if(h(e))return A({writable:e});if(l(e))return A({writable:!1,readable:!1});if(c(e))return A({readable:E.fromWeb(e)});if(f(e))return A({writable:w.fromWeb(e)});if("function"==typeof e){let{value:t,write:i,final:a,destroy:o}=function(t){let{promise:e,resolve:n}=_(),i=new O,a=i.signal;return{value:t(async function*(){for(;;){let t=e;e=null;let{chunk:i,done:o,cb:s}=await t;if(r.nextTick(s),o)return;if(a.aborted)throw new g(void 0,{cause:a.reason});({promise:e,resolve:n}=_()),yield i}}(),{signal:a}),write(t,e,r){let i=n;n=null,i({chunk:t,done:!1,cb:r})},final(t){let e=n;n=null,e({done:!0,cb:t})},destroy(t,e){i.abort(),e(t)}}}(e);if(s(t))return S(M,t,{objectMode:!0,write:i,final:a,destroy:o});let l=null==t?void 0:t.then;if("function"==typeof l){let e;let n=T(l,t,t=>{if(null!=t)throw new m("nully","body",t)},t=>{b(e,t)});return e=new M({objectMode:!0,readable:!1,write:i,final(t){a(async()=>{try{await n,r.nextTick(t,null)}catch(e){r.nextTick(t,e)}})},destroy:o})}throw new m("Iterable, AsyncIterable or AsyncFunction",n,t)}if(N(e))return t(e.arrayBuffer());if(s(e))return S(M,e,{objectMode:!0,writable:!1});if(c(null==e?void 0:e.readable)&&f(null==e?void 0:e.writable))return M.fromWeb(e);if("object"==typeof(null==e?void 0:e.writable)||"object"==typeof(null==e?void 0:e.readable))return A({readable:null!=e&&e.readable?u(null==e?void 0:e.readable)?null==e?void 0:e.readable:t(e.readable):void 0,writable:null!=e&&e.writable?h(null==e?void 0:e.writable)?null==e?void 0:e.writable:t(e.writable):void 0});let i=null==e?void 0:e.then;if("function"==typeof i){let t;return T(i,e,e=>{null!=e&&t.push(e),t.push(null)},e=>{b(t,e)}),t=new M({objectMode:!0,writable:!1,read(){}})}throw new v(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],e)}}),v("6DJp0",function(t,e){var r=y("e93qE").ObjectSetPrototypeOf;t.exports=i;var n=y("9Q7aU");function i(t){if(!(this instanceof i))return new i(t);n.call(this,t)}r(i.prototype,n.prototype),r(i,n),i.prototype._transform=function(t,e,r){r(null,t)}}),v("9Q7aU",function(t,e){var r=y("e93qE"),n=r.ObjectSetPrototypeOf,i=r.Symbol;t.exports=u;let{ERR_METHOD_NOT_IMPLEMENTED:a}=y("aqMop").codes;var o=y("aAPdh"),s=y("04a3B").getHighWaterMark;n(u.prototype,o.prototype),n(u,o);let l=i("kCallback");function u(t){if(!(this instanceof u))return new u(t);let e=t?s(this,t,"readableHighWaterMark",!0):null;0===e&&(t={...t,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:t.writableHighWaterMark||0}),o.call(this,t),this._readableState.sync=!1,this[l]=null,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",d)}function h(t){"function"!=typeof this._flush||this.destroyed?(this.push(null),t&&t()):this._flush((e,r)=>{if(e){t?t(e):this.destroy(e);return}null!=r&&this.push(r),this.push(null),t&&t()})}function d(){this._final!==h&&h.call(this)}u.prototype._final=h,u.prototype._transform=function(t,e,r){throw new a("_transform()")},u.prototype._write=function(t,e,r){let n=this._readableState,i=this._writableState,a=n.length;this._transform(t,e,(t,e)=>{if(t){r(t);return}null!=e&&this.push(e),i.ended||a===n.length||n.length<n.highWaterMark?r():this[l]=r})},u.prototype._read=function(){if(this[l]){let t=this[l];this[l]=null,t()}}}),v("3llXF",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.JsonLdParser=void 0;var r=y("kn4dN"),n=y("d7uy5"),i=y("7K0Nk"),a=y("f5N42"),o=y("cJYov"),s=y("lh2ub"),l=y("69IJk"),u=y("hwjjJ"),h=y("8wgxD"),d=y("431Sm"),c=y("9KRGP"),f=y("Tf3ev"),p=y("e5zTQ"),g=y("gsWsI"),v=y("kFmh5"),m=y("k88Xq"),b=y("XwuNW"),x=y("ewyr8"),E=y("9YC4i");class w extends i.Transform{constructor(t){super({readableObjectMode:!0}),t=t||{},this.options=t,this.parsingContext=new m.ParsingContext(Object.assign({parser:this},t)),this.util=new b.Util({dataFactory:t.dataFactory,parsingContext:this.parsingContext}),this.jsonParser=new r,this.contextJobs=[],this.typeJobs=[],this.contextAwaitingJobs=[],this.lastDepth=0,this.lastKeys=[],this.lastOnValueJob=Promise.resolve(),this.attachJsonParserListeners(),this.on("end",()=>{void 0!==this.jsonParser.mode&&this.emit("error",Error("Unclosed document"))})}static fromHttpResponse(t,e,r,i){let a,o;let s=["application/activity+json"];if(i&&i.wellKnownMediaTypes&&(s=i.wellKnownMediaTypes),"application/ld+json"!==e&&!s.includes(e)){if("application/json"!==e&&!e.endsWith("+json"))throw new n.ErrorCoded(`Unsupported JSON-LD media type ${e}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED);if(r&&r.has("Link")&&r.forEach((e,r)=>{if("link"===r)for(let r of(0,x.parse)(e).get("rel","http://www.w3.org/ns/json-ld#context")){if(a)throw new n.ErrorCoded("Multiple JSON-LD context link headers were found on "+t,n.ERROR_CODES.MULTIPLE_CONTEXT_LINK_HEADERS);a=r.uri}}),!a&&!(null==i?void 0:i.ignoreMissingContextLinkHeader))throw new n.ErrorCoded(`Missing context link header for media type ${e} on ${t}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED)}if(r&&r.has("Content-Type")){let t=r.get("Content-Type"),e=/; *profile=([^"]*)/.exec(t);e&&"http://www.w3.org/ns/json-ld#streaming"===e[1]&&(o=!0)}return new w(Object.assign({baseIRI:t,context:a,streamingProfile:o},i||{}))}import(t){if("pipe"in t){t.on("error",t=>e.emit("error",t));let e=t.pipe(new w(this.options));return e}{let e=new i.PassThrough({readableObjectMode:!0});t.on("error",t=>r.emit("error",t)),t.on("data",t=>e.push(t)),t.on("end",()=>e.push(null));let r=e.pipe(new w(this.options));return r}}_transform(t,e,r){this.jsonParser.write(t),this.lastOnValueJob.then(()=>r(),t=>r(t))}async newOnValueJob(t,e,r,i){let a=!0;if(i&&r<this.lastDepth){let t=this.parsingContext.listPointerStack[this.lastDepth];t&&(t.value&&this.push(this.util.dataFactory.quad(t.value,this.util.rdfRest,this.util.rdfNil,this.util.getDefaultGraph())),t.listId.listHead=!0,this.parsingContext.idStack[t.listRootDepth+1]=[t.listId],this.parsingContext.listPointerStack.splice(this.lastDepth,1)),await o.EntryHandlerContainer.isBufferableContainerHandler(this.parsingContext,this.lastKeys,this.lastDepth)?(this.parsingContext.pendingContainerFlushBuffers.push({depth:this.lastDepth,keys:this.lastKeys.slice(0,this.lastKeys.length)}),a=!1):await this.flushBuffer(this.lastDepth,this.lastKeys)}let s=await this.util.unaliasKeyword(t[r],t,r),l=await this.util.unaliasKeywordParent(t,r);this.parsingContext.emittedStack[r]=!0;let u=!0;n.Util.isValidKeyword(s)&&"@reverse"===l&&"@context"!==s&&this.emit("error",new n.ErrorCoded(`Found the @id '${e}' inside an @reverse property`,n.ERROR_CODES.INVALID_REVERSE_PROPERTY_MAP));let h=!1;this.parsingContext.validationStack.length>1&&(h=this.parsingContext.validationStack[this.parsingContext.validationStack.length-1].property);for(let e=Math.max(1,this.parsingContext.validationStack.length-1);e<t.length-1;e++){let n=this.parsingContext.validationStack[e]||(this.parsingContext.validationStack[e]=await this.validateKey(t.slice(0,e+1),e,h));if(n.valid)!h&&n.property&&(h=!0);else{this.parsingContext.emittedStack[r]=!1,u=!1;break}}if(await this.util.isLiteral(t,r)&&(u=!1),u)for(let n of w.ENTRY_HANDLERS){let i=await n.test(this.parsingContext,this.util,s,t,r);if(i){await n.handle(this.parsingContext,this.util,s,t,e,r,i),n.isStackProcessor()&&(this.parsingContext.processingStack[r]=!0);break}}0===r&&Array.isArray(e)&&await this.util.validateValueIndexes(e),a&&r<this.lastDepth&&this.flushStacks(this.lastDepth),this.lastDepth=r,this.lastKeys=t,this.parsingContext.unaliasedKeywordCacheStack.splice(r-1)}flushStacks(t){this.parsingContext.processingStack.splice(t,1),this.parsingContext.processingType.splice(t,1),this.parsingContext.emittedStack.splice(t,1),this.parsingContext.idStack.splice(t,1),this.parsingContext.graphStack.splice(t+1,1),this.parsingContext.graphContainerTermStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1),this.parsingContext.validationStack.splice(t-1,2),this.parsingContext.literalStack.splice(t,this.parsingContext.literalStack.length-t),this.parsingContext.annotationsBuffer.splice(t,1)}async flushBuffer(t,e){let r=this.parsingContext.idStack[t];r||(r=this.parsingContext.idStack[t]=[this.util.dataFactory.blankNode()]);let i=this.parsingContext.unidentifiedValuesBuffer[t];if(i){for(let n of r){let r=await this.util.getDepthOffsetGraph(t,e),a=this.parsingContext.graphStack[t]||r>=0?this.parsingContext.idStack[t-r-1]:[await this.util.getGraphContainerValue(e,t)];if(a)for(let e of a)for(let r of(this.parsingContext.emittedStack[t]=!0,i))this.util.emitQuadChecked(t,n,r.predicate,r.object,e,r.reverse,r.isEmbedded);else{let r=this.parsingContext.getUnidentifiedGraphBufferSafe(t-await this.util.getDepthOffsetGraph(t,e)-1);for(let t of i)t.reverse?r.push({object:n,predicate:t.predicate,subject:t.object,isEmbedded:t.isEmbedded}):r.push({object:t.object,predicate:t.predicate,subject:n,isEmbedded:t.isEmbedded})}}this.parsingContext.unidentifiedValuesBuffer.splice(t,1),this.parsingContext.literalStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1)}let a=this.parsingContext.unidentifiedGraphsBuffer[t];if(a){for(let e of r){let r=1!==t||"BlankNode"!==e.termType||this.parsingContext.topLevelProperties?e:this.util.getDefaultGraph();for(let e of(this.parsingContext.emittedStack[t]=!0,a))this.parsingContext.emitQuad(t,this.util.dataFactory.quad(e.subject,e.predicate,e.object,r))}this.parsingContext.unidentifiedGraphsBuffer.splice(t,1)}let o=this.parsingContext.annotationsBuffer[t];if(o){o.length>0&&1===t&&this.parsingContext.emitError(new n.ErrorCoded("Annotations can not be made on top-level nodes",n.ERROR_CODES.INVALID_ANNOTATION));let e=this.parsingContext.getAnnotationsBufferSafe(t-1);for(let t of o)e.push(t);delete this.parsingContext.annotationsBuffer[t]}}async validateKey(t,e,r){for(let n of w.ENTRY_HANDLERS)if(await n.validate(this.parsingContext,this.util,t,e,r))return{valid:!0,property:r||n.isPropertyHandler()};return{valid:!1,property:!1}}attachJsonParserListeners(){this.jsonParser.onValue=t=>{let e=this.jsonParser.stack.length,r=Array(e+1).fill(0).map((t,r)=>r===e?this.jsonParser.key:this.jsonParser.stack[r].key);if(!this.isParsingContextInner(e)){let n=()=>this.newOnValueJob(r,t,e,!0);if(this.parsingContext.streamingProfile||this.parsingContext.contextTree.getContext(r.slice(0,-1)))this.lastOnValueJob=this.lastOnValueJob.then(n);else if("@context"===r[e]){let t=this.contextJobs[e];t||(t=this.contextJobs[e]=[]),t.push(n)}else this.contextAwaitingJobs.push({job:n,keys:r,depth:e});this.parsingContext.streamingProfile||0!==e||(this.lastOnValueJob=this.lastOnValueJob.then(()=>this.executeBufferedJobs()))}},this.jsonParser.onError=t=>{this.emit("error",t)}}isParsingContextInner(t){for(let e=t;e>0;e--)if("@context"===this.jsonParser.stack[e-1].key)return!0;return!1}async executeBufferedJobs(){for(let t of this.contextJobs)if(t)for(let e of t)await e();this.parsingContext.unaliasedKeywordCacheStack.splice(0);let t=[];for(let e of this.contextAwaitingJobs)await this.util.unaliasKeyword(e.keys[e.depth],e.keys,e.depth,!0)==="@type"||"number"==typeof e.keys[e.depth]&&await this.util.unaliasKeyword(e.keys[e.depth-1],e.keys,e.depth-1,!0)==="@type"?this.typeJobs.push({job:e.job,keys:e.keys.slice(0,e.keys.length-1)}):t.push(e);for(let e of t){if(this.typeJobs.length>0){let t=[],r=[];for(let n=0;n<this.typeJobs.length;n++){let i=this.typeJobs[n];b.Util.isPrefixArray(i.keys,e.keys)&&(t.push(i),r.push(n))}for(let e of t.sort((t,e)=>t.keys.length-e.keys.length))await e.job();for(let t of r.sort().reverse())this.typeJobs.splice(t,1)}await e.job()}}}w.DEFAULT_PROCESSING_MODE="1.1",w.ENTRY_HANDLERS=[new a.EntryHandlerArrayValue,new u.EntryHandlerKeywordContext,new d.EntryHandlerKeywordId,new c.EntryHandlerKeywordIncluded,new h.EntryHandlerKeywordGraph,new f.EntryHandlerKeywordNest,new p.EntryHandlerKeywordType,new v.EntryHandlerKeywordValue,new E.EntryHandlerKeywordAnnotation,new o.EntryHandlerContainer,new g.EntryHandlerKeywordUnknownFallback,new l.EntryHandlerPredicate,new s.EntryHandlerInvalidFallback],t.exports.JsonLdParser=w}),v("kn4dN",function(t,e){var r=y("6ZWSX").Buffer,n={},i=n.LEFT_BRACE=1,a=n.RIGHT_BRACE=2,o=n.LEFT_BRACKET=3,s=n.RIGHT_BRACKET=4,l=n.COLON=5,u=n.COMMA=6,h=n.TRUE=7,d=n.FALSE=8,c=n.NULL=9,f=n.STRING=10,p=n.NUMBER=11,g=n.START=17,v=n.STOP=18,m=n.TRUE1=33,b=n.TRUE2=34,x=n.TRUE3=35,E=n.FALSE1=49,w=n.FALSE2=50,_=n.FALSE3=51,S=n.FALSE4=52,k=n.NULL1=65,N=n.NULL2=66,O=n.NULL3=67,T=n.NUMBER1=81,M=n.NUMBER3=83,A=n.STRING1=97,C=n.STRING2=98,R=n.STRING3=99,I=n.STRING4=100,P=n.STRING5=101,D=n.STRING6=102,L=n.VALUE=113,j=n.KEY=114,F=n.OBJECT=129,B=n.ARRAY=130;function z(t){return r.alloc?r.alloc(t):new r(t)}function V(){this.tState=g,this.value=void 0,this.string=void 0,this.stringBuffer=z(65536),this.stringBufferOffset=0,this.unicode=void 0,this.highSurrogate=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=L,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:z(2),3:z(3),4:z(4)},this.offset=-1}V.toknam=function(t){for(var e=Object.keys(n),r=0,i=e.length;r<i;r++){var a=e[r];if(n[a]===t)return a}return t&&"0x"+t.toString(16)};var G=V.prototype;G.onError=function(t){throw t},G.charError=function(t,e){this.tState=v,this.onError(Error("Unexpected "+JSON.stringify(String.fromCharCode(t[e]))+" at position "+e+" in state "+V.toknam(this.tState)))},G.appendStringChar=function(t){this.stringBufferOffset>=65536&&(this.string+=this.stringBuffer.toString("utf8"),this.stringBufferOffset=0),this.stringBuffer[this.stringBufferOffset++]=t},G.appendStringBuf=function(t,e,r){var n=t.length;"number"==typeof e&&(n="number"==typeof r?r<0?t.length-e+r:r-e:t.length-e),n<0&&(n=0),this.stringBufferOffset+n>65536&&(this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0),t.copy(this.stringBuffer,this.stringBufferOffset,e,r),this.stringBufferOffset+=n},G.write=function(t){"string"==typeof t&&(t=new r(t));for(var e,n=0,p=t.length;n<p;n++)if(this.tState===g){if(e=t[n],this.offset++,123===e)this.onToken(i,"{");else if(125===e)this.onToken(a,"}");else if(91===e)this.onToken(o,"[");else if(93===e)this.onToken(s,"]");else if(58===e)this.onToken(l,":");else if(44===e)this.onToken(u,",");else if(116===e)this.tState=m;else if(102===e)this.tState=E;else if(110===e)this.tState=k;else if(34===e)this.string="",this.stringBufferOffset=0,this.tState=A;else if(45===e)this.string="-",this.tState=T;else if(e>=48&&e<64)this.string=String.fromCharCode(e),this.tState=M;else if(32!==e&&9!==e&&10!==e&&13!==e)return this.charError(t,n)}else if(this.tState===A){if(e=t[n],this.bytes_remaining>0){for(var y=0;y<this.bytes_remaining;y++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+y]=t[y];this.appendStringBuf(this.temp_buffs[this.bytes_in_sequence]),this.bytes_in_sequence=this.bytes_remaining=0,n=n+y-1}else if(0===this.bytes_remaining&&e>=128){if(e<=193||e>244)return this.onError(Error("Invalid UTF-8 character at position "+n+" in state "+V.toknam(this.tState)));if(e>=194&&e<=223&&(this.bytes_in_sequence=2),e>=224&&e<=239&&(this.bytes_in_sequence=3),e>=240&&e<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+n>t.length){for(var v=0;v<=t.length-1-n;v++)this.temp_buffs[this.bytes_in_sequence][v]=t[n+v];this.bytes_remaining=n+this.bytes_in_sequence-t.length,n=t.length-1}else this.appendStringBuf(t,n,n+this.bytes_in_sequence),n=n+this.bytes_in_sequence-1}else if(34===e)this.tState=g,this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0,this.onToken(f,this.string),this.offset+=r.byteLength(this.string,"utf8")+1,this.string=void 0;else if(92===e)this.tState=C;else{if(!(e>=32))return this.charError(t,n);this.appendStringChar(e)}}else if(this.tState===C){if(34===(e=t[n]))this.appendStringChar(e),this.tState=A;else if(92===e)this.appendStringChar(92),this.tState=A;else if(47===e)this.appendStringChar(47),this.tState=A;else if(98===e)this.appendStringChar(8),this.tState=A;else if(102===e)this.appendStringChar(12),this.tState=A;else if(110===e)this.appendStringChar(10),this.tState=A;else if(114===e)this.appendStringChar(13),this.tState=A;else if(116===e)this.appendStringChar(9),this.tState=A;else{if(117!==e)return this.charError(t,n);this.unicode="",this.tState=R}}else if(this.tState===R||this.tState===I||this.tState===P||this.tState===D){if((!((e=t[n])>=48)||!(e<64))&&(!(e>64)||!(e<=70))&&(!(e>96)||!(e<=102)))return this.charError(t,n);if(this.unicode+=String.fromCharCode(e),this.tState++===D){var L=parseInt(this.unicode,16);this.unicode=void 0,void 0!==this.highSurrogate&&L>=56320&&L<57344?(this.appendStringBuf(new r(String.fromCharCode(this.highSurrogate,L))),this.highSurrogate=void 0):void 0===this.highSurrogate&&L>=55296&&L<56320?this.highSurrogate=L:(void 0!==this.highSurrogate&&(this.appendStringBuf(new r(String.fromCharCode(this.highSurrogate))),this.highSurrogate=void 0),this.appendStringBuf(new r(String.fromCharCode(L)))),this.tState=A}}else if(this.tState===T||this.tState===M)switch(e=t[n]){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:this.string+=String.fromCharCode(e),this.tState=M;break;default:this.tState=g;var j=this.numberReviver(this.string,t,n);if(j)return j;this.offset+=this.string.length-1,this.string=void 0,n--}else if(this.tState===m){if(114!==t[n])return this.charError(t,n);this.tState=b}else if(this.tState===b){if(117!==t[n])return this.charError(t,n);this.tState=x}else if(this.tState===x){if(101!==t[n])return this.charError(t,n);this.tState=g,this.onToken(h,!0),this.offset+=3}else if(this.tState===E){if(97!==t[n])return this.charError(t,n);this.tState=w}else if(this.tState===w){if(108!==t[n])return this.charError(t,n);this.tState=_}else if(this.tState===_){if(115!==t[n])return this.charError(t,n);this.tState=S}else if(this.tState===S){if(101!==t[n])return this.charError(t,n);this.tState=g,this.onToken(d,!1),this.offset+=4}else if(this.tState===k){if(117!==t[n])return this.charError(t,n);this.tState=N}else if(this.tState===N){if(108!==t[n])return this.charError(t,n);this.tState=O}else if(this.tState===O){if(108!==t[n])return this.charError(t,n);this.tState=g,this.onToken(c,null),this.offset+=3}},G.onToken=function(t,e){},G.parseError=function(t,e){this.tState=v,this.onError(Error("Unexpected "+V.toknam(t)+(e?"("+JSON.stringify(e)+")":"")+" in state "+V.toknam(this.state)))},G.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},G.pop=function(){var t=this.value,e=this.stack.pop();this.value=e.value,this.key=e.key,this.mode=e.mode,this.emit(t),this.mode||(this.state=L)},G.emit=function(t){this.mode&&(this.state=u),this.onValue(t)},G.onValue=function(t){},G.onToken=function(t,e){if(this.state===L){if(t===f||t===p||t===h||t===d||t===c)this.value&&(this.value[this.key]=e),this.emit(e);else if(t===i)this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=j,this.mode=F;else if(t===o)this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=B,this.state=L;else if(t===a){if(this.mode!==F)return this.parseError(t,e);this.pop()}else{if(t!==s||this.mode!==B)return this.parseError(t,e);this.pop()}}else if(this.state===j){if(t===f)this.key=e,this.state=l;else{if(t!==a)return this.parseError(t,e);this.pop()}}else if(this.state===l){if(t!==l)return this.parseError(t,e);this.state=L}else if(this.state!==u)return this.parseError(t,e);else if(t===u)this.mode===B?(this.key++,this.state=L):this.mode===F&&(this.state=j);else{if((t!==s||this.mode!==B)&&(t!==a||this.mode!==F))return this.parseError(t,e);this.pop()}},G.numberReviver=function(t,e,r){var n=Number(t);if(isNaN(n))return this.charError(e,r);t.match(/[0-9]+/)==t&&n.toString()!=t?this.onToken(f,t):this.onToken(p,n)},V.C=n,t.exports=V}),v("d7uy5",function(t,e){var r=t.exports&&t.exports.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=t.exports&&t.exports.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(t.exports,"__esModule",{value:!0}),n(y("ilG7L"),t.exports),n(y("60GtF"),t.exports),n(y("bETwV"),t.exports),n(y("8EISD"),t.exports),n(y("4uhna"),t.exports),n(y("ecGDU"),t.exports),n(y("daggI"),t.exports)}),v("ilG7L",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.ContextParser=void 0;var r=y("7vqNZ"),n=y("60GtF"),i=y("bETwV"),a=y("ecGDU"),o=y("daggI");class s{constructor(t){t=t||{},this.documentLoader=t.documentLoader||new i.FetchDocumentLoader,this.documentCache={},this.validateContext=!t.skipValidation,this.expandContentTypeToBase=!!t.expandContentTypeToBase,this.remoteContextsDepthLimit=t.remoteContextsDepthLimit||32,this.redirectSchemaOrgHttps=!("redirectSchemaOrgHttps"in t)||!!t.redirectSchemaOrgHttps}static validateLanguage(t,e,r){if("string"!=typeof t)throw new n.ErrorCoded(`The value of an '@language' must be a string, got '${JSON.stringify(t)}'`,r);if(!o.Util.REGEX_LANGUAGE_TAG.test(t)){if(!e)return!1;throw new n.ErrorCoded(`The value of an '@language' must be a valid language tag, got '${JSON.stringify(t)}'`,r)}return!0}static validateDirection(t,e){if("string"!=typeof t)throw new n.ErrorCoded(`The value of an '@direction' must be a string, got '${JSON.stringify(t)}'`,n.ERROR_CODES.INVALID_BASE_DIRECTION);if(!o.Util.REGEX_DIRECTION_TAG.test(t)){if(!e)return!1;throw new n.ErrorCoded(`The value of an '@direction' must be 'ltr' or 'rtl', got '${JSON.stringify(t)}'`,n.ERROR_CODES.INVALID_BASE_DIRECTION)}return!0}idifyReverseTerms(t){for(let e of Object.keys(t)){let r=t[e];if(r&&"object"==typeof r&&r["@reverse"]&&!r["@id"]){if("string"!=typeof r["@reverse"]||o.Util.isValidKeyword(r["@reverse"]))throw new n.ErrorCoded(`Invalid @reverse value, must be absolute IRI or blank node: '${r["@reverse"]}'`,n.ERROR_CODES.INVALID_IRI_MAPPING);(r=t[e]=Object.assign(Object.assign({},r),{"@id":r["@reverse"]}))["@id"]=r["@reverse"],o.Util.isPotentialKeyword(r["@reverse"])?delete r["@reverse"]:r["@reverse"]=!0}}return t}expandPrefixedTerms(t,e,r){let i=t.getContextRaw();for(let a of r||Object.keys(i))if(0>o.Util.EXPAND_KEYS_BLACKLIST.indexOf(a)&&!o.Util.isReservedInternalKeyword(a)){let r=i[a];if(o.Util.isPotentialKeyword(a)&&o.Util.ALIAS_DOMAIN_BLACKLIST.indexOf(a)>=0&&("@type"!==a||"object"==typeof i[a]&&!(i[a]["@protected"]||"@set"===i[a]["@container"])))throw new n.ErrorCoded(`Keywords can not be aliased to something else.
Tried mapping ${a} to ${JSON.stringify(r)}`,n.ERROR_CODES.KEYWORD_REDEFINITION);if(o.Util.ALIAS_RANGE_BLACKLIST.indexOf(o.Util.getContextValueId(r))>=0)throw new n.ErrorCoded(`Aliasing to certain keywords is not allowed.
Tried mapping ${a} to ${JSON.stringify(r)}`,n.ERROR_CODES.INVALID_KEYWORD_ALIAS);if(r&&o.Util.isPotentialKeyword(o.Util.getContextValueId(r))&&!0===r["@prefix"])throw new n.ErrorCoded(`Tried to use keyword aliases as prefix: '${a}': '${JSON.stringify(r)}'`,n.ERROR_CODES.INVALID_TERM_DEFINITION);for(;o.Util.isPrefixValue(i[a]);){let r=i[a],n=!1;if("string"==typeof r)i[a]=t.expandTerm(r,!0),n=n||r!==i[a];else{let s=r["@id"],l=r["@type"],u=!("@prefix"in r)||o.Util.isValidIri(a);if("@id"in r)null!=s&&"string"==typeof s&&(i[a]=Object.assign(Object.assign({},i[a]),{"@id":t.expandTerm(s,!0)}),n=n||s!==i[a]["@id"]);else if(!o.Util.isPotentialKeyword(a)&&u){let e=t.expandTerm(a,!0);e!==a&&(i[a]=Object.assign(Object.assign({},i[a]),{"@id":e}),n=!0)}if(l&&"string"==typeof l&&"@vocab"!==l&&(!r["@container"]||!r["@container"]["@type"])&&u){let r=t.expandTerm(l,!0);e&&l===r&&(r=t.expandTerm(l,!1)),r!==l&&(n=!0,i[a]=Object.assign(Object.assign({},i[a]),{"@type":r}))}}if(!n)break}}}normalize(t,{processingMode:e,normalizeLanguageTags:r}){if(r||1===e)for(let e of Object.keys(t))if("@language"===e&&"string"==typeof t[e])t[e]=t[e].toLowerCase();else{let r=t[e];if(r&&"object"==typeof r&&"string"==typeof r["@language"]){let n=r["@language"].toLowerCase();n!==r["@language"]&&(t[e]=Object.assign(Object.assign({},r),{"@language":n}))}}}containersToHash(t){for(let e of Object.keys(t)){let r=t[e];if(r&&"object"==typeof r){if("string"==typeof r["@container"])t[e]=Object.assign(Object.assign({},r),{"@container":{[r["@container"]]:!0}});else if(Array.isArray(r["@container"])){let n={};for(let t of r["@container"])n[t]=!0;t[e]=Object.assign(Object.assign({},r),{"@container":n})}}}}applyScopedProtected(t,{processingMode:e},r){if(e&&e>=1.1&&t["@protected"]){for(let e of Object.keys(t))if(!o.Util.isReservedInternalKeyword(e)&&!o.Util.isPotentialKeyword(e)&&!o.Util.isTermProtected(t,e)){let n=t[e];n&&"object"==typeof n?"@protected"in t[e]||(t[e]=Object.assign(Object.assign({},t[e]),{"@protected":!0})):(t[e]={"@id":n,"@protected":!0},o.Util.isSimpleTermDefinitionPrefix(n,r)&&(t[e]=Object.assign(Object.assign({},t[e]),{"@prefix":!0})))}delete t["@protected"]}}validateKeywordRedefinitions(t,e,r,i){for(let r of null!=i?i:Object.keys(e))if(o.Util.isTermProtected(t,r)&&("string"==typeof e[r]?e[r]={"@id":e[r],"@protected":!0}:e[r]=Object.assign(Object.assign({},e[r]),{"@protected":!0}),!o.Util.deepEqual(t[r],e[r])))throw new n.ErrorCoded(`Attempted to override the protected keyword ${r} from ${JSON.stringify(o.Util.getContextValueId(t[r]))} to ${JSON.stringify(o.Util.getContextValueId(e[r]))}`,n.ERROR_CODES.PROTECTED_TERM_REDEFINITION)}validate(t,{processingMode:e}){for(let r of Object.keys(t)){if(o.Util.isReservedInternalKeyword(r))continue;if(""===r)throw new n.ErrorCoded(`The empty term is not allowed, got: '${r}': '${JSON.stringify(t[r])}'`,n.ERROR_CODES.INVALID_TERM_DEFINITION);let i=t[r],l=typeof i;if(o.Util.isPotentialKeyword(r)){switch(r.substr(1)){case"vocab":if(null!==i&&"string"!==l)throw new n.ErrorCoded(`Found an invalid @vocab IRI: ${i}`,n.ERROR_CODES.INVALID_VOCAB_MAPPING);break;case"base":if(null!==i&&"string"!==l)throw new n.ErrorCoded(`Found an invalid @base IRI: ${t[r]}`,n.ERROR_CODES.INVALID_BASE_IRI);break;case"language":null!==i&&s.validateLanguage(i,!0,n.ERROR_CODES.INVALID_DEFAULT_LANGUAGE);break;case"version":if(null!==i&&"number"!==l)throw new n.ErrorCoded(`Found an invalid @version number: ${i}`,n.ERROR_CODES.INVALID_VERSION_VALUE);break;case"direction":null!==i&&s.validateDirection(i,!0);break;case"propagate":if(1===e)throw new n.ErrorCoded(`Found an illegal @propagate keyword: ${i}`,n.ERROR_CODES.INVALID_CONTEXT_ENTRY);if(null!==i&&"boolean"!==l)throw new n.ErrorCoded(`Found an invalid @propagate value: ${i}`,n.ERROR_CODES.INVALID_PROPAGATE_VALUE)}if(o.Util.isValidKeyword(r)&&o.Util.isValidKeyword(o.Util.getContextValueId(i)))throw new n.ErrorCoded(`Illegal keyword alias in term value, found: '${r}': '${o.Util.getContextValueId(i)}'`,n.ERROR_CODES.KEYWORD_REDEFINITION);continue}if(null!==i)switch(l){case"string":if(o.Util.getPrefix(i,t)===r)throw new n.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${r}': '${JSON.stringify(i)}'`,n.ERROR_CODES.CYCLIC_IRI_MAPPING);if(o.Util.isValidIriWeak(r)){if("@type"===i)throw new n.ErrorCoded(`IRIs can not be mapped to @type, found: '${r}': '${i}'`,n.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(i)&&i!==new a.JsonLdContextNormalized(t).expandTerm(r))throw new n.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${r}': '${i}'`,n.ERROR_CODES.INVALID_IRI_MAPPING)}break;case"object":if(!o.Util.isCompactIri(r)&&!("@id"in i)&&("@id"===i["@type"]?!t["@base"]:!t["@vocab"]))throw new n.ErrorCoded(`Missing @id in context entry: '${r}': '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_IRI_MAPPING);for(let u of Object.keys(i)){let h=i[u];if(h)switch(u){case"@id":if(o.Util.isValidKeyword(h)&&"@type"!==h&&"@id"!==h&&"@graph"!==h&&"@nest"!==h)throw new n.ErrorCoded(`Illegal keyword alias in term value, found: '${r}': '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIriWeak(r)){if("@type"===h)throw new n.ErrorCoded(`IRIs can not be mapped to @type, found: '${r}': '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(h)&&h!==new a.JsonLdContextNormalized(t).expandTerm(r))throw new n.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${r}': '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_IRI_MAPPING)}if("string"!=typeof h)throw new n.ErrorCoded(`Detected non-string @id in context entry: '${r}': '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.getPrefix(h,t)===r)throw new n.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${r}': '${JSON.stringify(i)}'`,n.ERROR_CODES.CYCLIC_IRI_MAPPING);break;case"@type":if("@type"===i["@container"]&&"@id"!==h&&"@vocab"!==h)throw new n.ErrorCoded(`@container: @type only allows @type: @id or @vocab, but got: '${r}': '${h}'`,n.ERROR_CODES.INVALID_TYPE_MAPPING);if("string"!=typeof h)throw new n.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(l)}'`,n.ERROR_CODES.INVALID_TYPE_MAPPING);if("@id"!==h&&"@vocab"!==h&&(1===e||"@json"!==h)&&(1===e||"@none"!==h)&&("_"===h[0]||!o.Util.isValidIri(h)))throw new n.ErrorCoded(`A context @type must be an absolute IRI, found: '${r}': '${h}'`,n.ERROR_CODES.INVALID_TYPE_MAPPING);break;case"@reverse":if("string"==typeof h&&i["@id"]&&i["@id"]!==h)throw new n.ErrorCoded(`Found non-matching @id and @reverse term values in '${r}':\
'${h}' and '${i["@id"]}'`,n.ERROR_CODES.INVALID_REVERSE_PROPERTY);if("@nest"in i)throw new n.ErrorCoded(`@nest is not allowed in the reverse property '${r}'`,n.ERROR_CODES.INVALID_REVERSE_PROPERTY);break;case"@container":if(1===e&&(Object.keys(h).length>1||0>o.Util.CONTAINERS_1_0.indexOf(Object.keys(h)[0])))throw new n.ErrorCoded(`Invalid term @container for '${r}' ('${Object.keys(h)}') in 1.0, \
must be only one of ${o.Util.CONTAINERS_1_0.join(", ")}`,n.ERROR_CODES.INVALID_CONTAINER_MAPPING);for(let t of Object.keys(h)){if("@list"===t&&i["@reverse"])throw new n.ErrorCoded(`Term value can not be @container: @list and @reverse at the same time on '${r}'`,n.ERROR_CODES.INVALID_REVERSE_PROPERTY);if(0>o.Util.CONTAINERS.indexOf(t))throw new n.ErrorCoded(`Invalid term @container for '${r}' ('${t}'), \
must be one of ${o.Util.CONTAINERS.join(", ")}`,n.ERROR_CODES.INVALID_CONTAINER_MAPPING)}break;case"@language":s.validateLanguage(h,!0,n.ERROR_CODES.INVALID_LANGUAGE_MAPPING);break;case"@direction":s.validateDirection(h,!0);break;case"@prefix":if(null!==h&&"boolean"!=typeof h)throw new n.ErrorCoded(`Found an invalid term @prefix boolean in: '${r}': '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_PREFIX_VALUE);if(!("@id"in i)&&!o.Util.isValidIri(r))throw new n.ErrorCoded(`Invalid @prefix definition for '${r}' ('${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@index":if(1===e||!i["@container"]||!i["@container"]["@index"])throw new n.ErrorCoded(`Attempt to add illegal key to value object: '${r}': '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@nest":if(o.Util.isPotentialKeyword(h)&&"@nest"!==h)throw new n.ErrorCoded(`Found an invalid term @nest value in: '${r}': '${JSON.stringify(i)}'`,n.ERROR_CODES.INVALID_NEST_VALUE)}}break;default:throw new n.ErrorCoded(`Found an invalid term value: '${r}': '${i}'`,n.ERROR_CODES.INVALID_TERM_DEFINITION)}}}applyBaseEntry(t,e,n){return"string"==typeof t||(n&&!("@base"in t)&&e.parentContext&&"object"==typeof e.parentContext&&"@base"in e.parentContext&&(t["@base"]=e.parentContext["@base"],e.parentContext["@__baseDocument"]&&(t["@__baseDocument"]=!0)),!e.baseIRI||e.external||("@base"in t?null===t["@base"]||"string"!=typeof t["@base"]||o.Util.isValidIri(t["@base"])||(t["@base"]=(0,r.resolve)(t["@base"],e.parentContext&&e.parentContext["@base"]||e.baseIRI)):(t["@base"]=e.baseIRI,t["@__baseDocument"]=!0))),t}normalizeContextIri(t,e){if(!o.Util.isValidIri(t))try{t=(0,r.resolve)(t,e)}catch(e){throw Error(`Invalid context IRI: ${t}`)}return this.redirectSchemaOrgHttps&&t.startsWith("http://schema.org")&&(t="https://schema.org/"),t}async parseInnerContexts(t,e,r){for(let i of null!=r?r:Object.keys(t)){let r=t[i];if(r&&"object"==typeof r&&"@context"in r&&null!==r["@context"]&&!e.ignoreScopedContexts){if(this.validateContext)try{let n=Object.assign(Object.assign({},t),{[i]:Object.assign({},t[i])});delete n[i]["@context"],await this.parse(r["@context"],Object.assign(Object.assign({},e),{external:!1,parentContext:n,ignoreProtection:!0,ignoreRemoteScopedContexts:!0,ignoreScopedContexts:!0}))}catch(t){throw new n.ErrorCoded(t.message,n.ERROR_CODES.INVALID_SCOPED_CONTEXT)}t[i]=Object.assign(Object.assign({},r),{"@context":(await this.parse(r["@context"],Object.assign(Object.assign({},e),{external:!1,minimalProcessing:!0,ignoreRemoteScopedContexts:!0,parentContext:t}))).getContextRaw()})}}return t}async parse(t,e={},r={}){let{baseIRI:i,parentContext:l,external:u,processingMode:h=s.DEFAULT_PROCESSING_MODE,normalizeLanguageTags:d,ignoreProtection:c,minimalProcessing:f}=e,p=e.remoteContexts||{};if(Object.keys(p).length>=this.remoteContextsDepthLimit)throw new n.ErrorCoded("Detected an overflow in remote context inclusions: "+Object.keys(p),n.ERROR_CODES.CONTEXT_OVERFLOW);if(null==t){if(!c&&l&&o.Util.hasProtectedTerms(l))throw new n.ErrorCoded("Illegal context nullification when terms are protected",n.ERROR_CODES.INVALID_CONTEXT_NULLIFICATION);return new a.JsonLdContextNormalized(this.applyBaseEntry({},e,!1))}if("string"==typeof t){let r=this.normalizeContextIri(t,i),n=this.getOverriddenLoad(r,e);if(n)return new a.JsonLdContextNormalized(n);let o=await this.parse(await this.load(r),Object.assign(Object.assign({},e),{baseIRI:r,external:!0,remoteContexts:Object.assign(Object.assign({},p),{[r]:!0})}));return this.applyBaseEntry(o.getContextRaw(),e,!0),o}if(Array.isArray(t)){let r=[],n=await Promise.all(t.map((t,n)=>{if("string"!=typeof t)return t;{let a=this.normalizeContextIri(t,i);return r[n]=a,this.getOverriddenLoad(a,e)||this.load(a)}}));if(f)return new a.JsonLdContextNormalized(n);let o=await n.reduce((t,i,a)=>t.then(t=>this.parse(i,Object.assign(Object.assign({},e),{baseIRI:r[a]||e.baseIRI,external:!!r[a]||e.external,parentContext:t.getContextRaw(),remoteContexts:r[a]?Object.assign(Object.assign({},p),{[r[a]]:!0}):p}),{skipValidation:a<n.length-1})),Promise.resolve(new a.JsonLdContextNormalized(l||{})));return this.applyBaseEntry(o.getContextRaw(),e,!0),o}if("object"==typeof t){if("@context"in t)return await this.parse(t["@context"],e);if(t=Object.assign({},t),u&&delete t["@base"],this.applyBaseEntry(t,e,!0),this.containersToHash(t),f)return new a.JsonLdContextNormalized(t);let p={};if("@import"in t){if(h>=1.1){if("string"!=typeof t["@import"])throw new n.ErrorCoded("An @import value must be a string, but got "+typeof t["@import"],n.ERROR_CODES.INVALID_IMPORT_VALUE);p=await this.loadImportContext(this.normalizeContextIri(t["@import"],i)),delete t["@import"]}else throw new n.ErrorCoded("Context importing is not supported in JSON-LD 1.0",n.ERROR_CODES.INVALID_CONTEXT_ENTRY)}this.applyScopedProtected(p,{processingMode:h},a.defaultExpandOptions);let g=Object.assign(p,t);this.idifyReverseTerms(g),this.normalize(g,{processingMode:h,normalizeLanguageTags:d}),this.applyScopedProtected(g,{processingMode:h},a.defaultExpandOptions);let y=Object.keys(g),v=[];if("object"==typeof l)for(let t in l)t in g?v.push(t):g[t]=l[t];await this.parseInnerContexts(g,e,y);let m=new a.JsonLdContextNormalized(g);return(g&&g["@version"]||s.DEFAULT_PROCESSING_MODE)>=1.1&&(t["@vocab"]&&"string"==typeof t["@vocab"]||""===t["@vocab"])&&(l&&"@vocab"in l&&0>t["@vocab"].indexOf(":")?g["@vocab"]=l["@vocab"]+t["@vocab"]:(o.Util.isCompactIri(t["@vocab"])||t["@vocab"]in g)&&(g["@vocab"]=m.expandTerm(t["@vocab"],!0))),this.expandPrefixedTerms(m,this.expandContentTypeToBase,y),!c&&l&&h>=1.1&&this.validateKeywordRedefinitions(l,g,a.defaultExpandOptions,v),this.validateContext&&!r.skipValidation&&this.validate(g,{processingMode:h}),m}throw new n.ErrorCoded(`Tried parsing a context that is not a string, array or object, but got ${t}`,n.ERROR_CODES.INVALID_LOCAL_CONTEXT)}async load(t){let e;let r=this.documentCache[t];if(r)return r;try{e=await this.documentLoader.load(t)}catch(e){throw new n.ErrorCoded(`Failed to load remote context ${t}: ${e.message}`,n.ERROR_CODES.LOADING_REMOTE_CONTEXT_FAILED)}if(!("@context"in e))throw new n.ErrorCoded(`Missing @context in remote context at ${t}`,n.ERROR_CODES.INVALID_REMOTE_CONTEXT);return this.documentCache[t]=e["@context"]}getOverriddenLoad(t,e){if(t in(e.remoteContexts||{})){if(e.ignoreRemoteScopedContexts)return t;throw new n.ErrorCoded("Detected a cyclic context inclusion of "+t,n.ERROR_CODES.RECURSIVE_CONTEXT_INCLUSION)}return null}async loadImportContext(t){let e=await this.load(t);if("object"!=typeof e||Array.isArray(e))throw new n.ErrorCoded("An imported context must be a single object: "+t,n.ERROR_CODES.INVALID_REMOTE_CONTEXT);if("@import"in e)throw new n.ErrorCoded("An imported context can not import another context: "+t,n.ERROR_CODES.INVALID_CONTEXT_ENTRY);return e=Object.assign({},e),this.containersToHash(e),e}}s.DEFAULT_PROCESSING_MODE=1.1,t.exports.ContextParser=s}),v("7vqNZ",function(t,e){var r=t.exports&&t.exports.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=t.exports&&t.exports.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(t.exports,"__esModule",{value:!0}),n(y("4escN"),t.exports)}),v("4escN",function(t,e){function r(t){let e=[],r=0;for(;r<t.length;)switch(t[r]){case"/":if("."===t[r+1]){if("."===t[r+2]){if(!i(t[r+3])){e.push([]),r++;break}e.pop(),t[r+3]||e.push([]),r+=3}else{if(!i(t[r+2])){e.push([]),r++;break}t[r+2]||e.push([]),r+=2}}else e.push([]),r++;break;case"#":case"?":e.length||e.push([]),e[e.length-1].push(t.substr(r)),r=t.length;break;default:e.length||e.push([]),e[e.length-1].push(t[r]),r++}return"/"+e.map(t=>t.join("")).join("/")}function n(t,e){let n=e+1;e>=0?"/"===t[e+1]&&"/"===t[e+2]&&(n=e+3):"/"===t[0]&&"/"===t[1]&&(n=2);let i=t.indexOf("/",n);return i<0?t:t.substr(0,i)+r(t.substr(i))}function i(t){return!t||"#"===t||"?"===t||"/"===t}Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.removeDotSegmentsOfPath=t.exports.removeDotSegments=t.exports.resolve=void 0,t.exports.resolve=function(t,e){let i;let a=(e=e||"").indexOf("#");if(a>0&&(e=e.substr(0,a)),!t.length){if(0>e.indexOf(":"))throw Error(`Found invalid baseIRI '${e}' for value '${t}'`);return e}if(t.startsWith("?")){let r=e.indexOf("?");return r>0&&(e=e.substr(0,r)),e+t}if(t.startsWith("#"))return e+t;if(!e.length){let e=t.indexOf(":");if(e<0)throw Error(`Found invalid relative IRI '${t}' for a missing baseIRI`);return n(t,e)}let o=t.indexOf(":");if(o>=0)return n(t,o);let s=e.indexOf(":");if(s<0)throw Error(`Found invalid baseIRI '${e}' for value '${t}'`);let l=e.substr(0,s+1);if(0===t.indexOf("//"))return l+n(t,o);if(e.indexOf("//",s)===s+1){if((i=e.indexOf("/",s+3))<0)return e.length>s+3?e+"/"+n(t,o):l+n(t,o)}else if((i=e.indexOf("/",s+1))<0)return l+n(t,o);if(0===t.indexOf("/"))return e.substr(0,i)+r(t);let u=e.substr(i),h=u.lastIndexOf("/");return h>=0&&h<u.length-1&&(u=u.substr(0,h+1),"."===t[0]&&"."!==t[1]&&"/"!==t[1]&&t[2]&&(t=t.substr(1))),t=r(t=u+t),e.substr(0,i)+t},t.exports.removeDotSegments=r,t.exports.removeDotSegmentsOfPath=n}),v("60GtF",function(t,e){var r;Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.ERROR_CODES=t.exports.ErrorCoded=void 0,t.exports.ErrorCoded=class extends Error{constructor(t,e){super(t),this.code=e}},(r=t.exports.ERROR_CODES||(t.exports.ERROR_CODES={})).COLLIDING_KEYWORDS="colliding keywords",r.CONFLICTING_INDEXES="conflicting indexes",r.CYCLIC_IRI_MAPPING="cyclic IRI mapping",r.INVALID_ID_VALUE="invalid @id value",r.INVALID_INDEX_VALUE="invalid @index value",r.INVALID_NEST_VALUE="invalid @nest value",r.INVALID_PREFIX_VALUE="invalid @prefix value",r.INVALID_PROPAGATE_VALUE="invalid @propagate value",r.INVALID_REVERSE_VALUE="invalid @reverse value",r.INVALID_IMPORT_VALUE="invalid @import value",r.INVALID_VERSION_VALUE="invalid @version value",r.INVALID_BASE_IRI="invalid base IRI",r.INVALID_CONTAINER_MAPPING="invalid container mapping",r.INVALID_CONTEXT_ENTRY="invalid context entry",r.INVALID_CONTEXT_NULLIFICATION="invalid context nullification",r.INVALID_DEFAULT_LANGUAGE="invalid default language",r.INVALID_INCLUDED_VALUE="invalid @included value",r.INVALID_IRI_MAPPING="invalid IRI mapping",r.INVALID_JSON_LITERAL="invalid JSON literal",r.INVALID_KEYWORD_ALIAS="invalid keyword alias",r.INVALID_LANGUAGE_MAP_VALUE="invalid language map value",r.INVALID_LANGUAGE_MAPPING="invalid language mapping",r.INVALID_LANGUAGE_TAGGED_STRING="invalid language-tagged string",r.INVALID_LANGUAGE_TAGGED_VALUE="invalid language-tagged value",r.INVALID_LOCAL_CONTEXT="invalid local context",r.INVALID_REMOTE_CONTEXT="invalid remote context",r.INVALID_REVERSE_PROPERTY="invalid reverse property",r.INVALID_REVERSE_PROPERTY_MAP="invalid reverse property map",r.INVALID_REVERSE_PROPERTY_VALUE="invalid reverse property value",r.INVALID_SCOPED_CONTEXT="invalid scoped context",r.INVALID_SCRIPT_ELEMENT="invalid script element",r.INVALID_SET_OR_LIST_OBJECT="invalid set or list object",r.INVALID_TERM_DEFINITION="invalid term definition",r.INVALID_TYPE_MAPPING="invalid type mapping",r.INVALID_TYPE_VALUE="invalid type value",r.INVALID_TYPED_VALUE="invalid typed value",r.INVALID_VALUE_OBJECT="invalid value object",r.INVALID_VALUE_OBJECT_VALUE="invalid value object value",r.INVALID_VOCAB_MAPPING="invalid vocab mapping",r.IRI_CONFUSED_WITH_PREFIX="IRI confused with prefix",r.KEYWORD_REDEFINITION="keyword redefinition",r.LOADING_DOCUMENT_FAILED="loading document failed",r.LOADING_REMOTE_CONTEXT_FAILED="loading remote context failed",r.MULTIPLE_CONTEXT_LINK_HEADERS="multiple context link headers",r.PROCESSING_MODE_CONFLICT="processing mode conflict",r.PROTECTED_TERM_REDEFINITION="protected term redefinition",r.CONTEXT_OVERFLOW="context overflow",r.INVALID_BASE_DIRECTION="invalid base direction",r.RECURSIVE_CONTEXT_INCLUSION="recursive context inclusion",r.INVALID_STREAMING_KEY_ORDER="invalid streaming key order",r.INVALID_EMBEDDED_NODE="invalid embedded node",r.INVALID_ANNOTATION="invalid annotation"}),v("bETwV",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.FetchDocumentLoader=void 0;var r=y("60GtF"),n=y("ewyr8"),i=y("7vqNZ");t.exports.FetchDocumentLoader=class{constructor(t){this.fetcher=t}async load(t){let e=await (this.fetcher||fetch)(t,{headers:new Headers({accept:"application/ld+json"})});if(e.ok&&e.headers){let a=e.headers.get("Content-Type");if(a){let t=a.indexOf(";");t>0&&(a=a.substr(0,t))}if("application/ld+json"===a)return await e.json();if(e.headers.has("Link")){let r;if(e.headers.forEach((e,a)=>{if("link"===a){for(let a of(0,n.parse)(e).get("type","application/ld+json"))if("alternate"===a.rel){if(r)throw Error("Multiple JSON-LD alternate links were found on "+t);r=(0,i.resolve)(a.uri,t)}}}),r)return this.load(r)}throw new r.ErrorCoded(`Unsupported JSON-LD media type ${a}`,r.ERROR_CODES.LOADING_DOCUMENT_FAILED)}throw Error(e.statusText||`Status code: ${e.status}`)}}}),v("ewyr8",function(t,e){var r=y("6ZWSX").Buffer,n=/^utf-?8|ascii|utf-?16-?le|ucs-?2|base-?64|latin-?1$/i,i=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,a=/\s|\uFEFF|\xA0/,o=/\r?\n[\x20\x09]+/g,s=/[;,"]/,l=/[;,"]|\s/,u=/^[!#$%&'*+\-\.^_`|~\da-zA-Z]+$/,h={IDLE:1,URI:2,ATTR:4};function d(t){return t.replace(i,"")}function c(t){return a.test(t)}function f(t){return l.test(t)||!u.test(t)}class p{constructor(t){this.refs=[],t&&this.parse(t)}rel(t){for(var e=[],r=t.toLowerCase(),n=0;n<this.refs.length;n++)"string"==typeof this.refs[n].rel&&this.refs[n].rel.toLowerCase()===r&&e.push(this.refs[n]);return e}get(t,e){t=t.toLowerCase(),e=e.toLowerCase();for(var r=[],n=0;n<this.refs.length;n++)"string"==typeof this.refs[n][t]&&this.refs[n][t].toLowerCase()===e&&r.push(this.refs[n]);return r}set(t){return this.refs.push(t),this}setUnique(t){return this.refs.some(e=>Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every(r=>r in t&&e[r]===t[r]))||this.refs.push(t),this}has(t,e){t=t.toLowerCase(),e=e.toLowerCase();for(var r=0;r<this.refs.length;r++)if("string"==typeof this.refs[r][t]&&this.refs[r][t].toLowerCase()===e)return!0;return!1}parse(t,e){t=d(t=(e=e||0)?t.slice(e):t).replace(o,"");for(var r=h.IDLE,n=t.length,e=0,i=null;e<n;)if(r===h.IDLE){if(c(t[e])){e++;continue}if("<"===t[e]){null!=i&&(null!=i.rel?this.refs.push(...p.expandRelations(i)):this.refs.push(i));var a=t.indexOf(">",e);if(-1===a)throw Error("Expected end of URI delimiter at offset "+e);i={uri:t.slice(e+1,a)},e=a,r=h.URI}else throw Error('Unexpected character "'+t[e]+'" at offset '+e);e++}else if(r===h.URI){if(c(t[e])){e++;continue}if(";"===t[e])r=h.ATTR,e++;else if(","===t[e])r=h.IDLE,e++;else throw Error('Unexpected character "'+t[e]+'" at offset '+e)}else if(r===h.ATTR){if(";"===t[e]||c(t[e])){e++;continue}var a=t.indexOf("=",e);-1===a&&(a=t.indexOf(";",e)),-1===a&&(a=t.length);var l=d(t.slice(e,a)).toLowerCase(),u="";if(e=function(t,e){for(;c(t[e]);)e++;return e}(t,e=a+1),'"'===t[e])for(e++;e<n;){if('"'===t[e]){e++;break}"\\"===t[e]&&e++,u+=t[e],e++}else{for(var a=e+1;!s.test(t[a])&&a<n;)a++;u=t.slice(e,a),e=a}switch(i[l]&&p.isSingleOccurenceAttr(l)||("*"===l[l.length-1]?i[l]=p.parseExtendedValue(u):(u="type"===l?u.toLowerCase():u,null!=i[l]?Array.isArray(i[l])?i[l].push(u):i[l]=[i[l],u]:i[l]=u)),t[e]){case",":r=h.IDLE;break;case";":r=h.ATTR}e++}else throw Error('Unknown parser state "'+r+'"');return null!=i&&(null!=i.rel?this.refs.push(...p.expandRelations(i)):this.refs.push(i)),i=null,this}toString(){for(var t=[],e="",r=null,n=0;n<this.refs.length;n++)r=this.refs[n],t.push(Object.keys(this.refs[n]).reduce(function(t,e){return"uri"===e?t:t+"; "+p.formatAttribute(e,r[e])},"<"+r.uri+">"));return t.join(", ")}}p.isCompatibleEncoding=function(t){return n.test(t)},p.parse=function(t,e){return new p().parse(t,e)},p.isSingleOccurenceAttr=function(t){return"rel"===t||"type"===t||"media"===t||"title"===t||"title*"===t},p.isTokenAttr=function(t){return"rel"===t||"type"===t||"anchor"===t},p.escapeQuotes=function(t){return t.replace(/"/g,'\\"')},p.expandRelations=function(t){return t.rel.split(" ").map(function(e){var r=Object.assign({},t);return r.rel=e,r})},p.parseExtendedValue=function(t){var e=/([^']+)?(?:'([^']*)')?(.+)/.exec(t);return{language:e[2].toLowerCase(),encoding:p.isCompatibleEncoding(e[1])?null:e[1].toLowerCase(),value:p.isCompatibleEncoding(e[1])?decodeURIComponent(e[3]):e[3]}},p.formatExtendedAttribute=function(t,e){var n=(e.encoding||"utf-8").toUpperCase(),i=e.language||"en",a="";return a=r.isBuffer(e.value)&&p.isCompatibleEncoding(n)?e.value.toString(n):r.isBuffer(e.value)?e.value.toString("hex").replace(/[0-9a-f]{2}/gi,"%$1"):encodeURIComponent(e.value),t+"="+n+"'"+i+"'"+a},p.formatAttribute=function(t,e){return Array.isArray(e)?e.map(e=>p.formatAttribute(t,e)).join("; "):"*"===t[t.length-1]||"string"!=typeof e?p.formatExtendedAttribute(t,e):(p.isTokenAttr(t)?e=f(e)?'"'+p.escapeQuotes(e)+'"':p.escapeQuotes(e):f(e)&&(e='"'+(e=(e=encodeURIComponent(e)).replace(/%20/g," ").replace(/%2C/g,",").replace(/%3B/g,";"))+'"'),t+"="+e)},t.exports=p}),v("ecGDU",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.defaultExpandOptions=t.exports.JsonLdContextNormalized=void 0;var r=y("7vqNZ"),n=y("60GtF"),i=y("daggI");t.exports.JsonLdContextNormalized=class{constructor(t){this.contextRaw=t}getContextRaw(){return this.contextRaw}expandTerm(e,a,o=t.exports.defaultExpandOptions){let s=this.contextRaw[e];if(null===s||s&&null===s["@id"])return null;let l=!0;if(s&&a){let t=i.Util.getContextValueId(s);if(t&&t!==e){if("string"==typeof t&&(i.Util.isValidIri(t)||i.Util.isValidKeyword(t)))return t;i.Util.isPotentialKeyword(t)||(l=!1)}}let u=i.Util.getPrefix(e,this.contextRaw),h=this.contextRaw["@vocab"],d=(!!h||""===h)&&0>h.indexOf(":"),c=this.contextRaw["@base"],f=i.Util.isPotentialKeyword(e);if(u){let t=this.contextRaw[u],r=i.Util.getContextValueId(t);if(r){if("string"!=typeof t&&o.allowPrefixForcing){if("_"!==r[0]&&!f&&!t["@prefix"]&&!(e in this.contextRaw))return e}else if(!i.Util.isSimpleTermDefinitionPrefix(r,o))return e;return r+e.substr(u.length+1)}}else if(a&&(h||""===h||o.allowVocabRelativeToBase&&c&&d)&&!f&&!i.Util.isCompactIri(e)){if(!d)return h+e;if(o.allowVocabRelativeToBase)return(h||c?(0,r.resolve)(h,c):"")+e;throw new n.ErrorCoded(`Relative vocab expansion for term '${e}' with vocab '${h}' is not allowed.`,n.ERROR_CODES.INVALID_VOCAB_MAPPING)}else if(!a&&c&&!f&&!i.Util.isCompactIri(e))return(0,r.resolve)(e,c);if(l)return e;throw new n.ErrorCoded(`Invalid IRI mapping found for context entry '${e}': '${JSON.stringify(s)}'`,n.ERROR_CODES.INVALID_IRI_MAPPING)}compactIri(t,e){if(e&&this.contextRaw["@vocab"]&&t.startsWith(this.contextRaw["@vocab"]))return t.substr(this.contextRaw["@vocab"].length);if(!e&&this.contextRaw["@base"]&&t.startsWith(this.contextRaw["@base"]))return t.substr(this.contextRaw["@base"].length);let r={prefix:"",suffix:t};for(let n in this.contextRaw){let a=this.contextRaw[n];if(a&&!i.Util.isPotentialKeyword(n)){let o=i.Util.getContextValueId(a);if(t.startsWith(o)){let i=t.substr(o.length);if(i)i.length<r.suffix.length&&(r.prefix=n,r.suffix=i);else if(e)return n}}}return r.prefix?r.prefix+":"+r.suffix:t}},t.exports.defaultExpandOptions={allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}),v("daggI",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.Util=void 0;class r{static isCompactIri(t){return t.indexOf(":")>0&&!(t&&"#"===t[0])}static getPrefix(t,e){if(t&&"#"===t[0])return null;let r=t.indexOf(":");if(r>=0){if(t.length>r+1&&"/"===t.charAt(r+1)&&"/"===t.charAt(r+2))return null;let n=t.substr(0,r);if("_"===n)return null;if(e[n])return n}return null}static getContextValueId(t){return null===t||"string"==typeof t?t:t["@id"]||null}static isSimpleTermDefinitionPrefix(t,e){return!r.isPotentialKeyword(t)&&(e.allowPrefixNonGenDelims||"string"==typeof t&&("_"===t[0]||r.isPrefixIriEndingWithGenDelim(t)))}static isPotentialKeyword(t){return"string"==typeof t&&r.KEYWORD_REGEX.test(t)}static isPrefixIriEndingWithGenDelim(t){return r.ENDS_WITH_GEN_DELIM.test(t)}static isPrefixValue(t){return t&&("string"==typeof t||t&&"object"==typeof t)}static isValidIri(t){return!!(t&&r.IRI_REGEX.test(t))}static isValidIriWeak(t){return!!t&&":"!==t[0]&&r.IRI_REGEX_WEAK.test(t)}static isValidKeyword(t){return r.VALID_KEYWORDS[t]}static isTermProtected(t,e){let r=t[e];return"string"!=typeof r&&r&&r["@protected"]}static hasProtectedTerms(t){for(let e of Object.keys(t))if(r.isTermProtected(t,e))return!0;return!1}static isReservedInternalKeyword(t){return t.startsWith("@__")}static deepEqual(t,e){let r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&r.every(r=>{let n=t[r],i=e[r];return n===i||null!==n&&null!==i&&"object"==typeof n&&"object"==typeof i&&this.deepEqual(n,i)})}}r.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^ "<>{}|\\\[\]`#]*(#[^#]*)?$/,r.IRI_REGEX_WEAK=/(?::[^:])|\//,r.KEYWORD_REGEX=/^@[a-z]+$/i,r.ENDS_WITH_GEN_DELIM=/[:/?#\[\]@]$/,r.REGEX_LANGUAGE_TAG=/^[a-zA-Z]+(-[a-zA-Z0-9]+)*$/,r.REGEX_DIRECTION_TAG=/^(ltr)|(rtl)$/,r.VALID_KEYWORDS={"@annotation":!0,"@base":!0,"@container":!0,"@context":!0,"@direction":!0,"@graph":!0,"@id":!0,"@import":!0,"@included":!0,"@index":!0,"@json":!0,"@language":!0,"@list":!0,"@nest":!0,"@none":!0,"@prefix":!0,"@propagate":!0,"@protected":!0,"@reverse":!0,"@set":!0,"@type":!0,"@value":!0,"@version":!0,"@vocab":!0},r.EXPAND_KEYS_BLACKLIST=["@base","@vocab","@language","@version","@direction"],r.ALIAS_DOMAIN_BLACKLIST=["@container","@graph","@id","@index","@list","@nest","@none","@prefix","@reverse","@set","@type","@value","@version"],r.ALIAS_RANGE_BLACKLIST=["@context","@preserve"],r.CONTAINERS=["@list","@set","@index","@language","@graph","@id","@type"],r.CONTAINERS_1_0=["@list","@set","@index"],t.exports.Util=r}),v("8EISD",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0})}),v("4uhna",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0})}),v("7K0Nk",function(t,e){var r=y("bemQE"),n=y("gLC8J");let i=r.Readable.destroy;t.exports=r.Readable,t.exports._uint8ArrayToBuffer=r._uint8ArrayToBuffer,t.exports._isUint8Array=r._isUint8Array,t.exports.isDisturbed=r.isDisturbed,t.exports.isErrored=r.isErrored,t.exports.isReadable=r.isReadable,t.exports.Readable=r.Readable,t.exports.Writable=r.Writable,t.exports.Duplex=r.Duplex,t.exports.Transform=r.Transform,t.exports.PassThrough=r.PassThrough,t.exports.addAbortSignal=r.addAbortSignal,t.exports.finished=r.finished,t.exports.destroy=r.destroy,t.exports.destroy=i,t.exports.pipeline=r.pipeline,t.exports.compose=r.compose,Object.defineProperty(r,"promises",{configurable:!0,enumerable:!0,get:()=>n}),t.exports.Stream=r.Stream,t.exports.default=t.exports}),v("bemQE",function(t,e){var r=y("6ZWSX").Buffer,n=y("e93qE"),i=n.ObjectDefineProperty,a=n.ObjectKeys,o=n.ReflectApply;let{promisify:{custom:s}}=y("3OYnt");var l=y("iABzp"),u=l.streamReturningOperators,h=l.promiseReturningOperators;let{codes:{ERR_ILLEGAL_CONSTRUCTOR:d}}=y("aqMop");var c=y("lV9Lt"),f=y("04a3B"),p=f.setDefaultHighWaterMark,g=f.getDefaultHighWaterMark,v=y("aGSwO").pipeline,m=y("fMCbt").destroyer,b=y("fiCvv"),x=y("gLC8J"),E=y("b0Zn2");let w=t.exports=y("1B0VZ").Stream;for(let t of(w.isDestroyed=E.isDestroyed,w.isDisturbed=E.isDisturbed,w.isErrored=E.isErrored,w.isReadable=E.isReadable,w.isWritable=E.isWritable,w.Readable=y("2HCgn"),a(u))){let e=u[t];function _(...t){if(new.target)throw d();return w.Readable.from(o(e,this,t))}i(_,"name",{__proto__:null,value:e.name}),i(_,"length",{__proto__:null,value:e.length}),i(w.Readable.prototype,t,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}for(let t of a(h)){let e=h[t];function S(...t){if(new.target)throw d();return o(e,this,t)}i(S,"name",{__proto__:null,value:e.name}),i(S,"length",{__proto__:null,value:e.length}),i(w.Readable.prototype,t,{__proto__:null,value:S,enumerable:!1,configurable:!0,writable:!0})}w.Writable=y("e6GFj"),w.Duplex=y("aAPdh"),w.Transform=y("9Q7aU"),w.PassThrough=y("6DJp0"),w.pipeline=v;var k=y("19AFn").addAbortSignal;w.addAbortSignal=k,w.finished=b,w.destroy=m,w.compose=c,w.setDefaultHighWaterMark=p,w.getDefaultHighWaterMark=g,i(w,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>x}),i(v,s,{__proto__:null,enumerable:!0,get:()=>x.pipeline}),i(b,s,{__proto__:null,enumerable:!0,get:()=>x.finished}),w.Stream=w,w._isUint8Array=function(t){return t instanceof Uint8Array},w._uint8ArrayToBuffer=function(t){return r.from(t.buffer,t.byteOffset,t.byteLength)}}),v("iABzp",function(t,e){n(t.exports,"streamReturningOperators",()=>u,t=>u=t),n(t.exports,"promiseReturningOperators",()=>h,t=>h=t);let r=globalThis.AbortController||y("bHKGd").AbortController,{codes:{ERR_INVALID_ARG_VALUE:i,ERR_INVALID_ARG_TYPE:a,ERR_MISSING_ARGS:o,ERR_OUT_OF_RANGE:s},AbortError:l}=y("aqMop");var u,h,d=y("aTBkv"),c=d.validateAbortSignal,f=d.validateInteger,p=d.validateObject;let g=y("e93qE").Symbol("kWeak"),v=y("e93qE").Symbol("kResistStopPropagation");var m=y("fiCvv").finished,b=y("lV9Lt"),x=y("19AFn").addAbortSignalNoValidate,E=y("b0Zn2"),w=E.isWritable,_=E.isNodeStream,S=y("3OYnt").deprecate,k=y("e93qE").ArrayPrototypePush,N=y("e93qE").Boolean,O=y("e93qE").MathFloor,T=y("e93qE").Number,M=y("e93qE").NumberIsNaN,A=y("e93qE").Promise,C=y("e93qE").PromiseReject,R=y("e93qE").PromiseResolve,I=y("e93qE").PromisePrototypeThen,P=y("e93qE").Symbol;let D=P("kEmpty"),L=P("kEof");function j(t,e){if("function"!=typeof t)throw new a("fn",["Function","AsyncFunction"],t);null!=e&&p(e,"options"),(null==e?void 0:e.signal)!=null&&c(e.signal,"options.signal");let r=1;(null==e?void 0:e.concurrency)!=null&&(r=O(e.concurrency));let n=r-1;return(null==e?void 0:e.highWaterMark)!=null&&(n=O(e.highWaterMark)),f(r,"options.concurrency",1),f(n,"options.highWaterMark",0),n+=r,(async function*(){let i,a;let o=y("3OYnt").AbortSignalAny([null==e?void 0:e.signal].filter(N)),s=this,u=[],h={signal:o},d=!1,c=0;function f(){d=!0,p()}function p(){c-=1,g()}function g(){a&&!d&&c<r&&u.length<n&&(a(),a=null)}(async function(){try{for await(let e of s){if(d)return;if(o.aborted)throw new l;try{if((e=t(e,h))===D)continue;e=R(e)}catch(t){e=C(t)}c+=1,I(e,p,f),u.push(e),i&&(i(),i=null),!d&&(u.length>=n||c>=r)&&await new A(t=>{a=t})}u.push(L)}catch(e){let t=C(e);I(t,p,f),u.push(t)}finally{d=!0,i&&(i(),i=null)}})();try{for(;;){for(;u.length>0;){let t=await u[0];if(t===L)return;if(o.aborted)throw new l;t!==D&&(yield t),u.shift(),g()}await new A(t=>{i=t})}}finally{d=!0,a&&(a(),a=null)}}).call(this)}async function F(t,e){for await(let r of G.call(this,t,e))return!0;return!1}async function B(t,e){if("function"!=typeof t)throw new a("fn",["Function","AsyncFunction"],t);return!await F.call(this,async(...e)=>!await t(...e),e)}async function z(t,e){for await(let r of G.call(this,t,e))return r}async function V(t,e){if("function"!=typeof t)throw new a("fn",["Function","AsyncFunction"],t);async function r(e,r){return await t(e,r),D}for await(let t of j.call(this,r,e));}function G(t,e){if("function"!=typeof t)throw new a("fn",["Function","AsyncFunction"],t);async function r(e,r){return await t(e,r)?e:D}return j.call(this,r,e)}class $ extends o{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function U(t,e,n){var i,o;if("function"!=typeof t)throw new a("reducer",["Function","AsyncFunction"],t);null!=n&&p(n,"options"),(null==n?void 0:n.signal)!=null&&c(n.signal,"options.signal");let s=arguments.length>1;if(null!=n&&null!==(i=n.signal)&&void 0!==i&&i.aborted){let t=new l(void 0,{cause:n.signal.reason});throw this.once("error",()=>{}),await m(this.destroy(t)),t}let u=new r,h=u.signal;null!=n&&n.signal&&n.signal.addEventListener("abort",()=>u.abort(),{once:!0,[g]:this,[v]:!0});let d=!1;try{for await(let r of this){if(d=!0,null!=n&&null!==(o=n.signal)&&void 0!==o&&o.aborted)throw new l;s?e=await t(e,r,{signal:h}):(e=r,s=!0)}if(!d&&!s)throw new $}finally{u.abort()}return e}async function H(t){null!=t&&p(t,"options"),(null==t?void 0:t.signal)!=null&&c(t.signal,"options.signal");let e=[];for await(let n of this){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new l(void 0,{cause:t.signal.reason});k(e,n)}return e}function W(t){if(M(t=T(t)))return 0;if(t<0)throw new s("number",">= 0",t);return t}u={asIndexedPairs:S(function(t){return null!=t&&p(t,"options"),(null==t?void 0:t.signal)!=null&&c(t.signal,"options.signal"),(async function*(){let e=0;for await(let n of this){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new l({cause:t.signal.reason});yield[e++,n]}}).call(this)},"readable.asIndexedPairs will be removed in a future version."),drop:function(t,e){return null!=e&&p(e,"options"),(null==e?void 0:e.signal)!=null&&c(e.signal,"options.signal"),t=W(t),(async function*(){var r,n;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new l;for await(let r of this){if(null!=e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new l;t--<=0&&(yield r)}}).call(this)},filter:G,flatMap:function(t,e){let r=j.call(this,t,e);return(async function*(){for await(let t of r)yield*t}).call(this)},map:j,take:function(t,e){return null!=e&&p(e,"options"),(null==e?void 0:e.signal)!=null&&c(e.signal,"options.signal"),t=W(t),(async function*(){var r,n;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new l;for await(let r of this){if(null!=e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new l;if(t-- >0&&(yield r),t<=0)return}}).call(this)},compose:function(t,e){if(null!=e&&p(e,"options"),(null==e?void 0:e.signal)!=null&&c(e.signal,"options.signal"),_(t)&&!w(t))throw new i("stream",t,"must be writable");let r=b(this,t);return null!=e&&e.signal&&x(e.signal,r),r}},h={every:B,forEach:V,reduce:U,toArray:H,some:F,find:z}}),v("lV9Lt",function(t,e){var r=y("aGSwO").pipeline,n=y("aAPdh"),i=y("fMCbt").destroyer,a=y("b0Zn2"),o=a.isNodeStream,s=a.isReadable,l=a.isWritable,u=a.isWebStream,h=a.isTransformStream,d=a.isWritableStream,c=a.isReadableStream;let{AbortError:f,codes:{ERR_INVALID_ARG_VALUE:p,ERR_MISSING_ARGS:g}}=y("aqMop");var v=y("fiCvv");t.exports=function(...t){let e,a,y,m,b;if(0===t.length)throw new g("streams");if(1===t.length)return n.from(t[0]);let x=[...t];if("function"==typeof t[0]&&(t[0]=n.from(t[0])),"function"==typeof t[t.length-1]){let e=t.length-1;t[e]=n.from(t[e])}for(let e=0;e<t.length;++e)if(o(t[e])||u(t[e])){if(e<t.length-1&&!(s(t[e])||c(t[e])||h(t[e])))throw new p(`streams[${e}]`,x[e],"must be readable");if(e>0&&!(l(t[e])||d(t[e])||h(t[e])))throw new p(`streams[${e}]`,x[e],"must be writable")}let E=t[0],w=r(t,function(t){let e=m;m=null,e?e(t):t?b.destroy(t):S||_||b.destroy()}),_=!!(l(E)||d(E)||h(E)),S=!!(s(w)||c(w)||h(w));if(b=new n({writableObjectMode:!!(null!=E&&E.writableObjectMode),readableObjectMode:!!(null!=w&&w.readableObjectMode),writable:_,readable:S}),_){if(o(E))b._write=function(t,r,n){E.write(t,r)?n():e=n},b._final=function(t){E.end(),a=t},E.on("drain",function(){if(e){let t=e;e=null,t()}});else if(u(E)){let t=(h(E)?E.writable:E).getWriter();b._write=async function(e,r,n){try{await t.ready,t.write(e).catch(()=>{}),n()}catch(t){n(t)}},b._final=async function(e){try{await t.ready,t.close().catch(()=>{}),a=e}catch(t){e(t)}}}v(h(w)?w.readable:w,()=>{if(a){let t=a;a=null,t()}})}if(S){if(o(w))w.on("readable",function(){if(y){let t=y;y=null,t()}}),w.on("end",function(){b.push(null)}),b._read=function(){for(;;){let t=w.read();if(null===t){y=b._read;return}if(!b.push(t))return}};else if(u(w)){let t=(h(w)?w.readable:w).getReader();b._read=async function(){for(;;)try{let{value:e,done:r}=await t.read();if(!b.push(e))return;if(r){b.push(null);return}}catch{return}}}}return b._destroy=function(t,r){t||null===m||(t=new f),y=null,e=null,a=null,null===m?r(t):(m=r,o(w)&&i(w,t))},b}}),v("aGSwO",function(t,e){let r,n,i;var a=y("hPtJY"),o=y("e93qE"),s=o.ArrayIsArray,l=o.Promise,u=o.SymbolAsyncIterator,h=o.SymbolDispose,d=y("fiCvv"),c=y("3OYnt").once,f=y("fMCbt"),p=y("aAPdh");let{aggregateTwoErrors:g,codes:{ERR_INVALID_ARG_TYPE:v,ERR_INVALID_RETURN_VALUE:m,ERR_MISSING_ARGS:b,ERR_STREAM_DESTROYED:x,ERR_STREAM_PREMATURE_CLOSE:E},AbortError:w}=y("aqMop");var _=y("aTBkv"),S=_.validateFunction,k=_.validateAbortSignal,N=y("b0Zn2"),O=N.isIterable,T=N.isReadable,M=N.isReadableNodeStream,A=N.isNodeStream,C=N.isTransformStream,R=N.isWebStream,I=N.isReadableStream,P=N.isReadableFinished;let D=globalThis.AbortController||y("bHKGd").AbortController;function L(t,e,r){let n=!1;return t.on("close",()=>{n=!0}),{destroy:e=>{n||(n=!0,f.destroyer(t,e||new x("pipe")))},cleanup:d(t,{readable:e,writable:r},t=>{n=!t})}}function j(t){if(O(t))return t;if(M(t))return F(t);throw new v("val",["Readable","Iterable","AsyncIterable"],t)}async function*F(t){n||(n=y("2HCgn")),yield*n.prototype[u].call(t)}async function B(t,e,r,{end:n}){let i;let a=null,o=t=>{if(t&&(i=t),a){let t=a;a=null,t()}},s=()=>new l((t,e)=>{i?e(i):a=()=>{i?e(i):t()}});e.on("drain",o);let u=d(e,{readable:!1},o);try{for await(let r of(e.writableNeedDrain&&await s(),t))e.write(r)||await s();n&&(e.end(),await s()),r()}catch(t){r(i!==t?g(i,t):t)}finally{u(),e.off("drain",o)}}async function z(t,e,r,{end:n}){C(e)&&(e=e.writable);let i=e.getWriter();try{for await(let e of t)await i.ready,i.write(e).catch(()=>{});await i.ready,n&&await i.close(),r()}catch(t){try{await i.abort(t),r(t)}catch(t){r(t)}}}function V(t,e,n){let o,l,u,c;if(1===t.length&&s(t[0])&&(t=t[0]),t.length<2)throw new b("streams");let f=new D,g=f.signal,x=null==n?void 0:n.signal,_=[];function S(){G(new w)}k(x,"options.signal"),i=i||y("3OYnt").addAbortListener,x&&(o=i(x,S));let N=[],F=0;function V(t){G(t,0==--F)}function G(t,r){var n;if(t&&(!l||"ERR_STREAM_PREMATURE_CLOSE"===l.code)&&(l=t),l||r){for(;N.length;)N.shift()(l);null===(n=o)||void 0===n||n[h](),f.abort(),r&&(l||_.forEach(t=>t()),a.nextTick(e,l,u))}}for(let e=0;e<t.length;e++){let i=t[e],o=e<t.length-1,s=e>0,l=o||(null==n?void 0:n.end)!==!1,h=e===t.length-1;if(A(i)){if(l){let{destroy:t,cleanup:e}=L(i,o,s);N.push(t),T(i)&&h&&_.push(e)}function $(t){t&&"AbortError"!==t.name&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code&&V(t)}i.on("error",$),T(i)&&h&&_.push(()=>{i.removeListener("error",$)})}if(0===e){if("function"==typeof i){if(!O(c=i({signal:g})))throw new m("Iterable, AsyncIterable or Stream","source",c)}else c=O(i)||M(i)||C(i)?i:p.from(i)}else if("function"==typeof i){var U,H;if(c=i(c=C(c)?j(null===(U=c)||void 0===U?void 0:U.readable):j(c),{signal:g}),o){if(!O(c,!0))throw new m("AsyncIterable",`transform[${e-1}]`,c)}else{r||(r=y("6DJp0"));let t=new r({objectMode:!0}),e=null===(H=c)||void 0===H?void 0:H.then;if("function"==typeof e)F++,e.call(c,e=>{u=e,null!=e&&t.write(e),l&&t.end(),a.nextTick(V)},e=>{t.destroy(e),a.nextTick(V,e)});else if(O(c,!0))F++,B(c,t,V,{end:l});else if(I(c)||C(c)){let e=c.readable||c;F++,B(e,t,V,{end:l})}else throw new m("AsyncIterable or Promise","destination",c);let{destroy:n,cleanup:i}=L(c=t,!1,!0);N.push(n),h&&_.push(i)}}else if(A(i)){if(M(c)){F+=2;let t=function(t,e,r,{end:n}){let i=!1;if(e.on("close",()=>{i||r(new E)}),t.pipe(e,{end:!1}),n){function o(){i=!0,e.end()}P(t)?a.nextTick(o):t.once("end",o)}else r();return d(t,{readable:!0,writable:!1},e=>{let n=t._readableState;e&&"ERR_STREAM_PREMATURE_CLOSE"===e.code&&n&&n.ended&&!n.errored&&!n.errorEmitted?t.once("end",r).once("error",r):r(e)}),d(e,{readable:!1,writable:!0},r)}(c,i,V,{end:l});T(i)&&h&&_.push(t)}else if(C(c)||I(c)){let t=c.readable||c;F++,B(t,i,V,{end:l})}else if(O(c))F++,B(c,i,V,{end:l});else throw new v("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],c);c=i}else if(R(i)){if(M(c))F++,z(j(c),i,V,{end:l});else if(I(c)||O(c))F++,z(c,i,V,{end:l});else if(C(c))F++,z(c.readable,i,V,{end:l});else throw new v("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],c);c=i}else c=p.from(i)}return(null!=g&&g.aborted||null!=x&&x.aborted)&&a.nextTick(S),c}t.exports={pipelineImpl:V,pipeline:function(...t){return V(t,c((S(t[t.length-1],"streams[stream.length - 1]"),t.pop())))}}}),v("gLC8J",function(t,e){var r=y("e93qE"),n=r.ArrayPrototypePop,i=r.Promise,a=y("b0Zn2"),o=a.isIterable,s=a.isNodeStream,l=a.isWebStream,u=y("aGSwO").pipelineImpl,h=y("fiCvv").finished;y("bemQE"),t.exports={finished:h,pipeline:function(...t){return new i((e,r)=>{let i,a;let h=t[t.length-1];if(h&&"object"==typeof h&&!s(h)&&!o(h)&&!l(h)){let e=n(t);i=e.signal,a=e.end}u(t,(t,n)=>{t?r(t):e(n)},{signal:i,end:a})})}}}),v("f5N42",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerArrayValue=void 0;var r=y("XwuNW"),n=y("d7uy5");t.exports.EntryHandlerArrayValue=class{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,n,i){return this.test(t,e,null,r,n)}async test(t,e,r,n,i){return"number"==typeof n[i]}async handle(t,e,n,i,a,o){let s=await e.unaliasKeywordParent(i,o);if("@list"===s){let r=null,n=0;for(let t=o-2;t>0;t--){let e=i[t];if("string"==typeof e||"number"==typeof e){n=t,r=e;break}}if(null!==r){let s=await e.valueToTerm(await t.getContext(i),r,a,o,i);for(let r of s)await this.handleListElement(t,e,r,a,o,i.slice(0,n),n);0===s.length&&await this.handleListElement(t,e,null,a,o,i.slice(0,n),n)}}else if("@set"===s)await t.newOnValueJob(i.slice(0,-2),a,o-2,!1);else if(void 0!==s&&"@type"!==s){for(let t=o-1;t>0;t--)if("number"!=typeof i[t]){s=await e.unaliasKeyword(i[t],i,t);break}let n=await t.getContext(i.slice(0,-1));if("@list"in r.Util.getContextValueContainer(n,s)){t.emittedStack[o+1]=!0;let r=await e.valueToTerm(await t.getContext(i),s,a,o,i);for(let n of r)await this.handleListElement(t,e,n,a,o,i.slice(0,-1),o-1);0===r.length&&await this.handleListElement(t,e,null,a,o,i.slice(0,-1),o-1)}else t.shiftStack(o,1),await t.newOnValueJob(i.slice(0,-1),a,o-1,!1),t.contextTree.removeContext(i.slice(0,-1))}}async handleListElement(t,e,r,i,a,o,s){let l=t.listPointerStack[a];if(null!==i&&null!==(await e.unaliasKeywords(i,o,a))["@value"]){if(l&&l.value){let r=e.dataFactory.blankNode();t.emitQuad(a,e.dataFactory.quad(l.value,e.rdfRest,r,e.getDefaultGraph())),l.value=r}else{let t=e.dataFactory.blankNode();l={value:t,listRootDepth:s,listId:t}}r&&t.emitQuad(a,e.dataFactory.quad(l.value,e.rdfFirst,r,e.getDefaultGraph()))}else l||(l={listRootDepth:s,listId:e.rdfNil});t.listPointerStack[a]=l,t.rdfstar&&t.annotationsBuffer[a]&&t.emitError(new n.ErrorCoded("Found an illegal annotation inside a list",n.ERROR_CODES.INVALID_ANNOTATION))}}}),v("XwuNW",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.Util=void 0;var r=y("d7uy5"),n=y("lCEHR"),i=y("cJYov"),a=y("kRKFi");class o{constructor(t){this.parsingContext=t.parsingContext,this.dataFactory=t.dataFactory||new n.DataFactory,this.rdfFirst=this.dataFactory.namedNode(o.RDF+"first"),this.rdfRest=this.dataFactory.namedNode(o.RDF+"rest"),this.rdfNil=this.dataFactory.namedNode(o.RDF+"nil"),this.rdfType=this.dataFactory.namedNode(o.RDF+"type"),this.rdfJson=this.dataFactory.namedNode(o.RDF+"JSON")}static getContextValue(t,e,r,n){let i=t.getContextRaw()[r];if(!i)return n;let a=i[e];return void 0===a?n:a}static getContextValueContainer(t,e){return o.getContextValue(t,"@container",e,{"@set":!0})}static getContextValueType(t,e){let r=o.getContextValue(t,"@type",e,null);return"@none"===r?null:r}static getContextValueLanguage(t,e){return o.getContextValue(t,"@language",e,t.getContextRaw()["@language"]||null)}static getContextValueDirection(t,e){return o.getContextValue(t,"@direction",e,t.getContextRaw()["@direction"]||null)}static isContextValueReverse(t,e){return!!o.getContextValue(t,"@reverse",e,null)}static getContextValueIndex(t,e){return o.getContextValue(t,"@index",e,t.getContextRaw()["@index"]||null)}static isPropertyReverse(t,e,r){return"@reverse"===r!==o.isContextValueReverse(t,e)}static isPropertyInEmbeddedNode(t){return"@id"===t}static isPropertyInAnnotationObject(t){return"@annotation"===t}static isValidIri(t){return null!==t&&r.Util.isValidIri(t)}static isPrefixArray(t,e){if(t.length>e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}async validateValueIndexes(t){if(this.parsingContext.validateValueIndexes){let e={};for(let n of t)if(n&&"object"==typeof n){let t=n["@id"],i=n["@index"];if(t&&i){let n=e[t];if(n&&n!==i)throw new r.ErrorCoded(`Conflicting @index value for ${t}`,r.ERROR_CODES.CONFLICTING_INDEXES);e[t]=i}}}}async valueToTerm(t,e,n,i,a){if("@json"===o.getContextValueType(t,e))return[this.dataFactory.literal(this.valueToJsonString(n),this.rdfJson)];let s=typeof n;switch(s){case"object":if(null==n)return[];if(Array.isArray(n)){if("@list"in o.getContextValueContainer(t,e)){if(0===n.length)return[this.rdfNil];return this.parsingContext.idStack[i+1]||[]}return await this.validateValueIndexes(n),[]}if(t=await this.getContextSelfOrPropertyScoped(t,e),"@context"in n&&(t=await this.parsingContext.parseContext(n["@context"],(await this.parsingContext.getContext(a,0)).getContextRaw())),"@value"in(n=await this.unaliasKeywords(n,a,i,t))){let o,s,l,u,h;for(e in n){let t=n[e];switch(e){case"@value":o=t;break;case"@language":s=t;break;case"@direction":l=t;break;case"@type":u=t;break;case"@index":h=t;break;case"@annotation":break;default:throw new r.ErrorCoded(`Unknown value entry '${e}' in @value: ${JSON.stringify(n)}`,r.ERROR_CODES.INVALID_VALUE_OBJECT)}}if(await this.unaliasKeyword(u,a,i,!0,t)==="@json")return[this.dataFactory.literal(this.valueToJsonString(o),this.rdfJson)];if(null===o)return[];if("object"==typeof o)throw new r.ErrorCoded(`The value of an '@value' can not be an object, got '${JSON.stringify(o)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT_VALUE);if(this.parsingContext.validateValueIndexes&&h&&"string"!=typeof h)throw new r.ErrorCoded(`The value of an '@index' must be a string, got '${JSON.stringify(h)}'`,r.ERROR_CODES.INVALID_INDEX_VALUE);if(s){if("string"!=typeof o)throw new r.ErrorCoded(`When an '@language' is set, the value of '@value' must be a string, got '${JSON.stringify(o)}'`,r.ERROR_CODES.INVALID_LANGUAGE_TAGGED_VALUE);if(!r.ContextParser.validateLanguage(s,this.parsingContext.strictValues,r.ERROR_CODES.INVALID_LANGUAGE_TAGGED_STRING))return[];(this.parsingContext.normalizeLanguageTags||1===this.parsingContext.activeProcessingMode)&&(s=s.toLowerCase())}if(l){if("string"!=typeof o)throw Error(`When an '@direction' is set, the value of '@value' must be a string, got '${JSON.stringify(o)}'`);if(!r.ContextParser.validateDirection(l,this.parsingContext.strictValues))return[]}if(s&&l&&this.parsingContext.rdfDirection){if(u)throw new r.ErrorCoded(`Can not have '@language', '@direction' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(i,o,s,l))}if(s){if(u)throw new r.ErrorCoded(`Can not have both '@language' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return[this.dataFactory.literal(o,s)]}if(l&&this.parsingContext.rdfDirection){if(u)throw new r.ErrorCoded(`Can not have both '@direction' and '@type' in a value: '${JSON.stringify(n)}'`,r.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(i,o,s,l))}if(u){if("string"!=typeof u)throw new r.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(u)}'`,r.ERROR_CODES.INVALID_TYPED_VALUE);let e=this.createVocabOrBaseTerm(t,u);if(!e)throw new r.ErrorCoded(`Invalid '@type' value, got '${JSON.stringify(u)}'`,r.ERROR_CODES.INVALID_TYPED_VALUE);if("NamedNode"!==e.termType)throw new r.ErrorCoded(`Illegal value type (${e.termType}): ${u}`,r.ERROR_CODES.INVALID_TYPED_VALUE);return[this.dataFactory.literal(o,e)]}return await this.valueToTerm(new r.JsonLdContextNormalized({}),e,o,i,a)}if("@set"in n){if(Object.keys(n).length>1)throw new r.ErrorCoded(`Found illegal neighbouring entries next to @set for key: '${e}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);return[]}if("@list"in n){if(Object.keys(n).length>1)throw new r.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${e}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);let t=n["@list"];if(!Array.isArray(t))return await this.valueToTerm(await this.parsingContext.getContext(a),e,t,i-1,a.slice(0,-1));if(0===t.length)return[this.rdfNil];return this.parsingContext.idStack[i+1]||[]}if("@reverse"in n&&"boolean"==typeof n["@reverse"])return[];else if("@graph"in o.getContextValueContainer(await this.parsingContext.getContext(a),e)){let t=this.parsingContext.graphContainerTermStack[i+1];return t?Object.values(t):[this.dataFactory.blankNode()]}else if("@id"in n){if(Object.keys(n).length>1&&(t=await this.parsingContext.getContext(a,0)),"@context"in n&&(t=await this.parsingContext.parseContext(n["@context"],t.getContextRaw())),"@vocab"===n["@type"])return this.nullableTermToArray(this.createVocabOrBaseTerm(t,n["@id"]));{let e;let a=n["@id"];if("object"==typeof a){if(this.parsingContext.rdfstar)e=this.parsingContext.idStack[i+1][0];else throw new r.ErrorCoded(`Found illegal @id '${n}'`,r.ERROR_CODES.INVALID_ID_VALUE)}else e=this.resourceToTerm(t,a);return this.nullableTermToArray(e)}}else{if(this.parsingContext.emittedStack[i+1]||n&&"object"==typeof n&&0===Object.keys(n).length)return this.parsingContext.idStack[i+1]||(this.parsingContext.idStack[i+1]=[this.dataFactory.blankNode()]);return[]}case"string":return this.nullableTermToArray(this.stringValueToTerm(i,await this.getContextSelfOrPropertyScoped(t,e),e,n,null));case"boolean":return this.nullableTermToArray(this.stringValueToTerm(i,await this.getContextSelfOrPropertyScoped(t,e),e,(!!n).toString(),this.dataFactory.namedNode(o.XSD_BOOLEAN)));case"number":return this.nullableTermToArray(this.stringValueToTerm(i,await this.getContextSelfOrPropertyScoped(t,e),e,n,this.dataFactory.namedNode(n%1==0&&n<1e21?o.XSD_INTEGER:o.XSD_DOUBLE)));default:return this.parsingContext.emitError(Error(`Could not determine the RDF type of a ${s}`)),[]}}async getContextSelfOrPropertyScoped(t,e){let r=t.getContextRaw()[e];return r&&"object"==typeof r&&"@context"in r&&(t=await this.parsingContext.parseContext(r,t.getContextRaw(),!0)),t}nullableTermToArray(t){return t?[t]:[]}predicateToTerm(t,e){let n=t.expandTerm(e,!0,this.parsingContext.getExpandOptions());return n?"_"===n[0]&&":"===n[1]?this.parsingContext.produceGeneralizedRdf?this.dataFactory.blankNode(n.substr(2)):null:o.isValidIri(n)?this.dataFactory.namedNode(n):(n&&this.parsingContext.strictValues&&this.parsingContext.emitError(new r.ErrorCoded(`Invalid predicate IRI: ${n}`,r.ERROR_CODES.INVALID_IRI_MAPPING)),null):null}resourceToTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));let r=t.expandTerm(e,!1,this.parsingContext.getExpandOptions());if(!o.isValidIri(r)){if(!r||!this.parsingContext.strictValues)return null;this.parsingContext.emitError(Error(`Invalid resource IRI: ${r}`))}return this.dataFactory.namedNode(r)}createVocabOrBaseTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));let r=this.parsingContext.getExpandOptions(),n=t.expandTerm(e,!0,r);if(n===e&&(n=t.expandTerm(e,!1,r)),!o.isValidIri(n)){if(!n||!this.parsingContext.strictValues||n.startsWith("@"))return null;this.parsingContext.emitError(Error(`Invalid term IRI: ${n}`))}return this.dataFactory.namedNode(n)}intToString(t,e){return"number"!=typeof t?t:Number.isFinite(t)?t%1!=0||e&&e.value===o.XSD_DOUBLE?t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"):Number(t).toString():t>0?"INF":"-INF"}stringValueToTerm(t,e,r,n,i){let a=o.getContextValueType(e,r);if(a){if("@id"===a){if(!i)return this.resourceToTerm(e,this.intToString(n,i))}else if("@vocab"===a){if(!i)return this.createVocabOrBaseTerm(e,this.intToString(n,i))}else i=this.dataFactory.namedNode(a)}if(!i){let a=o.getContextValueLanguage(e,r),s=o.getContextValueDirection(e,r);return s&&this.parsingContext.rdfDirection?this.createLanguageDirectionLiteral(t,this.intToString(n,i),a,s):this.dataFactory.literal(this.intToString(n,i),a)}return this.dataFactory.literal(this.intToString(n,i),i)}createLanguageDirectionLiteral(t,e,r,n){if("i18n-datatype"===this.parsingContext.rdfDirection)return r||(r=""),this.dataFactory.literal(e,this.dataFactory.namedNode(`https://www.w3.org/ns/i18n#${r}_${n}`));{let i=this.dataFactory.blankNode(),a=this.getDefaultGraph();return this.parsingContext.emitQuad(t,this.dataFactory.quad(i,this.dataFactory.namedNode(o.RDF+"value"),this.dataFactory.literal(e),a)),r&&this.parsingContext.emitQuad(t,this.dataFactory.quad(i,this.dataFactory.namedNode(o.RDF+"language"),this.dataFactory.literal(r),a)),this.parsingContext.emitQuad(t,this.dataFactory.quad(i,this.dataFactory.namedNode(o.RDF+"direction"),this.dataFactory.literal(n),a)),i}}valueToJsonString(t){return a(t)}async unaliasKeyword(t,e,n,i,a){if(Number.isInteger(t))return t;if(!i){let t=this.parsingContext.unaliasedKeywordCacheStack[n];if(t)return t}if(!r.Util.isPotentialKeyword(t)){let n=(a=a||await this.parsingContext.getContext(e)).getContextRaw()[t];n&&"object"==typeof n&&(n=n["@id"]),r.Util.isValidKeyword(n)&&(t=n)}return i?t:this.parsingContext.unaliasedKeywordCacheStack[n]=t}async unaliasKeywordParent(t,e){return await this.unaliasKeyword(e>0&&t[e-1],t,e-1)}async unaliasKeywords(t,e,r,n){let i={};for(let a in t)i[await this.unaliasKeyword(a,e,r+1,!0,n)]=t[a];return i}async isLiteral(t,e){for(let r=e;r>=0&&await this.unaliasKeyword(t[r],t,r)!=="@annotation";r--)if(this.parsingContext.literalStack[r]||this.parsingContext.jsonLiteralStack[r])return!0;return!1}async getDepthOffsetGraph(t,e){for(let r=t-1;r>0;r--)if(await this.unaliasKeyword(e[r],e,r)==="@graph"){let n=(await i.EntryHandlerContainer.getContainerHandler(this.parsingContext,e,r)).containers;if(i.EntryHandlerContainer.isComplexGraphContainer(n))return -1;return t-r-1}return -1}validateReverseSubject(t){if("Literal"===t.termType)throw new r.ErrorCoded(`Found illegal literal in subject position: ${t.value}`,r.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}getDefaultGraph(){return this.parsingContext.defaultGraph||this.dataFactory.defaultGraph()}async getGraphContainerValue(t,e){let r=this.getDefaultGraph(),{containers:n,depth:a}=await i.EntryHandlerContainer.getContainerHandler(this.parsingContext,t,e);if("@graph"in n){let e=i.EntryHandlerContainer.getContainerGraphIndex(n,a,t),o=this.parsingContext.graphContainerTermStack[a];if(!(r=o?o[e]:null)){let i=null;if("@id"in n){let e=await this.getContainerKey(t[a],t,a);null!==e&&(i=await this.resourceToTerm(await this.parsingContext.getContext(t),e))}i||(i=this.dataFactory.blankNode()),this.parsingContext.graphContainerTermStack[a]||(this.parsingContext.graphContainerTermStack[a]={}),r=this.parsingContext.graphContainerTermStack[a][e]=i}}return r}async getPropertiesDepth(t,e){let r=e;for(let n=e-1;n>0;n--)if("number"!=typeof t[n]){let e=await this.unaliasKeyword(t[n],t,n);if("@reverse"===e)return n;if("@nest"===e)r=n;else break}return r}async getContainerKey(t,e,r){let n=await this.unaliasKeyword(t,e,r);return"@none"===n?null:n}validateReverseInEmbeddedNode(t,e,n){if(n&&e&&!this.parsingContext.rdfstarReverseInEmbedded)throw new r.ErrorCoded(`Illegal reverse property in embedded node in ${t}`,r.ERROR_CODES.INVALID_EMBEDDED_NODE)}emitQuadChecked(t,e,n,i,a,o,s){let l;if(o?(this.validateReverseSubject(i),l=this.dataFactory.quad(i,n,e,a)):l=this.dataFactory.quad(e,n,i,a),s){if("DefaultGraph"!==l.graph.termType&&(l=this.dataFactory.quad(l.subject,l.predicate,l.object)),this.parsingContext.idStack[t-1])throw new r.ErrorCoded("Illegal multiple properties in an embedded node",r.ERROR_CODES.INVALID_EMBEDDED_NODE);this.parsingContext.idStack[t-1]=[l]}else this.parsingContext.emitQuad(t,l);let u=this.parsingContext.annotationsBuffer[t];if(u){for(let e of u)this.emitAnnotation(t,l,e);delete this.parsingContext.annotationsBuffer[t]}}emitAnnotation(t,e,r){let n;for(let i of(r.reverse?(this.validateReverseSubject(r.object),n=this.dataFactory.quad(r.object,r.predicate,e)):n=this.dataFactory.quad(e,r.predicate,r.object),this.parsingContext.emitQuad(t,n),r.nestedAnnotations))this.emitAnnotation(t,n,i)}}o.XSD="http://www.w3.org/2001/XMLSchema#",o.XSD_BOOLEAN=o.XSD+"boolean",o.XSD_INTEGER=o.XSD+"integer",o.XSD_DOUBLE=o.XSD+"double",o.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",t.exports.Util=o}),v("lCEHR",function(t,e){var r=t.exports&&t.exports.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=t.exports&&t.exports.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(t.exports,"__esModule",{value:!0}),n(y("dUwlf"),t.exports),n(y("3wL3n"),t.exports),n(y("0UUif"),t.exports),n(y("8RsDA"),t.exports),n(y("7KJsK"),t.exports),n(y("1k2AX"),t.exports),n(y("kNA9K"),t.exports)}),v("dUwlf",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.BlankNode=void 0,t.exports.BlankNode=class{constructor(t){this.termType="BlankNode",this.value=t}equals(t){return!!t&&"BlankNode"===t.termType&&t.value===this.value}}}),v("3wL3n",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.DataFactory=void 0;var r=y("dUwlf"),n=y("0UUif"),i=y("8RsDA"),a=y("7KJsK"),o=y("1k2AX"),s=y("kNA9K");let l=0;t.exports.DataFactory=class{constructor(t){this.blankNodeCounter=0,t=t||{},this.blankNodePrefix=t.blankNodePrefix||`df_${l++}_`}namedNode(t){return new a.NamedNode(t)}blankNode(t){return new r.BlankNode(t||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(t,e){return new i.Literal(t,e)}variable(t){return new s.Variable(t)}defaultGraph(){return n.DefaultGraph.INSTANCE}quad(t,e,r,n){return new o.Quad(t,e,r,n||this.defaultGraph())}fromTerm(t){switch(t.termType){case"NamedNode":return this.namedNode(t.value);case"BlankNode":return this.blankNode(t.value);case"Literal":if(t.language)return this.literal(t.value,t.language);if(!t.datatype.equals(i.Literal.XSD_STRING))return this.literal(t.value,this.fromTerm(t.datatype));return this.literal(t.value);case"Variable":return this.variable(t.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(t.subject),this.fromTerm(t.predicate),this.fromTerm(t.object),this.fromTerm(t.graph))}}fromQuad(t){return this.fromTerm(t)}resetBlankNodeCounter(){this.blankNodeCounter=0}}}),v("0UUif",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.DefaultGraph=void 0;class r{constructor(){this.termType="DefaultGraph",this.value=""}equals(t){return!!t&&"DefaultGraph"===t.termType}}t.exports.DefaultGraph=r,r.INSTANCE=new r}),v("8RsDA",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.Literal=void 0;var r=y("7KJsK");class n{constructor(t,e){this.termType="Literal",this.value=t,"string"==typeof e?(this.language=e,this.datatype=n.RDF_LANGUAGE_STRING):e?(this.language="",this.datatype=e):(this.language="",this.datatype=n.XSD_STRING)}equals(t){return!!t&&"Literal"===t.termType&&t.value===this.value&&t.language===this.language&&this.datatype.equals(t.datatype)}}t.exports.Literal=n,n.RDF_LANGUAGE_STRING=new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),n.XSD_STRING=new r.NamedNode("http://www.w3.org/2001/XMLSchema#string")}),v("7KJsK",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.NamedNode=void 0,t.exports.NamedNode=class{constructor(t){this.termType="NamedNode",this.value=t}equals(t){return!!t&&"NamedNode"===t.termType&&t.value===this.value}}}),v("1k2AX",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.Quad=void 0,t.exports.Quad=class{constructor(t,e,r,n){this.termType="Quad",this.value="",this.subject=t,this.predicate=e,this.object=r,this.graph=n}equals(t){return!!t&&("Quad"===t.termType||!t.termType)&&this.subject.equals(t.subject)&&this.predicate.equals(t.predicate)&&this.object.equals(t.object)&&this.graph.equals(t.graph)}}}),v("kNA9K",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.Variable=void 0,t.exports.Variable=class{constructor(t){this.termType="Variable",this.value=t}equals(t){return!!t&&"Variable"===t.termType&&t.value===this.value}}}),v("cJYov",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerContainer=void 0;var r=y("2u4NY"),n=y("gFhgn"),i=y("9C876"),a=y("5YxCu"),o=y("XwuNW");class s{static isSimpleGraphContainer(t){return"@graph"in t&&("@set"in t&&2===Object.keys(t).length||1===Object.keys(t).length)}static isComplexGraphContainer(t){return"@graph"in t&&("@set"in t&&Object.keys(t).length>2||!("@set"in t)&&Object.keys(t).length>1)}static getContainerGraphIndex(t,e,r){let n=s.isSimpleGraphContainer(t),i="";for(let t=e;t<r.length;t++)n&&"number"!=typeof r[t]||(i+=":"+r[t]),n||"number"==typeof r[t]||(n=!0);return i}static async getContainerHandler(t,e,r){let n={containers:{"@set":!0},depth:r,fallback:!0},i=!1,a=await t.getContext(e,2);for(let t=r-1;t>=0;t--)if("number"!=typeof e[t]){let r=o.Util.getContextValue(a,"@container",e[t],!1);if(r&&s.isSimpleGraphContainer(r))return{containers:r,depth:t+1,fallback:!1};let l=o.Util.getContextValue(a,"@container",e[t-1],!1);if(l){let e="@graph"in l;for(let r in s.CONTAINER_HANDLERS)if(l[r]){if(e){if(s.CONTAINER_HANDLERS[r].canCombineWithGraph())return{containers:l,depth:t,fallback:!1};break}if(!i)return{containers:l,depth:t,fallback:!1};break}break}if(i)return n;i=!0}return n}static async isBufferableContainerHandler(t,e,r){let n=await s.getContainerHandler(t,e,r);return!n.fallback&&!("@graph"in n.containers)}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,n,i){return!!await this.test(t,e,null,r,n)}async test(t,e,r,n,i){let a=o.Util.getContextValueContainer(await t.getContext(n,2),n[i-1]);for(let t in s.CONTAINER_HANDLERS)if(a[t])return{containers:a,handler:s.CONTAINER_HANDLERS[t]};return null}async handle(t,e,r,n,i,a,o){return o.handler.handle(o.containers,t,e,n,i,a)}}s.CONTAINER_HANDLERS={"@id":new r.ContainerHandlerIdentifier,"@index":new n.ContainerHandlerIndex,"@language":new i.ContainerHandlerLanguage,"@type":new a.ContainerHandlerType},t.exports.EntryHandlerContainer=s}),v("2u4NY",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.ContainerHandlerIdentifier=void 0,t.exports.ContainerHandlerIdentifier=class{canCombineWithGraph(){return!0}async handle(t,e,r,n,i,a){let o;if(e.emittedStack[a+1]&&e.idStack[a+1])o=e.idStack[a+1][0];else{let t=null!==await r.getContainerKey(n[a],n,a)?await r.resourceToTerm(await e.getContext(n),n[a]):r.dataFactory.blankNode();if(!t){e.emittedStack[a]=!1;return}o=t,e.idStack[a+1]=[o]}let s=e.idStack[a];s||(s=e.idStack[a]=[]),s.some(t=>t.equals(o))||s.push(o),await e.handlePendingContainerFlushBuffers()||(e.emittedStack[a]=!1)}}}),v("gFhgn",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.ContainerHandlerIndex=void 0;var r=y("d7uy5"),n=y("69IJk"),i=y("XwuNW");t.exports.ContainerHandlerIndex=class{canCombineWithGraph(){return!0}async handle(t,e,a,o,s,l){if(!Array.isArray(s)){let u="@graph"in t,h=await e.getContext(o),d=o[l-1],c=i.Util.getContextValueIndex(h,d);if(c){if(r.Util.isPotentialKeyword(c))throw new r.ErrorCoded(`Keywords can not be used as @index value, got: ${c}`,r.ERROR_CODES.INVALID_TERM_DEFINITION);if("string"!=typeof c)throw new r.ErrorCoded(`@index values must be strings, got: ${c}`,r.ERROR_CODES.INVALID_TERM_DEFINITION);if("object"!=typeof s){if("@id"!==i.Util.getContextValueType(h,d))throw new r.ErrorCoded(`Property-based index containers require nodes as values or strings with @type: @id, but got: ${s}`,r.ERROR_CODES.INVALID_VALUE_OBJECT);let t=a.resourceToTerm(h,s);t&&(e.idStack[l+1]=[t])}let t=a.createVocabOrBaseTerm(h,c);if(t){let r=await a.valueToTerm(h,c,await a.getContainerKey(o[l],o,l),l,o);if(u){let n=await a.getGraphContainerValue(o,l+1);for(let i of r)e.emitQuad(l,a.dataFactory.quad(n,t,i,a.getDefaultGraph()))}else for(let i of r)await n.EntryHandlerPredicate.handlePredicateObject(e,a,o,l+1,t,i,!1,!1,!1)}}let f=u?2:1;await e.newOnValueJob(o.slice(0,o.length-f),s,l-f,!0),await e.handlePendingContainerFlushBuffers()}e.emittedStack[l]=!1}}}),v("69IJk",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerPredicate=void 0;var r=y("d7uy5"),n=y("XwuNW");class i{static async handlePredicateObject(t,e,n,i,a,o,s,l,u){let h=await e.getPropertiesDepth(n,i),d=await e.getDepthOffsetGraph(i,n),c=i-d,f=t.idStack[h];if(f&&!u)for(let r of f)if(d>=0){let n=t.idStack[c-1];if(n)for(let t of n)e.emitQuadChecked(i,r,a,o,t,s,l);else s?(e.validateReverseSubject(o),t.getUnidentifiedGraphBufferSafe(c-1).push({subject:o,predicate:a,object:r,isEmbedded:l})):t.getUnidentifiedGraphBufferSafe(c-1).push({subject:r,predicate:a,object:o,isEmbedded:l})}else{let t=await e.getGraphContainerValue(n,h);e.emitQuadChecked(i,r,a,o,t,s,l)}else if(s&&e.validateReverseSubject(o),u){if(t.rdfstar){t.idStack[i]&&t.emitError(new r.ErrorCoded(`Found an illegal @id inside an annotation: ${t.idStack[i][0].value}`,r.ERROR_CODES.INVALID_ANNOTATION));for(let a=0;a<i;a++)await e.unaliasKeyword(n[a],n,a)==="@id"&&t.emitError(new r.ErrorCoded("Found an illegal annotation inside an embedded node",r.ERROR_CODES.INVALID_ANNOTATION));let l=t.getAnnotationsBufferSafe(h),u={predicate:a,object:o,reverse:s,nestedAnnotations:[],depth:h};l.push(u);for(let t=l.length-2;t>=0;t--){let e=l[t];e.depth>h&&(u.nestedAnnotations.push(e),l.splice(t,1))}}}else t.getUnidentifiedValueBufferSafe(h).push({predicate:a,object:o,reverse:s,isEmbedded:l})}isPropertyHandler(){return!0}isStackProcessor(){return!0}async validate(t,e,r,i,a){let o=r[i];if(o){let a=await t.getContext(r);if(!t.jsonLiteralStack[i]&&await e.predicateToTerm(a,r[i]))return"@json"===n.Util.getContextValueType(a,o)&&(t.jsonLiteralStack[i+1]=!0),!0}return!1}async test(t,e,r,n,i){return n[i]}async handle(t,e,a,o,s,l,u){let h=o[l],d=await t.getContext(o),c=await e.predicateToTerm(d,a);if(c){let u=await e.valueToTerm(d,a,s,l,o);if(u.length)for(let f of u){let u=await e.unaliasKeywordParent(o,l),p=n.Util.isPropertyReverse(d,h,u),g=0;for(;"@reverse"===u||"number"==typeof u;)"number"==typeof u?g++:l--,u=await e.unaliasKeywordParent(o,l-g);let y=n.Util.isPropertyInEmbeddedNode(u);e.validateReverseInEmbeddedNode(a,p,y);let v=n.Util.isPropertyInAnnotationObject(u);if(s){let i="@list"in n.Util.getContextValueContainer(d,a);if(i||s["@list"]){if((i&&!Array.isArray(s)&&!s["@list"]||s["@list"]&&!Array.isArray(s["@list"]))&&f!==e.rdfNil){let r=e.dataFactory.blankNode();t.emitQuad(l,e.dataFactory.quad(r,e.rdfRest,e.rdfNil,e.getDefaultGraph())),t.emitQuad(l,e.dataFactory.quad(r,e.rdfFirst,f,e.getDefaultGraph())),f=r}if(p&&!t.allowSubjectList)throw new r.ErrorCoded(`Found illegal list value in subject position at ${a}`,r.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}}await i.handlePredicateObject(t,e,o,l,c,f,p,y,v)}}}}t.exports.EntryHandlerPredicate=i}),v("9C876",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.ContainerHandlerLanguage=void 0;var r=y("d7uy5");t.exports.ContainerHandlerLanguage=class{canCombineWithGraph(){return!1}async handle(t,e,n,i,a,o){let s=await n.getContainerKey(i[o],i,o);if(Array.isArray(a))a=a.map(t=>({"@value":t,"@language":s}));else{if("string"!=typeof a)throw new r.ErrorCoded(`Got invalid language map value, got '${JSON.stringify(a)}', but expected string`,r.ERROR_CODES.INVALID_LANGUAGE_MAP_VALUE);a={"@value":a,"@language":s}}await e.newOnValueJob(i.slice(0,i.length-1),a,o-1,!0),e.emittedStack[o]=!1}}}),v("5YxCu",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.ContainerHandlerType=void 0;var r=y("69IJk"),n=y("XwuNW");t.exports.ContainerHandlerType=class{canCombineWithGraph(){return!1}async handle(t,e,i,a,o,s){if(!Array.isArray(o)){if("string"==typeof o){let t=await e.getContext(a),r="@vocab"===n.Util.getContextValueType(t,a[s-1])?await i.createVocabOrBaseTerm(t,o):await i.resourceToTerm(t,o);if(r){let t={"@id":"NamedNode"===r.termType?r.value:o};await e.newOnValueJob(a.slice(0,a.length-1),t,s-1,!0),e.idStack[s+1]=[r]}}else{let t=!!e.idStack[s+1];t||delete e.idStack[s],await e.newOnValueJob(a.slice(0,a.length-1),o,s-1,!0),t||(e.idStack[s+1]=e.idStack[s])}let t=await i.getContainerKey(a[s],a,s),l=null!==t?i.createVocabOrBaseTerm(await e.getContext(a),t):null;l&&await r.EntryHandlerPredicate.handlePredicateObject(e,i,a,s+1,i.rdfType,l,!1,!1,!1),await e.handlePendingContainerFlushBuffers()}e.emittedStack[s]=!1}}}),v("kRKFi",function(t,e){t.exports=function t(e){return null===e||"object"!=typeof e||null!=e.toJSON?JSON.stringify(e):Array.isArray(e)?"["+e.reduce((e,r,n)=>e+(0===n?"":",")+t(void 0===r||"symbol"==typeof r?null:r),"")+"]":"{"+Object.keys(e).sort().reduce((r,n,i)=>{if(void 0===e[n]||"symbol"==typeof e[n])return r;let a=0===r.length?"":",";return r+a+t(n)+":"+t(e[n])},"")+"}"}}),v("lh2ub",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerInvalidFallback=void 0,t.exports.EntryHandlerInvalidFallback=class{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,n,i){return!1}async test(t,e,r,n,i){return!0}async handle(t,e,r,n,i,a){t.emittedStack[a]=!1}}}),v("hwjjJ",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerKeywordContext=void 0;var r=y("d7uy5"),n=y("fmswm");class i extends n.EntryHandlerKeyword{constructor(){super("@context")}isStackProcessor(){return!1}async handle(t,e,n,i,a,o){t.streamingProfile&&(t.processingStack[o]||t.processingType[o]||void 0!==t.idStack[o])&&t.emitError(new r.ErrorCoded("Found an out-of-order context, while streaming is enabled.(disable `streamingProfile`)",r.ERROR_CODES.INVALID_STREAMING_KEY_ORDER));let s=t.getContext(i),l=t.parseContext(a,(await s).getContextRaw());t.contextTree.setContext(i.slice(0,-1),l),t.emitContext(a),await t.validateContext(await l)}}t.exports.EntryHandlerKeywordContext=i}),v("fmswm",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerKeyword=void 0,t.exports.EntryHandlerKeyword=class{constructor(t){this.keyword=t}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,n,i){return!1}async test(t,e,r,n,i){return r===this.keyword}}}),v("8wgxD",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerKeywordGraph=void 0;var r=y("fmswm");class n extends r.EntryHandlerKeyword{constructor(){super("@graph")}async handle(t,e,r,n,i,a){t.graphStack[a+1]=!0}}t.exports.EntryHandlerKeywordGraph=n}),v("431Sm",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerKeywordId=void 0;var r=y("d7uy5"),n=y("fmswm");class i extends n.EntryHandlerKeyword{constructor(){super("@id")}isStackProcessor(){return!1}async handle(t,e,n,i,a,o){if("string"!=typeof a){if(t.rdfstar&&"object"==typeof a){let e=Object.keys(a);1===e.length&&"@id"===e[0]&&t.emitError(new r.ErrorCoded(`Invalid embedded node without property with @id ${a["@id"]}`,r.ERROR_CODES.INVALID_EMBEDDED_NODE))}else t.emitError(new r.ErrorCoded(`Found illegal @id '${a}'`,r.ERROR_CODES.INVALID_ID_VALUE));return}let s=await e.getPropertiesDepth(i,o);if(void 0!==t.idStack[s]&&(t.idStack[s][0].listHead?t.emitError(new r.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${i[o-1]}'`,r.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT)):t.emitError(new r.ErrorCoded(`Found duplicate @ids '${t.idStack[s][0].value}' and '${a}'`,r.ERROR_CODES.COLLIDING_KEYWORDS))),t.rdfstar&&t.annotationsBuffer[o])for(let e of t.annotationsBuffer[o])e.depth===o&&t.emitError(new r.ErrorCoded(`Found an illegal @id inside an annotation: ${a}`,r.ERROR_CODES.INVALID_ANNOTATION));t.idStack[s]=e.nullableTermToArray(await e.resourceToTerm(await t.getContext(i),a))}}t.exports.EntryHandlerKeywordId=i}),v("9KRGP",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerKeywordIncluded=void 0;var r=y("d7uy5"),n=y("fmswm");class i extends n.EntryHandlerKeyword{constructor(){super("@included")}async handle(t,e,n,i,a,o){"object"!=typeof a&&t.emitError(new r.ErrorCoded(`Found illegal @included '${a}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE));let s=await e.unaliasKeywords(a,i,o,await t.getContext(i));"@value"in s&&t.emitError(new r.ErrorCoded(`Found an illegal @included @value node '${JSON.stringify(a)}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE)),"@list"in s&&t.emitError(new r.ErrorCoded(`Found an illegal @included @list node '${JSON.stringify(a)}'`,r.ERROR_CODES.INVALID_INCLUDED_VALUE)),t.emittedStack[o]=!1}}t.exports.EntryHandlerKeywordIncluded=i}),v("Tf3ev",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerKeywordNest=void 0;var r=y("d7uy5"),n=y("fmswm");class i extends n.EntryHandlerKeyword{constructor(){super("@nest")}async handle(t,e,n,i,a,o){"object"!=typeof a&&t.emitError(new r.ErrorCoded(`Found invalid @nest entry for '${n}': '${a}'`,r.ERROR_CODES.INVALID_NEST_VALUE)),"@value"in await e.unaliasKeywords(a,i,o,await t.getContext(i))&&t.emitError(new r.ErrorCoded(`Found an invalid @value node for '${n}'`,r.ERROR_CODES.INVALID_NEST_VALUE)),t.emittedStack[o]=!1}}t.exports.EntryHandlerKeywordNest=i}),v("e5zTQ",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerKeywordType=void 0;var r=y("d7uy5"),n=y("XwuNW"),i=y("69IJk"),a=y("fmswm");class o extends a.EntryHandlerKeyword{constructor(){super("@type")}isStackProcessor(){return!1}async handle(t,e,a,o,s,l){let u=o[l],h=await t.getContext(o),d=e.rdfType,c=await e.unaliasKeywordParent(o,l),f=n.Util.isPropertyReverse(h,u,c),p=n.Util.isPropertyInEmbeddedNode(c);e.validateReverseInEmbeddedNode(a,f,p);let g=n.Util.isPropertyInAnnotationObject(c),y=Array.isArray(s)?s:[s];for(let n of y){"string"!=typeof n&&t.emitError(new r.ErrorCoded(`Found illegal @type '${n}'`,r.ERROR_CODES.INVALID_TYPE_VALUE));let a=e.createVocabOrBaseTerm(h,n);a&&await i.EntryHandlerPredicate.handlePredicateObject(t,e,o,l,d,a,f,p,g)}let v=Promise.resolve(h),m=!1;for(let e of y.sort()){let r=n.Util.getContextValue(h,"@context",e,null);r&&(m=!0,v=v.then(e=>t.parseContext(r,e.getContextRaw())))}t.streamingProfile&&(m||!t.streamingProfileAllowOutOfOrderPlainType)&&(t.processingStack[l]||t.idStack[l])&&t.emitError(new r.ErrorCoded("Found an out-of-order type-scoped context, while streaming is enabled.(disable `streamingProfile`)",r.ERROR_CODES.INVALID_STREAMING_KEY_ORDER)),m&&(v=v.then(t=>!0!==t.getContextRaw()["@propagate"]?new r.JsonLdContextNormalized(Object.assign(Object.assign({},t.getContextRaw()),{"@propagate":!1,"@__propagateFallback":h.getContextRaw()})):t),t.contextTree.setContext(o.slice(0,o.length-1),v)),t.processingType[l]=!0}}t.exports.EntryHandlerKeywordType=o}),v("gsWsI",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerKeywordUnknownFallback=void 0;var r=y("d7uy5");class n{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,n,i,a){let o=await e.unaliasKeyword(n[i],n,i);return!!r.Util.isPotentialKeyword(o)&&(!!a||"@list"!==o)}async test(t,e,n,i,a){return r.Util.isPotentialKeyword(n)}async handle(t,e,i,a,o,s){let l=n.VALID_KEYWORDS_TYPES[i];void 0!==l?l&&typeof o!==l.type&&t.emitError(new r.ErrorCoded(`Invalid value type for '${i}' with value '${o}'`,l.errorCode)):t.strictValues&&t.emitError(Error(`Unknown keyword '${i}' with value '${o}'`)),t.emittedStack[s]=!1}}n.VALID_KEYWORDS_TYPES={"@index":{type:"string",errorCode:r.ERROR_CODES.INVALID_INDEX_VALUE},"@list":null,"@reverse":{type:"object",errorCode:r.ERROR_CODES.INVALID_REVERSE_VALUE},"@set":null,"@value":null},t.exports.EntryHandlerKeywordUnknownFallback=n}),v("kFmh5",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerKeywordValue=void 0;var r=y("fmswm");class n extends r.EntryHandlerKeyword{constructor(){super("@value")}async validate(t,e,r,n,i){let a=r[n];return a&&!t.literalStack[n]&&await this.test(t,e,a,r,n)&&(t.literalStack[n]=!0),super.validate(t,e,r,n,i)}async test(t,e,r,n,i){return await e.unaliasKeyword(n[i],n.slice(0,n.length-1),i-1,!0)==="@value"}async handle(t,e,r,n,i,a){t.literalStack[a]=!0,delete t.unidentifiedValuesBuffer[a],delete t.unidentifiedGraphsBuffer[a],t.emittedStack[a]=!1}}t.exports.EntryHandlerKeywordValue=n}),v("k88Xq",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.ParsingContext=void 0;var r=y("d7uy5"),n=y("60GtF"),i=y("16oN2"),a=y("3llXF");class o{constructor(t){this.contextParser=new r.ContextParser({documentLoader:t.documentLoader,skipValidation:t.skipContextValidation}),this.streamingProfile=!!t.streamingProfile,this.baseIRI=t.baseIRI,this.produceGeneralizedRdf=!!t.produceGeneralizedRdf,this.allowSubjectList=!!t.allowSubjectList,this.processingMode=t.processingMode||a.JsonLdParser.DEFAULT_PROCESSING_MODE,this.strictValues=!!t.strictValues,this.validateValueIndexes=!!t.validateValueIndexes,this.defaultGraph=t.defaultGraph,this.rdfDirection=t.rdfDirection,this.normalizeLanguageTags=t.normalizeLanguageTags,this.streamingProfileAllowOutOfOrderPlainType=t.streamingProfileAllowOutOfOrderPlainType,this.rdfstar=!1!==t.rdfstar,this.rdfstarReverseInEmbedded=t.rdfstarReverseInEmbedded,this.topLevelProperties=!1,this.activeProcessingMode=parseFloat(this.processingMode),this.processingStack=[],this.processingType=[],this.emittedStack=[],this.idStack=[],this.graphStack=[],this.graphContainerTermStack=[],this.listPointerStack=[],this.contextTree=new i.ContextTree,this.literalStack=[],this.validationStack=[],this.unaliasedKeywordCacheStack=[],this.jsonLiteralStack=[],this.unidentifiedValuesBuffer=[],this.unidentifiedGraphsBuffer=[],this.annotationsBuffer=[],this.pendingContainerFlushBuffers=[],this.parser=t.parser,t.context?(this.rootContext=this.parseContext(t.context),this.rootContext.then(t=>this.validateContext(t))):this.rootContext=Promise.resolve(new r.JsonLdContextNormalized(this.baseIRI?{"@base":this.baseIRI,"@__baseDocument":!0}:{}))}async parseContext(t,e,r){return this.contextParser.parse(t,{baseIRI:this.baseIRI,ignoreProtection:r,normalizeLanguageTags:this.normalizeLanguageTags,parentContext:e,processingMode:this.activeProcessingMode})}validateContext(t){let e=t.getContextRaw()["@version"];if(e){if(this.activeProcessingMode&&e>this.activeProcessingMode)throw new n.ErrorCoded(`Unsupported JSON-LD version '${e}' under active processing mode ${this.activeProcessingMode}.`,n.ERROR_CODES.PROCESSING_MODE_CONFLICT);if(this.activeProcessingMode&&e<this.activeProcessingMode)throw new n.ErrorCoded(`Invalid JSON-LD version ${e} under active processing mode ${this.activeProcessingMode}.`,n.ERROR_CODES.INVALID_VERSION_VALUE);this.activeProcessingMode=e}}async getContext(t,e=1){let n=t;for(;"number"==typeof t[t.length-1];)t=t.slice(0,t.length-1);e&&(t=t.slice(0,-e));let i=await this.getContextPropagationAware(t),a=i.context.getContextRaw();for(let t=i.depth;t<n.length-e;t++){let i=n[t],o=a[i];if(o&&"object"==typeof o&&"@context"in o){let s=(await this.parseContext(o,a,!0)).getContextRaw(),l=!(i in s)||s[i]["@context"]["@propagate"];(!1!==l||t===n.length-1-e)&&(a=Object.assign({},s),delete a["@propagate"],a[i]=Object.assign({},a[i]),"@id"in o&&(a[i]["@id"]=o["@id"]),delete a[i]["@context"],!1!==l&&this.contextTree.setContext(n.slice(0,t+e),Promise.resolve(new r.JsonLdContextNormalized(a))))}}return new r.JsonLdContextNormalized(a)}async getContextPropagationAware(t){let e;let n=t.length,i=null;do{e=!1,i&&"@__propagateFallback"in i.context.getContextRaw()?i.context=new r.JsonLdContextNormalized(i.context.getContextRaw()["@__propagateFallback"]):(i&&(t=t.slice(0,i.depth-1)),i=await this.contextTree.getContext(t)||{context:await this.rootContext,depth:0});let n=t[t.length-1];if(n in i.context.getContextRaw()){let t=i.context.getContextRaw()[n];t&&"object"==typeof t&&"@context"in t&&(e=!0)}}while(i.depth>0&&!1===i.context.getContextRaw()["@propagate"]&&i.depth!==n&&!e)return 0===i.depth&&!1===i.context.getContextRaw()["@propagate"]&&i.depth!==n&&(i.context=new r.JsonLdContextNormalized({})),i}async newOnValueJob(t,e,r,n){await this.parser.newOnValueJob(t,e,r,n)}async handlePendingContainerFlushBuffers(){if(!(this.pendingContainerFlushBuffers.length>0))return!1;for(let t of this.pendingContainerFlushBuffers)await this.parser.flushBuffer(t.depth,t.keys),this.parser.flushStacks(t.depth);return this.pendingContainerFlushBuffers.splice(0,this.pendingContainerFlushBuffers.length),!0}emitQuad(t,e){1===t&&(this.topLevelProperties=!0),this.parser.push(e)}emitError(t){this.parser.emit("error",t)}emitContext(t){this.parser.emit("context",t)}getUnidentifiedValueBufferSafe(t){let e=this.unidentifiedValuesBuffer[t];return e||(e=[],this.unidentifiedValuesBuffer[t]=e),e}getUnidentifiedGraphBufferSafe(t){let e=this.unidentifiedGraphsBuffer[t];return e||(e=[],this.unidentifiedGraphsBuffer[t]=e),e}getAnnotationsBufferSafe(t){let e=this.annotationsBuffer[t];return e||(e=[],this.annotationsBuffer[t]=e),e}getExpandOptions(){return o.EXPAND_OPTIONS[this.activeProcessingMode]}shiftStack(t,e){let r=this.idStack[t+e];if(r&&(this.idStack[t]=r,this.emittedStack[t]=!0,delete this.idStack[t+e]),this.pendingContainerFlushBuffers.length)for(let r of this.pendingContainerFlushBuffers)r.depth>=t+e&&(r.depth-=e,r.keys.splice(t,e));this.unidentifiedValuesBuffer[t+e]&&(this.unidentifiedValuesBuffer[t]=this.unidentifiedValuesBuffer[t+e],delete this.unidentifiedValuesBuffer[t+e]),this.annotationsBuffer[t+e-1]&&(this.annotationsBuffer[t-1]||(this.annotationsBuffer[t-1]=[]),this.annotationsBuffer[t-1]=[...this.annotationsBuffer[t-1],...this.annotationsBuffer[t+e-1]],delete this.annotationsBuffer[t+e-1])}}o.EXPAND_OPTIONS={1:{allowPrefixForcing:!1,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!1},1.1:{allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}},t.exports.ParsingContext=o}),v("16oN2",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.ContextTree=void 0;class r{constructor(){this.subTrees={}}getContext(t){if(t.length>0){let[e,...r]=t,n=this.subTrees[e];if(n){let t=n.getContext(r);if(t)return t.then(({context:t,depth:e})=>({context:t,depth:e+1}))}}return this.context?this.context.then(t=>({context:t,depth:0})):null}setContext(t,e){if(0===t.length)this.context=e;else{let[n,...i]=t,a=this.subTrees[n];a||(a=this.subTrees[n]=new r),a.setContext(i,e)}}removeContext(t){this.setContext(t,null)}}t.exports.ContextTree=r}),v("9YC4i",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.EntryHandlerKeywordAnnotation=void 0;var r=y("fmswm"),n=y("d7uy5");class i extends r.EntryHandlerKeyword{constructor(){super("@annotation")}async handle(t,e,r,i,a,o){("string"==typeof a||"object"==typeof a&&a["@value"])&&t.emitError(new n.ErrorCoded(`Found illegal annotation value: ${JSON.stringify(a)}`,n.ERROR_CODES.INVALID_ANNOTATION))}}t.exports.EntryHandlerKeywordAnnotation=i}),v("h0LIu",function(t,e){t.exports=y("7fpTx")}),v("7fpTx",function(t,e){let r;n(t.exports,"NQuads",()=>i,t=>i=t),n(t.exports,"IdentifierIssuer",()=>a,t=>a=t),n(t.exports,"_rdfCanonizeNative",()=>o,t=>o=t),n(t.exports,"canonize",()=>s,t=>s=t),n(t.exports,"_canonizeSync",()=>l,t=>l=t);var i,a,o,s,l,u=y("dVoAc"),h=y("iA9G8"),d=y("5mJZl"),c=y("1phhp");try{r=y("kjyEk")}catch(t){}function f(t){return Array.isArray(t)?t:i.legacyDatasetToQuads(t)}i=y("73eeT"),a=y("dvul9"),o=function(t){return t&&(r=t),r},s=async function(t,e){let n=f(t,e);if(e.useNative){if(!r)throw Error("rdf-canonize-native not available");if(e.createMessageDigest)throw Error('"createMessageDigest" cannot be used with "useNative".');return new Promise((t,i)=>r.canonize(n,e,(e,r)=>e?i(e):t(r)))}if("URDNA2015"===e.algorithm)return new u(e).main(n);if("URGNA2012"===e.algorithm){if(e.createMessageDigest)throw Error('"createMessageDigest" cannot be used with "URGNA2012".');return new h(e).main(n)}if(!("algorithm"in e))throw Error("No RDF Dataset Canonicalization algorithm specified.");throw Error("Invalid RDF Dataset Canonicalization algorithm: "+e.algorithm)},l=function(t,e){let n=f(t,e);if(e.useNative){if(!r)throw Error("rdf-canonize-native not available");if(e.createMessageDigest)throw Error('"createMessageDigest" cannot be used with "useNative".');return r.canonizeSync(n,e)}if("URDNA2015"===e.algorithm)return new d(e).main(n);if("URGNA2012"===e.algorithm){if(e.createMessageDigest)throw Error('"createMessageDigest" cannot be used with "URGNA2012".');return new c(e).main(n)}if(!("algorithm"in e))throw Error("No RDF Dataset Canonicalization algorithm specified.");throw Error("Invalid RDF Dataset Canonicalization algorithm: "+e.algorithm)}}),v("dVoAc",function(t,e){var r=y("dvul9"),n=y("jnHNj"),i=y("9NKOE"),a=y("73eeT");function o(t,e){return t.hash<e.hash?-1:t.hash>e.hash?1:0}t.exports=class{constructor({createMessageDigest:t=()=>new n("sha256"),canonicalIdMap:e=new Map,maxDeepIterations:i=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new r("_:c14n",e),this.createMessageDigest=t,this.maxDeepIterations=i,this.quads=null,this.deepIterations=null}async main(t){for(let e of(this.deepIterations=new Map,this.quads=t,t))this._addBlankNodeQuadInfo({quad:e,component:e.subject}),this._addBlankNodeQuadInfo({quad:e,component:e.object}),this._addBlankNodeQuadInfo({quad:e,component:e.graph});let e=new Map,n=[...this.blankNodeInfo.keys()],i=0;for(let t of n)++i%100==0&&await this._yield(),await this._hashAndTrackBlankNode({id:t,hashToBlankNodes:e});let s=[...e.keys()].sort(),l=[];for(let t of s){let r=e.get(t);if(r.length>1){l.push(r);continue}let n=r[0];this.canonicalIssuer.getId(n)}for(let t of l){let e=[];for(let n of t){if(this.canonicalIssuer.hasId(n))continue;let t=new r("_:b");t.getId(n);let i=await this.hashNDegreeQuads(n,t);e.push(i)}for(let t of(e.sort(o),e))for(let e of t.issuer.getOldIds())this.canonicalIssuer.getId(e)}let u=[];for(let t of this.quads){let e=a.serializeQuadComponents(this._componentWithCanonicalId(t.subject),t.predicate,this._componentWithCanonicalId(t.object),this._componentWithCanonicalId(t.graph));u.push(e)}return u.sort(),u.join("")}async hashFirstDegreeQuads(t){let e=[],r=this.blankNodeInfo.get(t);for(let n of r.quads){let r={subject:null,predicate:n.predicate,object:null,graph:null};r.subject=this.modifyFirstDegreeComponent(t,n.subject,"subject"),r.object=this.modifyFirstDegreeComponent(t,n.object,"object"),r.graph=this.modifyFirstDegreeComponent(t,n.graph,"graph"),e.push(a.serializeQuad(r))}e.sort();let n=this.createMessageDigest();for(let t of e)n.update(t);return r.hash=await n.digest(),r.hash}async hashRelatedBlankNode(t,e,r,n){let i;i=this.canonicalIssuer.hasId(t)?this.canonicalIssuer.getId(t):r.hasId(t)?r.getId(t):this.blankNodeInfo.get(t).hash;let a=this.createMessageDigest();return a.update(n),"g"!==n&&a.update(this.getRelatedPredicate(e)),a.update(i),a.digest()}async hashNDegreeQuads(t,e){let r=this.deepIterations.get(t)||0;if(r>this.maxDeepIterations)throw Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(t,r+1);let n=this.createMessageDigest(),a=await this.createHashToRelated(t,e);for(let t of[...a.keys()].sort()){let r;n.update(t);let o="",s=new i(a.get(t)),l=0;for(;s.hasNext();){let t=s.next();++l%3==0&&await this._yield();let n=e.clone(),i="",a=[],u=!1;for(let e of t)if(this.canonicalIssuer.hasId(e)?i+=this.canonicalIssuer.getId(e):(n.hasId(e)||a.push(e),i+=n.getId(e)),0!==o.length&&i>o){u=!0;break}if(!u){for(let t of a){let e=await this.hashNDegreeQuads(t,n);if(i+=n.getId(t),i+=`<${e.hash}>`,n=e.issuer,0!==o.length&&i>o){u=!0;break}}!u&&(0===o.length||i<o)&&(o=i,r=n)}}n.update(o),e=r}return{hash:await n.digest(),issuer:e}}modifyFirstDegreeComponent(t,e){return"BlankNode"!==e.termType?e:{termType:"BlankNode",value:e.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return`<${t.predicate.value}>`}async createHashToRelated(t,e){let r=new Map,n=this.blankNodeInfo.get(t).quads,i=0;for(let a of n)++i%100==0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:a,component:a.subject,position:"s",id:t,issuer:e,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:a,component:a.object,position:"o",id:t,issuer:e,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:a,component:a.graph,position:"g",id:t,issuer:e,hashToRelated:r})]);return r}async _hashAndTrackBlankNode({id:t,hashToBlankNodes:e}){let r=await this.hashFirstDegreeQuads(t),n=e.get(r);n?n.push(t):e.set(r,[t])}_addBlankNodeQuadInfo({quad:t,component:e}){if("BlankNode"!==e.termType)return;let r=e.value,n=this.blankNodeInfo.get(r);n?n.quads.add(t):this.blankNodeInfo.set(r,{quads:new Set([t]),hash:null})}async _addRelatedBlankNodeHash({quad:t,component:e,position:r,id:n,issuer:i,hashToRelated:a}){if(!("BlankNode"===e.termType&&e.value!==n))return;let o=e.value,s=await this.hashRelatedBlankNode(o,t,i,r),l=a.get(s);l?l.push(o):a.set(s,[o])}_componentWithCanonicalId(t){return"BlankNode"!==t.termType||t.value.startsWith(this.canonicalIssuer.prefix)?t:{termType:"BlankNode",value:this.canonicalIssuer.getId(t.value)}}async _yield(){return new Promise(t=>setImmediate(t))}}}),v("dvul9",function(t,e){t.exports=class t{constructor(t,e=new Map,r=0){this.prefix=t,this._existing=e,this.counter=r}clone(){let{prefix:e,_existing:r,counter:n}=this;return new t(e,new Map(r),n)}getId(t){let e=t&&this._existing.get(t);if(e)return e;let r=this.prefix+this.counter;return this.counter++,t&&this._existing.set(t,r),r}hasId(t){return this._existing.has(t)}getOldIds(){return[...this._existing.keys()]}}}),v("jnHNj",function(t,e){y("jGbML");let r=self.crypto||self.msCrypto;t.exports=class{constructor(t){if(!(r&&r.subtle))throw Error("crypto.subtle not found.");if("sha256"===t)this.algorithm={name:"SHA-256"};else if("sha1"===t)this.algorithm={name:"SHA-1"};else throw Error(`Unsupported algorithm "${t}".`);this._content=""}update(t){this._content+=t}async digest(){let t=new TextEncoder().encode(this._content),e=new Uint8Array(await r.subtle.digest(this.algorithm,t)),n="";for(let t=0;t<e.length;++t)n+=e[t].toString(16).padStart(2,"0");return n}}}),v("jGbML",function(t,e){var r=y("hPtJY");!function(t,e){if(!t.setImmediate){var n,i,a,o,s,l=1,u={},h=!1,d=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"===({}).toString.call(t.process)?s=function(t){r.nextTick(function(){p(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}()?(n="setImmediate$"+Math.random()+"$",i=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(n)&&p(+e.data.slice(n.length))},t.addEventListener?t.addEventListener("message",i,!1):t.attachEvent("onmessage",i),s=function(e){t.postMessage(n+e,"*")}):t.MessageChannel?((a=new MessageChannel).port1.onmessage=function(t){p(t.data)},s=function(t){a.port2.postMessage(t)}):d&&"onreadystatechange"in d.createElement("script")?(o=d.documentElement,s=function(t){var e=d.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):s=function(t){setTimeout(p,0,t)},c.setImmediate=function(t){"function"!=typeof t&&(t=Function(""+t));for(var e=Array(arguments.length-1),r=0;r<e.length;r++)e[r]=arguments[r+1];var n={callback:t,args:e};return u[l]=n,s(l),l++},c.clearImmediate=f}function f(t){delete u[t]}function p(t){if(h)setTimeout(p,0,t);else{var r=u[t];if(r){h=!0;try{!function(t){var r=t.callback,n=t.args;switch(n.length){case 0:r();break;case 1:r(n[0]);break;case 2:r(n[0],n[1]);break;case 3:r(n[0],n[1],n[2]);break;default:r.apply(e,n)}}(r)}finally{f(t),h=!1}}}}}("undefined"==typeof self?void 0===c?t.exports:c:self)}),v("9NKOE",function(t,e){t.exports=class{constructor(t){this.current=t.sort(),this.done=!1,this.dir=new Map;for(let e=0;e<t.length;++e)this.dir.set(t[e],!0)}hasNext(){return!this.done}next(){let{current:t,dir:e}=this,r=t.slice(),n=null,i=0,a=t.length;for(let r=0;r<a;++r){let o=t[r],s=e.get(o);(null===n||o>n)&&(s&&r>0&&o>t[r-1]||!s&&r<a-1&&o>t[r+1])&&(n=o,i=r)}if(null===n)this.done=!0;else{let r=e.get(n)?i-1:i+1;for(let a of(t[i]=t[r],t[r]=n,t))a>n&&e.set(a,!e.get(a))}return r}}}),v("73eeT",function(t,e){let r="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",n="http://www.w3.org/2001/XMLSchema#string",i="NamedNode",a="BlankNode",o="Literal",s="DefaultGraph",l={};(()=>{let t="(?:<([^:]+:[^>]*)>)",e="A-Za-z-----------_",r=e+"0-9---",n="(_:(?:["+e+"0-9])(?:(?:["+r+".])*(?:["+r+"]))?)",i="[ \\t]+",a="[ \\t]*";l.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,l.empty=RegExp("^"+a+"$"),l.quad=RegExp("^"+a+("(?:"+t+"|")+n+")"+i+(t+i)+("(?:"+t+"|"+n+'|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^'+t)+")|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))"+a+("(?:\\.|(?:(?:"+t+"|"+n)+")"+a+"\\.))"+a+"$")})(),t.exports=class t{static parse(t){let e=[],u={},d=t.split(l.eoln),c=0;for(let t of d){if(c++,l.empty.test(t))continue;let d=t.match(l.quad);if(null===d)throw Error("N-Quads parse error on line "+c+".");let f={subject:null,predicate:null,object:null,graph:null};if(void 0!==d[1]?f.subject={termType:i,value:d[1]}:f.subject={termType:a,value:d[2]},f.predicate={termType:i,value:d[3]},void 0!==d[4]?f.object={termType:i,value:d[4]}:void 0!==d[5]?f.object={termType:a,value:d[5]}:(f.object={termType:o,value:void 0,datatype:{termType:i}},void 0!==d[7]?f.object.datatype.value=d[7]:void 0!==d[8]?(f.object.datatype.value=r,f.object.language=d[8]):f.object.datatype.value=n,f.object.value=d[6].replace(h,function(t,e,r,n){if(e)switch(e){case"t":return"	";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(r)return String.fromCharCode(parseInt(r,16));if(n)throw Error("Unsupported U escape")})),void 0!==d[9]?f.graph={termType:i,value:d[9]}:void 0!==d[10]?f.graph={termType:a,value:d[10]}:f.graph={termType:s,value:""},f.graph.value in u){let t=!0,r=u[f.graph.value];for(let e of r)if(e.subject.termType===f.subject.termType&&e.object.termType===f.object.termType&&e.subject.value===f.subject.value&&e.predicate.value===f.predicate.value&&e.object.value===f.object.value&&(e.object.termType!==o||e.object.datatype.termType===f.object.datatype.termType&&e.object.language===f.object.language&&e.object.datatype.value===f.object.datatype.value)){t=!1;break}t&&(r.push(f),e.push(f))}else u[f.graph.value]=[f],e.push(f)}return e}static serialize(e){Array.isArray(e)||(e=t.legacyDatasetToQuads(e));let r=[];for(let n of e)r.push(t.serializeQuad(n));return r.sort().join("")}static serializeQuadComponents(t,e,o,s){let l="";return t.termType===i?l+=`<${t.value}>`:l+=`${t.value}`,l+=` <${e.value}> `,o.termType===i?l+=`<${o.value}>`:o.termType===a?l+=o.value:(l+=`"${o.value.replace(u,function(t){switch(t){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,o.datatype.value===r?o.language&&(l+=`@${o.language}`):o.datatype.value!==n&&(l+=`^^<${o.datatype.value}>`)),s.termType===i?l+=` <${s.value}>`:s.termType===a&&(l+=` ${s.value}`),l+=" .\n"}static serializeQuad(e){return t.serializeQuadComponents(e.subject,e.predicate,e.object,e.graph)}static legacyDatasetToQuads(t){let e=[],l={"blank node":a,IRI:i,literal:o};for(let u in t)t[u].forEach(t=>{let h={};for(let e in t){let a=t[e],s={termType:l[a.type],value:a.value};s.termType!==o||(s.datatype={termType:i},"datatype"in a&&(s.datatype.value=a.datatype),"language"in a?("datatype"in a||(s.datatype.value=r),s.language=a.language):"datatype"in a||(s.datatype.value=n)),h[e]=s}"@default"===u?h.graph={termType:s,value:""}:h.graph={termType:u.startsWith("_:")?a:i,value:u},e.push(h)});return e}};let u=/["\\\n\r]/g,h=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g}),v("iA9G8",function(t,e){var r=y("jnHNj"),n=y("dVoAc");t.exports=class extends n{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new r("sha1")}modifyFirstDegreeComponent(t,e,r){return"BlankNode"!==e.termType?e:"graph"===r?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:e.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return t.predicate.value}async createHashToRelated(t,e){let r=new Map,n=this.blankNodeInfo.get(t).quads,i=0;for(let a of n){let n,o;if("BlankNode"===a.subject.termType&&a.subject.value!==t)o=a.subject.value,n="p";else{if("BlankNode"!==a.object.termType||a.object.value===t)continue;o=a.object.value,n="r"}++i%100==0&&await this._yield();let s=await this.hashRelatedBlankNode(o,a,e,n),l=r.get(s);l?l.push(o):r.set(s,[o])}return r}}}),v("5mJZl",function(t,e){var r=y("dvul9"),n=y("jnHNj"),i=y("9NKOE"),a=y("73eeT");function o(t,e){return t.hash<e.hash?-1:t.hash>e.hash?1:0}t.exports=class{constructor({createMessageDigest:t=()=>new n("sha256"),canonicalIdMap:e=new Map,maxDeepIterations:i=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new r("_:c14n",e),this.createMessageDigest=t,this.maxDeepIterations=i,this.quads=null,this.deepIterations=null}main(t){for(let e of(this.deepIterations=new Map,this.quads=t,t))this._addBlankNodeQuadInfo({quad:e,component:e.subject}),this._addBlankNodeQuadInfo({quad:e,component:e.object}),this._addBlankNodeQuadInfo({quad:e,component:e.graph});let e=new Map;for(let t of[...this.blankNodeInfo.keys()])this._hashAndTrackBlankNode({id:t,hashToBlankNodes:e});let n=[...e.keys()].sort(),i=[];for(let t of n){let r=e.get(t);if(r.length>1){i.push(r);continue}let n=r[0];this.canonicalIssuer.getId(n)}for(let t of i){let e=[];for(let n of t){if(this.canonicalIssuer.hasId(n))continue;let t=new r("_:b");t.getId(n);let i=this.hashNDegreeQuads(n,t);e.push(i)}for(let t of(e.sort(o),e))for(let e of t.issuer.getOldIds())this.canonicalIssuer.getId(e)}let s=[];for(let t of this.quads){let e=a.serializeQuadComponents(this._componentWithCanonicalId({component:t.subject}),t.predicate,this._componentWithCanonicalId({component:t.object}),this._componentWithCanonicalId({component:t.graph}));s.push(e)}return s.sort(),s.join("")}hashFirstDegreeQuads(t){let e=[],r=this.blankNodeInfo.get(t);for(let n of r.quads){let r={subject:null,predicate:n.predicate,object:null,graph:null};r.subject=this.modifyFirstDegreeComponent(t,n.subject,"subject"),r.object=this.modifyFirstDegreeComponent(t,n.object,"object"),r.graph=this.modifyFirstDegreeComponent(t,n.graph,"graph"),e.push(a.serializeQuad(r))}e.sort();let n=this.createMessageDigest();for(let t of e)n.update(t);return r.hash=n.digest(),r.hash}hashRelatedBlankNode(t,e,r,n){let i;i=this.canonicalIssuer.hasId(t)?this.canonicalIssuer.getId(t):r.hasId(t)?r.getId(t):this.blankNodeInfo.get(t).hash;let a=this.createMessageDigest();return a.update(n),"g"!==n&&a.update(this.getRelatedPredicate(e)),a.update(i),a.digest()}hashNDegreeQuads(t,e){let r=this.deepIterations.get(t)||0;if(r>this.maxDeepIterations)throw Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(t,r+1);let n=this.createMessageDigest(),a=this.createHashToRelated(t,e);for(let t of[...a.keys()].sort()){let r;n.update(t);let o="",s=new i(a.get(t));for(;s.hasNext();){let t=s.next(),n=e.clone(),i="",a=[],l=!1;for(let e of t)if(this.canonicalIssuer.hasId(e)?i+=this.canonicalIssuer.getId(e):(n.hasId(e)||a.push(e),i+=n.getId(e)),0!==o.length&&i>o){l=!0;break}if(!l){for(let t of a){let e=this.hashNDegreeQuads(t,n);if(i+=n.getId(t),i+=`<${e.hash}>`,n=e.issuer,0!==o.length&&i>o){l=!0;break}}!l&&(0===o.length||i<o)&&(o=i,r=n)}}n.update(o),e=r}return{hash:n.digest(),issuer:e}}modifyFirstDegreeComponent(t,e){return"BlankNode"!==e.termType?e:{termType:"BlankNode",value:e.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return`<${t.predicate.value}>`}createHashToRelated(t,e){let r=new Map;for(let n of this.blankNodeInfo.get(t).quads)this._addRelatedBlankNodeHash({quad:n,component:n.subject,position:"s",id:t,issuer:e,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:n,component:n.object,position:"o",id:t,issuer:e,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:n,component:n.graph,position:"g",id:t,issuer:e,hashToRelated:r});return r}_hashAndTrackBlankNode({id:t,hashToBlankNodes:e}){let r=this.hashFirstDegreeQuads(t),n=e.get(r);n?n.push(t):e.set(r,[t])}_addBlankNodeQuadInfo({quad:t,component:e}){if("BlankNode"!==e.termType)return;let r=e.value,n=this.blankNodeInfo.get(r);n?n.quads.add(t):this.blankNodeInfo.set(r,{quads:new Set([t]),hash:null})}_addRelatedBlankNodeHash({quad:t,component:e,position:r,id:n,issuer:i,hashToRelated:a}){if(!("BlankNode"===e.termType&&e.value!==n))return;let o=e.value,s=this.hashRelatedBlankNode(o,t,i,r),l=a.get(s);l?l.push(o):a.set(s,[o])}_componentWithCanonicalId({component:t}){return"BlankNode"!==t.termType||t.value.startsWith(this.canonicalIssuer.prefix)?t:{termType:"BlankNode",value:this.canonicalIssuer.getId(t.value)}}}}),v("1phhp",function(t,e){var r=y("jnHNj"),n=y("5mJZl");t.exports=class extends n{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new r("sha1")}modifyFirstDegreeComponent(t,e,r){return"BlankNode"!==e.termType?e:"graph"===r?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:e.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return t.predicate.value}createHashToRelated(t,e){let r=new Map;for(let n of this.blankNodeInfo.get(t).quads){let i,a;if("BlankNode"===n.subject.termType&&n.subject.value!==t)a=n.subject.value,i="p";else{if("BlankNode"!==n.object.termType||n.object.value===t)continue;a=n.object.value,i="r"}let o=this.hashRelatedBlankNode(a,n,e,i),s=r.get(o);s?s.push(a):r.set(o,[a])}return r}}}),v("kjyEk",function(t,e){}),v("jUcZG",function(t,e){t.exports=class{constructor(){this._requests={}}wrapLoader(t){let e=this;return e._loader=t,function(){return e.add.apply(e,arguments)}}async add(t){let e=this._requests[t];if(e)return Promise.resolve(e);e=this._requests[t]=this._loader(t);try{return await e}finally{delete this._requests[t]}}}}),v("c0VXR",function(t,e){var r=y("guzPY");let n={};t.exports=n,n.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([a-zA-Z][a-zA-Z0-9+-.]*):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},n.parse=(t,e)=>{let r={},i=n.parsers[e||"full"],a=i.regex.exec(t),o=i.keys.length;for(;o--;)r[i.keys[o]]=void 0===a[o]?null:a[o];return("https"===r.scheme&&"443"===r.port||"http"===r.scheme&&"80"===r.port)&&(r.href=r.href.replace(":"+r.port,""),r.authority=r.authority.replace(":"+r.port,""),r.port=null),r.normalizedPath=n.removeDotSegments(r.path),r},n.prependBase=(t,e)=>{if(null===t||n.isAbsolute(e))return e;(!t||r.isString(t))&&(t=n.parse(t||""));let i=n.parse(e),a={protocol:t.protocol||""};if(null!==i.authority)a.authority=i.authority,a.path=i.path,a.query=i.query;else if(a.authority=t.authority,""===i.path)a.path=t.path,null!==i.query?a.query=i.query:a.query=t.query;else{if(0===i.path.indexOf("/"))a.path=i.path;else{let e=t.path;((e=e.substr(0,e.lastIndexOf("/")+1)).length>0||t.authority)&&"/"!==e.substr(-1)&&(e+="/"),e+=i.path,a.path=e}a.query=i.query}""!==i.path&&(a.path=n.removeDotSegments(a.path));let o=a.protocol;return null!==a.authority&&(o+="//"+a.authority),o+=a.path,null!==a.query&&(o+="?"+a.query),null!==i.fragment&&(o+="#"+i.fragment),""===o&&(o="./"),o},n.removeBase=(t,e)=>{if(null===t)return e;(!t||r.isString(t))&&(t=n.parse(t||""));let i="";if(""!==t.href?i+=(t.protocol||"")+"//"+(t.authority||""):e.indexOf("//")&&(i+="//"),0!==e.indexOf(i))return e;let a=n.parse(e.substr(i.length)),o=t.normalizedPath.split("/"),s=a.normalizedPath.split("/"),l=a.fragment||a.query?0:1;for(;o.length>0&&s.length>l&&o[0]===s[0];)o.shift(),s.shift();let u="";if(o.length>0){o.pop();for(let t=0;t<o.length;++t)u+="../"}return u+=s.join("/"),null!==a.query&&(u+="?"+a.query),null!==a.fragment&&(u+="#"+a.fragment),""===u&&(u="./"),u},n.removeDotSegments=t=>{if(0===t.length)return"";let e=t.split("/"),r=[];for(;e.length>0;){let t=e.shift(),n=0===e.length;if("."===t){n&&r.push("");continue}if(".."===t){r.pop(),n&&r.push("");continue}r.push(t)}return("/"===t[0]&&r.length>0&&""!==r[0]&&r.unshift(""),1===r.length&&""===r[0])?"/":r.join("/")};let i=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;n.isAbsolute=t=>r.isString(t)&&i.test(t),n.isRelative=t=>r.isString(t)}),v("guzPY",function(t,e){let r={};t.exports=r,r.isArray=Array.isArray,r.isBoolean=t=>"boolean"==typeof t||"[object Boolean]"===Object.prototype.toString.call(t),r.isDouble=t=>r.isNumber(t)&&(-1!==String(t).indexOf(".")||Math.abs(t)>=1e21),r.isEmptyObject=t=>r.isObject(t)&&0===Object.keys(t).length,r.isNumber=t=>"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t),r.isNumeric=t=>!isNaN(parseFloat(t))&&isFinite(t),r.isObject=t=>"[object Object]"===Object.prototype.toString.call(t),r.isString=t=>"string"==typeof t||"[object String]"===Object.prototype.toString.call(t),r.isUndefined=t=>void 0===t}),v("fcGo5",function(t,e){t.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}}),v("frGHZ",function(t,e){var r=y("85rA0"),n=y("3Yszg"),i=y("guzPY"),a=i.isArray,o=i.isObject,s=i.isString,l=i.isUndefined,u=y("c0VXR"),h=u.isAbsolute,d=u.isRelative,c=u.prependBase,f=y("8qp2g").handleEvent,r=y("85rA0"),p=r.REGEX_BCP47,g=r.REGEX_KEYWORD,v=r.asArray,m=r.compareShortestLeast;let b=new Map,x={};function E(t,e,r,n,i,a){if(null===e||!s(e)||x.isKeyword(e))return e;if(e.match(g))return null;if(n&&n.hasOwnProperty(e)&&!0!==i.get(e)&&x.createTermDefinition({activeCtx:t,localCtx:n,term:e,defined:i,options:a}),(r=r||{}).vocab){let r=t.mappings.get(e);if(null===r)return null;if(o(r)&&"@id"in r)return r["@id"]}let l=e.indexOf(":");if(l>0){let r=e.substr(0,l),o=e.substr(l+1);if("_"===r||0===o.indexOf("//"))return e;n&&n.hasOwnProperty(r)&&x.createTermDefinition({activeCtx:t,localCtx:n,term:r,defined:i,options:a});let s=t.mappings.get(r);if(s&&s._prefix)return s["@id"]+o;if(h(e))return e}if(r.vocab&&"@vocab"in t)e=t["@vocab"]+e;else if(r.base){let r,n;"@base"in t?t["@base"]?(n=c(a.base,t["@base"]),r=c(n,e)):(n=t["@base"],r=e):(n=a.base,r=c(a.base,e)),e=r}return e}t.exports=x,x.process=async({activeCtx:t,localCtx:e,options:r,propagate:i=!0,overrideProtected:l=!1,cycles:u=new Set})=>{if(o(e)&&"@context"in e&&a(e["@context"])&&(e=e["@context"]),0===v(e).length)return t;let g=[],y=[({event:t,next:e})=>{g.push(t),e()}];r.eventHandler&&y.push(r.eventHandler);let m=r;r={...r,eventHandler:y};let b=await r.contextResolver.resolve({activeCtx:t,context:e,documentLoader:r.documentLoader,base:r.base});o(b[0].document)&&"boolean"==typeof b[0].document["@propagate"]&&(i=b[0].document["@propagate"]);let w=t;for(let a of(i||w.previousContext||((w=w.clone()).previousContext=t),b)){let{document:i}=a;if(t=w,null===i){if(!l&&0!==Object.keys(t.protected).length)throw new n("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});w=t=x.getInitialContext(r).clone();continue}let y=a.getProcessed(t);if(y){if(m.eventHandler)for(let t of y.events)f({event:t,options:m});w=t=y.context;continue}if(o(i)&&"@context"in i&&(i=i["@context"]),!o(i))throw new n("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:i});w=w.clone();let v=new Map;if("@version"in i){if(1.1!==i["@version"])throw new n("Unsupported JSON-LD version: "+i["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:i});if(t.processingMode&&"json-ld-1.0"===t.processingMode)throw new n("@version: "+i["@version"]+" not compatible with "+t.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:i});w.processingMode="json-ld-1.1",w["@version"]=i["@version"],v.set("@version",!0)}if(w.processingMode=w.processingMode||t.processingMode,"@base"in i){let t=i["@base"];if(null===t||h(t));else if(d(t))t=c(w["@base"],t);else throw new n('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:i});w["@base"]=t,v.set("@base",!0)}if("@vocab"in i){let t=i["@vocab"];if(null===t)delete w["@vocab"];else if(s(t)){if(!h(t)&&x.processingMode(w,1))throw new n('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:i});{let e=E(w,t,{vocab:!0,base:!0},void 0,void 0,r);!h(e)&&r.eventHandler&&f({event:{type:["JsonLdEvent"],code:"relative @vocab reference",level:"warning",message:"Relative @vocab reference found.",details:{vocab:e}},options:r}),w["@vocab"]=e}}else throw new n('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:i});v.set("@vocab",!0)}if("@language"in i){let t=i["@language"];if(null===t)delete w["@language"];else if(s(t))!t.match(p)&&r.eventHandler&&f({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:t}},options:r}),w["@language"]=t.toLowerCase();else throw new n('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:i});v.set("@language",!0)}if("@direction"in i){let e=i["@direction"];if("json-ld-1.0"===t.processingMode)throw new n("Invalid JSON-LD syntax; @direction not compatible with "+t.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:i});if(null===e)delete w["@direction"];else if("ltr"!==e&&"rtl"!==e)throw new n('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:i});else w["@direction"]=e;v.set("@direction",!0)}if("@propagate"in i){let r=i["@propagate"];if("json-ld-1.0"===t.processingMode)throw new n("Invalid JSON-LD syntax; @propagate not compatible with "+t.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:i});if("boolean"!=typeof r)throw new n("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:e});v.set("@propagate",!0)}if("@import"in i){let a=i["@import"];if("json-ld-1.0"===t.processingMode)throw new n("Invalid JSON-LD syntax; @import not compatible with "+t.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:i});if(!s(a))throw new n("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:e});let o=await r.contextResolver.resolve({activeCtx:t,context:a,documentLoader:r.documentLoader,base:r.base});if(1!==o.length)throw new n("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:e});let l=o[0].getProcessed(t);if(l)i=l;else{let r=o[0].document;if("@import"in r)throw new n("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:e});for(let t in r)i.hasOwnProperty(t)||(i[t]=r[t]);o[0].setProcessed(t,i)}v.set("@import",!0)}for(let t in v.set("@protected",i["@protected"]||!1),i)if(x.createTermDefinition({activeCtx:w,localCtx:i,term:t,defined:v,options:r,overrideProtected:l}),o(i[t])&&"@context"in i[t]){let e=i[t]["@context"],a=!0;if(s(e)){let t=c(r.base,e);u.has(t)?a=!1:u.add(t)}if(a)try{await x.process({activeCtx:w.clone(),localCtx:i[t]["@context"],overrideProtected:!0,options:r,cycles:u})}catch(e){throw new n("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:i[t]["@context"],term:t})}}a.setProcessed(t,{context:w,events:g})}return w},x.createTermDefinition=({activeCtx:t,localCtx:e,term:r,defined:i,options:l,overrideProtected:u=!1})=>{let d;if(i.has(r)){if(i.get(r))return;throw new n("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:e,term:r})}if(i.set(r,!1),e.hasOwnProperty(r)&&(d=e[r]),"@type"===r&&o(d)&&"@set"===(d["@container"]||"@set")&&x.processingMode(t,1.1)){let t=["@container","@id","@protected"],i=Object.keys(d);if(0===i.length||i.some(e=>!t.includes(e)))throw new n("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:e,term:r})}else if(x.isKeyword(r))throw new n("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:e,term:r});else if(r.match(g)){l.eventHandler&&f({event:{type:["JsonLdEvent"],code:"reserved term",level:"warning",message:'Terms beginning with "@" are reserved for future use and dropped.',details:{term:r}},options:l});return}else if(""===r)throw new n("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:e});let c=t.mappings.get(r);t.mappings.has(r)&&t.mappings.delete(r);let p=!1;if((s(d)||null===d)&&(p=!0,d={"@id":d}),!o(d))throw new n("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:e});let y={};t.mappings.set(r,y),y.reverse=!1;let v=["@container","@id","@language","@reverse","@type"];for(let r in x.processingMode(t,1.1)&&v.push("@context","@direction","@index","@nest","@prefix","@protected"),d)if(!v.includes(r))throw new n("Invalid JSON-LD syntax; a term definition must not contain "+r,"jsonld.SyntaxError",{code:"invalid term definition",context:e});let m=r.indexOf(":");if(y._termHasColon=m>0,"@reverse"in d){if("@id"in d)throw new n("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:e});if("@nest"in d)throw new n("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:e});let a=d["@reverse"];if(!s(a))throw new n("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});if(a.match(g)){l.eventHandler&&f({event:{type:["JsonLdEvent"],code:"reserved @reverse value",level:"warning",message:'@reverse values beginning with "@" are reserved for future use and dropped.',details:{reverse:a}},options:l}),c?t.mappings.set(r,c):t.mappings.delete(r);return}let o=E(t,a,{vocab:!0,base:!1},e,i,l);if(!h(o))throw new n("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});y["@id"]=o,y.reverse=!0}else if("@id"in d){let a=d["@id"];if(a&&!s(a))throw new n("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});if(null===a)y["@id"]=null;else if(!x.isKeyword(a)&&a.match(g)){l.eventHandler&&f({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:'@id values beginning with "@" are reserved for future use and dropped.',details:{id:a}},options:l}),c?t.mappings.set(r,c):t.mappings.delete(r);return}else if(a!==r){if(!h(a=E(t,a,{vocab:!0,base:!1},e,i,l))&&!x.isKeyword(a))throw new n("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});if(r.match(/(?::[^:])|\//)){let o=new Map(i).set(r,!0);if(E(t,r,{vocab:!0,base:!1},e,o,l)!==a)throw new n("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e})}y["@id"]=a,y._prefix=p&&!y._termHasColon&&null!==a.match(/[:\/\?#\[\]@]$/)}}if(!("@id"in y)){if(y._termHasColon){let n=r.substr(0,m);if(e.hasOwnProperty(n)&&x.createTermDefinition({activeCtx:t,localCtx:e,term:n,defined:i,options:l}),t.mappings.has(n)){let e=r.substr(m+1);y["@id"]=t.mappings.get(n)["@id"]+e}else y["@id"]=r}else if("@type"===r)y["@id"]=r;else{if(!("@vocab"in t))throw new n("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e,term:r});y["@id"]=t["@vocab"]+r}}if((!0===d["@protected"]||!0===i.get("@protected")&&!1!==d["@protected"])&&(t.protected[r]=!0,y.protected=!0),i.set(r,!0),"@type"in d){let r=d["@type"];if(!s(r))throw new n("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:e});if("@json"===r||"@none"===r){if(x.processingMode(t,1))throw new n(`Invalid JSON-LD syntax; an @context @type value must not be "${r}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:e})}else if("@id"!==r&&"@vocab"!==r){if(!h(r=E(t,r,{vocab:!0,base:!1},e,i,l)))throw new n("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:e});if(0===r.indexOf("_:"))throw new n("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:e})}y["@type"]=r}if("@container"in d){let r=s(d["@container"])?[d["@container"]]:d["@container"]||[],i=["@list","@set","@index","@language"],o=!0,l=r.includes("@set");if(x.processingMode(t,1.1)){if(i.push("@graph","@id","@type"),r.includes("@list")){if(1!==r.length)throw new n("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:e})}else if(r.includes("@graph")){if(r.some(t=>"@graph"!==t&&"@id"!==t&&"@index"!==t&&"@set"!==t))throw new n("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:e})}else o&=r.length<=(l?2:1);if(r.includes("@type")&&(y["@type"]=y["@type"]||"@id",!["@id","@vocab"].includes(y["@type"])))throw new n("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:e})}else o&=!a(d["@container"]),o&=r.length<=1;if(o&=r.every(t=>i.includes(t)),!(o&=!(l&&r.includes("@list"))))throw new n("Invalid JSON-LD syntax; @context @container value must be one of the following: "+i.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:e});if(y.reverse&&!r.every(t=>["@index","@set"].includes(t)))throw new n("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:e});y["@container"]=r}if("@index"in d){if(!("@container"in d)||!y["@container"].includes("@index"))throw new n(`Invalid JSON-LD syntax; @index without @index in @container: "${d["@index"]}" on term "${r}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:e});if(!s(d["@index"])||0===d["@index"].indexOf("@"))throw new n(`Invalid JSON-LD syntax; @index must expand to an IRI: "${d["@index"]}" on term "${r}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:e});y["@index"]=d["@index"]}if("@context"in d&&(y["@context"]=d["@context"]),"@language"in d&&!("@type"in d)){let t=d["@language"];if(null!==t&&!s(t))throw new n("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:e});null!==t&&(t=t.toLowerCase()),y["@language"]=t}if("@prefix"in d){if(r.match(/:|\//))throw new n("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:e});if(x.isKeyword(y["@id"]))throw new n("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:e});if("boolean"==typeof d["@prefix"])y._prefix=!0===d["@prefix"];else throw new n("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:e})}if("@direction"in d){let t=d["@direction"];if(null!==t&&"ltr"!==t&&"rtl"!==t)throw new n('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:e});y["@direction"]=t}if("@nest"in d){let t=d["@nest"];if(!s(t)||"@nest"!==t&&0===t.indexOf("@"))throw new n("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:e});y["@nest"]=t}// disallow aliasing @context and @preserve
let b=y["@id"];if("@context"===b||"@preserve"===b)throw new n("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:e});if(c&&c.protected&&!u&&(t.protected[r]=!0,y.protected=!0,!function t(e,r){if(!(e&&"object"==typeof e)||!(r&&"object"==typeof r))return e===r;let n=Array.isArray(e);if(n!==Array.isArray(r))return!1;if(n){if(e.length!==r.length)return!1;for(let n=0;n<e.length;++n)if(!t(e[n],r[n]))return!1;return!0}let i=Object.keys(e),a=Object.keys(r);if(i.length!==a.length)return!1;for(let n in e){let i=e[n],a=r[n];if("@container"===n&&Array.isArray(i)&&Array.isArray(a)&&(i=i.slice().sort(),a=a.slice().sort()),!t(i,a))return!1}return!0}(c,y)))throw new n("Invalid JSON-LD syntax; tried to redefine a protected term.","jsonld.SyntaxError",{code:"protected term redefinition",context:e,term:r})},x.expandIri=(t,e,r,n)=>E(t,e,r,void 0,void 0,n),x.getInitialContext=t=>{let e=JSON.stringify({processingMode:t.processingMode}),n=b.get(e);if(n)return n;let i={processingMode:t.processingMode,mappings:new Map,inverse:null,getInverse:function(){if(this.inverse)return this.inverse;let t=this.inverse={},e=this.fastCurieMap={},r={},n=(this["@language"]||"@none").toLowerCase(),i=this["@direction"],o=this.mappings;for(let s of[...o.keys()].sort(m)){let l=o.get(s);if(null===l)continue;let u=l["@container"]||"@none";if(u=[].concat(u).sort().join(""),null!==l["@id"])for(let o of v(l["@id"])){let h=t[o],d=x.isKeyword(o);if(h)d||l._termHasColon||r[o].push(s);else if(t[o]=h={},!d&&!l._termHasColon){r[o]=[s];let t={iri:o,terms:r[o]};o[0]in e?e[o[0]].push(t):e[o[0]]=[t]}if(h[u]||(h[u]={"@language":{},"@type":{},"@any":{}}),a(s,(h=h[u])["@any"],"@none"),l.reverse)a(s,h["@type"],"@reverse");else if("@none"===l["@type"])a(s,h["@any"],"@none"),a(s,h["@language"],"@none"),a(s,h["@type"],"@none");else if("@type"in l)a(s,h["@type"],l["@type"]);else if("@language"in l&&"@direction"in l){let t=l["@language"],e=l["@direction"];t&&e?a(s,h["@language"],`${t}_${e}`.toLowerCase()):t?a(s,h["@language"],t.toLowerCase()):e?a(s,h["@language"],`_${e}`):a(s,h["@language"],"@null")}else"@language"in l?a(s,h["@language"],(l["@language"]||"@null").toLowerCase()):"@direction"in l?l["@direction"]?a(s,h["@language"],`_${l["@direction"]}`):a(s,h["@language"],"@none"):(i?a(s,h["@language"],`_${i}`):a(s,h["@language"],n),a(s,h["@language"],"@none"),a(s,h["@type"],"@none"))}}for(let t in e)(function t(e,r,n){let i,a;let o=e[r],s=e[r]={};for(let t of o)(a=n>=(i=t.iri).length?"":i[n])in s?s[a].push(t):s[a]=[t];for(let e in s)""!==e&&t(s,e,n+1)})(e,t,1);return t},clone:function(){let t={};return t.mappings=r.clone(this.mappings),t.clone=this.clone,t.inverse=null,t.getInverse=this.getInverse,t.protected=r.clone(this.protected),this.previousContext&&(t.previousContext=this.previousContext.clone()),t.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(t["@base"]=this["@base"]),"@language"in this&&(t["@language"]=this["@language"]),"@vocab"in this&&(t["@vocab"]=this["@vocab"]),t},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===b.size&&b.clear(),b.set(e,i),i;function a(t,e,r){e.hasOwnProperty(r)||(e[r]=t)}},x.getContextValue=(t,e,r)=>{if(null===e){if("@context"===r)return;return null}if(t.mappings.has(e)){let n=t.mappings.get(e);if(l(r))return n;if(n.hasOwnProperty(r))return n[r]}return"@language"===r&&r in t||"@direction"===r&&r in t?t[r]:"@context"!==r?null:void 0},x.processingMode=(t,e)=>e.toString()>="1.1"?!t.processingMode||t.processingMode>="json-ld-"+e.toString():"json-ld-1.0"===t.processingMode,x.isKeyword=t=>{if(!s(t)||"@"!==t[0])return!1;switch(t){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}}),v("85rA0",function(t,e){var r=y("dEapz"),n=y("guzPY"),i=y("h0LIu").IdentifierIssuer,a=y("3Yszg");let o=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,s=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,l=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,u={headers:{accept:"application/ld+json, application/json"}},h={};t.exports=h,h.IdentifierIssuer=i,h.REGEX_BCP47=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,h.REGEX_KEYWORD=/^@[a-zA-Z]+$/,h.clone=function(t){if(t&&"object"==typeof t){let e;if(n.isArray(t)){e=[];for(let r=0;r<t.length;++r)e[r]=h.clone(t[r])}else if(t instanceof Map)for(let[r,n]of(e=new Map,t))e.set(r,h.clone(n));else if(t instanceof Set)for(let r of(e=new Set,t))e.add(h.clone(r));else if(n.isObject(t))for(let r in e={},t)e[r]=h.clone(t[r]);else e=t.toString();return e}return t},h.asArray=function(t){return Array.isArray(t)?t:[t]},h.buildHeaders=(t={})=>{if(Object.keys(t).some(t=>"accept"===t.toLowerCase()))throw RangeError('Accept header may not be specified; only "'+u.headers.accept+'" is supported.');return Object.assign({Accept:u.headers.accept},t)},h.parseLinkHeader=t=>{let e={},r=t.match(o);for(let t=0;t<r.length;++t){let n=r[t].match(s);if(!n)continue;let i={target:n[1]},a=n[2];for(;n=l.exec(a);)i[n[1]]=void 0===n[2]?n[3]:n[2];let o=i.rel||"";Array.isArray(e[o])?e[o].push(i):e.hasOwnProperty(o)?e[o]=[e[o],i]:e[o]=i}return e},h.validateTypeValue=(t,e)=>{if(!n.isString(t)&&!(n.isArray(t)&&t.every(t=>n.isString(t)))){if(e&&n.isObject(t))switch(Object.keys(t).length){case 0:return;case 1:if("@default"in t&&h.asArray(t["@default"]).every(t=>n.isString(t)))return}throw new a('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:t})}},h.hasProperty=(t,e)=>{if(t.hasOwnProperty(e)){let r=t[e];return!n.isArray(r)||r.length>0}return!1},h.hasValue=(t,e,i)=>{if(h.hasProperty(t,e)){let a=t[e],o=r.isList(a);if(n.isArray(a)||o){o&&(a=a["@list"]);for(let t=0;t<a.length;++t)if(h.compareValues(i,a[t]))return!0}else if(!n.isArray(i))return h.compareValues(i,a)}return!1},h.addValue=(t,e,r,i)=>{if("propertyIsArray"in(i=i||{})||(i.propertyIsArray=!1),"valueIsArray"in i||(i.valueIsArray=!1),"allowDuplicate"in i||(i.allowDuplicate=!0),"prependValue"in i||(i.prependValue=!1),i.valueIsArray)t[e]=r;else if(n.isArray(r)){0===r.length&&i.propertyIsArray&&!t.hasOwnProperty(e)&&(t[e]=[]),i.prependValue&&(r=r.concat(t[e]),t[e]=[]);for(let n=0;n<r.length;++n)h.addValue(t,e,r[n],i)}else if(t.hasOwnProperty(e)){let a=!i.allowDuplicate&&h.hasValue(t,e,r);n.isArray(t[e])||a&&!i.propertyIsArray||(t[e]=[t[e]]),a||(i.prependValue?t[e].unshift(r):t[e].push(r))}else t[e]=i.propertyIsArray?[r]:r},h.getValues=(t,e)=>[].concat(t[e]||[]),h.removeProperty=(t,e)=>{delete t[e]},h.removeValue=(t,e,r,n)=>{"propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1);let i=h.getValues(t,e).filter(t=>!h.compareValues(t,r));0===i.length?h.removeProperty(t,e):1!==i.length||n.propertyIsArray?t[e]=i:t[e]=i[0]},h.relabelBlankNodes=(t,e)=>(function t(e,i){if(n.isArray(i))for(let r=0;r<i.length;++r)i[r]=t(e,i[r]);else if(r.isList(i))i["@list"]=t(e,i["@list"]);else if(n.isObject(i)){r.isBlankNode(i)&&(i["@id"]=e.getId(i["@id"]));let n=Object.keys(i).sort();for(let r=0;r<n.length;++r){let a=n[r];"@id"!==a&&(i[a]=t(e,i[a]))}}return i})((e=e||{}).issuer||new i("_:b"),t),h.compareValues=(t,e)=>!!(t===e||r.isValue(t)&&r.isValue(e)&&t["@value"]===e["@value"]&&t["@type"]===e["@type"]&&t["@language"]===e["@language"]&&t["@index"]===e["@index"])||!!(n.isObject(t)&&"@id"in t&&n.isObject(e))&&"@id"in e&&t["@id"]===e["@id"],h.compareShortestLeast=(t,e)=>t.length<e.length?-1:e.length<t.length?1:t===e?0:t<e?-1:1}),v("dEapz",function(t,e){var r=y("guzPY");let n={};t.exports=n,n.isSubject=t=>!!r.isObject(t)&&!("@value"in t||"@set"in t||"@list"in t)&&(Object.keys(t).length>1||!("@id"in t)),n.isSubjectReference=t=>r.isObject(t)&&1===Object.keys(t).length&&"@id"in t,n.isValue=t=>r.isObject(t)&&"@value"in t,n.isList=t=>r.isObject(t)&&"@list"in t,n.isGraph=t=>r.isObject(t)&&"@graph"in t&&1===Object.keys(t).filter(t=>"@id"!==t&&"@index"!==t).length,n.isSimpleGraph=t=>n.isGraph(t)&&!("@id"in t),n.isBlankNode=t=>{if(r.isObject(t)){if("@id"in t){let e=t["@id"];return!r.isString(e)||0===e.indexOf("_:")}return 0===Object.keys(t).length||!("@value"in t||"@set"in t||"@list"in t)}return!1}}),v("3Yszg",function(t,e){t.exports=class extends Error{constructor(t="An unspecified JSON-LD error occurred.",e="jsonld.Error",r={}){super(t),this.name=e,this.message=t,this.details=r}}}),v("8qp2g",function(t,e){var r=y("3Yszg"),n=y("guzPY").isArray,i=y("85rA0").asArray;let a={};t.exports=a,a.defaultEventHandler=null,a.setupEventHandler=({options:t={}})=>{let e=[].concat(t.safe?a.safeEventHandler:[],t.eventHandler?i(t.eventHandler):[],a.defaultEventHandler?a.defaultEventHandler:[]);return 0===e.length?null:e},a.handleEvent=({event:t,options:e})=>{(function t({event:e,handlers:i}){let a=!0;for(let o=0;a&&o<i.length;++o){a=!1;let s=i[o];if(n(s))a=t({event:e,handlers:s});else if("function"==typeof s)s({event:e,next:()=>{a=!0}});else if("object"==typeof s)e.code in s?s[e.code]({event:e,next:()=>{a=!0}}):a=!0;else throw new r("Invalid event handler.","jsonld.InvalidEventHandler",{event:e})}return a})({event:t,handlers:e.eventHandler})};let o=new Set(["empty object","free-floating scalar","invalid @language value","invalid property","null @id value","null @value value","object with only @id","object with only @language","object with only @list","object with only @value","relative @id reference","relative @type reference","relative @vocab reference","reserved @id value","reserved @reverse value","reserved term","blank node predicate","relative graph reference","relative object reference","relative predicate reference","relative subject reference","rdfDirection not set"]);a.safeEventHandler=function({event:t,next:e}){if("warning"===t.level&&o.has(t.code))throw new r("Safe mode validation error.","jsonld.ValidationError",{event:t});e()},a.logEventHandler=function({event:t,next:e}){console.log(`EVENT: ${t.message}`,{event:t}),e()},a.logWarningEventHandler=function({event:t,next:e}){"warning"===t.level&&console.warn(`WARNING: ${t.message}`,{event:t}),e()},a.unhandledEventHandler=function({event:t}){throw new r("No handler for event.","jsonld.UnhandledEvent",{event:t})},a.setDefaultEventHandler=function({eventHandler:t}={}){a.defaultEventHandler=t?i(t):null}}),v("eds65",function(t,e){t.exports=t=>{class e{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(e,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(e.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:e}),e.compact=function(e,r){return arguments.length<2?Promise.reject(TypeError("Could not compact, too few arguments.")):t.compact(e,r)},e.expand=function(e){return arguments.length<1?Promise.reject(TypeError("Could not expand, too few arguments.")):t.expand(e)},e.flatten=function(e){return arguments.length<1?Promise.reject(TypeError("Could not flatten, too few arguments.")):t.flatten(e)},e}}),v("4l69v",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.ParseType=t.exports.RdfXmlParser=void 0;var r,n,i=y("7vqNZ"),a=y("4Lz2o"),o=y("7K0Nk"),s=y("3c9Jd"),l=y("lCEHR"),u=y("3XGlj");class h extends o.Transform{constructor(t){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},t&&(Object.assign(this,t),this.options=t),this.dataFactory||(this.dataFactory=new l.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),!1!==this.validateUri&&(this.validateUri=!0),this.iriValidationStrategy||(this.iriValidationStrategy=this.validateUri?u.IriValidationStrategy.Pragmatic:u.IriValidationStrategy.None),this.saxParser=new a.SaxesParser({xmlns:!0,position:this.trackPosition}),this.attachSaxListeners()}import(t){let e=new o.PassThrough({readableObjectMode:!0});t.on("error",t=>r.emit("error",t)),t.on("data",t=>e.push(t)),t.on("end",()=>e.push(null));let r=e.pipe(new h(this.options));return r}_transform(t,e,r){try{this.saxParser.write(t)}catch(t){return r(t)}r()}newParseError(t){return new s.ParseError(this,t)}valueToUri(t,e){return this.uriToNamedNode((0,i.resolve)(t,e.baseIRI))}uriToNamedNode(t){let e=(0,u.validateIri)(t,this.iriValidationStrategy);if(e instanceof Error)throw this.newParseError(e.message);return this.dataFactory.namedNode(t)}validateNcname(t){if(!h.NCNAME_MATCHER.test(t))throw this.newParseError(`Not a valid NCName: ${t}`)}attachSaxListeners(){this.saxParser.on("error",t=>this.emit("error",t)),this.saxParser.on("opentag",this.onTag.bind(this)),this.saxParser.on("text",this.onText.bind(this)),this.saxParser.on("cdata",this.onText.bind(this)),this.saxParser.on("closetag",this.onCloseTag.bind(this)),this.saxParser.on("doctype",this.onDoctype.bind(this))}onTag(t){let e=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null,r=n.RESOURCE;if(e&&(e.hadChildren=!0,r=e.childrenParseType),e&&e.childrenStringTags){let r=t.name,n="";for(let e in t.attributes)n+=` ${e}="${t.attributes[e].value}"`;let i=`${r}${n}`,a=`<${i}>`;e.childrenStringTags.push(a);let o={childrenStringTags:e.childrenStringTags};o.childrenStringEmitClosingTag=`</${r}>`,this.activeTagStack.push(o);return}let i={};e?(i.language=e.language,i.baseIRI=e.baseIRI):i.baseIRI=this.baseIRI,this.activeTagStack.push(i),r===n.RESOURCE?this.onTagResource(t,i,e,!e):this.onTagProperty(t,i,e)}onTagResource(t,e,r,a){e.childrenParseType=n.PROPERTY;let o=!0;if(t.uri===h.RDF){if(!a&&h.FORBIDDEN_NODE_ELEMENTS.indexOf(t.local)>=0)throw this.newParseError(`Illegal node element name: ${t.local}`);switch(t.local){case"RDF":e.childrenParseType=n.RESOURCE;case"Description":o=!1}}let s=[],l=[],u=null,d=!1,c=!1,f=null;for(let n in t.attributes){let a=t.attributes[n];if(r&&a.uri===h.RDF)switch(a.local){case"about":if(u)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, \
while ${a.value} and ${u} where found.`);u=a.value;continue;case"ID":if(u)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, \
while ${a.value} and ${u} where found.`);this.validateNcname(a.value),u="#"+a.value,d=!0;continue;case"nodeID":if(u)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, \
while ${a.value} and ${u} where found.`);this.validateNcname(a.value),u=a.value,c=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":f=a.value;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(a.uri===h.XML){if("lang"===a.local){e.language=""===a.value?null:a.value.toLowerCase();continue}if("base"===a.local){e.baseIRI=(0,i.resolve)(a.value,e.baseIRI);continue}}"xml"!==a.prefix&&"xmlns"!==a.prefix&&(""!==a.prefix||"xmlns"!==a.local)&&a.uri&&(s.push(this.uriToNamedNode(a.uri+a.local)),l.push(a.value))}if(null!==u&&(e.subject=c?this.dataFactory.blankNode(u):this.valueToUri(u,e),d&&this.claimNodeId(e.subject)),e.subject||(e.subject=this.dataFactory.blankNode()),o){let n=this.uriToNamedNode(t.uri+t.local);this.emitTriple(e.subject,this.dataFactory.namedNode(h.RDF+"type"),n,r?r.reifiedStatementId:null)}if(r){if(r.predicate){if(r.childrenCollectionSubject){let t=this.dataFactory.blankNode();this.emitTriple(r.childrenCollectionSubject,r.childrenCollectionPredicate,t,r.reifiedStatementId),this.emitTriple(t,this.dataFactory.namedNode(h.RDF+"first"),e.subject,e.reifiedStatementId),r.childrenCollectionSubject=t,r.childrenCollectionPredicate=this.dataFactory.namedNode(h.RDF+"rest")}else{this.emitTriple(r.subject,r.predicate,e.subject,r.reifiedStatementId);for(let t=0;t<r.predicateSubPredicates.length;t++)this.emitTriple(e.subject,r.predicateSubPredicates[t],r.predicateSubObjects[t],null);r.predicateSubPredicates=[],r.predicateSubObjects=[],r.predicateEmitted=!0}}for(let t=0;t<s.length;t++){let n=this.dataFactory.literal(l[t],e.datatype||e.language);this.emitTriple(e.subject,s[t],n,r.reifiedStatementId)}f&&this.emitTriple(e.subject,this.dataFactory.namedNode(h.RDF+"type"),this.uriToNamedNode(f),null)}}onTagProperty(t,e,r){if(e.childrenParseType=n.RESOURCE,e.subject=r.subject,t.uri===h.RDF&&"li"===t.local?(r.listItemCounter||(r.listItemCounter=1),e.predicate=this.uriToNamedNode(t.uri+"_"+r.listItemCounter++)):e.predicate=this.uriToNamedNode(t.uri+t.local),t.uri===h.RDF&&h.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(t.local)>=0)throw this.newParseError(`Illegal property element name: ${t.local}`);e.predicateSubPredicates=[],e.predicateSubObjects=[];let i=!1,a=!1,o=null,s=!0,l=[],u=[];for(let r in t.attributes){let d=t.attributes[r];if(d.uri===h.RDF)switch(d.local){case"resource":if(o)throw this.newParseError(`Found both rdf:resource (${d.value}) and rdf:nodeID (${o}).`);if(i)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${d.value})`);e.hadChildren=!0,o=d.value,s=!1;continue;case"datatype":if(a)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${d.value}).`);if(i)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${d.value})`);e.datatype=this.valueToUri(d.value,e);continue;case"nodeID":if(a)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${d.value}).`);if(e.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${d.value}).`);if(i)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${d.value})`);this.validateNcname(d.value),e.hadChildren=!0,o=d.value,s=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(a)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(e.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${e.datatype.value})`);if(o)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${o})`);if("Resource"===d.value){i=!0,e.childrenParseType=n.PROPERTY;let t=this.dataFactory.blankNode();this.emitTriple(e.subject,e.predicate,t,e.reifiedStatementId),e.subject=t,e.predicate=null}else"Collection"===d.value?(i=!0,e.hadChildren=!0,e.childrenCollectionSubject=e.subject,e.childrenCollectionPredicate=e.predicate,s=!1):"Literal"===d.value&&(i=!0,e.childrenTagsToString=!0,e.childrenStringTags=[]);continue;case"ID":this.validateNcname(d.value),e.reifiedStatementId=this.valueToUri("#"+d.value,e),this.claimNodeId(e.reifiedStatementId);continue}else if(d.uri===h.XML&&"lang"===d.local){e.language=""===d.value?null:d.value.toLowerCase();continue}if("xml"!==d.prefix&&"xmlns"!==d.prefix&&(""!==d.prefix||"xmlns"!==d.local)&&d.uri){if(i||e.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${d.value}`);e.hadChildren=!0,a=!0,l.push(this.uriToNamedNode(d.uri+d.local)),u.push(this.dataFactory.literal(d.value,e.datatype||e.language))}}if(null!==o){let t=e.subject;e.subject=s?this.dataFactory.blankNode(o):this.valueToUri(o,e),this.emitTriple(t,e.predicate,e.subject,e.reifiedStatementId);for(let t=0;t<l.length;t++)this.emitTriple(e.subject,l[t],u[t],null);e.predicateEmitted=!0}else s&&(e.predicateSubPredicates=l,e.predicateSubObjects=u,e.predicateEmitted=!1)}emitTriple(t,e,r,n){this.push(this.dataFactory.quad(t,e,r,this.defaultGraph)),n&&(this.push(this.dataFactory.quad(n,this.dataFactory.namedNode(h.RDF+"type"),this.dataFactory.namedNode(h.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(n,this.dataFactory.namedNode(h.RDF+"subject"),t,this.defaultGraph)),this.push(this.dataFactory.quad(n,this.dataFactory.namedNode(h.RDF+"predicate"),e,this.defaultGraph)),this.push(this.dataFactory.quad(n,this.dataFactory.namedNode(h.RDF+"object"),r,this.defaultGraph)))}claimNodeId(t){if(!this.allowDuplicateRdfIds){if(this.nodeIds[t.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${t.value}'.`);this.nodeIds[t.value]=!0}}onText(t){let e=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;e&&(e.childrenStringTags?e.childrenStringTags.push(t):e.predicate&&(e.text=t))}onCloseTag(){let t=this.activeTagStack.pop();if(t.childrenStringEmitClosingTag&&t.childrenStringTags.push(t.childrenStringEmitClosingTag),t.childrenTagsToString&&(t.datatype=this.dataFactory.namedNode(h.RDF+"XMLLiteral"),t.text=t.childrenStringTags.join(""),t.hadChildren=!1),t.childrenCollectionSubject)this.emitTriple(t.childrenCollectionSubject,t.childrenCollectionPredicate,this.dataFactory.namedNode(h.RDF+"nil"),t.reifiedStatementId);else if(t.predicate){if(t.hadChildren||t.childrenParseType===n.PROPERTY){if(!t.predicateEmitted){let e=this.dataFactory.blankNode();this.emitTriple(t.subject,t.predicate,e,t.reifiedStatementId);for(let r=0;r<t.predicateSubPredicates.length;r++)this.emitTriple(e,t.predicateSubPredicates[r],t.predicateSubObjects[r],null)}}else this.emitTriple(t.subject,t.predicate,this.dataFactory.literal(t.text||"",t.datatype||t.language),t.reifiedStatementId)}}onDoctype(t){t.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(t,e,r)=>(this.saxParser.ENTITIES[e]=r,""))}}t.exports.RdfXmlParser=h,h.MIME_TYPE="application/rdf+xml",h.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",h.XML="http://www.w3.org/XML/1998/namespace",h.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],h.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],h.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(r=n||(t.exports.ParseType=n={}))[r.RESOURCE=0]="RESOURCE",r[r.PROPERTY=1]="PROPERTY"}),v("4Lz2o",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.SaxesParser=t.exports.EVENTS=void 0;var r=y("bCNQP"),n=y("hnsSo"),i=y("652lH"),a=r.isS,o=r.isChar,s=r.isNameStartChar,l=r.isNameChar,u=r.S_LIST,h=r.NAME_RE,d=n.isChar,c=i.isNCNameStartChar,f=i.isNCNameChar,p=i.NC_NAME_RE;let g="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/2000/xmlns/",m={__proto__:null,xml:g,xmlns:v},b={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},x=t=>34===t||39===t,E=[34,39],w=[...E,91,62],_=[...E,60,93],S=[61,63,...u],k=[...u,62,38,60];function N(t,e,r){switch(e){case"xml":r!==g&&t.fail(`xml prefix must be bound to ${g}.`);break;case"xmlns":r!==v&&t.fail(`xmlns prefix must be bound to ${v}.`)}switch(r){case v:t.fail(""===e?`the default namespace may not be set to ${r}.`:`may not assign a prefix (even "xmlns") to the URI \
${v}.`);break;case g:switch(e){case"xml":break;case"":t.fail(`the default namespace may not be set to ${r}.`);break;default:t.fail("may not assign the xml namespace to another prefix.")}}}let O=t=>p.test(t),T=t=>h.test(t);t.exports.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];let M={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};t.exports.SaxesParser=class{get closed(){return this._closed}constructor(t){this.opt=null!=t?t:{},this.fragmentOpt=!!this.opt.fragment;let e=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=!1!==this.opt.position,this.fileName=this.opt.fileName,e){this.nameStartCheck=c,this.nameCheck=f,this.isName=O,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},m);let t=this.opt.additionalNamespaces;null!=t&&(function(t,e){for(let r of Object.keys(e))N(t,r,e[r])}(this,t),Object.assign(this.ns,t))}else this.nameStartCheck=s,this.nameCheck=l,this.isName=T,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}_init(){var t;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];let{fragmentOpt:e}=this;this.state=e?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=e,this.xmlDeclPossible=!e,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:r}=this.opt;if(void 0===r){if(!0===this.opt.forceXMLVersion)throw Error("forceXMLVersion set but defaultXMLVersion is not set");r="1.0"}this.setXMLVersion(r),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(b),null===(t=this.readyHandler)||void 0===t||t.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(t,e){this[M[t]]=e}off(t){this[M[t]]=void 0}makeError(t){var e;let r=null!==(e=this.fileName)&&void 0!==e?e:"";return this.trackPosition&&(r.length>0&&(r+=":"),r+=`${this.line}:${this.column}`),r.length>0&&(r+=": "),Error(r+t)}fail(t){let e=this.makeError(t),r=this.errorHandler;if(void 0===r)throw e;return r(e),this}write(t){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let e=!1;null===t?(e=!0,t=""):"object"==typeof t&&(t=t.toString()),void 0!==this.carriedFromPrevious&&(t=`${this.carriedFromPrevious}${t}`,this.carriedFromPrevious=void 0);let r=t.length,n=t.charCodeAt(r-1);!e&&(13===n||n>=55296&&n<=56319)&&(this.carriedFromPrevious=t[r-1],r--,t=t.slice(0,r));let{stateTable:i}=this;for(this.chunk=t,this.i=0;this.i<r;)i[this.state].call(this);return this.chunkPosition+=r,e?this.end():this}close(){return this.write(null)}getCode10(){let{chunk:t,i:e}=this;if(this.prevI=e,this.i=e+1,e>=t.length)return -1;let r=t.charCodeAt(e);if(this.column++,r<55296){if(r>=32||9===r)return r;switch(r){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return 10===t.charCodeAt(e+1)&&(this.i=e+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;let n=65536+(r-55296)*1024+(t.charCodeAt(e+1)-56320);return this.i=e+2,n>1114111&&this.fail("disallowed character."),n}getCode11(){let{chunk:t,i:e}=this;if(this.prevI=e,this.i=e+1,e>=t.length)return -1;let r=t.charCodeAt(e);if(this.column++,r<55296){if(r>31&&r<127||r>159&&8232!==r||9===r)return r;switch(r){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{let r=t.charCodeAt(e+1);(10===r||133===r)&&(this.i=e+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;let n=65536+(r-55296)*1024+(t.charCodeAt(e+1)-56320);return this.i=e+2,n>1114111&&this.fail("disallowed character."),n}getCodeNorm(){let t=this.getCode();return -2===t?10:t}unget(){this.i=this.prevI,this.column--}captureTo(t){let{i:e}=this,{chunk:r}=this;for(;;){let n=this.getCode(),i=-2===n,a=i?10:n;if(-1===a||t.includes(a))return this.text+=r.slice(e,this.prevI),a;i&&(this.text+=`${r.slice(e,this.prevI)}
`,e=this.i)}}captureToChar(t){let{i:e}=this,{chunk:r}=this;for(;;){let n=this.getCode();switch(n){case -2:this.text+=`${r.slice(e,this.prevI)}
`,e=this.i,n=10;break;case -1:return this.text+=r.slice(e),!1}if(n===t)return this.text+=r.slice(e,this.prevI),!0}}captureNameChars(){let{chunk:t,i:e}=this;for(;;){let r=this.getCode();if(-1===r)return this.name+=t.slice(e),-1;if(!l(r))return this.name+=t.slice(e,this.prevI),-2===r?10:r}}skipSpaces(){for(;;){let t=this.getCodeNorm();if(-1===t||!a(t))return t}}setXMLVersion(t){this.currentXMLVersion=t,"1.0"===t?(this.isChar=o,this.getCode=this.getCode10):(this.isChar=d,this.getCode=this.getCode11)}sBegin(){65279===this.chunk.charCodeAt(0)&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){let t=this.i,e=this.skipSpaces();switch(this.prevI!==t&&(this.xmlDeclPossible=!1),e){case 60:if(this.state=15,0!==this.text.length)throw Error("no-empty text at start");break;case -1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var t;let e=this.captureTo(w);switch(e){case 62:null===(t=this.doctypeHandler)||void 0===t||t.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case -1:break;default:this.text+=String.fromCodePoint(e),91===e?this.state=4:x(e)&&(this.state=3,this.q=e)}}sDoctypeQuote(){let t=this.q;this.captureToChar(t)&&(this.text+=String.fromCodePoint(t),this.q=null,this.state=2)}sDTD(){let t=this.captureTo(_);-1!==t&&(this.text+=String.fromCodePoint(t),93===t?this.state=2:60===t?this.state=6:x(t)&&(this.state=5,this.q=t))}sDTDQuoted(){let t=this.q;this.captureToChar(t)&&(this.text+=String.fromCodePoint(t),this.state=4,this.q=null)}sDTDOpenWaka(){let t=this.getCodeNorm();switch(this.text+=String.fromCodePoint(t),t){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){let t=String.fromCodePoint(this.getCodeNorm()),e=this.openWakaBang+=t;this.text+=t,"-"!==e&&(this.state="--"===e?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){let t=this.getCodeNorm();this.text+=String.fromCodePoint(t),this.state=45===t?10:8}sDTDCommentEnded(){let t=this.getCodeNorm();this.text+=String.fromCodePoint(t),62===t?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){let t=this.getCodeNorm();this.text+=String.fromCodePoint(t),62===t&&(this.state=4)}sText(){0!==this.tags.length?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:t}=this,{chunk:e}=this;t:for(;;)switch(this.getCode()){case -2:this.entity+=`${e.slice(t,this.prevI)}
`,t=this.i;break;case 59:{let r;let{entityReturnState:n}=this,i=this.entity+e.slice(t,this.prevI);this.state=n,""===i?(this.fail("empty entity name."),r="&;"):(r=this.parseEntity(i),this.entity=""),(13!==n||void 0!==this.textHandler)&&(this.text+=r);break t}case -1:this.entity+=e.slice(t);break t}}sOpenWaka(){let t=this.getCode();if(s(t))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(t){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var t;let e=this.getCodeNorm();45===e?(this.state=19,null===(t=this.commentHandler)||void 0===t||t.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(e)}`,this.state=17)}sCommentEnded(){let t=this.getCodeNorm();62!==t?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(t)}`,this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){let t=this.getCodeNorm();93===t?this.state=22:(this.text+=`]${String.fromCodePoint(t)}`,this.state=20)}sCDataEnding2(){var t;let e=this.getCodeNorm();switch(e){case 62:null===(t=this.cdataHandler)||void 0===t||t.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(e)}`,this.state=20}}sPIFirstChar(){let t=this.getCodeNorm();this.nameStartCheck(t)?(this.piTarget+=String.fromCodePoint(t),this.state=24):63===t||a(t)?(this.fail("processing instruction without a target."),this.state=63===t?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(t),this.state=24)}sPIRest(){let{chunk:t,i:e}=this;for(;;){let r=this.getCodeNorm();if(-1===r){this.piTarget+=t.slice(e);return}if(!this.nameCheck(r)){this.piTarget+=t.slice(e,this.prevI);let n=63===r;n||a(r)?"xml"===this.piTarget?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=n?33:27):this.state=n?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(r));break}}}sPIBody(){if(0===this.text.length){let t=this.getCodeNorm();63===t?this.state=26:a(t)||(this.text=String.fromCodePoint(t))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var t;let e=this.getCodeNorm();if(62===e){let{piTarget:e}=this;"xml"===e.toLowerCase()&&this.fail("the XML declaration must appear at the start of the document."),null===(t=this.piHandler)||void 0===t||t.call(this,{target:e,body:this.text}),this.piTarget=this.text="",this.state=13}else 63===e?this.text+="?":(this.text+=`?${String.fromCodePoint(e)}`,this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){let t=this.skipSpaces();if(63===t){this.state=33;return}-1!==t&&(this.state=28,this.name=String.fromCodePoint(t))}sXMLDeclName(){let t=this.captureTo(S);if(63===t){this.state=33,this.name+=this.text,this.text="",this.fail("XML declaration is incomplete.");return}if(a(t)||61===t){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=61===t?30:29}}sXMLDeclEq(){let t=this.getCodeNorm();if(63===t){this.state=33,this.fail("XML declaration is incomplete.");return}a(t)||(61!==t&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){let t=this.getCodeNorm();if(63===t){this.state=33,this.fail("XML declaration is incomplete.");return}a(t)||(x(t)?this.q=t:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){let t=this.captureTo([this.q,63]);if(63===t){this.state=33,this.text="",this.fail("XML declaration is incomplete.");return}if(-1===t)return;let e=this.text;switch(this.text="",this.name){case"version":this.xmlDeclExpects=["encoding","standalone"],this.xmlDecl.version=e,/^1\.[0-9]+$/.test(e)?this.opt.forceXMLVersion||this.setXMLVersion(e):this.fail("version number must match /^1\\.[0-9]+$/.");break;case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(e)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=e;break;case"standalone":"yes"!==e&&"no"!==e&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=e}this.name="",this.state=32}sXMLDeclSeparator(){let t=this.getCodeNorm();if(63===t){this.state=33;return}a(t)||(this.fail("whitespace required."),this.unget()),this.state=27}sXMLDeclEnding(){var t;62===this.getCodeNorm()?("xml"!==this.piTarget?this.fail("processing instructions are not allowed before root."):"version"!==this.name&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),null===(t=this.xmldeclHandler)||void 0===t||t.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var t;let e=this.captureNameChars();if(-1===e)return;let r=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=r.ns=Object.create(null)),null===(t=this.openTagStartHandler)||void 0===t||t.call(this,r),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),e){case 62:this.openTag();break;case 47:this.state=35;break;default:a(e)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){62===this.getCode()?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){let t=this.skipSpaces();-1!==t&&(s(t)?(this.unget(),this.state=37):62===t?this.openTag():47===t?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){let t=this.captureNameChars();61===t?this.state=39:a(t)?this.state=38:62===t?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):-1!==t&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){let t=this.skipSpaces();switch(t){case -1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",62===t?this.openTag():s(t)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){let t=this.getCodeNorm();x(t)?(this.q=t,this.state=40):a(t)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){let{q:t,chunk:e}=this,{i:r}=this;for(;;)switch(this.getCode()){case t:this.pushAttrib(this.name,this.text+e.slice(r,this.prevI)),this.name=this.text="",this.q=null,this.state=41;return;case 38:this.text+=e.slice(r,this.prevI),this.state=14,this.entityReturnState=40;return;case 10:case -2:case 9:this.text+=`${e.slice(r,this.prevI)} `,r=this.i;break;case 60:this.text+=e.slice(r,this.prevI),this.fail("disallowed character.");return;case -1:this.text+=e.slice(r);return}}sAttribValueClosed(){let t=this.getCodeNorm();a(t)?this.state=36:62===t?this.openTag():47===t?this.state=35:s(t)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){let t=this.captureTo(k);switch(t){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case -1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",62===t?this.openTag():this.state=36}}sCloseTag(){let t=this.captureNameChars();62===t?this.closeTag():a(t)?this.state=44:-1!==t&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case -1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:t,forbiddenState:e}=this,{chunk:r,textHandler:n}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,void 0!==n){let{text:e}=this,i=r.slice(t,this.prevI);0!==e.length?(n(e+i),this.text=""):0!==i.length&&n(i)}e=0;break e;case 38:this.state=14,this.entityReturnState=13,void 0!==n&&(this.text+=r.slice(t,this.prevI)),e=0;break e;case 93:switch(e){case 0:e=1;break;case 1:e=2;break;case 2:break;default:throw Error("impossible state")}break;case 62:2===e&&this.fail('the string "]]>" is disallowed in char data.'),e=0;break;case -2:void 0!==n&&(this.text+=`${r.slice(t,this.prevI)}
`),t=this.i,e=0;break;case -1:void 0!==n&&(this.text+=r.slice(t));break e;default:e=0}this.forbiddenState=e}handleTextOutsideRoot(){let{i:t}=this,{chunk:e,textHandler:r}=this,n=!1;r:for(;;){let i=this.getCode();switch(i){case 60:if(this.state=15,void 0!==r){let{text:n}=this,i=e.slice(t,this.prevI);0!==n.length?(r(n+i),this.text=""):0!==i.length&&r(i)}break r;case 38:this.state=14,this.entityReturnState=13,void 0!==r&&(this.text+=e.slice(t,this.prevI)),n=!0;break r;case -2:void 0!==r&&(this.text+=`${e.slice(t,this.prevI)}
`),t=this.i;break;case -1:void 0!==r&&(this.text+=e.slice(t));break r;default:a(i)||(n=!0)}}n&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(t,e){var r;let{prefix:n,local:i}=this.qname(t),a={name:t,prefix:n,local:i,value:e};if(this.attribList.push(a),null===(r=this.attributeHandler)||void 0===r||r.call(this,a),"xmlns"===n){let t=e.trim();"1.0"===this.currentXMLVersion&&""===t&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[i]=t,N(this,i,t)}else if("xmlns"===t){let t=e.trim();this.topNS[""]=t,N(this,"",t)}}pushAttribPlain(t,e){var r;let n={name:t,value:e};this.attribList.push(n),null===(r=this.attributeHandler)||void 0===r||r.call(this,n)}end(){var t,e;this.sawRoot||this.fail("document must contain a root element.");let{tags:r}=this;for(;r.length>0;){let t=r.pop();this.fail(`unclosed tag: ${t.name}`)}0!==this.state&&13!==this.state&&this.fail("unexpected end.");let{text:n}=this;return 0!==n.length&&(null===(t=this.textHandler)||void 0===t||t.call(this,n),this.text=""),this._closed=!0,null===(e=this.endHandler)||void 0===e||e.call(this),this._init(),this}resolve(t){var e,r;let n=this.topNS[t];if(void 0!==n)return n;let{tags:i}=this;for(let e=i.length-1;e>=0;e--)if(void 0!==(n=i[e].ns[t]))return n;return void 0!==(n=this.ns[t])?n:null===(r=(e=this.opt).resolvePrefix)||void 0===r?void 0:r.call(e,t)}qname(t){let e=t.indexOf(":");if(-1===e)return{prefix:"",local:t};let r=t.slice(e+1),n=t.slice(0,e);return(""===n||""===r||r.includes(":"))&&this.fail(`malformed name: ${t}.`),{prefix:n,local:r}}processAttribsNS(){var t;let{attribList:e}=this,r=this.tag;{let{prefix:e,local:n}=this.qname(r.name);r.prefix=e,r.local=n;let i=r.uri=null!==(t=this.resolve(e))&&void 0!==t?t:"";""!==e&&("xmlns"===e&&this.fail('tags may not have "xmlns" as prefix.'),""===i&&(this.fail(`unbound namespace prefix: ${JSON.stringify(e)}.`),r.uri=e))}if(0===e.length)return;let{attributes:n}=r,i=new Set;for(let t of e){let e,r;let{name:a,prefix:o,local:s}=t;""===o?(e="xmlns"===a?v:"",r=a):(void 0===(e=this.resolve(o))&&(this.fail(`unbound namespace prefix: ${JSON.stringify(o)}.`),e=o),r=`{${e}}${s}`),i.has(r)&&this.fail(`duplicate attribute: ${r}.`),i.add(r),t.uri=e,n[a]=t}this.attribList=[]}processAttribsPlain(){let{attribList:t}=this,e=this.tag.attributes;for(let{name:r,value:n}of t)void 0!==e[r]&&this.fail(`duplicate attribute: ${r}.`),e[r]=n;this.attribList=[]}openTag(){var t;this.processAttribs();let{tags:e}=this,r=this.tag;r.isSelfClosing=!1,null===(t=this.openTagHandler)||void 0===t||t.call(this,r),e.push(r),this.state=13,this.name=""}openSelfClosingTag(){var t,e,r;this.processAttribs();let{tags:n}=this,i=this.tag;i.isSelfClosing=!0,null===(t=this.openTagHandler)||void 0===t||t.call(this,i),null===(e=this.closeTagHandler)||void 0===e||e.call(this,i),null===(this.tag=null!==(r=n[n.length-1])&&void 0!==r?r:null)&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){let{tags:t,name:e}=this;if(this.state=13,this.name="",""===e){this.fail("weird empty close tag."),this.text+="</>";return}let r=this.closeTagHandler,n=t.length;for(;n-- >0;){let n=this.tag=t.pop();if(this.topNS=n.ns,null==r||r(n),n.name===e)break;this.fail("unexpected close tag.")}0===n?this.closedRoot=!0:n<0&&(this.fail(`unmatched closing tag: ${e}.`),this.text+=`</${e}>`)}parseEntity(t){if("#"!==t[0]){let e=this.ENTITIES[t];return void 0!==e?e:(this.fail(this.isName(t)?"undefined entity.":"disallowed character in entity name."),`&${t};`)}let e=NaN;return("x"===t[1]&&/^#x[0-9a-f]+$/i.test(t)?e=parseInt(t.slice(2),16):/^#[0-9]+$/.test(t)&&(e=parseInt(t.slice(1),10)),this.isChar(e))?String.fromCodePoint(e):(this.fail("malformed character entity."),`&${t};`)}}}),v("bCNQP",function(t,e){function r(t){return t>=65&&t<=90||t>=97&&t<=122||58===t||95===t||8204===t||8205===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}/**
 * Character classes and associated utilities for the 5th edition of XML 1.0.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.CHAR="	\n\r --\uD800\uDC00-\uDBFF\uDFFF",t.exports.S=" 	\r\n",t.exports.NAME_START_CHAR=":A-Z_a-z----------\uD800\uDC00-\uDB7F\uDFFF",t.exports.NAME_CHAR="-"+t.exports.NAME_START_CHAR+".0-9--",t.exports.CHAR_RE=RegExp("^["+t.exports.CHAR+"]$","u"),t.exports.S_RE=RegExp("^["+t.exports.S+"]+$","u"),t.exports.NAME_START_CHAR_RE=RegExp("^["+t.exports.NAME_START_CHAR+"]$","u"),t.exports.NAME_CHAR_RE=RegExp("^["+t.exports.NAME_CHAR+"]$","u"),t.exports.NAME_RE=RegExp("^["+t.exports.NAME_START_CHAR+"]["+t.exports.NAME_CHAR+"]*$","u"),t.exports.NMTOKEN_RE=RegExp("^["+t.exports.NAME_CHAR+"]+$","u"),t.exports.S_LIST=[32,10,13,9],t.exports.isChar=function(t){return t>=32&&t<=55295||10===t||13===t||9===t||t>=57344&&t<=65533||t>=65536&&t<=1114111},t.exports.isS=function(t){return 32===t||10===t||13===t||9===t},t.exports.isNameStartChar=r,t.exports.isNameChar=function(t){return r(t)||t>=48&&t<=57||45===t||46===t||183===t||t>=768&&t<=879||t>=8255&&t<=8256}}),v("hnsSo",function(t,e){function r(t){return t>=65&&t<=90||t>=97&&t<=122||58===t||95===t||8204===t||8205===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}/**
 * Character classes and associated utilities for the 2nd edition of XML 1.1.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.CHAR="\x01--\uD800\uDC00-\uDBFF\uDFFF",t.exports.RESTRICTED_CHAR="\x01-\b\v\f\x0e-\x1f--",t.exports.S=" 	\r\n",t.exports.NAME_START_CHAR=":A-Z_a-z----------\uD800\uDC00-\uDB7F\uDFFF",t.exports.NAME_CHAR="-"+t.exports.NAME_START_CHAR+".0-9--",t.exports.CHAR_RE=RegExp("^["+t.exports.CHAR+"]$","u"),t.exports.RESTRICTED_CHAR_RE=RegExp("^["+t.exports.RESTRICTED_CHAR+"]$","u"),t.exports.S_RE=RegExp("^["+t.exports.S+"]+$","u"),t.exports.NAME_START_CHAR_RE=RegExp("^["+t.exports.NAME_START_CHAR+"]$","u"),t.exports.NAME_CHAR_RE=RegExp("^["+t.exports.NAME_CHAR+"]$","u"),t.exports.NAME_RE=RegExp("^["+t.exports.NAME_START_CHAR+"]["+t.exports.NAME_CHAR+"]*$","u"),t.exports.NMTOKEN_RE=RegExp("^["+t.exports.NAME_CHAR+"]+$","u"),t.exports.S_LIST=[32,10,13,9],t.exports.isChar=function(t){return t>=1&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111},t.exports.isRestrictedChar=function(t){return t>=1&&t<=8||11===t||12===t||t>=14&&t<=31||t>=127&&t<=132||t>=134&&t<=159},t.exports.isCharAndNotRestricted=function(t){return 9===t||10===t||13===t||t>31&&t<127||133===t||t>159&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111},t.exports.isS=function(t){return 32===t||10===t||13===t||9===t},t.exports.isNameStartChar=r,t.exports.isNameChar=function(t){return r(t)||t>=48&&t<=57||45===t||46===t||183===t||t>=768&&t<=879||t>=8255&&t<=8256}}),v("652lH",function(t,e){function r(t){return t>=65&&t<=90||95===t||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}/**
 * Character class utilities for XML NS 1.0 edition 3.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.NC_NAME_START_CHAR="A-Z_a-z-----------\uD800\uDC00-\uDB7F\uDFFF",t.exports.NC_NAME_CHAR="-"+t.exports.NC_NAME_START_CHAR+".0-9--",t.exports.NC_NAME_START_CHAR_RE=RegExp("^["+t.exports.NC_NAME_START_CHAR+"]$","u"),t.exports.NC_NAME_CHAR_RE=RegExp("^["+t.exports.NC_NAME_CHAR+"]$","u"),t.exports.NC_NAME_RE=RegExp("^["+t.exports.NC_NAME_START_CHAR+"]["+t.exports.NC_NAME_CHAR+"]*$","u"),t.exports.isNCNameStartChar=r,t.exports.isNCNameChar=function(t){return r(t)||45===t||46===t||t>=48&&t<=57||183===t||t>=768&&t<=879||t>=8255&&t<=8256}}),v("3c9Jd",function(t,e){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.ParseError=void 0,t.exports.ParseError=class extends Error{constructor(t,e){let r=t.saxParser;super(t.trackPosition?`Line ${r.line} column ${r.column+1}: ${e}`:e)}}}),v("3XGlj",function(t,e){var r=t.exports&&t.exports.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=t.exports&&t.exports.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(t.exports,"__esModule",{value:!0}),n(y("f8gKv"),t.exports)}),v("f8gKv",function(t,e){var r,n;Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.validateIri=t.exports.IriValidationStrategy=void 0;let i=function(){let t="[!$&'()*+,;=]",e="%[a-fA-F0-9]{2}",r="([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",n=`${r}\\.${r}\\.${r}\\.${r}`,i="[a-fA-F0-9]{1,4}",a=`(${i}:${i}|${n})`,o=`((${i}:){6}${a}|::(${i}:){5}${a}|(${i})?::(${i}:){4}${a}|((${i}:){0,1}${i})?::(${i}:){3}${a}|((${i}:){0,2}${i})?::(${i}:){2}${a}|((${i}:){0,3}${i})?::${i}:${a}|((${i}:){0,4}${i})?::${a}|((${i}:){0,5}${i})?::${i}|((${i}:){0,6}${i})?::)`,s=`v[a-fA-F0-9]+\\.(${t}|${t}|":)+`,l=`\\[(${o}|${s})\\]`,u=`\u{E000}-\u{F8FF}\u{F0000}-\u{FFFFD}\u{100000}-\u{10FFFD}`,h=`[${u}]`,d=`\u{A0}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFEF}\u{10000}-\u{1FFFD}\u{20000}-\u{2FFFD}\u{30000}-\u{3FFFD}\u{40000}-\u{4FFFD}\u{50000}-\u{5FFFD}\u{60000}-\u{6FFFD}\u{70000}-\u{7FFFD}\u{80000}-\u{8FFFD}\u{90000}-\u{9FFFD}\u{A0000}-\u{AFFFD}\u{B0000}-\u{BFFFD}\u{C0000}-\u{CFFFD}\u{D0000}-\u{DFFFD}\u{E1000}-\u{EFFFD}`,c=`a-zA-Z0-9\\-._~${d}`,f=`[${c}]`,p=`(${f}|${e}|${t}|[:@])*`,g=`(${p}|[\\/?])*`,y=`(${p}|${h}|[\\/?])*`,v=`(${p})+`,m=`(${p})*`,b=`${v}(\\/${m})*`,x=`\\/(${v}(\\/${m})*)?`,E=`(\\/${m})*`,w=`(${f}|${e}|${t})*`,_=`(${l}|${n}|${w})`,S=`(${f}|${e}|${t}|:)*`,k=`(${S}@)?${_}(:[0-9]*)?`,N=`(\\/\\/${k}${E}|${x}|${b}|)`;return RegExp(`^[a-zA-Z][a-zA-Z0-9+\\-.]*:${N}(\\?${y})?(#${g})?$`,"u")}(),a=/^[A-Za-z][\d+-.A-Za-z]*:[^\u0000-\u0020"<>\\^`{|}]*$/u;(n=r=t.exports.IriValidationStrategy||(t.exports.IriValidationStrategy={})).Strict="strict",n.Pragmatic="pragmatic",n.None="none",t.exports.validateIri=function(t,e=r.Strict){switch(e){case r.Strict:return i.test(t)?void 0:Error(`Invalid IRI according to RFC 3987: '${t}'`);case r.Pragmatic:return a.test(t)?void 0:Error(`Invalid IRI according to RDF Turtle: '${t}'`);case r.None:return;default:return Error(`Not supported validation strategy "${e}"`)}}}),v("2eDEB",function(t,e){n(t.exports,"Shape",()=>tk),n(t.exports,"AbstractRendererPlugin",()=>tO),n(t.exports,"AbstractRenderer",()=>tT),n(t.exports,"AABB",()=>tD),n(t.exports,"Point",()=>tB),n(t.exports,"ERROR_MSG_METHOD_NOT_IMPLEMENTED",()=>tV),n(t.exports,"getAngle",()=>t$),n(t.exports,"createVec3",()=>tH),n(t.exports,"deg2rad",()=>tq),n(t.exports,"rad2deg",()=>tK),n(t.exports,"CameraType",()=>t5),n(t.exports,"Camera",()=>t7),n(t.exports,"UnitType",()=>ea),n(t.exports,"GradientType",()=>ev),n(t.exports,"computeLinearGradient",()=>eI),n(t.exports,"computeRadialGradient",()=>eP),n(t.exports,"isPattern",()=>e$),n(t.exports,"isCSSRGB",()=>eU),n(t.exports,"getOrCalculatePathTotalLength",()=>rt),n(t.exports,"parseTransform",()=>rx),n(t.exports,"propertyMetadataCache",()=>rD),n(t.exports,"isBrowser",()=>r2),n(t.exports,"findClosestClipPathTarget",()=>r6),n(t.exports,"setDOMSize",()=>r5),n(t.exports,"isFillOrStrokeAffected",()=>nt),n(t.exports,"runtime",()=>iv),n(t.exports,"parsedTransformToMat4",()=>nS),n(t.exports,"FederatedEvent",()=>nj),n(t.exports,"FederatedPointerEvent",()=>nB),n(t.exports,"CustomEvent",()=>nV),n(t.exports,"Node",()=>nU),n(t.exports,"OffscreenCanvasCreator",()=>nW),n(t.exports,"RenderReason",()=>nq),n(t.exports,"ElementEvent",()=>nJ),n(t.exports,"MutationEvent",()=>nZ),n(t.exports,"isDisplayObject",()=>ik),n(t.exports,"DisplayObject",()=>iA),n(t.exports,"Circle",()=>iC),n(t.exports,"CustomElement",()=>iI),n(t.exports,"Ellipse",()=>iP),n(t.exports,"Group",()=>iD),n(t.exports,"HTML",()=>ij),n(t.exports,"Image",()=>iF),n(t.exports,"Line",()=>iz),n(t.exports,"Path",()=>iG),n(t.exports,"Polygon",()=>iU),n(t.exports,"Polyline",()=>iW),n(t.exports,"Rect",()=>iq),n(t.exports,"Text",()=>iK),n(t.exports,"Document",()=>iJ),n(t.exports,"CanvasEvent",()=>i3),n(t.exports,"Canvas",()=>i7);/*!
 * @antv/g-lite
 * @description A core module for rendering engine implements DOM API.
 * @version 2.2.6
 * @date 11/25/2024, 1:44:49 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var r,i,a,o,s,l,u,h,d,p,g,v,m,b,x,E,w,_,S,k,N,O,T,M,A,C,R=y("cbdLd"),I=y("fu0YK"),P=y("lR7jo"),D=y("fUHKi"),L=y("jLNr1"),j=y("f8wIT"),F=y("02Ztr"),B=y("3vRz3"),z=y("bDSmI"),V=y("3iqbd"),G=y("k1dpP"),$=y("6BoVD"),U=y("eIStk"),H=y("jxhwV");y("bnGdl");var W=y("8hhuV"),q=y("lIA8Y"),Y=y("aoFex"),K=y("gAC5x"),X=y("bqypU"),J=y("3O2w1"),Z=y("ctnG0"),Q=y("iJzUi"),tt=y("1uF5a"),te=y("2LrCM"),tr=y("ky7aH"),tn=y("geZBG"),ti=y("jyI49"),ta=y("dFv1j"),to=y("6JKSc"),ts=y("kVcyu"),tl=y("aFcWQ"),tu=y("bFgqX"),th=y("04Wz9"),td=y("fo9PZ"),tc=y("dnxxK"),tf=y("7Tbfw"),tp=y("6kBPW"),tg=y("g5Zhu"),ty=y("dPop6"),tv=y("bYoiY"),tm=y("11s8J"),tb=y("8HV7i"),tx=y("fOd0O"),tE=y("8QL5z"),tw=y("gZU1N"),t_=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==c||"undefined"!=typeof self&&self,{exports:{}});r=function(){function t(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function e(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function n(t,e){i(t,0,t.children.length,e,t)}function i(t,e,r,n,i){i||(i=c(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<r;o++){var s=t.children[o];a(i,t.leaf?n(s):s)}return i}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function o(t,e){return t.minX-e.minX}function s(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function c(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function f(r,n,i,a,o){for(var s=[n,i];s.length;)if(!((i=s.pop())-(n=s.pop())<=a)){var l=n+Math.ceil((i-n)/a/2)*a;(function e(r,n,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,l=n-i+1,u=Math.log(s),h=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*h*(s-h)/s)*(l-s/2<0?-1:1),c=Math.max(i,Math.floor(n-l*h/s+d)),f=Math.min(a,Math.floor(n+(s-l)*h/s+d));e(r,n,c,f,o)}var p=r[n],g=i,y=a;for(t(r,i,n),o(r[a],p)>0&&t(r,i,a);g<y;){for(t(r,g,y),g++,y--;0>o(r[g],p);)g++;for(;o(r[y],p)>0;)y--}0===o(r[i],p)?t(r,i,y):t(r,++y,a),y<=n&&(i=y+1),n<=y&&(a=y-1)}})(r,l,n||0,i||r.length-1,o||e),s.push(n,l,l,i)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,r=[];if(!d(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var a=0;a<e.children.length;a++){var o=e.children[a],s=e.leaf?n(o):o;d(t,s)&&(e.leaf?r.push(o):h(t,s)?this._all(o,r):i.push(o))}e=i.pop()}return r},r.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],a=e.leaf?this.toBBox(i):i;if(d(t,a)){if(e.leaf||h(t,a))return!0;r.push(i)}}e=r.pop()}return!1},r.prototype.load=function(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length){if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}}else this.data=r;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=c([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var r,n,i,a=this.data,o=this.toBBox(t),s=[],l=[];a||s.length;){if(a||(a=s.pop(),n=s[s.length-1],r=l.pop(),i=!0),a.leaf){var u=function(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return -1}(t,a.children,e);if(-1!==u){a.children.splice(u,1),s.push(a),this._condense(s);break}}!i&&!a.leaf&&h(a,o)?(s.push(a),l.push(r),r=0,n=a,a=a.children[0]):n?(r++,a=n.children[r],i=!1):a=null}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},r.prototype._build=function(t,e,r,i){var a,o=r-e+1,s=this._maxEntries;if(o<=s)return n(a=c(t.slice(e,r+1)),this.toBBox),a;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(a=c([])).leaf=!1,a.height=i;var l=Math.ceil(o/s),u=l*Math.ceil(Math.sqrt(s));f(t,e,r,u,this.compareMinX);for(var h=e;h<=r;h+=u){var d=Math.min(h+u-1,r);f(t,h,d,l,this.compareMinY);for(var p=h;p<=d;p+=l){var g=Math.min(p+l-1,d);a.children.push(this._build(t,p,g,i-1))}}return n(a,this.toBBox),a},r.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=1/0,a=1/0,o=void 0,s=0;s<e.children.length;s++){var u=e.children[s],h=l(u),d=(Math.max(u.maxX,t.maxX)-Math.min(u.minX,t.minX))*(Math.max(u.maxY,t.maxY)-Math.min(u.minY,t.minY))-h;d<a?(a=d,i=h<i?h:i,o=u):d===a&&h<i&&(i=h,o=u)}e=o||e.children[0]}return e},r.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(n,this.data,e,i);for(o.children.push(t),a(o,n);e>=0;)if(i[e].children.length>this._maxEntries)this._split(i,e),e--;else break;this._adjustParentBBoxes(n,i,e)},r.prototype._split=function(t,e){var r=t[e],i=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,i);var o=this._chooseSplitIndex(r,a,i),s=c(r.children.splice(o,r.children.length-o));s.height=r.height,s.leaf=r.leaf,n(r,this.toBBox),n(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(r,s)},r.prototype._splitRoot=function(t,e){this.data=c([t,e]),this.data.height=t.height+1,this.data.leaf=!1,n(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,r){for(var n,a=1/0,o=1/0,s=e;s<=r-e;s++){var u=i(t,0,s,this.toBBox),h=i(t,s,r,this.toBBox),d=function(t,e){var r=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY);return Math.max(0,Math.min(t.maxX,e.maxX)-r)*Math.max(0,Math.min(t.maxY,e.maxY)-n)}(u,h),c=l(u)+l(h);d<a?(a=d,n=s,o=c<o?c:o):d===a&&c<o&&(o=c,n=s)}return n||r-e},r.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:o,i=t.leaf?this.compareMinY:s;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},r.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var o=this.toBBox,s=i(t,0,e,o),l=i(t,r-e,r,o),h=u(s)+u(l),d=e;d<r-e;d++){var c=t.children[d];a(s,t.leaf?o(c):c),h+=u(s)}for(var f=r-e-1;f>=e;f--){var p=t.children[f];a(l,t.leaf?o(p):p),h+=u(l)}return h},r.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)a(e[n],t)},r.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():n(t[e],this.toBBox)},r},t_.exports=r();var tS=t_.exports,tk=((i={}).GROUP="g",i.FRAGMENT="fragment",i.CIRCLE="circle",i.ELLIPSE="ellipse",i.IMAGE="image",i.RECT="rect",i.LINE="line",i.POLYLINE="polyline",i.POLYGON="polygon",i.TEXT="text",i.PATH="path",i.HTML="html",i.MESH="mesh",i),tN=((a={})[a.ZERO=0]="ZERO",a[a.NEGATIVE_ONE=1]="NEGATIVE_ONE",a),tO=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.plugins=[]},[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(e){var r=t.context.renderingPlugins.indexOf(e);r>=0&&t.context.renderingPlugins.splice(r,1)})}}]),tT=/*@__PURE__*/f(P)(function t(e){/*@__PURE__*/f(I)(this,t),this.clipSpaceNearZ=tN.NEGATIVE_ONE,this.plugins=[],this.config=/*@__PURE__*/f(R)({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},e)},[{key:"registerPlugin",value:function(t){-1===this.plugins.findIndex(function(e){return e===t})&&this.plugins.push(t)}},{key:"unregisterPlugin",value:function(t){var e=this.plugins.findIndex(function(e){return e===t});e>-1&&this.plugins.splice(e,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(t){return this.plugins.find(function(e){return e.name===t})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(t){Object.assign(this.config,t)}}]),tM=U.add,tA=U.copy,tC=U.max,tR=U.min,tI=U.scale,tP=U.sub,tD=/*#__PURE__*/function(){function t(){/*@__PURE__*/f(I)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return /*@__PURE__*/f(P)(t,[{key:"update",value:function(t,e){tA(this.center,t),tA(this.halfExtents,e),tP(this.min,this.center,this.halfExtents),tM(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,e){tM(this.center,e,t),tI(this.center,this.center,.5),tP(this.halfExtents,e,t),tI(this.halfExtents,this.halfExtents,.5),tA(this.min,t),tA(this.max,e)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var r=this.center,n=r[0],i=r[1],a=r[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],h=n-s,d=n+s,c=i-l,f=i+l,p=a-u,g=a+u,y=e.center,v=y[0],m=y[1],b=y[2],x=e.halfExtents,E=x[0],w=x[1],_=x[2],S=v-E,k=v+E,N=m-w,O=m+w,T=b-_,M=b+_;S<h&&(h=S),k>d&&(d=k),N<c&&(c=N),O>f&&(f=O),T<p&&(p=T),M>g&&(g=M),r[0]=(h+d)*.5,r[1]=(c+f)*.5,r[2]=(p+g)*.5,o[0]=(d-h)*.5,o[1]=(f-c)*.5,o[2]=(g-p)*.5,this.min[0]=h,this.min[1]=c,this.min[2]=p,this.max[0]=d,this.max[1]=f,this.max[2]=g}}},{key:"setFromTransformedAABB",value:function(t,e){var r=this.center,n=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],h=e[5],d=e[9],c=e[2],f=e[6],p=e[10],g=Math.abs(o),y=Math.abs(s),v=Math.abs(l),m=Math.abs(u),b=Math.abs(h),x=Math.abs(d),E=Math.abs(c),w=Math.abs(f),_=Math.abs(p);r[0]=e[12]+o*i[0]+s*i[1]+l*i[2],r[1]=e[13]+u*i[0]+h*i[1]+d*i[2],r[2]=e[14]+c*i[0]+f*i[1]+p*i[2],n[0]=g*a[0]+y*a[1]+v*a[2],n[1]=m*a[0]+b*a[1]+x*a[2],n[2]=E*a[0]+w*a[1]+_*a[2],tP(this.min,r,n),tM(this.max,r,n)}},{key:"intersects",value:function(t){var e=this.getMax(),r=this.getMin(),n=t.getMax(),i=t.getMin();return r[0]<=n[0]&&e[0]>=i[0]&&r[1]<=n[1]&&e[1]>=i[1]&&r[2]<=n[2]&&e[2]>=i[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var r=new t,n=tC([0,0,0],this.getMin(),e.getMin()),i=tR([0,0,0],this.getMax(),e.getMax());return r.setMinMax(n,i),r}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?tA([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?tA([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]}}])}(),tL=/*@__PURE__*/f(P)(function t(e,r){/*@__PURE__*/f(I)(this,t),this.distance=e||0,this.normal=r||U.fromValues(0,1,0),this.updatePNVertexFlag()},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return U.dot(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/U.len(this.normal);U.scale(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,e,r){var n=this.distanceToPoint(t),i=n/(n-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&r&&U.lerp(r,t,e,i),a}}]),tj=((o={})[o.OUTSIDE=0xffffffff]="OUTSIDE",o[o.INSIDE=0]="INSIDE",o[o.INDETERMINATE=0x7fffffff]="INDETERMINATE",o),tF=/*@__PURE__*/f(P)(function t(e){if(/*@__PURE__*/f(I)(this,t),this.planes=[],e)this.planes=e;else for(var r=0;r<6;r++)this.planes.push(new tL)},[{key:"extractFromVPMatrix",value:function(t){var e=/*@__PURE__*/f(F)(t,16),r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],h=e[8],d=e[9],c=e[10],p=e[11],g=e[12],y=e[13],v=e[14],m=e[15];U.set(this.planes[0].normal,a-r,u-o,p-h),this.planes[0].distance=m-g,U.set(this.planes[1].normal,a+r,u+o,p+h),this.planes[1].distance=m+g,U.set(this.planes[2].normal,a+n,u+s,p+d),this.planes[2].distance=m+y,U.set(this.planes[3].normal,a-n,u-s,p-d),this.planes[3].distance=m-y,U.set(this.planes[4].normal,a-i,u-l,p-c),this.planes[4].distance=m-v,U.set(this.planes[5].normal,a+i,u+l,p+c),this.planes[5].distance=m+v,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag()})}}]),tB=/*#__PURE__*/function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;/*@__PURE__*/f(I)(this,t),this.x=0,this.y=0,this.x=e,this.y=r}return /*@__PURE__*/f(P)(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),tz=/*#__PURE__*/function(){function t(e,r,n,i){/*@__PURE__*/f(I)(this,t),this.x=e,this.y=r,this.width=n,this.height=i,this.left=e,this.right=e+n,this.top=r,this.bottom=r+i}return /*@__PURE__*/f(P)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,r){var n=H.fromValues(e.x,e.y,0,1),i=H.fromValues(e.x+e.width,e.y,0,1),a=H.fromValues(e.x,e.y+e.height,0,1),o=H.fromValues(e.x+e.width,e.y+e.height,0,1),s=H.create(),l=H.create(),u=H.create(),h=H.create();H.transformMat4(s,n,r),H.transformMat4(l,i,r),H.transformMat4(u,a,r),H.transformMat4(h,o,r);var d=Math.min(s[0],l[0],u[0],h[0]),c=Math.min(s[1],l[1],u[1],h[1]),f=Math.max(s[0],l[0],u[0],h[0]),p=Math.max(s[1],l[1],u[1],h[1]);return t.fromRect({x:d,y:c,width:f-d,height:p-c})}}])}(),tV="Method not implemented.",tG="Use document.documentElement instead.";function t$(t){return void 0===t?0:t>360||t<-360?t%360:t}var tU=U.create();function tH(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?n?U.clone(t):U.copy(tU,t):(0,ti.default)(t)?n?U.fromValues(t,e,r):U.set(tU,t,e,r):n?U.fromValues(t[0],t[1]||e,t[2]||r):U.set(tU,t[0],t[1]||e,t[2]||r)}var tW=Math.PI/180;function tq(t){return t*tW}var tY=180/Math.PI;function tK(t){return t*tY}var tX=Math.PI/2;function tJ(t,e){var r,n,i,a,o,s,l,u,h,d,c,p,g,y,v,m,b;return 16===e.length?(i=V.getScaling(U.create(),e),o=(a=/*@__PURE__*/f(F)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<tX?u>-tX?(r=Math.atan2(e[6]/s,e[10]/l),n=Math.atan2(e[1]/o,e[0]/o)):(n=0,r=-Math.atan2(e[4]/s,e[5]/s)):(n=0,r=Math.atan2(e[4]/s,e[5]/s)),t[0]=r,t[1]=u,t[2]=n):(h=e[0],d=e[1],c=e[2],p=e[3],m=h*h+(g=d*d)+(y=c*c)+(v=p*p),(b=h*p-d*c)>.499995*m?(t[0]=tX,t[1]=2*Math.atan2(d,h),t[2]=0):b<-.499995*m?(t[0]=-tX,t[1]=2*Math.atan2(d,h),t[2]=0):(t[0]=Math.asin(2*(h*c-p*d)),t[1]=Math.atan2(2*(h*p+d*c),1-2*(y+v)),t[2]=Math.atan2(2*(h*d+c*p),1-2*(g+y)))),t}function tZ(t){var e=t[0],r=t[1],n=t[3],i=t[4],a=Math.sqrt(e*e+r*r),o=Math.sqrt(n*n+i*i);if(e*i-r*n<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,r*=s}if(o){var l=1/o;n*=l,i*=l}var u=Math.atan2(r,e)*tY;return[t[6],t[7],a,o,u]}var tQ=V.create(),t0=V.create(),t1=H.create(),t2=[U.create(),U.create(),U.create()],t3=U.create();function t6(t,e,r,n,i){t[0]=e[0]*n+r[0]*i,t[1]=e[1]*n+r[1]*i,t[2]=e[2]*n+r[2]*i}var t5=((s={})[s.ORBITING=0]="ORBITING",s[s.EXPLORING=1]="EXPLORING",s[s.TRACKING=2]="TRACKING",s),t4=((l={})[l.DEFAULT=0]="DEFAULT",l[l.ROTATIONAL=1]="ROTATIONAL",l[l.TRANSLATIONAL=2]="TRANSLATIONAL",l[l.CINEMATIC=3]="CINEMATIC",l),t8=((u={})[u.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",u[u.PERSPECTIVE=1]="PERSPECTIVE",u),t9={UPDATED:"updated"},t7=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.clipSpaceNearZ=tN.NEGATIVE_ONE,this.eventEmitter=new/*@__PURE__*/(f(B)),this.matrix=V.create(),this.right=U.fromValues(1,0,0),this.up=U.fromValues(0,1,0),this.forward=U.fromValues(0,0,1),this.position=U.fromValues(0,0,1),this.focalPoint=U.fromValues(0,0,0),this.distanceVector=U.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=V.create(),this.projectionMatrixInverse=V.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=t5.EXPLORING,this.trackingMode=t4.DEFAULT,this.projectionMode=t8.PERSPECTIVE,this.frustum=new tF,this.orthoMatrix=V.create()},[{key:"isOrtho",value:function(){return this.projectionMode===t8.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,e){return this.type=t,this.type===t5.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===t5.TRACKING&&void 0!==e&&this.setTrackingMode(e),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==t5.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return V.invert(V.create(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,e){var r=V.fromTranslation(V.create(),[t,e,0]);this.jitteredProjectionMatrix=V.multiply(V.create(),r,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===t8.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===t8.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,e,r,n,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.projectionMode===t8.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===t8.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===t8.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===t8.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,e){var r=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),n=r.x,i=r.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(n,i),this.setFocalPoint(n,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=U.fromValues(s-n,l-i,0),h=U.dot(u,this.right)/U.length(this.right),d=U.dot(u,this.up)/U.length(this.up),c=this.getPosition(),p=/*@__PURE__*/f(F)(c,2),g=p[0],y=p[1],v=this.getFocalPoint(),m=/*@__PURE__*/f(F)(v,2),b=m[0],x=m[1];return this.setPosition(g-h,y-d),this.setFocalPoint(b-h,x-d),this}},{key:"setPerspective",value:function(t,e,r,n){this.projectionMode=t8.PERSPECTIVE,this.fov=r,this.near=t,this.far=e,this.aspect=n;var i,a=this.near*Math.tan(.5*this.fov*tW)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,h=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/h,s*=this.view.width/u,o*=this.view.height/h}return function(t,e,r,n,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],h=2*a,d=r-e,c=n-i,f=o-a,p=o*a;u?(s=-o/f,l=-p/f):(s=-(o+a)/f,l=-2*p/f),t[0]=h/d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h/c,t[6]=0,t[7]=0,t[8]=(r+e)/d,t[9]=(n+i)/c,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===tN.ZERO),V.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,e,r,n,i,a){this.projectionMode=t8.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=r,this.bottom=n,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,d=u-s,c=u+s,f=h+l,p=h-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=g*this.view.offsetX,c=d+g*this.view.width,f-=y*this.view.offsetY,p=f-y*this.view.height}return this.clipSpaceNearZ===tN.NEGATIVE_ONE?V.ortho(this.projectionMatrix,d,c,f,p,i,a):V.orthoZO(this.projectionMatrix,d,c,f,p,i,a),V.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],n=tH(t,e,r);return this._setPosition(n),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],n=U.fromValues(0,1,0);if(this.focalPoint=tH(t,e,r),this.trackingMode===t4.CINEMATIC){var i=U.subtract(U.create(),this.focalPoint,this.position);t=i[0],e=i[1],r=i[2];var a=Math.asin(e/U.length(i))*tY,o=90+Math.atan2(r,t)*tY,s=V.create();V.rotateY(s,s,o*tW),V.rotateX(s,s,a*tW),n=U.transformMat4(U.create(),[0,1,0],s)}return V.invert(this.matrix,V.lookAt(V.create(),this.position,this.focalPoint,n)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=U.create();t=this.distance;var r=this.forward,n=this.focalPoint;return e[0]=t*r[0]+n[0],e[1]=t*r[1]+n[1],e[2]=t*r[2]+n[2],this._setPosition(e),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=t$(t),this.computeMatrix(),this._getAxes(),this.type===t5.ORBITING||this.type===t5.EXPLORING?this._getPosition():this.type===t5.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=t$(t),this.computeMatrix(),this._getAxes(),this.type===t5.ORBITING||this.type===t5.EXPLORING?this._getPosition():this.type===t5.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=t$(t),this.computeMatrix(),this._getAxes(),this.type===t5.ORBITING||this.type===t5.EXPLORING?this._getPosition():this.type===t5.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=G.setAxisAngle(G.create(),[0,0,1],this.roll*tW);V.identity(this.matrix);var e=G.setAxisAngle(G.create(),[1,0,0],(this.rotateWorld&&this.type!==t5.TRACKING||this.type===t5.TRACKING?1:-1)*this.elevation*tW),r=G.setAxisAngle(G.create(),[0,1,0],(this.rotateWorld&&this.type!==t5.TRACKING||this.type===t5.TRACKING?1:-1)*this.azimuth*tW),n=G.multiply(G.create(),r,e);n=G.multiply(G.create(),n,t);var i=V.fromQuat(V.create(),n);this.type===t5.ORBITING||this.type===t5.EXPLORING?(V.translate(this.matrix,this.matrix,this.focalPoint),V.multiply(this.matrix,this.matrix,i),V.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===t5.TRACKING&&(V.translate(this.matrix,this.matrix,this.position),V.multiply(this.matrix,this.matrix,i))}},{key:"_setPosition",value:function(t,e,r){this.position=tH(t,e,r);var n=this.matrix;n[12]=this.position[0],n[13]=this.position[1],n[14]=this.position[2],n[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){U.copy(this.right,tH(H.transformMat4(H.create(),[1,0,0,0],this.matrix))),U.copy(this.up,tH(H.transformMat4(H.create(),[0,1,0,0],this.matrix))),U.copy(this.forward,tH(H.transformMat4(H.create(),[0,0,1,0],this.matrix))),U.normalize(this.right,this.right),U.normalize(this.up,this.up),U.normalize(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],r=this.distanceVector[2],n=U.length(this.distanceVector);if(0===n){this.elevation=0,this.azimuth=0;return}this.type===t5.TRACKING?(this.elevation=Math.asin(e/n)*tY,this.azimuth=Math.atan2(-t,-r)*tY):this.rotateWorld?(this.elevation=Math.asin(e/n)*tY,this.azimuth=Math.atan2(-t,-r)*tY):(this.elevation=-(Math.asin(e/n)*tY),this.azimuth=-(Math.atan2(-t,-r)*tY))}},{key:"_getPosition",value:function(){U.copy(this.position,tH(H.transformMat4(H.create(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){U.transformMat3(this.distanceVector,[0,0,-this.distance],z.fromMat4(z.create(),this.matrix)),U.add(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=U.subtract(U.create(),this.focalPoint,this.position),this.distance=U.length(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===t8.ORTHOGRAPHIC){var t=this.position,e=G.setAxisAngle(G.create(),[0,0,1],-this.roll*Math.PI/180);V.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,U.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),U.fromValues(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=V.multiply(V.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(t9.UPDATED)}}},{key:"rotate",value:function(t,e,r){throw Error(tV)}},{key:"pan",value:function(t,e){throw Error(tV)}},{key:"dolly",value:function(t){throw Error(tV)}},{key:"createLandmark",value:function(t,e){throw Error(tV)}},{key:"gotoLandmark",value:function(t,e){throw Error(tV)}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tV)}}]),et=((h={})[h.Standard=0]="Standard",h),ee=((d={})[d.ADDED=0]="ADDED",d[d.REMOVED=1]="REMOVED",d[d.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",d),er={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tz(0,0,0,0)},en=((p={}).COORDINATE="<coordinate>",p.COLOR="<color>",p.PAINT="<paint>",p.NUMBER="<number>",p.ANGLE="<angle>",p.OPACITY_VALUE="<opacity-value>",p.SHADOW_BLUR="<shadow-blur>",p.LENGTH="<length>",p.PERCENTAGE="<percentage>",p.LENGTH_PERCENTAGE="<length> | <percentage>",p.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",p.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",p.LIST_OF_POINTS="<list-of-points>",p.PATH="<path>",p.FILTER="<filter>",p.Z_INDEX="<z-index>",p.OFFSET_DISTANCE="<offset-distance>",p.DEFINED_PATH="<defined-path>",p.MARKER="<marker>",p.TRANSFORM="<transform>",p.TRANSFORM_ORIGIN="<transform-origin>",p.TEXT="<text>",p.TEXT_TRANSFORM="<text-transform>",p);function ei(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var r=function(){for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=r.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return r.cache=s.set(o,l)||s,l};return r.cache=new(ei.Cache||Map),r}ei.Cache=Map;var ea=((g={})[g.kUnknown=0]="kUnknown",g[g.kNumber=1]="kNumber",g[g.kPercentage=2]="kPercentage",g[g.kEms=3]="kEms",g[g.kPixels=4]="kPixels",g[g.kRems=5]="kRems",g[g.kDegrees=6]="kDegrees",g[g.kRadians=7]="kRadians",g[g.kGradians=8]="kGradians",g[g.kTurns=9]="kTurns",g[g.kMilliseconds=10]="kMilliseconds",g[g.kSeconds=11]="kSeconds",g[g.kInteger=12]="kInteger",g),eo=((v={})[v.kUNumber=0]="kUNumber",v[v.kUPercent=1]="kUPercent",v[v.kULength=2]="kULength",v[v.kUAngle=3]="kUAngle",v[v.kUTime=4]="kUTime",v[v.kUOther=5]="kUOther",v),es=((m={})[m.kYes=0]="kYes",m[m.kNo=1]="kNo",m),el=((b={})[b.kYes=0]="kYes",b[b.kNo=1]="kNo",b),eu=[{name:"em",unit_type:ea.kEms},{name:"px",unit_type:ea.kPixels},{name:"deg",unit_type:ea.kDegrees},{name:"rad",unit_type:ea.kRadians},{name:"grad",unit_type:ea.kGradians},{name:"ms",unit_type:ea.kMilliseconds},{name:"s",unit_type:ea.kSeconds},{name:"rem",unit_type:ea.kRems},{name:"turn",unit_type:ea.kTurns}],eh=((x={})[x.kUnknownType=0]="kUnknownType",x[x.kUnparsedType=1]="kUnparsedType",x[x.kKeywordType=2]="kKeywordType",x[x.kUnitType=3]="kUnitType",x[x.kSumType=4]="kSumType",x[x.kProductType=5]="kProductType",x[x.kNegateType=6]="kNegateType",x[x.kInvertType=7]="kInvertType",x[x.kMinType=8]="kMinType",x[x.kMaxType=9]="kMaxType",x[x.kClampType=10]="kClampType",x[x.kTransformType=11]="kTransformType",x[x.kPositionType=12]="kPositionType",x[x.kURLImageType=13]="kURLImageType",x[x.kColorType=14]="kColorType",x[x.kUnsupportedColorType=15]="kUnsupportedColorType",x),ed=function(t){switch(t){case ea.kNumber:case ea.kInteger:return eo.kUNumber;case ea.kPercentage:return eo.kUPercent;case ea.kPixels:return eo.kULength;case ea.kMilliseconds:case ea.kSeconds:return eo.kUTime;case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kTurns:return eo.kUAngle;default:return eo.kUOther}},ec=function(t){switch(t){case eo.kUNumber:return ea.kNumber;case eo.kULength:return ea.kPixels;case eo.kUPercent:return ea.kPercentage;case eo.kUTime:return ea.kSeconds;case eo.kUAngle:return ea.kDegrees;default:return ea.kUnknown}},ef=function(t){var e=1;switch(t){case ea.kPixels:case ea.kDegrees:case ea.kSeconds:break;case ea.kMilliseconds:e=.001;break;case ea.kRadians:e=180/Math.PI;break;case ea.kGradians:e=.9;break;case ea.kTurns:e=360}return e},ep=function(t){switch(t){case ea.kNumber:case ea.kInteger:break;case ea.kPercentage:return"%";case ea.kEms:return"em";case ea.kRems:return"rem";case ea.kPixels:return"px";case ea.kDegrees:return"deg";case ea.kRadians:return"rad";case ea.kGradians:return"grad";case ea.kMilliseconds:return"ms";case ea.kSeconds:return"s";case ea.kTurns:return"turn"}return""},eg=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"toString",value:function(){return this.buildCSSText(es.kNo,el.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=eh.kUnitType&&this.getType()<=eh.kClampType}}],[{key:"isAngle",value:function(t){return t===ea.kDegrees||t===ea.kRadians||t===ea.kGradians||t===ea.kTurns}},{key:"isLength",value:function(t){return t>=ea.kEms&&t<ea.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===ea.kPercentage||t===ea.kEms||t===ea.kRems}},{key:"isTime",value:function(t){return t===ea.kSeconds||t===ea.kMilliseconds}}]),ey=/*#__PURE__*/function(t){function e(t){var r;return /*@__PURE__*/f(I)(this,e),(r=/*@__PURE__*/f(L)(this,e)).colorSpace=t,r}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"getType",value:function(){return eh.kColorType}},{key:"to",value:function(t){return this}}])}(eg),ev=((E={})[E.Constant=0]="Constant",E[E.LinearGradient=1]="LinearGradient",E[E.RadialGradient=2]="RadialGradient",E),em=/*#__PURE__*/function(t){function e(t,r){var n;return /*@__PURE__*/f(I)(this,e),(n=/*@__PURE__*/f(L)(this,e)).type=t,n.value=r,n}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(t,e,r){return r}},{key:"getType",value:function(){return eh.kColorType}}])}(eg),eb=/*#__PURE__*/function(t){function e(t){var r;return /*@__PURE__*/f(I)(this,e),(r=/*@__PURE__*/f(L)(this,e)).value=t,r}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return eh.kKeywordType}},{key:"buildCSSText",value:function(t,e,r){return r+this.value}}])}(eg),ex=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e},eE=function(t){return ec(ed(t))},ew=/*#__PURE__*/function(t){function e(t){var r,n,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return /*@__PURE__*/f(I)(this,e),n=/*@__PURE__*/f(L)(this,e),i="string"==typeof a?(r=a)?"number"===r?ea.kNumber:"percent"===r||"%"===r?ea.kPercentage:eu.find(function(t){return t.name===r}).unit_type:ea.kUnknown:a,n.unit=i,n.value=t,n}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit}},{key:"getType",value:function(){return eh.kUnitType}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var r=eE(this.unit);if(r!==eE(t)||r===ea.kUnknown)return null;var n=ef(this.unit)/ef(t);return new e(this.value*n,t)}},{key:"buildCSSText",value:function(t,e,r){var n;switch(this.unit){case ea.kUnknown:break;case ea.kInteger:n=Number(this.value).toFixed(0);break;case ea.kNumber:case ea.kPercentage:case ea.kEms:case ea.kRems:case ea.kPixels:case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kMilliseconds:case ea.kSeconds:case ea.kTurns:var i=this.value,a=ep(this.unit);if(i<-999999||i>999999){var o=ep(this.unit);n=!Number.isFinite(i)||Number.isNaN(i)?ex(i,o):i+(o||"")}else n="".concat(i).concat(a)}return r+n}}])}(eg),e_=new ew(0,"px");new ew(1,"px");var eS=new ew(0,"deg"),ek=/*#__PURE__*/function(t){function e(t,r,n){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return /*@__PURE__*/f(I)(this,e),(i=/*@__PURE__*/f(L)(this,e,["rgb"])).r=t,i.g=r,i.b=n,i.alpha=a,i.isNone=o,i}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,e,r){return"".concat(r,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(ey),eN=new eb("unset"),eO={"":eN,unset:eN,initial:new eb("initial"),inherit:new eb("inherit")},eT=new ek(0,0,0,0,!0),eM=new ek(0,0,0,0),eA=ei(function(t,e,r,n){return new ek(t,e,r,n)},function(t,e,r,n){return"rgba(".concat(t,",").concat(e,",").concat(r,",").concat(n,")")}),eC=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return new ew(t,e)};new ew(50,"%");var eR=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function r(t){throw Error("".concat(e,": ").concat(t))}function n(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s)}function i(e,n,i){return a(n,function(n){var a=i();return a&&!m(t.comma)&&r("Missing comma before color stops"),{type:e,orientation:a,colorStops:c(f)}})}function a(e,n){var i=m(e);if(i){m(t.startCall)||r("Missing (");var a=n(i);return m(t.endCall)||r("Missing )"),a}}function o(){return v("directional",t.sideOrCorner,1)||v("angular",t.angleValue,1)}function s(){var r,n,i=l();return i&&((r=[]).push(i),n=e,m(t.comma)&&((i=l())?r.push(i):e=n)),r}function l(){var t,e,r=((t=v("shape",/^(circle)/i,0))&&(t.style=y()||u()),t||((e=v("shape",/^(ellipse)/i,0))&&(e.style=g()||u()),e));if(r)r.at=h();else{var n=u();if(n){r=n;var i=h();i&&(r.at=i)}else{var a=d();a&&(r={type:"default-radial",at:a})}}return r}function u(){return v("extent-keyword",t.extentKeywords,1)}function h(){if(v("position",/^at/,0)){var t=d();return t||r("Missing positioning value"),t}}function d(){var t={x:g(),y:g()};if(t.x||t.y)return{type:"position",value:t}}function c(e){var n=e(),i=[];if(n)for(i.push(n);m(t.comma);)(n=e())?i.push(n):r("One extra comma");return i}function f(){var e=v("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:c(p)}})||a(t.rgbColor,function(){return{type:"rgb",value:c(p)}})||v("literal",t.literalColor,0);return e||r("Expected color definition"),e.length=g(),e}function p(){return m(t.number)[1]}function g(){return v("%",t.percentageValue,1)||v("position-keyword",t.positionKeywords,1)||y()}function y(){return v("px",t.pixelValue,1)||v("em",t.emValue,1)}function v(t,e,r){var n=m(e);if(n)return{type:t,value:n[r]}}function m(t){var r=/^[\n\r\t\s]+/.exec(e);r&&b(r[0].length);var n=t.exec(e);return n&&b(n[0].length),n}function b(t){e=e.substring(t)}return function(t){var i;return e=t,i=c(n),e.length>0&&r("Invalid input not EOF"),i}}();function eI(t,e,r,n){var i=n.value*tW,a=0+e/2,o=0+r/2,s=Math.abs(e*Math.cos(i))+Math.abs(r*Math.sin(i));return{x1:t[0]+a-Math.cos(i)*s/2,y1:t[1]+o-Math.sin(i)*s/2,x2:t[0]+a+Math.cos(i)*s/2,y2:t[1]+o+Math.sin(i)*s/2}}function eP(t,e,r,n,i,a){var o=n.value,s=i.value;n.unit===ea.kPercentage&&(o=n.value/100*e),i.unit===ea.kPercentage&&(s=i.value/100*r);var l=Math.max((0,Y.distanceSquareRoot)([0,0],[o,s]),(0,Y.distanceSquareRoot)([0,r],[o,s]),(0,Y.distanceSquareRoot)([e,r],[o,s]),(0,Y.distanceSquareRoot)([e,0],[o,s]));return a&&(a instanceof ew?l=a.value:a instanceof eb&&("closest-side"===a.value?l=Math.min(o,e-o,s,r-s):"farthest-side"===a.value?l=Math.max(o,e-o,s,r-s):"closest-corner"===a.value&&(l=Math.min((0,Y.distanceSquareRoot)([0,0],[o,s]),(0,Y.distanceSquareRoot)([0,r],[o,s]),(0,Y.distanceSquareRoot)([e,r],[o,s]),(0,Y.distanceSquareRoot)([e,0],[o,s]))))),{x:o+t[0],y:s+t[1],r:l}}var eD=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,eL=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,ej=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,eF=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eB={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},ez=ei(function(t){return eC("angular"===t.type?Number(t.value):eB[t.value]||0,"deg")}),eV=ei(function(t){var e=50,r=50,n="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?r=0:"bottom"===o.value&&(r=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?r=50:"right"===s.value?e=100:"top"===s.value?r=0:"bottom"===s.value&&(r=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(n=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,r=Number(s.value))}return{cx:eC(e,n),cy:eC(r,i)}}),eG=ei(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eR(t).map(function(t){var e=t.type,r=t.orientation,n=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var r=0,n=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,tn.default)(l)&&!(0,tn.default)(n)){for(var u=1;u<i-r;u++)t[r+u].length={type:"%",value:"".concat(n+(Number(l)-n)*u/(i-r))};r=i,n=Number(l)}}}(n);var i=n.map(function(t){var e,r;return{offset:eC(Number(t.length.value),"%"),color:(e=t.type,r=t.value,"hex"===e?"#".concat(r):"literal"===e?r:"rgb"===e?"rgb(".concat(r.join(","),")"):"rgba(".concat(r.join(","),")"))}});if("linear-gradient"===e)return new em(ev.LinearGradient,{angle:r?ez(r):eS,steps:i});if("radial-gradient"===e&&(r||(r=[{type:"shape",value:"circle"}]),"shape"===r[0].type&&"circle"===r[0].value)){var a,o=eV(r[0].at),s=o.cx,l=o.cy;if(r[0].style){var u=r[0].style,h=u.type,d=u.value;"extent-keyword"===h?(eO[d]||(eO[d]=new eb(d)),a=eO[d]):a=eC(d,h)}return new em(ev.RadialGradient,{cx:s,cy:l,size:a,steps:i})}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var r=eD.exec(t);if(r){var n,i=(null===(n=r[2].match(eF))||void 0===n?void 0:n.map(function(t){return t.split(":")}))||[];return[new em(ev.LinearGradient,{angle:eC(parseFloat(r[1]),"deg"),steps:i.map(function(t){var e=/*@__PURE__*/f(F)(t,2),r=e[0],n=e[1];return{offset:eC(100*Number(r),"%"),color:n}})})]}}else if("r"===e){var a=function(t){var e=eL.exec(t);if(e){var r,n=(null===(r=e[4].match(eF))||void 0===r?void 0:r.map(function(t){return t.split(":")}))||[];return{cx:eC(50,"%"),cy:eC(50,"%"),steps:n.map(function(t){var e=/*@__PURE__*/f(F)(t,2),r=e[0],n=e[1];return{offset:eC(100*Number(r),"%"),color:n}})}}return null}(t);if(a){if(!(0,ts.default)(a))return[new em(ev.RadialGradient,a)];t=a}}else if("p"===e)return function(t){var e=ej.exec(t);if(e){var r=e[1],n=e[2];switch(r){case"a":r="repeat";break;case"x":r="repeat-x";break;case"y":r="repeat-y";break;default:r="no-repeat"}return{image:n,repetition:r}}return null}(t)}});function e$(t){return t&&!!t.image}function eU(t){return t&&!(0,tn.default)(t.r)&&!(0,tn.default)(t.g)&&!(0,tn.default)(t.b)}var eH=ei(function(t){if(e$(t))return /*@__PURE__*/f(R)({repetition:"repeat"},t);if((0,tn.default)(t)&&(t=""),"transparent"===t)return eM;if("currentColor"===t)t="black";else if("none"===t)return eT;var e=eG(t);if(e)return e;var r=tv.default(t),n=[0,0,0,0];return null!==r&&(n[0]=r.r||0,n[1]=r.g||0,n[2]=r.b||0,n[3]=r.opacity),eA.apply(void 0,n)});function eW(t,e){if(eU(t)&&eU(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var r=0;r<3;r++)e[r]=Math.round((0,W.default)(e[r],0,255));return e[3]=(0,W.default)(e[3],0,1),"rgba(".concat(e.join(","),")")}]}function eq(t,e){if((0,tn.default)(e))return eC(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eC(Number(e),"px");if("deg".search(t)>=0)return eC(Number(e),"deg")}var r=[];e=e.replace(t,function(t){return r.push(t),"U".concat(t)});var n="U(".concat(t.source,")");return r.map(function(t){return eC(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(n,"g"),"*0")),t)})[0]}var eY=function(t){return eq(/px/g,t)},eK=ei(eY);ei(function(t){return eq(RegExp("%","g"),t)});var eX=function(t){return(0,ti.default)(t)||isFinite(Number(t))?eC(Number(t)||0,"px"):eq(RegExp("px|%|em|rem","g"),t)},eJ=ei(eX),eZ=function(t){return eq(RegExp("deg|rad|grad|turn","g"),t)},eQ=ei(eZ);function e0(t){var e=0;return t.unit===ea.kDegrees?e=t.value:t.unit===ea.kRadians?e=Number(t.value)*tY:t.unit===ea.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e}function e1(t,e){var r;return(Array.isArray(t)?r=t.map(function(t){return Number(t)}):(0,ts.default)(t)?r=t.split(" ").map(function(t){return Number(t)}):(0,ti.default)(t)&&(r=[t]),2===e)?1===r.length?[r[0],r[0]]:[r[0],r[1]]:1===r.length?[r[0],r[0],r[0],r[0]]:2===r.length?[r[0],r[1],r[0],r[1]]:3===r.length?[r[0],r[1],r[2],r[1]]:[r[0],r[1],r[2],r[3]]}function e2(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===ea.kPixels)return Number(t.value);if(t.unit===ea.kPercentage&&r){var i=r.nodeName===tk.GROUP?r.getLocalBounds():r.getGeometryBounds();return(n?i.min[e]:0)+t.value/100*i.halfExtents[e]*2}return 0}var e3=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e6(t){return t.toString()}var e5=function(t){return"number"==typeof t?eC(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eC(Number(t)):eC(0)},e4=ei(e5);function e8(t,e){return[t,e,e6]}function e9(t,e){return function(r,n){return[r,n,function(r){return e6((0,W.default)(r,t,e))}]}}function e7(t,e){if(t.length===e.length)return[t,e,function(t){return t}]}function rt(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,Q.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength}function re(t,e){return t[0]===e[0]&&t[1]===e[1]}function rr(t,e){var r=t.prePoint,n=t.currentPoint,i=t.nextPoint,a=Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2),o=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),s=Math.acos((a+o-(Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,ta.default)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-n[1],i[0]-n[0])),u=Math.abs(Math.atan2(i[0]-n[0],i[1]-n[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0}}function rn(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}ei(function(t){return(0,ts.default)(t)?t.split(" ").map(e4):t.map(e4)});var ri=function(t,e){var r=t.x*e.x+t.y*e.y,n=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(r/n)},ra=function(t,e,r,n,i,a,o,s){e=Math.abs(e),r=Math.abs(r);var l=(n=(0,td.default)(n,360))*tW;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===r)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,h=(t.y-o.y)/2,d={x:Math.cos(l)*u+Math.sin(l)*h,y:-Math.sin(l)*u+Math.cos(l)*h},c=Math.pow(d.x,2)/Math.pow(e,2)+Math.pow(d.y,2)/Math.pow(r,2);c>1&&(e*=Math.sqrt(c),r*=Math.sqrt(c));var f=(Math.pow(e,2)*Math.pow(r,2)-Math.pow(e,2)*Math.pow(d.y,2)-Math.pow(r,2)*Math.pow(d.x,2))/(Math.pow(e,2)*Math.pow(d.y,2)+Math.pow(r,2)*Math.pow(d.x,2)),p=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),g={x:p*(e*d.y/r),y:p*(-(r*d.x)/e)},y={x:Math.cos(l)*g.x-Math.sin(l)*g.y+(t.x+o.x)/2,y:Math.sin(l)*g.x+Math.cos(l)*g.y+(t.y+o.y)/2},v={x:(d.x-g.x)/e,y:(d.y-g.y)/r},m=ri({x:1,y:0},v),b=ri(v,{x:(-d.x-g.x)/e,y:(-d.y-g.y)/r});!a&&b>0?b-=2*Math.PI:a&&b<0&&(b+=2*Math.PI);var x=m+(b%=2*Math.PI)*s,E=e*Math.cos(x),w=r*Math.sin(x);return{x:Math.cos(l)*E-Math.sin(l)*w+y.x,y:Math.sin(l)*E+Math.cos(l)*w+y.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+b,ellipticalArcAngle:x,ellipticalArcCenter:y,resultantRx:e,resultantRy:r}};function ro(t,e){var r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=t.arcParams,i=n.rx,a=void 0===i?0:i,o=n.ry,s=void 0===o?0:o,l=n.xRotation,u=n.arcFlag,h=n.sweepFlag,d=ra({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!h,{x:t.currentPoint[0],y:t.currentPoint[1]},e),c=ra({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!h,{x:t.currentPoint[0],y:t.currentPoint[1]},r?e+.005:e-.005),f=c.x-d.x,p=c.y-d.y,g=Math.sqrt(f*f+p*p);return{x:-f/g,y:-p/g}}function rs(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function rl(t,e){return rs(t)*rs(e)?(t[0]*e[0]+t[1]*e[1])/(rs(t)*rs(e)):1}function ru(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(rl(t,e))}var rh=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,tc.normalizePath)(t)}catch(r){e=(0,tc.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}!function(t){for(var e=0;e<t.length;e++){var r=t[e-1],n=t[e];if("M"===n[0]&&r){var i=r[0],a=[n[1],n[2]],o=void 0;"L"===i||"M"===i?o=[r[1],r[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[r[r.length-2],r[r.length-1]]),o&&re(a,o)&&(t.splice(e,1),e--)}}}(e);var e,r=function(t){for(var e=!1,r=t.length,n=0;n<r;n++){var i=t[n][0];if("C"===i||"A"===i||"Q"===i){e=!0;break}}return e}(e),n=function(t){for(var e=[],r=[],n=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(n.length&&(r.push(n),n=[]),n.push([a[1],a[2]])):"Z"===o?n.length&&(e.push(n),n=[]):n.push([a[1],a[2]])}return n.length>0&&r.push(n),{polygons:e,polylines:r}}(e),i=n.polygons,a=n.polylines,o=function(t){for(var e=[],r=null,n=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];n=t[s+1];var u=l[0],h={command:u,prePoint:r,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var d=function(t,e){var r=e[1],n=e[2],i=(0,td.default)(e[3]*tW,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],h=e[7],d=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-h)/2,c=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-h)/2,f=d*d/(r*r)+c*c/(n*n);f>1&&(r*=Math.sqrt(f),n*=Math.sqrt(f));var p=r*r*(c*c)+n*n*(d*d),g=p?Math.sqrt((r*r*(n*n)-p)/p):1;a===o&&(g*=-1),isNaN(g)&&(g=0);var y=n?g*r*c/n:0,v=r?-(g*n)*d/r:0,m=(s+u)/2+Math.cos(i)*y-Math.sin(i)*v,b=(l+h)/2+Math.sin(i)*y+Math.cos(i)*v,x=[(d-y)/r,(c-v)/n],E=[(-1*d-y)/r,(-1*c-v)/n],w=ru([1,0],x),_=ru(x,E);return -1>=rl(x,E)&&(_=Math.PI),rl(x,E)>=1&&(_=0),0===o&&_>0&&(_-=2*Math.PI),1===o&&_<0&&(_+=2*Math.PI),{cx:m,cy:b,rx:re(t,[u,h])?0:r,ry:re(t,[u,h])?0:n,startAngle:w,endAngle:w+_,xRotation:i,arcFlag:a,sweepFlag:o}}(r,l);h.arcParams=d}if("Z"===u)r=i,n=t[a+1];else{var c=l.length;r=[l[c-2],l[c-1]]}n&&"Z"===n[0]&&(n=t[a],e[a]&&(e[a].prePoint=r)),h.currentPoint=r,e[a]&&re(r,e[a].currentPoint)&&(e[a].prePoint=h.prePoint);var f=n?[n[n.length-2],n[n.length-1]]:null;h.nextPoint=f;var p=h.prePoint;if(["L","H","V"].includes(u))h.startTangent=[p[0]-r[0],p[1]-r[1]],h.endTangent=[r[0]-p[0],r[1]-p[1]];else if("Q"===u){var g=[l[1],l[2]];h.startTangent=[p[0]-g[0],p[1]-g[1]],h.endTangent=[r[0]-g[0],r[1]-g[1]]}else if("T"===u){var y=e[s-1],v=rn(y.currentPoint,p);"Q"===y.command?(h.command="Q",h.startTangent=[p[0]-v[0],p[1]-v[1]],h.endTangent=[r[0]-v[0],r[1]-v[1]]):(h.command="TL",h.startTangent=[p[0]-r[0],p[1]-r[1]],h.endTangent=[r[0]-p[0],r[1]-p[1]])}else if("C"===u){var m=[l[1],l[2]],b=[l[3],l[4]];h.startTangent=[p[0]-m[0],p[1]-m[1]],h.endTangent=[r[0]-b[0],r[1]-b[1]],0===h.startTangent[0]&&0===h.startTangent[1]&&(h.startTangent=[m[0]-b[0],m[1]-b[1]]),0===h.endTangent[0]&&0===h.endTangent[1]&&(h.endTangent=[b[0]-m[0],b[1]-m[1]])}else if("S"===u){var x=e[s-1],E=rn(x.currentPoint,p),w=[l[1],l[2]];"C"===x.command?(h.command="C",h.startTangent=[p[0]-E[0],p[1]-E[1]]):(h.command="SQ",h.startTangent=[p[0]-w[0],p[1]-w[1]]),h.endTangent=[r[0]-w[0],r[1]-w[1]]}else if("A"===u){var _=ro(h,0),S=_.x,k=_.y,N=ro(h,1,!1),O=N.x,T=N.y;h.startTangent=[S,k],h.endTangent=[O,T]}e.push(h)}return e}(e),s=function(t,e){for(var r=[],n=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,h=void 0;switch(o.command){case"Q":h=(0,tm.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":h=(0,tm.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var d=o.arcParams;h=(0,tm.arcBox)(d.cx,d.cy,d.rx,d.ry,d.xRotation,d.startAngle,d.endAngle);break;default:r.push(s[0]),n.push(s[1])}h&&(o.box=h,r.push(h.x,h.x+h.width),n.push(h.y,h.y+h.height))}r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0}),n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0});var c=(0,th.default)(r),f=(0,th.default)(n),p=(0,tu.default)(r),g=(0,tu.default)(n);if(0===i.length)return{x:c,y:f,width:p-c,height:g-f};for(var y=0;y<i.length;y++){var v=i[y],m=v.currentPoint;m[0]===c?c-=rr(v,0).xExtra:m[0]===p&&(p+=rr(v,0).xExtra),m[1]===f?f-=rr(v,e).yExtra:m[1]===g&&(g+=rr(v,e).yExtra)}return{x:c,y:f,width:p-c,height:g-f}}(o,0),l=s.x,u=s.y,h=s.width,d=s.height;return{absolutePath:e,hasArc:r,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(h)?h:0,height:Number.isFinite(d)?d:0}}},rd=ei(rh);function rc(t){return(0,ts.default)(t)?rd(t):rh(t)}function rf(t,e,r){var n=t.curve,i=e.curve;n&&0!==n.length||(n=(0,tf.path2Curve)(t.absolutePath,!1),t.curve=n),i&&0!==i.length||(i=(0,tf.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[n,i];n.length!==i.length&&(a=(0,K.equalizeSegments)(n,i));var o=(0,X.getDrawDirection)(a[0])!==(0,X.getDrawDirection)(a[1])?(0,tp.reverseCurve)(a[0]):(0,q.clonePath)(a[0]);return[o,(0,Z.getRotatedCurve)(a[1],o),function(t){return t}]}function rp(t,e){return[t.points,e.points,function(t){return t}]}var rg=/\s*(\w+)\(([^)]*)\)/g;function ry(t){return function(e){var r=0;return t.map(function(t){return null===t?e[r++]:t})}}function rv(t){return t}var rm={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],rv],matrix3d:["NNNNNNNNNNNNNNNN",rv],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",ry([null,null,new ew(1)]),rv],scaleX:["N",ry([null,new ew(1),new ew(1)]),ry([null,new ew(1)])],scaleY:["N",ry([new ew(1),null,new ew(1)]),ry([new ew(1),null])],scaleZ:["N",ry([new ew(1),new ew(1),null])],scale3d:["NNN",rv],skew:["Aa",null,rv],skewX:["A",null,ry([null,eS])],skewY:["A",null,ry([eS,null])],translate:["Tt",ry([null,null,e_]),rv],translateX:["T",ry([null,e_,e_]),ry([null,e_])],translateY:["T",ry([e_,null,e_]),ry([e_,null])],translateZ:["L",ry([e_,e_,null])],translate3d:["TTL",rv]};function rb(t){for(var e=[],r=t.length,n=0;n<r;n++){var i=t[n],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!rm[a])return[];var s=o.map(function(t){return eC(t)});e.push({t:a,d:s})}return e}function rx(t){if(Array.isArray(t))return rb(t);if("none"===(t=(t||"none").trim()))return[];var e,r=[],n=0;for(rg.lastIndex=0;(e=rg.exec(t))&&e.index===n;){n=e.index+e[0].length;var i=e[1],a=rm[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var h=o[u],d=s[u],c=void 0;if(void 0===(c=h?({A:function(t){return"0"===t.trim()?eS:eQ(t)},N:e4,T:eJ,L:eK})[d.toUpperCase()](h):({a:eS,n:l[0],t:e_})[d]))return[];l.push(c)}if(r.push({t:i,d:l}),rg.lastIndex===t.length)return r}return[]}function rE(t){if(Array.isArray(t))return rb(t);if("none"===(t=(t||"none").trim()))return[];var e,r=[],n=0;for(rg.lastIndex=0;(e=rg.exec(t))&&e.index===n;){n=e.index+e[0].length;var i=e[1],a=rm[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var h=o[u],d=s[u],c=void 0;if(void 0===(c=h?({A:function(t){return"0"===t.trim()?eS:eZ(t)},N:e5,T:eX,L:eY})[d.toUpperCase()](h):({a:eS,n:l[0],t:e_})[d]))return[];l.push(c)}if(r.push({t:i,d:l}),rg.lastIndex===t.length)return r}return[]}function rw(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=e0(t.d[0])*tW),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=e0(t.d[0])*tW),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=e0(t.d[0])*tW),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,r=t.d[1].value,n=t.d[2].value,i=e0(t.d[3])*tW;var e,r,n,i,a=e*e+r*r+n*n;if(0===a)e=1,r=0,n=0;else if(1!==a){var o=Math.sqrt(a);e/=o,r/=o,n/=o}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(r*r+n*n)*u,2*(e*r*u+n*l),2*(e*n*u-r*l),0,2*(e*r*u-n*l),1-2*(e*e+n*n)*u,2*(r*n*u+e*l),0,2*(e*n*u+r*l),2*(r*n*u-e*l),1-2*(e*e+r*r)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var h=e0(t.d[0])*tW;return[1,Math.tan(e0(t.d[1])*tW),0,0,Math.tan(h),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=e0(t.d[0])*tW),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=e0(t.d[0])*tW),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e2(t.d[0],0,null)||0,r=e2(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e2(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,r=e2(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,n=e2(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e2(t.d[0],0,null)||0,r=e2(t.d[1],0,null)||0,n=e2(t.d[2],0,null)||0,1];case"perspective":var d=e2(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,d?-1/d:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value})}}function r_(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function rS(t){var e=[0,0,0],r=[1,1,1],n=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return function(t,e,r,n,i,a){if(!(!function(t,e){var r=e[15];if(0===r)return!1;for(var n=1/r,i=0;i<16;i++)t[i]=e[i]*n;return!0}(tQ,t)||(V.copy(t0,tQ),t0[3]=0,t0[7]=0,t0[11]=0,t0[15]=1,1e-8>Math.abs(V.determinant(t0))))){var o=tQ[3],s=tQ[7],l=tQ[11],u=tQ[12],h=tQ[13],d=tQ[14],c=tQ[15];if(0!==o||0!==s||0!==l){if(t1[0]=o,t1[1]=s,t1[2]=l,t1[3]=c,!V.invert(t0,t0))return;V.transpose(t0,t0),H.transformMat4(i,t1,t0)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=h,e[2]=d,t2[0][0]=tQ[0],t2[0][1]=tQ[1],t2[0][2]=tQ[2],t2[1][0]=tQ[4],t2[1][1]=tQ[5],t2[1][2]=tQ[6],t2[2][0]=tQ[8],t2[2][1]=tQ[9],t2[2][2]=tQ[10],r[0]=U.length(t2[0]),U.normalize(t2[0],t2[0]),n[0]=U.dot(t2[0],t2[1]),t6(t2[1],t2[1],t2[0],1,-n[0]),r[1]=U.length(t2[1]),U.normalize(t2[1],t2[1]),n[0]/=r[1],n[1]=U.dot(t2[0],t2[2]),t6(t2[2],t2[2],t2[0],1,-n[1]),n[2]=U.dot(t2[1],t2[2]),t6(t2[2],t2[2],t2[1],1,-n[2]),r[2]=U.length(t2[2]),U.normalize(t2[2],t2[2]),n[1]/=r[2],n[2]/=r[2],U.cross(t3,t2[1],t2[2]),0>U.dot(t2[0],t3))for(var f=0;f<3;f++)r[f]*=-1,t2[f][0]*=-1,t2[f][1]*=-1,t2[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+t2[0][0]-t2[1][1]-t2[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-t2[0][0]+t2[1][1]-t2[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-t2[0][0]-t2[1][1]+t2[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+t2[0][0]+t2[1][1]+t2[2][2],0)),t2[2][1]>t2[1][2]&&(a[0]=-a[0]),t2[0][2]>t2[2][0]&&(a[1]=-a[1]),t2[1][0]>t2[0][1]&&(a[2]=-a[2])}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(rw).reduce(r_),e,r,n,i,a),[[e,r,n,a,i]]}var rk=function(){function t(t,e){for(var r=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],n=0;n<4;n++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)r[n][i]+=e[n][a]*t[a][i];return r}return function(e,r,n,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var h=0;h<3;h++)s[3][u]+=e[h]*s[h][u];var d=i[0],c=i[1],f=i[2],p=i[3],g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];g[0][0]=1-2*(c*c+f*f),g[0][1]=2*(d*c-f*p),g[0][2]=2*(d*f+c*p),g[1][0]=2*(d*c+f*p),g[1][1]=1-2*(d*d+f*f),g[1][2]=2*(c*f-d*p),g[2][0]=2*(d*f-c*p),g[2][1]=2*(c*f+d*p),g[2][2]=1-2*(d*d+c*c),s=t(s,g);var y=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];n[2]&&(y[2][1]=n[2],s=t(s,y)),n[1]&&(y[2][1]=0,y[2][0]=n[0],s=t(s,y)),n[0]&&(y[2][0]=0,y[1][0]=n[0],s=t(s,y));for(var v=0;v<3;v++)for(var m=0;m<3;m++)s[v][m]*=r[v];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3])}}();function rN(t){return t.toFixed(6).replace(".000000","")}function rO(t,e){var r,n;return(t.decompositionPair!==e&&(t.decompositionPair=e,r=rS(t)),e.decompositionPair!==t&&(e.decompositionPair=t,n=rS(e)),null===r[0]||null===n[0])?[[!1],[!0],function(r){return r?e[0].d:t[0].d}]:(r[0].push(0),n[0].push(1),[r,n,function(t){var e=function(t,e,r){var n=function(t,e){for(var r=0,n=0;n<t.length;n++)r+=t[n]*e[n];return r}(t,e);n=(0,W.default)(n,-1,1);var i=[];if(1===n)i=t;else for(var a=Math.acos(n),o=1*Math.sin(r*a)/Math.sqrt(1-n*n),s=0;s<4;s++)i.push(t[s]*(Math.cos(r*a)-n*o)+e[s]*o);return i}(r[0][3],n[0][3],t[5]);return rk(t[0],t[1],t[2],e,t[4]).map(rN).join(",")}])}function rT(t){return t.replace(/[XY]/,"")}function rM(t){return t.replace(/(X|Y|Z|3d)?$/,"3d")}function rA(t,e,r){var n=!1;if(!t.length||!e.length){t.length||(n=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var r=t[i],n=r.t,a=r.d,o="scale"===n.substring(0,5)?1:0;e.push({t:n,d:a.map(function(t){return"number"==typeof t?eC(o):eC(o,t.unit)})})}()}var a=[],o=[],s=[];if(t.length!==e.length){var l=rO(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]]}else for(var u=0;u<t.length;u++){var h=t[u].t,d=e[u].t,c=t[u].d,f=e[u].d,p=rm[h],g=rm[d],y=void 0;if("perspective"===h&&"perspective"===d||("matrix"===h||"matrix3d"===h)&&("matrix"===d||"matrix3d"===d)){var v=rO([t[u]],[e[u]]);a.push(v[0]),o.push(v[1]),s.push(["matrix",[v[2]]]);continue}if(h===d)y=h;else if(p[2]&&g[2]&&rT(h)===rT(d))y=rT(h),c=p[2](c),f=g[2](f);else if(p[1]&&g[1]&&rM(h)===rM(d))y=rM(h),c=p[1](c),f=g[1](f);else{var m=rO(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break}for(var b=[],x=[],E=[],w=0;w<c.length;w++){var _=function(t,e,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=eE(t.unit),u=t.convertTo(l),h=e.convertTo(l);return u&&h?(o=u.value,s=h.value,a=ep(t.unit)):(ew.isLength(t.unit)||ew.isLength(e.unit))&&(o=e2(t,i,r),s=e2(e,i,r),a="px"),[o,s,function(t){return n&&(t=Math.max(t,0)),t+a}]}(c[w],f[w],r,!1,w);b[w]=_[0],x[w]=_[1],E.push(_[2])}a.push(b),o.push(x),s.push([y,E])}if(n){var S=a;a=o,o=S}return[a,o,function(t){return t.map(function(t,e){var r=t.map(function(t,r){return s[e][1][r](t)}).join(",");return"matrix"===s[e][0]&&16===r.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===r.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(r,")")}).join(" ")}]}var rC=ei(function(t){if((0,ts.default)(t)){if("text-anchor"===t)return[eC(0,"px"),eC(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[eJ(rR(e[0])),eJ(rR(e[1]))]}return[eC(t[0]||0,"px"),eC(t[1]||0,"px")]});function rR(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t}var rI=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:en.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:en.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:en.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:en.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:en.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:en.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:en.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:en.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:en.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:en.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:en.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:en.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:en.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:en.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:en.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:en.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:en.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:en.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:en.FILTER},{n:"clipPath",syntax:en.DEFINED_PATH},{n:"textPath",syntax:en.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:en.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:en.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:en.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:en.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:en.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:en.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:en.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:en.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:en.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:en.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:en.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:en.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:en.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:en.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:en.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:en.COORDINATE},{n:"y1",int:!0,l:!0,syntax:en.COORDINATE},{n:"z1",int:!0,l:!0,syntax:en.COORDINATE},{n:"x2",int:!0,l:!0,syntax:en.COORDINATE},{n:"y2",int:!0,l:!0,syntax:en.COORDINATE},{n:"z2",int:!0,l:!0,syntax:en.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:en.PATH,p:50},{n:"points",int:!0,l:!0,syntax:en.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:en.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:en.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:en.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:en.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:en.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:en.NUMBER,d:function(t){return t===tk.PATH||t===tk.POLYGON||t===tk.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:en.MARKER},{n:"markerEnd",syntax:en.MARKER},{n:"markerMid",syntax:en.MARKER},{n:"markerStartOffset",syntax:en.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:en.LENGTH,l:!0,int:!0,d:"0"}],rP=new Set(rI.filter(function(t){return!!t.l}).map(function(t){return t.n})),rD={},rL=/*@__PURE__*/f(P)(function t(e){var r=this;/*@__PURE__*/f(I)(this,t),this.runtime=e,rI.forEach(function(t){r.registerMetadata(t)})},[{key:"registerMetadata",value:function(t){[t.n].concat(/*@__PURE__*/f(D)(t.a||[])).forEach(function(e){rD[e]=t})}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,e){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;(function(t,e){var r=rj(t);for(var n in e)r.has(n)&&(t.parsedStyle[n]=e[n])})(t,e);var o=!!n.forceUpdateGeometry;if(!o){for(var s in e)if(rP.has(s)){o=!0;break}}var l=rj(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=eH(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=eH(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=eH(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var r=/\s*([\w-]+)\(([^)]*)\)/g,n=[],i=0;(t=r.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e3.indexOf(t[1])>-1&&n.push({name:t[1],params:t[2].split(" ").map(function(t){return eq(/deg|rad|grad|turn|px|%/g,t)||eH(t)})}),r.lastIndex===e.length)return n;return[]}(e.filter)),l.has("radius")&&!(0,tn.default)(e.radius)&&(t.parsedStyle.radius=e1(e.radius,4)),l.has("lineDash")&&!(0,tn.default)(e.lineDash)&&(t.parsedStyle.lineDash=e1(e.lineDash,2)),l.has("points")&&e.points&&(t.parsedStyle.points=(r=e.points,{points:(0,ts.default)(r)?r.split(" ").map(function(t){var e=t.split(","),r=/*@__PURE__*/f(F)(e,2),n=r[0],i=r[1];return[Number(n),Number(i)]}):r,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=/*@__PURE__*/f(R)({},er)),l.has("d")&&e.d&&(t.parsedStyle.d=rc(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[en.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,tl.default)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[en.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[en.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=rx(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=rC(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[en.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[en.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[en.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,tn.default)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[en.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,tn.default)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[en.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[en.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[en.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,n.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t))}},{key:"updateGeometry",value:function(t){var e=t.nodeName,r=this.runtime.geometryUpdaterFactory[e];if(r){var n=t.geometry;n.contentBounds||(n.contentBounds=new tD),n.renderBounds||(n.renderBounds=new tD);var i=t.parsedStyle,a=r.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,h=void 0===u?0:u,d=a.hheight,c=void 0===d?0:d,f=a.hdepth,p=[Math.abs(h),Math.abs(c),void 0===f?0:f],g=i.stroke,y=i.lineWidth,v=i.increasedLineWidthForHitTesting,m=i.shadowType,b=void 0===m?"outer":m,x=i.shadowColor,E=i.filter,w=i.transformOrigin,_=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];n.contentBounds.update(_,p);var S=e===tk.POLYLINE||e===tk.POLYGON||e===tk.PATH?Math.SQRT2:.5;if(g&&!g.isNone){var k=(((void 0===y?1:y)||0)+((void 0===v?0:v)||0))*S;p[0]+=k,p[1]+=k}if(n.renderBounds.update(_,p),x&&b&&"inner"!==b){var N=n.renderBounds,O=N.min,T=N.max,M=i.shadowBlur,A=i.shadowOffsetX,C=i.shadowOffsetY,R=M||0,I=A||0,P=C||0,D=O[0]-R+I,L=T[0]+R+I,j=O[1]-R+P,F=T[1]+R+P;O[0]=Math.min(O[0],D),T[0]=Math.max(T[0],L),O[1]=Math.min(O[1],j),T[1]=Math.max(T[1],F),n.renderBounds.setMinMax(O,T)}(void 0===E?[]:E).forEach(function(t){var e=t.name,r=t.params;if("blur"===e){var i=r[0].value;n.renderBounds.update(n.renderBounds.center,U.add(n.renderBounds.halfExtents,n.renderBounds.halfExtents,[i,i,0]))}else if("drop-shadow"===e){var a=r[0].value,o=r[1].value,s=r[2].value,l=n.renderBounds,u=l.min,h=l.max,d=u[0]-s+a,c=h[0]+s+a,f=u[1]-s+o,p=h[1]+s+o;u[0]=Math.min(u[0],d),h[0]=Math.max(h[0],c),u[1]=Math.min(u[1],f),h[1]=Math.max(h[1],p),n.renderBounds.setMinMax(u,h)}}),t.geometry.dirty=!1;var B=c<0,z=(h<0?-1:1)*(w?e2(w[0],0,t,!0):0),V=(B?-1:1)*(w?e2(w[1],1,t,!0):0);(z||V)&&t.setOrigin(z,V)}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===tk.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===tk.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}]);function rj(t){return t.constructor.PARSED_STYLE_LIST}var rF=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.mixer=e8},[{key:"calculator",value:function(t,e,r,n){return e0(r)}}]),rB=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"calculator",value:function(t,e,r,n,i){return r instanceof eb&&(r=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,r,n),"clipPath"===t&&n.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtifyToRoot(t)}),r}}]),rz=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.parser=eH,this.mixer=eW},[{key:"calculator",value:function(t,e,r,n){return r instanceof eb?"none"===r.value?eT:eM:r}}]),rV=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"calculator",value:function(t,e,r){return r instanceof eb?[]:r}}]);function rG(t){var e=t.parsedStyle.fontSize;return(0,tn.default)(e)?null:e}var r$=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.mixer=e8},[{key:"calculator",value:function(t,e,r,n,i){if((0,ti.default)(r))return r;if(!ew.isRelativeUnit(r.unit))return r.value;if(r.unit===ea.kPercentage)return 0;if(r.unit===ea.kEms){if(n.parentNode){var a,o=rG(n.parentNode);if(o)return o*r.value}return 0}if(r.unit===ea.kRems){if(null!=n&&null!==(a=n.ownerDocument)&&void 0!==a&&a.documentElement){var s=rG(n.ownerDocument.documentElement);if(s)return s*r.value}return 0}}}]),rU=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.mixer=e7},[{key:"calculator",value:function(t,e,r){return r.map(function(t){return t.value})}}]),rH=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.mixer=e7},[{key:"calculator",value:function(t,e,r){return r.map(function(t){return t.value})}}]),rW=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"calculator",value:function(t,e,r,n){r instanceof eb&&(r=null);var i,a=null===(i=r)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a}}]),rq=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.mixer=e8},[{key:"calculator",value:function(t,e,r){return r.value}}]),rY=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.mixer=e9(0,1)},[{key:"calculator",value:function(t,e,r){return r.value}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,r=e.offsetPath,n=e.offsetDistance;if(r){var i=r.nodeName;if(i===tk.LINE||i===tk.PATH||i===tk.POLYLINE){var a=r.getPoint(n);a&&t.setLocalPosition(a.x,a.y)}}}}]),rK=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.mixer=e9(0,1)},[{key:"calculator",value:function(t,e,r){return r.value}}]),rX=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.parser=rc,this.mixer=rf},[{key:"calculator",value:function(t,e,r){return r instanceof eb&&"unset"===r.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tz(0,0,0,0)}:r}}]),rJ=/*#__PURE__*//*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.mixer=rp}),rZ=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(I)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(L)(this,e,[].concat(n))).mixer=e9(0,1/0),t}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e)}(r$),rQ=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"calculator",value:function(t,e,r,n){return r instanceof eb?"unset"===r.value?"":r.value:"".concat(r)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}]),r0=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"calculator",value:function(t,e,r,n){var i=n.getAttribute("text");if(i){var a=i;"capitalize"===r.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===r.value?a=i.toLowerCase():"uppercase"===r.value&&(a=i.toUpperCase()),n.parsedStyle.text=a}return r.value}}]),r1=new WeakMap,r2="undefined"!=typeof window&&void 0!==window.document;function r3(t,e){var r=Number(t.parsedStyle.zIndex||0),n=Number(e.parsedStyle.zIndex||0);if(r===n){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e)}}return r-n}function r6(t){var e,r=t;do{if(null===(e=r.parsedStyle)||void 0===e?void 0:e.clipPath)return r;r=r.parentElement}while(null!==r)return null}function r5(t,e,r){r2&&t.style&&(t.style.width=e+"px",t.style.height=r+"px")}function r4(t,e){if(r2)return document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}var r8={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},r9="object"==typeof performance&&performance.now?performance:Date;function r7(t){return t.nodeName===tk.FRAGMENT||t.getRootNode().nodeName===tk.FRAGMENT}function nt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto",e=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=!1,i=!1,a=!!e&&!e.isNone,o=!!r&&!r.isNone;return"visiblepainted"===t||"painted"===t||"auto"===t?(n=a,i=o):"visiblefill"===t||"fill"===t?n=!0:"visiblestroke"===t||"stroke"===t?i=!0:("visible"===t||"all"===t)&&(n=!0,i=!0),[n,i]}var ne=1,nr="object"==typeof self&&self.self===self?self:"object"==typeof c&&c.global===c?c:{},nn=Date.now(),ni={},na=Date.now(),no=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),r=e-na,n=ne++;return ni[n]=t,Object.keys(ni).length>1||setTimeout(function(){na=e;var t=ni;ni={},Object.keys(t).forEach(function(e){return t[e](nr.performance&&"function"==typeof nr.performance.now?nr.performance.now():Date.now()-nn)})},r>16?0:16-r),n},ns=function(t){return"string"!=typeof t?no:""===t?nr.requestAnimationFrame:nr["".concat(t,"RequestAnimationFrame")]},nl=function(t,e){for(var r=0;void 0!==t[r];){if(e(t[r]))return t[r];r+=1}}(["","webkit","moz","ms","o"],function(t){return!!ns(t)}),nu=ns(nl),nh="string"!=typeof nl?function(t){delete ni[t]}:""===nl?nr.cancelAnimationFrame:nr["".concat(nl,"CancelAnimationFrame")]||nr["".concat(nl,"CancelRequestAnimationFrame")];nr.requestAnimationFrame=nu,nr.cancelAnimationFrame=nh;var nd=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.callbacks=[]},[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e)}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e)}))}}]),nc=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.callbacks=[]},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e)}},{key:"promise",value:(w=/*@__PURE__*/f(tx)(/*#__PURE__*//*@__PURE__*/f(tb)().mark(function t(){var e,r,n,i,a=arguments;return /*@__PURE__*/f(tb)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=14;break}return t.next=3,(e=this.callbacks)[0].apply(e,a);case 3:r=t.sent,n=0;case 5:if(!(n<this.callbacks.length-1)){t.next=13;break}return i=this.callbacks[n],t.next=9,i(r);case 9:r=t.sent;case 10:n++,t.next=5;break;case 13:return t.abrupt("return",r);case 14:return t.abrupt("return",null);case 15:case"end":return t.stop()}},t,this)})),function(){return w.apply(this,arguments)})}]),nf=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.callbacks=[]},[{key:"tap",value:function(t,e){this.callbacks.push(e)}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=arguments;this.callbacks.forEach(function(t){t.apply(void 0,n)})}}]),np=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.callbacks=[]},[{key:"tap",value:function(t,e){this.callbacks.push(e)}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];if(this.callbacks.length){for(var n=arguments,i=this.callbacks[0].apply(void 0,n),a=0;a<this.callbacks.length-1;a++)i=(0,this.callbacks[a])(i);return i}return null}}]),ng=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ny=/([\"\'])[^\'\"]+\1/;function nv(t,e,r){return V.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(r),t}var nm=V.create(),nb=V.create(),nx={scale:function(t){V.fromScaling(nm,[t[0].value,t[1].value,1])},scaleX:function(t){V.fromScaling(nm,[t[0].value,1,1])},scaleY:function(t){V.fromScaling(nm,[1,t[0].value,1])},scaleZ:function(t){V.fromScaling(nm,[1,1,t[0].value])},scale3d:function(t){V.fromScaling(nm,[t[0].value,t[1].value,t[2].value])},translate:function(t){V.fromTranslation(nm,[t[0].value,t[1].value,0])},translateX:function(t){V.fromTranslation(nm,[t[0].value,0,0])},translateY:function(t){V.fromTranslation(nm,[0,t[0].value,0])},translateZ:function(t){V.fromTranslation(nm,[0,0,t[0].value])},translate3d:function(t){V.fromTranslation(nm,[t[0].value,t[1].value,t[2].value])},rotate:function(t){V.fromZRotation(nm,e0(t[0])*tW)},rotateX:function(t){V.fromXRotation(nm,e0(t[0])*tW)},rotateY:function(t){V.fromYRotation(nm,e0(t[0])*tW)},rotateZ:function(t){V.fromZRotation(nm,e0(t[0])*tW)},rotate3d:function(t){V.fromRotation(nm,e0(t[3])*tW,[t[0].value,t[1].value,t[2].value])},skew:function(t){nv(nm,t[0].value*tW,t[1].value*tW)},skewX:function(t){nv(nm,t[0].value*tW,0)},skewY:function(t){nv(nm,0,t[0].value*tW)},matrix:function(t){V.set(nm,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1)},matrix3d:function(t){V.set.apply(V,[nm].concat(/*@__PURE__*/f(D)(t.map(function(t){return t.value}))))}},nE=U.fromValues(1,1,1),nw=U.create(),n_={translate:function(t,e){iv.sceneGraphService.setLocalScale(t,nE,!1),iv.sceneGraphService.setLocalEulerAngles(t,nw,void 0,void 0,!1),iv.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),iv.sceneGraphService.dirtifyLocal(t,t.transformable)}};function nS(t,e){if(t.length){if(1===t.length&&n_[t[0].t]){n_[t[0].t](e,t[0].d);return}for(var r=V.identity(nb),n=0;n<t.length;n++){var i=t[n],a=i.t,o=i.d,s=nx[a];s&&(s(o),V.mul(r,r,nm))}e.setLocalTransform(r)}else e.resetLocalTransform();return e.getLocalTransform()}var nk=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.parser=rE,this.mixer=rA},[{key:"calculator",value:function(t,e,r,n){return r instanceof eb?[]:r}},{key:"postProcessor",value:function(t){nS(t.parsedStyle.transform,t)}}]),nN=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===ea.kPixels&&e[1].unit===ea.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds()}}]),nO=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"calculator",value:function(t,e,r,n){return r.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,r=e.renderable,n=e.sortable;r&&(r.dirty=!0),n&&(n.dirty=!0,n.dirtyReason=ee.Z_INDEX_CHANGED)}}}]),nT=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"update",value:function(t,e){var r=t.cx,n=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===r?0:r,cy:void 0===n?0:n,hwidth:a,hheight:a}}}]),nM=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"update",value:function(t,e){var r=t.cx,n=t.cy,i=t.rx,a=t.ry;return{cx:void 0===r?0:r,cy:void 0===n?0:n,hwidth:void 0===i?0:i,hheight:void 0===a?0:a}}}]),nA=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"update",value:function(t){var e=t.x1,r=t.y1,n=t.x2,i=t.y2,a=Math.min(e,n),o=Math.min(r,i),s=(Math.max(e,n)-a)/2,l=(Math.max(r,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l}}}]),nC=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"update",value:function(t){var e=t.d.rect,r=e.x,n=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:r+o,cy:n+s,hwidth:o,hheight:s}}}]),nR=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"update",value:function(t){if(t.points&&(0,tt.default)(t.points.points)){var e=t.points.points,r=Math.min.apply(Math,/*@__PURE__*/f(D)(e.map(function(t){return t[0]}))),n=Math.max.apply(Math,/*@__PURE__*/f(D)(e.map(function(t){return t[0]}))),i=Math.min.apply(Math,/*@__PURE__*/f(D)(e.map(function(t){return t[1]}))),a=Math.max.apply(Math,/*@__PURE__*/f(D)(e.map(function(t){return t[1]}))),o=(n-r)/2,s=(a-i)/2;return{cx:r+o,cy:i+s,hwidth:o,hheight:s}}return{cx:0,cy:0,hwidth:0,hheight:0}}}]),nI=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"update",value:function(t,e){var r=t.x,n=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,ts.default)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===r?0:r)+s/2,cy:(void 0===n?0:n)+l/2,hwidth:s/2,hheight:l/2}}}]),nP=/*@__PURE__*/f(P)(function t(e){/*@__PURE__*/f(I)(this,t),this.globalRuntime=e},[{key:"isReadyToMeasure",value:function(t,e){return t.text}},{key:"update",value:function(t,e){var r,n=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,h=t.dx,d=void 0===h?0:h,c=t.dy,f=void 0===c?0:c,p=t.x,g=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var y=((null==e||null===(r=e.ownerDocument)||void 0===r||null===(r=r.defaultView)||void 0===r?void 0:r.getConfig())||{}).offscreenCanvas,v=this.globalRuntime.textService.measureText(n,t,y);t.metrics=v;var m=v.width,b=v.height,x=m/2,E=b/2,w=(void 0===p?0:p)+x;"center"===a||"middle"===a?w+=s/2-x:("right"===a||"end"===a)&&(w+=s-2*x);var _=(void 0===g?0:g)-E;return"middle"===u?_+=E:"top"===u||"hanging"===u?_+=2*E:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(_+=0),d&&(w+=d),f&&(_+=f),{cx:w,cy:_,hwidth:x,hheight:E}}}]),nD=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0}}}]),nL=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"update",value:function(t,e){var r=t.x,n=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===r?0:r)+a/2,cy:(void 0===n?0:n)+s/2,hwidth:a/2,hheight:s/2}}}]),nj=/*@__PURE__*/f(P)(function t(e){/*@__PURE__*/f(I)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new tB,this.page=new tB,this.canvas=new tB,this.viewport=new tB,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e},[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tV)}}]),nF=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(I)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(L)(this,e,[].concat(n))).client=new tB,t.movement=new tB,t.offset=new tB,t.global=new tB,t.screen=new tB,t}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw Error(tV)}}])}(nj),nB=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(I)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(L)(this,e,[].concat(n))).width=0,t.height=0,t.isPrimary=!1,t}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(nF),nz=/*#__PURE__*/function(t){function e(){return /*@__PURE__*/f(I)(this,e),/*@__PURE__*/f(L)(this,e,arguments)}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(nF),nV=/*#__PURE__*/function(t){function e(t,r){var n;return /*@__PURE__*/f(I)(this,e),(n=/*@__PURE__*/f(L)(this,e,[null])).type=t,n.detail=r,Object.assign(n,r),n}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e)}(nj),nG=new WeakMap,n$=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.emitter=new/*@__PURE__*/(f(B))},[{key:"on",value:function(t,e,r){return this.addEventListener(t,e,r),this}},{key:"addEventListener",value:function(t,e,r){var n=!1,i=!1;if((0,te.default)(r))n=r;else if(r){var a=r.capture;n=void 0!==a&&a;var o=r.once;i=void 0!==o&&o}n&&(t+="capture"),e=(0,tr.default)(e)?e:e.handleEvent;var s=(0,tr.default)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this}},{key:"off",value:function(t,e,r){return t?this.removeEventListener(t,e,r):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,e,r){if(!this.emitter)return this;((0,te.default)(r)?r:null==r?void 0:r.capture)&&(t+="capture"),e=(0,tr.default)(e)?e:null===(n=e)||void 0===n?void 0:n.handleEvent;var n,i=(0,tr.default)(e)?void 0:e;return this.emitter.off(t,e,i),this}},{key:"emit",value:function(t,e){this.dispatchEvent(new nV(t,e))}},{key:"dispatchEvent",value:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=nG.get(this);if(!n&&(n=this.document?this:this.defaultView?this.defaultView:null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView)&&nG.set(this,n),n){if(t.manager=n.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r)}else this.emitter.emit(t.type,t);return!t.defaultPrevented}}]),nU=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(I)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(L)(this,e,[].concat(n))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"textContent",get:function(){var t="";this.nodeName===tk.TEXT&&(t+=this.style.text);var e,r=/*@__PURE__*/f(tE)(this.childNodes);try{for(r.s();!(e=r.n()).done;){var n=e.value;n.nodeName===tk.TEXT?t+=n.nodeValue:t+=n.textContent}}catch(t){r.e(t)}finally{r.f()}return t},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t)}),this.nodeName===tk.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(t){throw Error(tV)}},{key:"lookupNamespaceURI",value:function(t){throw Error(tV)}},{key:"lookupPrefix",value:function(t){throw Error(tV)}},{key:"normalize",value:function(){throw Error(tV)}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var r,n=t,i=this,a=[n],o=[i];null!==(r=n.parentNode)&&void 0!==r?r:i.parentNode;)n=n.parentNode?(a.push(n.parentNode),n.parentNode):n,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(n!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,h=l.length-1;h>=0;h--){var d=l[h],c=s[u+h];if(c!==d){var f=d.parentNode.childNodes;if(f.indexOf(d)<f.indexOf(c)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var r=e.pop();if(!1===t(r))break;for(var n=r.childNodes.length-1;n>=0;n--)e.push(r.childNodes[n])}}}],[{key:"isNode",value:function(t){return!!t.childNodes}}])}(n$);nU.DOCUMENT_POSITION_DISCONNECTED=1,nU.DOCUMENT_POSITION_PRECEDING=2,nU.DOCUMENT_POSITION_FOLLOWING=4,nU.DOCUMENT_POSITION_CONTAINS=8,nU.DOCUMENT_POSITION_CONTAINED_BY=16,nU.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var nH=/*@__PURE__*/f(P)(function t(e,r){var n=this;/*@__PURE__*/f(I)(this,t),this.emitter=new/*@__PURE__*/(f(B)),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=V.create(),this.tmpVec3=U.create(),this.onPointerDown=function(t){var e=n.createPointerEvent(t);if(n.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)n.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var r=2===e.button;n.dispatchEvent(e,r?"rightdown":"mousedown")}n.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),n.freeEvent(e)},this.onPointerUp=function(t){var e=r9.now(),r=n.createPointerEvent(t,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);if(n.dispatchEvent(r,"pointerup"),"touch"===r.pointerType)n.dispatchEvent(r,"touchend");else if("mouse"===r.pointerType||"pen"===r.pointerType){var i=2===r.button;n.dispatchEvent(r,i?"rightup":"mouseup")}var a=n.trackingData(t.pointerId),o=n.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!r.composedPath().includes(o)){for(var l=o;l&&!r.composedPath().includes(l);){if(r.currentTarget=l,n.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType)n.notifyTarget(r,"touchendoutside");else if("mouse"===r.pointerType||"pen"===r.pointerType){var u=2===r.button;n.notifyTarget(r,u?"rightupoutside":"mouseupoutside")}nU.isNode(l)&&(l=l.parentNode)}delete a.pressTargetsByButton[t.button],s=l}if(s){var h,d=n.clonePointerEvent(r,"click");d.target=s,d.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:d.target,timeStamp:e});var c=n.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===d.target&&e-f.timeStamp<c.dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=d.target,f.timeStamp=e,d.detail=f.clickCount,null!==(h=r.detail)&&void 0!==h&&h.preventClick||(n.context.config.useNativeClickEvent||"mouse"!==d.pointerType&&"touch"!==d.pointerType||n.dispatchEvent(d,"click"),n.dispatchEvent(d,"pointertap")),n.freeEvent(d)}n.freeEvent(r)},this.onPointerMove=function(t){var e=n.createPointerEvent(t,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0),r="mouse"===e.pointerType||"pen"===e.pointerType,i=n.trackingData(t.pointerId),a=n.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=n.createPointerEvent(t,o,a||void 0);if(n.dispatchEvent(s,"pointerout"),r&&n.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=n.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,n.notifyTarget(l),r&&n.notifyTarget(l,"mouseleave"),nU.isNode(l.target)&&(l.target=l.target.parentNode);n.freeEvent(l)}n.freeEvent(s)}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",h=n.clonePointerEvent(e,u);n.dispatchEvent(h,"pointerover"),r&&n.dispatchEvent(h,"mouseover");for(var d=a&&nU.isNode(a)&&a.parentNode;d&&d!==(nU.isNode(n.rootTarget)&&n.rootTarget.parentNode)&&d!==e.target;)d=d.parentNode;if(!d||d===(nU.isNode(n.rootTarget)&&n.rootTarget.parentNode)){var c=n.clonePointerEvent(e,"pointerenter");for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==a&&c.target!==(nU.isNode(n.rootTarget)&&n.rootTarget.parentNode);)c.currentTarget=c.target,n.notifyTarget(c),r&&n.notifyTarget(c,"mouseenter"),nU.isNode(c.target)&&(c.target=c.target.parentNode);n.freeEvent(c)}n.freeEvent(h)}n.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&n.dispatchEvent(e,"touchmove"),r&&(n.dispatchEvent(e,"mousemove"),n.cursor=n.getCursor(e.target)),i.overTargets=e.composedPath(),n.freeEvent(e)},this.onPointerOut=function(t){var e=n.trackingData(t.pointerId);if(e.overTargets){var r="mouse"===t.pointerType||"pen"===t.pointerType,i=n.findMountedTarget(e.overTargets),a=n.createPointerEvent(t,"pointerout",i||void 0);n.dispatchEvent(a),r&&n.dispatchEvent(a,"mouseout");var o=n.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(nU.isNode(n.rootTarget)&&n.rootTarget.parentNode);)o.currentTarget=o.target,n.notifyTarget(o),r&&n.notifyTarget(o,"mouseleave"),nU.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,n.freeEvent(a),n.freeEvent(o)}n.cursor=null},this.onPointerOver=function(t){var e=n.trackingData(t.pointerId),r=n.createPointerEvent(t),i="mouse"===r.pointerType||"pen"===r.pointerType;n.dispatchEvent(r,"pointerover"),i&&n.dispatchEvent(r,"mouseover"),"mouse"===r.pointerType&&(n.cursor=n.getCursor(r.target));var a=n.clonePointerEvent(r,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(nU.isNode(n.rootTarget)&&n.rootTarget.parentNode);)a.currentTarget=a.target,n.notifyTarget(a),i&&n.notifyTarget(a,"mouseenter"),nU.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=r.composedPath(),n.freeEvent(r),n.freeEvent(a)},this.onPointerUpOutside=function(t){var e=n.trackingData(t.pointerId),r=n.findMountedTarget(e.pressTargetsByButton[t.button]),i=n.createPointerEvent(t);if(r){for(var a=r;a;)i.currentTarget=a,n.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&n.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),nU.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button]}n.freeEvent(i)},this.onWheel=function(t){var e=n.createWheelEvent(t);n.dispatchEvent(e),n.freeEvent(e)},this.onClick=function(t){if(n.context.config.useNativeClickEvent){var e=n.createPointerEvent(t);n.dispatchEvent(e),n.freeEvent(e)}},this.onPointerCancel=function(t){var e=n.createPointerEvent(t,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);n.dispatchEvent(e),n.freeEvent(e)},this.globalRuntime=e,this.context=r},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,r=1,n=this.context.contextService.getDomElement();if(n&&t){var i=n.offsetWidth,a=n.offsetHeight;i&&a&&(e=t.width/i,r=t.height/a)}return{scaleX:e,scaleY:r,bbox:t}}},{key:"client2Viewport",value:function(t){var e=this.getScale(),r=e.scaleX,n=e.scaleY,i=e.bbox;return new tB((t.x-((null==i?void 0:i.left)||0))/r,(t.y-((null==i?void 0:i.top)||0))/n)}},{key:"viewport2Client",value:function(t){var e=this.getScale(),r=e.scaleX,n=e.scaleY,i=e.bbox;return new tB((t.x+((null==i?void 0:i.left)||0))*r,(t.y+((null==i?void 0:i.top)||0))*n)}},{key:"viewport2Canvas",value:function(t){var e=t.x,r=t.y,n=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=n.getPerspectiveInverse(),l=n.getWorldTransform(),u=V.multiply(this.tmpMatrix,l,s),h=U.set(this.tmpVec3,e/a*2-1,(1-r/o)*2-1,0);return U.transformMat4(h,h,u),new tB(h[0],h[1])}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),r=e.getPerspective(),n=e.getViewTransform(),i=V.multiply(this.tmpMatrix,r,n),a=U.set(this.tmpVec3,t.x,t.y,0);U.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new tB((a[0]+1)/2*s,(1-(a[1]+1)/2)*l)}},{key:"setPickHandler",value:function(t){this.pickHandler=t}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority})}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var r=0,n=e.length;r<n;r++)e[r].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}}},{key:"dispatchEvent",value:function(t,e,r){if(r){t.eventPhase=t.AT_TARGET;var n=this.rootTarget.defaultView||null;t.currentTarget=n,this.notifyListeners(t,e)}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);this.emitter.emit(e||t.type,t)}},{key:"propagate",value:function(t,e){if(t.target){var r=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var n=r.length-1;n>=1;n--)if(t.currentTarget=r[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=r.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<r.length;a++)if(t.currentTarget=r[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){var e=[t],r=this.rootTarget.defaultView||null;if(r&&r===t)return e.unshift(r.document),e;for(var n=0;n<2048&&t!==this.rootTarget;n++)nU.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return r&&e.push(r),e}},{key:"hitTest",value:function(t){var e=t.viewportX,r=t.viewportY,n=this.context.config,i=n.width,a=n.height,o=n.disableHitTesting;return e<0||r<0||e>i||r>a?null:!o&&this.pickHandler(t)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(t,e){var r,n=null==e?void 0:e.target;if(null!==(r=n)&&void 0!==r&&r.shadowRoot&&(n=e.composedPath()[0]),n){if(n===t)return!0;if(t&&t.contains)return t.contains(n)}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,r=t.nativeEvent.composedPath();e<r.length;e++){var n=r[e],i=this.nativeHTMLMap.get(n);if(i)return i}return null}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY})}},{key:"createPointerEvent",value:function(t,e,r,n){var i=this.allocateEvent(nB);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=r?r:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||n,"string"==typeof e&&(i.type=e),i}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(nz);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var r=this.getExistedHTML(e),n=this.context.contextService.getDomElement();return e.target=r||this.isNativeEventFromCanvas(n,e.nativeEvent)&&this.pickTarget(e),e}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(nz);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e}},{key:"clonePointerEvent",value:function(t,e){var r=this.allocateEvent(nB);return r.nativeEvent=t.nativeEvent,r.originalEvent=t.originalEvent,this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.target=t.target,r.path=t.composedPath().slice(),r.type=null!=e?e:r.type,r}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset)}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=r9.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport)}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}},{key:"notifyTarget",value:function(t,e){e=null!==(r=e)&&void 0!==r?r:t.type;var r,n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}},{key:"notifyListeners",value:function(t,e){var r=t.currentTarget.emitter,n=r._events[e];if(n){if("fn"in n)n.once&&r.removeListener(e,n.fn,void 0,!0),n.fn.call(t.currentTarget||n.context,t);else for(var i=0;i<n.length&&!t.propagationImmediatelyStopped;i++)n[i].once&&r.removeListener(e,n[i].fn,void 0,!0),n[i].fn.call(t.currentTarget||n[i].context,t)}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],r=t.length-2;r>=0;r--){var n=t[r];if(n===this.rootTarget||nU.isNode(n)&&n.parentNode===e)e=t[r];else break}return e}},{key:"getCursor",value:function(t){for(var e=t;e;){var r=!!e.getAttribute&&e.getAttribute("cursor");if(r)return r;e=nU.isNode(e)&&e.parentNode}}}]),nW=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||iv.offscreenCanvas)this.canvas=t||iv.offscreenCanvas,this.context=this.canvas.getContext("2d",/*@__PURE__*/f(R)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",/*@__PURE__*/f(R)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",/*@__PURE__*/f(R)({willReadFrequently:!0},e))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(t){}try{return document.createElement("canvas")}catch(t){}return null}}]),nq=((_={})[_.CAMERA_CHANGED=0]="CAMERA_CHANGED",_[_.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",_[_.NONE=2]="NONE",_),nY=/*@__PURE__*/f(P)(function t(e,r){/*@__PURE__*/f(I)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new nf,initAsync:new nd,dirtycheck:new np,cull:new np,beginFrame:new nf,beforeRender:new nf,render:new nf,afterRender:new nf,endFrame:new nf,destroy:new nf,pick:new nc,pickSync:new np,pointerDown:new nf,pointerUp:new nf,pointerMove:new nf,pointerOut:new nf,pointerOver:new nf,pointerWheel:new nf,pointerCancel:new nf,click:new nf},this.globalRuntime=e,this.context=r},[{key:"init",value:function(t){var e=this,r=/*@__PURE__*/f(R)(/*@__PURE__*/f(R)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(r,e.globalRuntime)}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t()}).catch(function(t){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(nq.CAMERA_CHANGED)}},{key:"render",value:function(t,e,r){var n=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var i=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(i.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),i.renderReasons.size&&this.inited){i.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var a=1===i.renderReasons.size&&i.renderReasons.has(nq.CAMERA_CHANGED),o=!t.disableRenderHooks||!(t.disableRenderHooks&&a);o&&this.renderDisplayObject(i.root,t,i),this.hooks.beginFrame.call(e),o&&i.renderListCurrentFrame.forEach(function(t){n.hooks.beforeRender.call(t),n.hooks.render.call(t),n.hooks.afterRender.call(t)}),this.hooks.endFrame.call(e),i.renderListCurrentFrame=[],i.renderReasons.clear(),r()}}},{key:"renderDisplayObject",value:function(t,e,r){for(var n=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||r.dirtyRectangleRenderingDisabled?t:null:t;if(s){var l=o?n.hooks.cull.call(s,n.context.camera):s;l&&(n.stats.rendered+=1,r.renderListCurrentFrame.push(l))}e.dirty=!1,i.renderOrder=n.zIndexCounter,n.zIndexCounter+=1,n.stats.total+=1,i.dirty&&(n.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0)}(l);for(var u=l.sortable.sorted||l.childNodes,h=u.length-1;h>=0;h--)s.push(u[h])}}},{key:"sort",value:function(t,e){e.sorted&&e.dirtyReason!==ee.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(r){if(-1===t.childNodes.indexOf(r)){var n=e.sorted.indexOf(r);n>=0&&e.sorted.splice(n,1)}else if(0===e.sorted.length)e.sorted.push(r);else{var i=function(t,e){for(var r=0,n=t.length;r<n;){var i=r+n>>>1;0>r3(t[i],e)?r=i+1:n=i}return r}(e.sorted,r);e.sorted.splice(i,0,r)}}):e.sorted=t.childNodes.slice().sort(r3)}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(nq.DISPLAY_OBJECT_CHANGED)}}]),nK=/\[\s*(.*)=(.*)\s*\]/,nX=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"selectOne",value:function(t,e){var r=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(r.getIdOrClassname(t))>-1});if(t.startsWith("#"))return e.find(function(e){return e.id===r.getIdOrClassname(t)});if(t.startsWith("[")){var n=this.getAttribute(t),i=n.name,a=n.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:r.attributeToString(t,i)===a)}):null}return e.find(function(r){return e!==r&&r.nodeName===t})}},{key:"selectAll",value:function(t,e){var r=this;if(t.startsWith("."))return e.findAll(function(n){return e!==n&&((null==n?void 0:n.classList)||[]).indexOf(r.getIdOrClassname(t))>-1});if(t.startsWith("#"))return e.findAll(function(n){return e!==n&&n.id===r.getIdOrClassname(t)});if(t.startsWith("[")){var n=this.getAttribute(t),i=n.name,a=n.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:r.attributeToString(t,i)===a)}):[]}return e.findAll(function(r){return e!==r&&r.nodeName===t})}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var r=this.getAttribute(t),n=r.name,i=r.value;return"name"===n?e.name===i:this.attributeToString(e,n)===i}return e.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var e=t.match(nK),r="",n="";return e&&e.length>2&&(r=e[1].replace(/"/g,""),n=e[2].replace(/"/g,"")),{name:r,value:n}}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var r=t.getAttribute(e);return(0,tn.default)(r)?"":r.toString?r.toString():""}}]),nJ=((S={}).REPARENT="reparent",S.DESTROY="destroy",S.ATTR_MODIFIED="DOMAttrModified",S.INSERTED="DOMNodeInserted",S.REMOVED="removed",S.MOUNTED="DOMNodeInsertedIntoDocument",S.UNMOUNTED="DOMNodeRemovedFromDocument",S.BOUNDS_CHANGED="bounds-changed",S.CULLED="culled",S),nZ=/*#__PURE__*/function(t){function e(t,r,n,i,a,o,s,l){var u;return /*@__PURE__*/f(I)(this,e),(u=/*@__PURE__*/f(L)(this,e,[null])).relatedNode=r,u.prevValue=n,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e)}(nj);function nQ(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}nZ.ADDITION=2,nZ.MODIFICATION=1,nZ.REMOVAL=3;var n0=new nZ(nJ.REPARENT,null,"","","",0,"",""),n1=$.create(),n2=U.create(),n3=U.fromValues(1,1,1),n6=V.create(),n5=$.create(),n4=U.create(),n8=V.create(),n9=G.create(),n7=U.create(),it=G.create(),ie=U.create(),ir=U.create(),ii=U.create(),ia=V.create(),io=G.create(),is=G.create(),il=G.create(),iu={affectChildren:!0},ih=/*@__PURE__*/f(P)(function t(e){/*@__PURE__*/f(I)(this,t),this.pendingEvents=new Map,this.boundsChangedEvent=new nV(nJ.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e)}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e)}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e)}},{key:"attach",value:function(t,e,r){var n,i=!1;t.parentNode&&(i=t.parentNode!==e,this.detach(t));var a=t.nodeName===tk.FRAGMENT,o=r7(e);t.parentNode=e;var s=a?t.childNodes:[t];(0,ti.default)(r)?s.forEach(function(t){e.childNodes.splice(r,0,t),t.parentNode=e}):s.forEach(function(t){e.childNodes.push(t),t.parentNode=e});var l=e.sortable;if((null!=l&&null!==(n=l.sorted)&&void 0!==n&&n.length||t.parsedStyle.zIndex)&&(-1===l.dirtyChildren.indexOf(t)&&l.dirtyChildren.push(t),l.dirty=!0,l.dirtyReason=ee.ADDED),!o){if(a)this.dirtifyFragment(t);else{var u=t.transformable;u&&this.dirtifyWorld(t,u)}i&&t.dispatchEvent(n0)}}},{key:"detach",value:function(t){if(t.parentNode){var e,r,n=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(r=t.style)&&void 0!==r&&r.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=ee.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),n&&this.dirtifyWorld(t,n),t.parentNode=null}}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"setOrigin",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,r,n]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtifyLocal(t,i)}}},{key:"rotate",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=U.fromValues(e,r,n));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.fromEuler(n9,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);G.copy(il,o),G.invert(il,il),G.multiply(n9,il,n9),G.multiply(i.localRotation,n9,a),G.normalize(i.localRotation,i.localRotation),this.dirtifyLocal(t,i)}else this.rotateLocal(t,e)}},{key:"rotateLocal",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=U.fromValues(e,r,n));var i=t.transformable;G.fromEuler(is,e[0],e[1],e[2]),G.mul(i.localRotation,i.localRotation,is),this.dirtifyLocal(t,i)}},{key:"setEulerAngles",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=U.fromValues(e,r,n));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);G.copy(io,G.invert(n9,a)),G.mul(i.localRotation,i.localRotation,io),this.dirtifyLocal(t,i)}else this.setLocalEulerAngles(t,e)}},{key:"setLocalEulerAngles",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=U.fromValues(e,r,n));var a=t.transformable;G.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtifyLocal(t,a)}},{key:"translateLocal",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=U.fromValues(e,r,n));var i=t.transformable;U.equals(e,n2)||(U.transformQuat(e,e,i.localRotation),U.add(i.localPosition,i.localPosition,e),this.dirtifyLocal(t,i))}},{key:"setPosition",value:function(t,e){var r,n=t.transformable;if(ii[0]=e[0],ii[1]=e[1],ii[2]=null!==(r=e[2])&&void 0!==r?r:0,!U.equals(this.getPosition(t),ii)){if(U.copy(n.position,ii),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;V.copy(ia,i.worldTransform),V.invert(ia,ia),U.transformMat4(n.localPosition,ii,ia)}else U.copy(n.localPosition,ii);this.dirtifyLocal(t,n)}}},{key:"setLocalPosition",value:function(t,e){var r,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;ir[0]=e[0],ir[1]=e[1],ir[2]=null!==(r=e[2])&&void 0!==r?r:0,!U.equals(i.localPosition,ir)&&(U.copy(i.localPosition,ir),n&&this.dirtifyLocal(t,i))}},{key:"scaleLocal",value:function(t,e){var r,n=t.transformable;U.multiply(n.localScale,n.localScale,U.set(n4,e[0],e[1],null!==(r=e[2])&&void 0!==r?r:1)),this.dirtifyLocal(t,n)}},{key:"setLocalScale",value:function(t,e){var r,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;U.set(n4,e[0],e[1],null!==(r=e[2])&&void 0!==r?r:i.localScale[2]),!U.equals(n4,i.localScale)&&(U.copy(i.localScale,n4),n&&this.dirtifyLocal(t,i))}},{key:"translate",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=U.set(n4,e,r,n)),U.equals(e,n2)||(U.add(n4,this.getPosition(t),e),this.setPosition(t,n4))}},{key:"setRotation",value:function(t,e,r,n,i){var a=t.transformable;if("number"==typeof e&&(e=G.fromValues(e,r,n,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);G.copy(n9,o),G.invert(n9,n9),G.multiply(a.localRotation,n9,e),G.normalize(a.localRotation,a.localRotation),this.dirtifyLocal(t,a)}else this.setLocalRotation(t,e)}},{key:"setLocalRotation",value:function(t,e,r,n,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=G.set(n9,e,r,n,i));var o=t.transformable;G.copy(o.localRotation,e),a&&this.dirtifyLocal(t,o)}},{key:"setLocalSkew",value:function(t,e,r){var n=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=$.set(n5,e,r));var i=t.transformable;$.copy(i.localSkew,e),n&&this.dirtifyLocal(t,i)}},{key:"dirtifyLocal",value:function(t,e){r7(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtifyWorld(t,e))}},{key:"dirtifyWorld",value:function(t,e){e.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,e),this.dirtifyToRoot(t,!0)}},{key:"dirtifyFragment",value:function(t){var e=t.transformable;e&&(e.frozen=!1,e.dirtyFlag=!0,e.localDirtyFlag=!0);var r=t.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0,r.dirty=!0);for(var n=t.childNodes.length,i=0;i<n;i++)this.dirtifyFragment(t.childNodes[i]);t.nodeName===tk.FRAGMENT&&this.pendingEvents.set(t,!1)}},{key:"triggerPendingEvents",value:function(){var t=this,e=new Set,r=function(r,n){!r.isConnected||e.has(r)||r.nodeName===tk.FRAGMENT||(t.boundsChangedEvent.detail=n,t.boundsChangedEvent.target=r,r.isMutationObserved?r.dispatchEvent(t.boundsChangedEvent):r.ownerDocument.defaultView.dispatchEvent(t.boundsChangedEvent,!0),e.add(r))};this.pendingEvents.forEach(function(t,e){e.nodeName!==tk.FRAGMENT&&(iu.affectChildren=t,t?e.forEach(function(t){r(t,iu)}):r(e,iu))}),e.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"dirtifyToRoot",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t;for(r.renderable&&(r.renderable.dirty=!0);r;)nQ(r),r=r.parentNode;e&&t.forEach(function(t){nQ(t)}),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,e)}},{key:"updateDisplayObjectDependency",value:function(t,e,r,n){if(e&&e!==r){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(n);i[t].splice(a,1)}}if(r){var o=this.displayObjectDependencyMap.get(r);o||(this.displayObjectDependencyMap.set(r,{}),o=this.displayObjectDependencyMap.get(r)),o[t]||(o[t]=[]),o[t].push(n)}}},{key:"informDependentDisplayObjects",value:function(t){var e=this,r=this.displayObjectDependencyMap.get(t);r&&Object.keys(r).forEach(function(t){r[t].forEach(function(r){e.dirtifyToRoot(r,!0),r.dispatchEvent(new nZ(nJ.ATTR_MODIFIED,r,e,e,t,nZ.MODIFICATION,e,e)),r.isCustomElement&&r.isConnected&&r.attributeChangedCallback&&r.attributeChangedCallback(t,e,e)})})}},{key:"getPosition",value:function(t){var e=t.transformable;return V.getTranslation(e.position,this.getWorldTransform(t,e))}},{key:"getRotation",value:function(t){var e=t.transformable;return V.getRotation(e.rotation,this.getWorldTransform(t,e))}},{key:"getScale",value:function(t){var e=t.transformable;return V.getScaling(e.scaling,this.getWorldTransform(t,e))}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,e)),e.worldTransform}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"calcLocalTransform",value:function(t){if(0!==t.localSkew[0]||0!==t.localSkew[1]){V.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,U.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(V.identity(n8),n8[4]=Math.tan(t.localSkew[0]),n8[1]=Math.tan(t.localSkew[1]),V.multiply(t.localTransform,t.localTransform,n8));var e=V.fromRotationTranslationScaleOrigin(n8,G.set(n9,0,0,0,1),U.set(n4,1,1,1),t.localScale,t.origin);V.multiply(t.localTransform,t.localTransform,e)}else{var r=t.localTransform,n=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==n[0]||0!==n[1]||0!==n[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],h=0!==o[0]||0!==o[1]||0!==o[2];l||u||h?V.fromRotationTranslationScaleOrigin(r,i,n,a,o):s?V.fromTranslation(r,n):V.identity(r)}}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.localTransform}},{key:"setLocalTransform",value:function(t,e){var r=V.getTranslation(n7,e),n=V.getRotation(it,e),i=V.getScaling(ie,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,r,!1),this.setLocalRotation(t,n,void 0,void 0,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,n3,!1),this.setLocalPosition(t,n2,!1),this.setLocalEulerAngles(t,n2,void 0,void 0,!1),this.setLocalSkew(t,n1,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,n=this.getGeometryBounds(t,e);if(!tD.isEmpty(n)){var i=r||new tD;return i.setFromTransformedAABB(n,this.getWorldTransform(t)),i}return null}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.geometry;return r.dirty&&iv.styleValueRegistry.updateGeometry(t),(e?r.renderBounds:r.contentBounds||null)||new tD}},{key:"getBounds",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.renderable;if(!n.boundsDirty&&!r&&n.bounds)return n.bounds;if(!n.renderBoundsDirty&&r&&n.renderBounds)return n.renderBounds;var i=r?n.renderBounds:n.bounds,a=this.getTransformedGeometryBounds(t,r,i);if(t.childNodes.forEach(function(t){var n=e.getBounds(t,r);n&&(a?a.add(n):(a=i||new tD).update(n.center,n.halfExtents))}),a||(a=new tD),r){var o=r6(t);if(o){var s=o.parsedStyle.clipPath.getBounds(r);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents)}}return r?(n.renderBounds=a,n.renderBoundsDirty=!1):(n.bounds=a,n.boundsDirty=!1),a}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=n6;t.parentNode.transformable&&(e=V.invert(n8,this.getWorldTransform(t.parentNode)));var r=this.getBounds(t);if(!tD.isEmpty(r)){var n=new tD;return n.setFromTransformedAABB(r,e),n}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var e,r,n=this.getGeometryBounds(t);tD.isEmpty(n)||(r=new tD).setFromTransformedAABB(n,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(r){var a=r.getMin(),o=/*@__PURE__*/f(F)(a,2),s=o[0],l=o[1],u=r.getMax(),h=/*@__PURE__*/f(F)(u,2),d=h[0],c=h[1];return new tz(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),d-s,c-l)}return new tz((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(t,e){var r=this;if(!e.dirtyFlag){e.dirtyFlag=!0,e.frozen=!1,t.childNodes.forEach(function(t){var e=t.transformable;e.dirtyFlag||r.dirtifyWorldInternal(t,e)});var n=t.renderable;n&&(n.renderBoundsDirty=!0,n.boundsDirty=!0,n.dirty=!0)}}},{key:"syncHierarchy",value:function(t){var e=t.transformable;if(!e.frozen){e.frozen=!0,(e.localDirtyFlag||e.dirtyFlag)&&this.sync(t,e);for(var r=t.childNodes,n=0;n<r.length;n++)this.syncHierarchy(r[n])}}},{key:"sync",value:function(t,e){if(e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.dirtyFlag){var r=t.parentNode,n=r&&r.transformable;null!==r&&n?V.multiply(e.worldTransform,n.worldTransform,e.localTransform):V.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1}}},{key:"unfreezeParentToRoot",value:function(t){for(var e=t.parentNode;e;){var r=e.transformable;r&&(r.frozen=!1),e=e.parentNode}}}]),id={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},ic=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,ip=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),ig=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),iy=/*@__PURE__*/f(P)(function t(e){var r=this;/*@__PURE__*/f(I)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!r.isBreakingSpace(e)&&!!(t&&(ig.exec(e)||ip.exec(t)))},this.trimByKinsokuShorui=function(t){var e=/*@__PURE__*/f(D)(t),r=e[e.length-2];if(!r)return t;var n=r[r.length-1];return e[e.length-2]=r.slice(0,-1),e[e.length-1]=n+e[e.length-1],e},this.runtime=e},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var r={ascent:0,descent:0,fontSize:0},n=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=id.MetricsString+id.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(id.BaselineSymbol).width),l=id.HeightMultiplier*s;s=s*id.BaselineMultiplier|0,n.width=o,n.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,h=u.length,d=4*o,c=0,f=0,p=!1;for(c=0;c<s;++c){for(var g=0;g<d;g+=4)if(255!==u[f+g]){p=!0;break}if(p)break;f+=d}for(r.ascent=s-c,f=h-d,p=!1,c=l;c>s;--c){for(var y=0;y<d;y+=4)if(255!==u[f+y]){p=!0;break}if(p)break;f-=d}return r.descent=c-s,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[t]=r,r}},{key:"measureText",value:function(t,e,r){var n=e.fontSize,i=void 0===n?16:n,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,h=void 0===u?"alphabetic":u,d=e.textAlign,c=void 0===d?"start":d,f=e.letterSpacing,p=void 0===f?0:f,g=e.textPath;e.textPathSide,e.textPathStartOffset;var y=e.leading,v=void 0===y?0:y,m=function(t){for(var e=t.fontSize,r=void 0===e?16:e,n=t.fontFamily,i=t.fontStyle,a=t.fontVariant,o=t.fontWeight,s=(0,ti.default)(r)&&"".concat(r,"px")||"16px",l=(void 0===n?"sans-serif":n).split(","),u=l.length-1;u>=0;u--){var h=l[u].trim();!ny.test(h)&&0>ng.indexOf(h)&&(h='"'.concat(h,'"')),l[u]=h}return"".concat(void 0===i?"normal":i," ").concat(void 0===a?"normal":a," ").concat(void 0===o?"normal":o," ").concat(s," ").concat(l.join(","))}(e),b=this.measureFont(m,r);0===b.fontSize&&(b.fontSize=i,b.ascent=i);var x=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);x.font=m,e.isOverflowing=!1;var E=(void 0!==a&&a?this.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),w=Array(E.length),_=0;if(g){g.getTotalLength();for(var S=0;S<E.length;S++)x.measureText(E[S]).width,E[S].length}else{for(var k=0;k<E.length;k++){var N=x.measureText(E[k]).width+(E[k].length-1)*p;w[k]=N,_=Math.max(_,N)}var O=_+l,T=o||b.fontSize+l,M=Math.max(T,b.fontSize+l)+(E.length-1)*(T+v);T+=v;var A=0;return"middle"===h?A=-M/2:"bottom"===h||"alphabetic"===h||"ideographic"===h?A=-M:("top"===h||"hanging"===h)&&(A=0),{font:m,width:O,height:M,lines:E,lineWidths:w,lineHeight:T,maxLineWidth:_,fontProperties:b,lineMetrics:w.map(function(t,e){var r=0;return"center"===c||"middle"===c?r-=t/2:("right"===c||"end"===c)&&(r-=t),new tz(r-l/2,A+e*T,t+l,T)})}}}},{key:"wordWrap",value:function(t,e,r){var n=this,i=e.wordWrapWidth,a=e.letterSpacing,o=void 0===a?0:a,s=e.maxLines,l=void 0===s?1/0:s,u=e.textOverflow,h=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),d=(void 0===i?0:i)+o,c="";"ellipsis"===u?c="...":u&&"clip"!==u&&(c=u);var f=[],p=0,g=0,y={},v=function(t){return n.getFromCache(t,o,y,h)},m=Array.from(c).reduce(function(t,e){return t+v(e)},0);function b(t){if(!(m<=0)&&!(m>d)){for(var e=f[t].length,r=0,n=e,i=0;i<e;i++){var a=v(f[t][i]);if(r+a+m>d){n=i;break}r+=a}f[t]=(f[t]||"").slice(0,n)+c}}for(var x=Array.from(t),E=0;E<x.length;E++){var w=x[E],_=t[E-1],S=t[E+1],k=v(w);if(this.isNewline(w)){if(++p>=l){e.isOverflowing=!0,E<x.length-1&&b(p-1);break}g=0,f[p]="";continue}if(g>0&&g+k>d){if(p+1>=l){e.isOverflowing=!0,b(p);break}if(g=0,f[++p]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(f=this.trimToBreakable(f),g=this.sumTextWidthByCache(f[p]||"",y)),this.shouldBreakByKinsokuShorui(w,S)&&(f=this.trimByKinsokuShorui(f),g+=v(_||""))}g+=k,f[p]=(f[p]||"")+w}return f.join("\n")}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&id.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return"string"==typeof t&&id.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var e=/*@__PURE__*/f(D)(t),r=e[e.length-2],n=this.findBreakableIndex(r);if(-1===n||!r)return e;var i=r.slice(n,n+1),a=this.isBreakingSpace(i);return e[e.length-1]+=r.slice(n+1,r.length),e[e.length-2]=r.slice(0,n+(a?0:1)),e}},{key:"canBreakInLastChar",value:function(t){return!(t&&ic.test(t))}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,r){if(!e[r])throw Error("cannot count the word without cache");return t+e[r]},0)}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!ic.test(t[e]))return e;return -1}},{key:"getFromCache",value:function(t,e,r,n){var i=r[t];if("number"!=typeof i){var a=t.length*e;i=n.measureText(t).width+a,r[t]=i}return i}}]),iv={},im=(N=new nI,O=new nR,k={},/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(k,tk.FRAGMENT,null),tk.CIRCLE,new nT),tk.ELLIPSE,new nM),tk.RECT,N),tk.IMAGE,N),tk.GROUP,new nD),tk.LINE,new nA),tk.TEXT,new nP(iv)),tk.POLYLINE,O),tk.POLYGON,O),/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(k,tk.PATH,new nC),tk.HTML,new nL),tk.MESH,null)),ib=(M=new rz,A=new r$,T={},/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(T,en.PERCENTAGE,null),en.NUMBER,new rq),en.ANGLE,new rF),en.DEFINED_PATH,new rB),en.PAINT,M),en.COLOR,M),en.FILTER,new rV),en.LENGTH,A),en.LENGTH_PERCENTAGE,A),en.LENGTH_PERCENTAGE_12,new rU),/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(T,en.LENGTH_PERCENTAGE_14,new rH),en.COORDINATE,new r$),en.OFFSET_DISTANCE,new rY),en.OPACITY_VALUE,new rK),en.PATH,new rX),en.LIST_OF_POINTS,new rJ),en.SHADOW_BLUR,new rZ),en.TEXT,new rQ),en.TEXT_TRANSFORM,new r0),en.TRANSFORM,new nk),/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(/*@__PURE__*/f(tg)(T,en.TRANSFORM_ORIGIN,new nN),en.Z_INDEX,new nO),en.MARKER,new rW));iv.CameraContribution=t7,iv.AnimationTimeline=null,iv.EasingFunction=null,iv.offscreenCanvasCreator=new nW,iv.sceneGraphSelector=new nX,iv.sceneGraphService=new ih(iv),iv.textService=new iy(iv),iv.geometryUpdaterFactory=im,iv.CSSPropertySyntaxFactory=ib,iv.styleValueRegistry=new rL(iv),iv.layoutRegistry=null,iv.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==c?c:{},iv.enableStyleSyntax=!0,iv.enableSizeAttenuation=!1;var ix=0,iE=new nZ(nJ.INSERTED,null,"","","",0,"",""),iw=new nZ(nJ.REMOVED,null,"","","",0,"",""),i_=new nV(nJ.DESTROY),iS=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(I)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(L)(this,e,[].concat(n))).entity=ix++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:et.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}},{key:"cloneNode",value:function(t){throw Error(tV)}},{key:"appendChild",value:function(t,e){var r;if(t.destroyed)throw Error("Cannot append a destroyed element.");return iv.sceneGraphService.attach(t,this,e),null!==(r=this.ownerDocument)&&void 0!==r&&r.defaultView&&(r7(this)||t.nodeName!==tk.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(iE.relatedNode=this,t.dispatchEvent(iE)),t}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var r=this.childNodes.indexOf(e);-1===r?this.appendChild(t):this.appendChild(t,r)}else this.appendChild(t);return t}},{key:"replaceChild",value:function(t,e){var r=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,r),e}},{key:"removeChild",value:function(t){var e;return iw.relatedNode=this,t.dispatchEvent(iw),null!==(e=t.ownerDocument)&&void 0!==e&&e.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),iv.sceneGraphService.detach(t),t}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e)}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy()}}},{key:"matches",value:function(t){return iv.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return iv.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return iv.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return iv.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return iv.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return iv.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return iv.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var e=this;do{if(iv.sceneGraphService.matches(t,e))return e;e=e.parentElement}while(null!==e)return null}},{key:"find",value:function(t){var e=this,r=null;return this.forEach(function(n){return!(n!==e&&t(n))||(r=n,!1)}),r}},{key:"findAll",value:function(t){var e=this,r=[];return this.forEach(function(n){n!==e&&t(n)&&r.push(n)}),r}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];n.forEach(function(r,n){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(r,e+n+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0],a=r.slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,/*@__PURE__*/f(D)(a))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var t=this,e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];r.forEach(function(e){return t.appendChild(e)})}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];r.forEach(function(e,r){return t.appendChild(e,r)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(i_),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return iv.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return iv.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return iv.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return iv.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return iv.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t]}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,e,r,n){this.attributes[t]=e}},{key:"getAttributeNS",value:function(t,e){throw Error(tV)}},{key:"getAttributeNode",value:function(t){throw Error(tV)}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tV)}},{key:"hasAttributeNS",value:function(t,e){throw Error(tV)}},{key:"removeAttributeNS",value:function(t,e){throw Error(tV)}},{key:"removeAttributeNode",value:function(t){throw Error(tV)}},{key:"setAttributeNS",value:function(t,e,r){throw Error(tV)}},{key:"setAttributeNode",value:function(t){throw Error(tV)}},{key:"setAttributeNodeNS",value:function(t){throw Error(tV)}},{key:"toggleAttribute",value:function(t,e){throw Error(tV)}}])}(nU);function ik(t){return!!(null!=t&&t.nodeName)}var iN=iv.globalThis.Proxy?iv.globalThis.Proxy:function(){},iO=new nZ(nJ.ATTR_MODIFIED,null,null,null,null,nZ.MODIFICATION,null,null),iT=U.create(),iM=G.create(),iA=/*#__PURE__*/function(t){function e(t){var r;return /*@__PURE__*/f(I)(this,e),(r=/*@__PURE__*/f(L)(this,e)).isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=t,r.id=t.id||"",r.name=t.name||"",(t.className||t.class)&&(r.className=t.className||t.class),r.nodeName=t.type||tk.GROUP,t.initialParsedStyle&&Object.assign(r.parsedStyle,t.initialParsedStyle),r.initAttributes(t.style),iv.enableStyleSyntax&&(r.style=new iN({setProperty:function(t,e){r.setAttribute(t,e)},getPropertyValue:function(t){return r.getAttribute(t)},removeProperty:function(t){r.removeAttribute(t)},item:function(){return""}},{get:function(t,e){return void 0!==t[e]?t[e]:r.getAttribute(e)},set:function(t,e,n){return r.setAttribute(e,n),!0}})),r}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"destroy",value:function(){/*@__PURE__*/f(ty)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel()})}},{key:"cloneNode",value:function(t,e){var r=/*@__PURE__*/f(R)({},this.attributes);for(var n in r){var i=r[n];ik(i)&&"clipPath"!==n&&"offsetPath"!==n&&"textPath"!==n&&(r[n]=i.cloneNode(t)),e&&(r[n]=e(n,i))}var a=new this.constructor(/*@__PURE__*/f(R)(/*@__PURE__*/f(R)({},this.config),{},{style:r}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var r=e.cloneNode(t);a.appendChild(r)}}),a}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};iv.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.renderable.dirty=!0}},{key:"setAttribute",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,tl.default)(r)&&(n||r!==this.attributes[t])&&(this.internalSetAttribute(t,r,{memoize:i}),/*@__PURE__*/f(ty)(e,"setAttribute",this,3)([t,r]))}},{key:"internalSetAttribute",value:function(t,e){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.renderable,a=this.attributes[t],o=this.parsedStyle[t];iv.styleValueRegistry.processProperties(this,/*@__PURE__*/f(tg)({},t,e),n),i.dirty=!0;var s=this.parsedStyle[t];this.isConnected&&(iO.relatedNode=this,iO.prevValue=a,iO.newValue=e,iO.attrName=t,iO.prevParsedValue=o,iO.newParsedValue=s,this.isMutationObserved?this.dispatchEvent(iO):(iO.target=this,this.ownerDocument.defaultView.dispatchEvent(iO,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(r=this.attributeChangedCallback)||void 0===r||r.call(this,t,a,e,o,s))}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),r=/*@__PURE__*/f(F)(e,2),n=r[0],i=r[1],a=t.getMax(),o=/*@__PURE__*/f(F)(a,2);return new tz(n,i,o[0]-n,o[1]-i)}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return iv.sceneGraphService.setOrigin(this,tH(t,e,r,!1)),this}},{key:"getOrigin",value:function(){return iv.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return iv.sceneGraphService.setPosition(this,tH(t,e,r,!1)),this}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return iv.sceneGraphService.setLocalPosition(this,tH(t,e,r,!1)),this}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return iv.sceneGraphService.translate(this,tH(t,e,r,!1)),this}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return iv.sceneGraphService.translateLocal(this,tH(t,e,r,!1)),this}},{key:"getPosition",value:function(){return iv.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return iv.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,e,r){return this.scaleLocal(t,e,r)}},{key:"scaleLocal",value:function(t,e,r){return"number"==typeof t&&(e=e||t,r=r||t,t=tH(t,e,r,!1)),iv.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,e,r){return"number"==typeof t&&(e=e||t,r=r||t,t=tH(t,e,r,!1)),iv.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return iv.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return iv.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var t=tJ(iT,iv.sceneGraphService.getWorldTransform(this));return /*@__PURE__*/f(F)(t,3)[2]*tY}},{key:"getLocalEulerAngles",value:function(){var t=tJ(iT,iv.sceneGraphService.getLocalRotation(this));return /*@__PURE__*/f(F)(t,3)[2]*tY}},{key:"setEulerAngles",value:function(t){return iv.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return iv.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,e,r){return(0,tn.default)(e)&&(0,tn.default)(r)?iv.sceneGraphService.rotateLocal(this,0,0,t):iv.sceneGraphService.rotateLocal(this,t,e,r),this}},{key:"rotate",value:function(t,e,r){return(0,tn.default)(e)&&(0,tn.default)(r)?iv.sceneGraphService.rotate(this,0,0,t):iv.sceneGraphService.rotate(this,t,e,r),this}},{key:"setRotation",value:function(t,e,r,n){return iv.sceneGraphService.setRotation(this,t,e,r,n),this}},{key:"setLocalRotation",value:function(t,e,r,n){return iv.sceneGraphService.setLocalRotation(this,t,e,r,n),this}},{key:"setLocalSkew",value:function(t,e){return iv.sceneGraphService.setLocalSkew(this,t,e),this}},{key:"getRotation",value:function(){return iv.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return iv.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return iv.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return iv.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return iv.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return iv.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){iv.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,e){var r,n=null===(r=this.ownerDocument)||void 0===r?void 0:r.timeline;return n?n.play(this,t,e):null}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden"}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none"}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,/*@__PURE__*/f(D)(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,/*@__PURE__*/f(D)(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var t=this,e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0],a=r[1];return i?(0,to.default)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e])}),this):2===r.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes}},{key:"getMatrix",value:function(t){var e,r,n,i=t||this.getWorldTransform(),a=V.getTranslation(iT,i),o=/*@__PURE__*/f(F)(a,2),s=o[0],l=o[1],u=V.getScaling(iT,i),h=/*@__PURE__*/f(F)(u,2),d=h[0],c=h[1],p=tJ(iT,V.getRotation(iM,i)),g=/*@__PURE__*/f(F)(p,3),y=g[0],v=g[2];return r=Math.cos(e=y||v),n=Math.sin(e),z.fromValues(d*r,c*n,0,-d*n,c*r,0,s,l,1)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var e=tZ(t),r=/*@__PURE__*/f(F)(e,5),n=r[0],i=r[1],a=r[2],o=r[3],s=r[4];this.setEulerAngles(s).setPosition(n,i).setLocalScale(a,o)}},{key:"setLocalMatrix",value:function(t){var e=tZ(t),r=/*@__PURE__*/f(F)(e,5),n=r[0],i=r[1],a=r[2],o=r[3],s=r[4];this.setLocalEulerAngles(s).setLocalPosition(n,i).setLocalScale(a,o)}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,e){return this.appendChild(t,e)}},{key:"set",value:function(t,e){this.config[t]=e}},{key:"get",value:function(t){return this.config[t]}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,r),this}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,r),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}}])}(iS);iA.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var iC=/*#__PURE__*/function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return /*@__PURE__*/f(I)(this,e),/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.CIRCLE},t)])}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e)}(iA);iC.PARSED_STYLE_LIST=new Set([].concat(/*@__PURE__*/f(D)(iA.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var iR=["style"],iI=/*#__PURE__*/function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.style,i=/*@__PURE__*/f(tw)(r,iR);return /*@__PURE__*/f(I)(this,e),(t=/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({style:n},i)])).isCustomElement=!0,t}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e)}(iA),iP=/*#__PURE__*/function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return /*@__PURE__*/f(I)(this,e),/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.ELLIPSE},t)])}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e)}(iA);iP.PARSED_STYLE_LIST=new Set([].concat(/*@__PURE__*/f(D)(iA.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"]));var iD=/*#__PURE__*/function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return /*@__PURE__*/f(I)(this,e),/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.GROUP},t)])}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e)}(iA);iD.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iL=["style"],ij=/*#__PURE__*/function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.style,i=/*@__PURE__*/f(tw)(r,iL);return /*@__PURE__*/f(I)(this,e),(t=/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.HTML,style:n},i)])).cullable.enable=!1,t}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=V.invert(V.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!tD.isEmpty(e)){var r=new tD;return r.setFromTransformedAABB(e,t),r}}return this.getBounds()}}])}(iA);ij.PARSED_STYLE_LIST=new Set([].concat(/*@__PURE__*/f(D)(iA.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iF=/*#__PURE__*/function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return /*@__PURE__*/f(I)(this,e),/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.IMAGE},t)])}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e)}(iA);iF.PARSED_STYLE_LIST=new Set([].concat(/*@__PURE__*/f(D)(iA.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iB=["style"],iz=/*#__PURE__*/function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.style,i=/*@__PURE__*/f(tw)(r,iB);/*@__PURE__*/f(I)(this,e),(t=/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.LINE,style:/*@__PURE__*/f(R)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},n)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&ik(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&ik(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"attributeChangedCallback",value:function(t,e,r,n,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(n&&ik(n)&&(this.markerStartAngle=0,n.remove()),i&&ik(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(n&&ik(n)&&(this.markerEndAngle=0,n.remove()),i&&ik(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)))}},{key:"transformMarker",value:function(t){var e,r,n,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,h=s.markerStartOffset,d=s.markerEndOffset,c=s.x1,f=s.x2,p=s.y1,g=s.y2,y=t?l:u;if(y&&ik(y)){var v=0;t?(n=c,i=p,e=f-c,r=g-p,a=h||0,o=this.markerStartAngle):(n=f,i=g,e=c-f,r=p-g,a=d||0,o=this.markerEndAngle),v=Math.atan2(r,e),y.setLocalEulerAngles(180*v/Math.PI+o),y.setLocalPosition(n+Math.cos(v)*a,i+Math.sin(v)*a)}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.parsedStyle,n=r.x1,i=r.y1,a=r.x2,o=r.y2,s=(0,tm.linePointAt)(n,i,a,o,t),l=s.x,u=s.y,h=U.transformMat4(U.create(),U.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new tB(h[0],h[1])}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,r=t.y1,n=t.x2,i=t.y2;return(0,tm.lineLength)(e,r,n,i)}}])}(iA);iz.PARSED_STYLE_LIST=new Set([].concat(/*@__PURE__*/f(D)(iA.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iV=["style"],iG=/*#__PURE__*/function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.style,i=/*@__PURE__*/f(tw)(r,iV);/*@__PURE__*/f(I)(this,e),(t=/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.PATH,style:n,initialParsedStyle:{miterLimit:4,d:/*@__PURE__*/f(R)({},er)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ik(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ik(l)&&t.placeMarkerMid(l),s&&ik(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"attributeChangedCallback",value:function(t,e,r,n,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(n&&ik(n)&&(this.markerStartAngle=0,n.remove()),i&&ik(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(n&&ik(n)&&(this.markerEndAngle=0,n.remove()),i&&ik(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)}},{key:"transformMarker",value:function(t){var e,r,n,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,h=s.markerStartOffset,d=s.markerEndOffset,c=t?l:u;if(c&&ik(c)){var p=0;if(t){var g=this.getStartTangent(),y=/*@__PURE__*/f(F)(g,2),v=y[0],m=y[1];n=m[0],i=m[1],e=v[0]-m[0],r=v[1]-m[1],a=h||0,o=this.markerStartAngle}else{var b=this.getEndTangent(),x=/*@__PURE__*/f(F)(b,2),E=x[0],w=x[1];n=w[0],i=w[1],e=E[0]-w[0],r=E[1]-w[1],a=d||0,o=this.markerEndAngle}p=Math.atan2(r,e),c.setLocalEulerAngles(180*p/Math.PI+o),c.setLocalPosition(n+Math.cos(p)*a,i+Math.sin(p)*a)}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove()}),t&&ik(t))for(var r=1;r<e.length-1;r++){var n=/*@__PURE__*/f(F)(e[r].currentPoint,2),i=n[0],a=n[1],o=1===r?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a)}}},{key:"getTotalLength",value:function(){return rt(this)}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.parsedStyle.d.absolutePath,n=(0,J.getPointAtLength)(r,t),i=n.x,a=n.y,o=U.transformMat4(U.create(),U.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new tB(o[0],o[1])}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*rt(this),e)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var r=t[0].currentPoint,n=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([r[0]-i[0],r[1]-i[1]]):e.push([n[0],n[1]]),e.push([r[0],r[1]])}return e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,r=[];if(e>1){var n=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;r=[],a?r.push([i[0]-a[0],i[1]-a[1]]):r.push([n[0],n[1]]),r.push([i[0],i[1]])}return r}}])}(iA);iG.PARSED_STYLE_LIST=new Set([].concat(/*@__PURE__*/f(D)(iA.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var i$=["style"],iU=/*#__PURE__*/function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.style,i=/*@__PURE__*/f(tw)(r,i$);/*@__PURE__*/f(I)(this,e),(t=/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.POLYGON,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ik(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ik(l)&&t.placeMarkerMid(l),s&&ik(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"attributeChangedCallback",value:function(t,e,r,n,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(n&&ik(n)&&(this.markerStartAngle=0,n.remove()),i&&ik(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(n&&ik(n)&&(this.markerEndAngle=0,n.remove()),i&&ik(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)}},{key:"transformMarker",value:function(t){var e,r,n,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,h=s.markerStartOffset,d=s.markerEndOffset,c=(s.points||{}).points,f=t?l:u;if(f&&ik(f)&&c){var p=0;if(n=c[0][0],i=c[0][1],t)e=c[1][0]-c[0][0],r=c[1][1]-c[0][1],a=h||0,o=this.markerStartAngle;else{var g=c.length;this.parsedStyle.isClosed?(e=c[g-1][0]-c[0][0],r=c[g-1][1]-c[0][1]):(n=c[g-1][0],i=c[g-1][1],e=c[g-2][0]-c[g-1][0],r=c[g-2][1]-c[g-1][1]),a=d||0,o=this.markerEndAngle}p=Math.atan2(r,e),f.setLocalEulerAngles(180*p/Math.PI+o),f.setLocalPosition(n+Math.cos(p)*a,i+Math.sin(p)*a)}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove()}),this.markerMidList=[],t&&ik(t)&&e)for(var r=1;r<(this.parsedStyle.isClosed?e.length:e.length-1);r++){var n=e[r][0],i=e[r][1],a=1===r?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(n,i)}}}])}(iA);iU.PARSED_STYLE_LIST=new Set([].concat(/*@__PURE__*/f(D)(iA.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iH=["style"],iW=/*#__PURE__*/function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.style,n=/*@__PURE__*/f(tw)(t,iH);return /*@__PURE__*/f(I)(this,e),/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.POLYLINE,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},n)])}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,tm.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var n,i,a=[],o=0,s=this.getTotalLength();r.forEach(function(t,e){r[e+1]&&((n=[0,0])[0]=o/s,i=(0,tm.lineLength)(t[0],t[1],r[e+1][0],r[e+1][1]),o+=i,n[1]=o/s,a.push(n))}),this.parsedStyle.points.segments=a}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,r){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=r)});var h=(0,tm.linePointAt)(r[u][0],r[u][1],r[u+1][0],r[u+1][1],l),d=h.x,c=h.y,f=U.transformMat4(U.create(),U.fromValues(d,c,0),e?this.getWorldTransform():this.getLocalTransform());return new tB(f[0],f[1])}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,r=[];return r.push([t[e-1][0],t[e-1][1]]),r.push([t[e][0],t[e][1]]),r}}])}(iU);iW.PARSED_STYLE_LIST=new Set([].concat(/*@__PURE__*/f(D)(iU.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iq=/*#__PURE__*/function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return /*@__PURE__*/f(I)(this,e),/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.RECT},t)])}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e)}(iA);iq.PARSED_STYLE_LIST=new Set([].concat(/*@__PURE__*/f(D)(iA.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iY=["style"],iK=/*#__PURE__*/function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.style,n=/*@__PURE__*/f(tw)(t,iY);return /*@__PURE__*/f(I)(this,e),/*@__PURE__*/f(L)(this,e,[/*@__PURE__*/f(R)({type:tk.TEXT,style:/*@__PURE__*/f(R)({fill:"black"},r)},n)])}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(iA);iK.PARSED_STYLE_LIST=new Set([].concat(/*@__PURE__*/f(D)(iA.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var iX=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t),this.registry={},this.define(tk.CIRCLE,iC),this.define(tk.ELLIPSE,iP),this.define(tk.RECT,iq),this.define(tk.IMAGE,iF),this.define(tk.LINE,iz),this.define(tk.GROUP,iD),this.define(tk.PATH,iG),this.define(tk.POLYGON,iU),this.define(tk.POLYLINE,iW),this.define(tk.TEXT,iK),this.define(tk.HTML,ij)},[{key:"define",value:function(t,e){this.registry[t]=e}},{key:"get",value:function(t){return this.registry[t]}}]),iJ=/*#__PURE__*/function(t){var e,r;function n(){/*@__PURE__*/f(I)(this,n),(t=/*@__PURE__*/f(L)(this,n)).defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new iv.AnimationTimeline(t)}catch(t){}var t,e={};return rI.forEach(function(t){var r=t.n,n=t.inh,i=t.d;n&&i&&(e[r]=(0,tr.default)(i)?i(tk.GROUP):i)}),t.documentElement=new iD({id:"g-root",style:e}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return /*@__PURE__*/f(j)(n,t),/*@__PURE__*/f(P)(n,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(t,e){if("svg"===t)return this.documentElement;var r=this.defaultView.customElements.get(t);r||(console.warn("Unsupported tagName: ",t),r="tspan"===t?iK:iD);var n=new r(e);return n.ownerDocument=this,n}},{key:"createElementNS",value:function(t,e,r){return this.createElement(e,r)}},{key:"cloneNode",value:function(t){throw Error(tV)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}}},{key:"elementsFromBBox",value:function(t,e,r,n){var i=this.defaultView.context.rBushRoot.search({minX:t,minY:e,maxX:r,maxY:n}),a=[];return i.forEach(function(t){var e=t.displayObject,r=e.parsedStyle.pointerEvents,n=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(void 0===r?"auto":r);(!n||n&&e.isVisible())&&!e.isCulled()&&e.isInteractive()&&a.push(e)}),a.sort(function(t,e){return e.sortable.renderOrder-t.sortable.renderOrder}),a}},{key:"elementFromPointSync",value:function(t,e){var r=this.defaultView.canvas2Viewport({x:t,y:e}),n=r.x,i=r.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(n<0||i<0||n>o||i>s)return null;var l=this.defaultView.viewport2Client({x:n,y:i}),u=l.x,h=l.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:e,viewportX:n,viewportY:i,clientX:u,clientY:h},picked:[]}).picked;return d&&d[0]||this.documentElement}},{key:"elementFromPoint",value:(e=/*@__PURE__*/f(tx)(/*#__PURE__*//*@__PURE__*/f(tb)().mark(function t(e,r){var n,i,a,o,s,l,u,h,d,c;return /*@__PURE__*/f(tb)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(n=this.defaultView.canvas2Viewport({x:e,y:r})).x,a=n.y,s=(o=this.defaultView.getConfig()).width,l=o.height,!(i<0||a<0||i>s||a>l)){t.next=4;break}return t.abrupt("return",null);case 4:return h=(u=this.defaultView.viewport2Client({x:i,y:a})).x,d=u.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:r,viewportX:i,viewportY:a,clientX:h,clientY:d},picked:[]});case 7:return c=t.sent.picked,t.abrupt("return",c&&c[0]||this.documentElement);case 10:case"end":return t.stop()}},t,this)})),function(t,r){return e.apply(this,arguments)})},{key:"elementsFromPointSync",value:function(t,e){var r=this.defaultView.canvas2Viewport({x:t,y:e}),n=r.x,i=r.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(n<0||i<0||n>o||i>s)return[];var l=this.defaultView.viewport2Client({x:n,y:i}),u=l.x,h=l.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:e,viewportX:n,viewportY:i,clientX:u,clientY:h},picked:[]}).picked;return d[d.length-1]!==this.documentElement&&d.push(this.documentElement),d}},{key:"elementsFromPoint",value:(r=/*@__PURE__*/f(tx)(/*#__PURE__*//*@__PURE__*/f(tb)().mark(function t(e,r){var n,i,a,o,s,l,u,h,d,c;return /*@__PURE__*/f(tb)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(n=this.defaultView.canvas2Viewport({x:e,y:r})).x,a=n.y,s=(o=this.defaultView.getConfig()).width,l=o.height,!(i<0||a<0||i>s||a>l)){t.next=4;break}return t.abrupt("return",[]);case 4:return h=(u=this.defaultView.viewport2Client({x:i,y:a})).x,d=u.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:r,viewportX:i,viewportY:a,clientX:h,clientY:d},picked:[]});case 7:return(c=t.sent.picked)[c.length-1]!==this.documentElement&&c.push(this.documentElement),t.abrupt("return",c);case 11:case"end":return t.stop()}},t,this)})),function(t,e){return r.apply(this,arguments)})},{key:"appendChild",value:function(t,e){throw Error(tG)}},{key:"insertBefore",value:function(t,e){throw Error(tG)}},{key:"removeChild",value:function(t,e){throw Error(tG)}},{key:"replaceChild",value:function(t,e,r){throw Error(tG)}},{key:"append",value:function(){throw Error(tG)}},{key:"prepend",value:function(){throw Error(tG)}},{key:"getElementById",value:function(t){return this.documentElement.getElementById(t)}},{key:"getElementsByName",value:function(t){return this.documentElement.getElementsByName(t)}},{key:"getElementsByTagName",value:function(t){return this.documentElement.getElementsByTagName(t)}},{key:"getElementsByClassName",value:function(t){return this.documentElement.getElementsByClassName(t)}},{key:"querySelector",value:function(t){return this.documentElement.querySelector(t)}},{key:"querySelectorAll",value:function(t){return this.documentElement.querySelectorAll(t)}},{key:"find",value:function(t){return this.documentElement.find(t)}},{key:"findAll",value:function(t){return this.documentElement.findAll(t)}}])}(nU),iZ=/*#__PURE__*/function(){function t(e){/*@__PURE__*/f(I)(this,t),this.strategies=e}return /*@__PURE__*/f(P)(t,[{key:"apply",value:function(e){var r=e.camera,n=e.renderingService,i=e.renderingContext,a=this.strategies;n.hooks.cull.tap(t.tag,function(t){if(t){var e=t.cullable;return(0===a.length?e.visible=i.unculledEntities.indexOf(t.entity)>-1:e.visible=a.every(function(e){return e.isVisible(r,t)}),!t.isCulled()&&t.isVisible())?t:(t.dispatchEvent(new nV(nJ.CULLED)),null)}return t}),n.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1})}}])}();iZ.tag="Culling";var iQ=/*#__PURE__*/function(){function t(){var e=this;/*@__PURE__*/f(I)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new nB(null),this.rootWheelEvent=new nz(null),this.onPointerMove=function(t){var r=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView;if(!r.supportsTouchEvents||"touch"!==t.pointerType){var n,i,a=e.normalizeToPointerEvent(t,r),o=/*@__PURE__*/f(tE)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,r,t);e.context.eventService.mapEvent(l)}}catch(t){o.e(t)}finally{o.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var r,n,i=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView,a=e.normalizeToPointerEvent(t,i),o=/*@__PURE__*/f(tE)(a);try{for(o.s();!(n=o.n()).done;){var s=n.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l)}}catch(t){o.e(t)}finally{o.f()}e.setCursor(e.context.eventService.cursor)}}return /*@__PURE__*/f(P)(t,[{key:"apply",value:function(e){var r=this;this.context=e;var n=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return r.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null}),n.hooks.pointerWheel.tap(t.tag,function(t){var e=r.normalizeWheelEvent(t);r.context.eventService.mapEvent(e)}),n.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=r.normalizeToPointerEvent(t,i);r.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var n,a=/*@__PURE__*/f(tE)(e);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.bootstrapEvent(r.rootPointerEvent,o,i,t);r.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}r.setCursor(r.context.eventService.cursor)}}),n.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,n=r.context.contextService.getDomElement(),a=r.context.eventService.isNativeEventFromCanvas(n,t)?"":"outside",o=r.normalizeToPointerEvent(t,i),s=/*@__PURE__*/f(tE)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=r.bootstrapEvent(r.rootPointerEvent,l,i,t);u.type+=a,r.context.eventService.mapEvent(u)}}catch(t){s.e(t)}finally{s.f()}r.setCursor(r.context.eventService.cursor)}}),n.hooks.pointerMove.tap(t.tag,this.onPointerMove),n.hooks.pointerOver.tap(t.tag,this.onPointerMove),n.hooks.pointerOut.tap(t.tag,this.onPointerMove),n.hooks.click.tap(t.tag,this.onClick),n.hooks.pointerCancel.tap(t.tag,function(t){var e,n=r.normalizeToPointerEvent(t,i),a=/*@__PURE__*/f(tE)(n);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=r.bootstrapEvent(r.rootPointerEvent,o,i,t);r.context.eventService.mapEvent(s)}}catch(t){a.e(t)}finally{a.f()}r.setCursor(r.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(t,e,r,n){t.view=r,t.originalEvent=null,t.nativeEvent=n,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=n.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=r8[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var r=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),n=r.x,i=r.y;e.viewport.x=n,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=r9.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,e){var r=[];if(e.isTouchEvent(t))for(var n=0;n<t.changedTouches.length;n++){var i=t.changedTouches[n];(0,tl.default)(i.button)&&(i.button=0),(0,tl.default)(i.buttons)&&(i.buttons=1),(0,tl.default)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,tl.default)(i.width)&&(i.width=i.radiusX||1),(0,tl.default)(i.height)&&(i.height=i.radiusY||1),(0,tl.default)(i.tiltX)&&(i.tiltX=0),(0,tl.default)(i.tiltY)&&(i.tiltY=0),(0,tl.default)(i.pointerType)&&(i.pointerType="touch"),(0,tl.default)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,tl.default)(i.pressure)&&(i.pressure=i.force||.5),(0,tl.default)(i.twist)&&(i.twist=0),(0,tl.default)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,r.push(i)}else e.isMouseEvent(t)&&((0,tl.default)(t.isPrimary)&&(t.isPrimary=!0),(0,tl.default)(t.width)&&(t.width=1),(0,tl.default)(t.height)&&(t.height=1),(0,tl.default)(t.tiltX)&&(t.tiltX=0),(0,tl.default)(t.tiltY)&&(t.tiltY=0),(0,tl.default)(t.pointerType)&&(t.pointerType="mouse"),(0,tl.default)(t.pointerId)&&(t.pointerId=1),(0,tl.default)(t.pressure)&&(t.pressure=.5),(0,tl.default)(t.twist)&&(t.twist=0),(0,tl.default)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),r.push(t);return r}}])}();iQ.tag="Event";var i0=[tk.CIRCLE,tk.ELLIPSE,tk.IMAGE,tk.RECT,tk.LINE,tk.POLYLINE,tk.POLYGON,tk.TEXT,tk.PATH,tk.HTML],i1=/*@__PURE__*/f(P)(function t(){/*@__PURE__*/f(I)(this,t)},[{key:"isVisible",value:function(t,e){var r,n=e.cullable;if(!n.enable)return!0;var i=e.getRenderBounds();if(tD.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(r=e.parentNode)||void 0===r||null===(r=r.cullable)||void 0===r?void 0:r.visibilityPlaneMask;return n.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||tj.INDETERMINATE,a.planes),n.visible=n.visibilityPlaneMask!==tj.OUTSIDE,n.visible}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,r,n){if(r===tj.OUTSIDE||r===tj.INSIDE)return r;for(var i=tj.INSIDE,a=i0.indexOf(t.nodeName)>-1,o=0,s=n.length;o<s;++o){var l=1<<o;if((r&l)!=0&&(!a||4!==o&&5!==o)){var u=n[o],h=u.normal,d=u.distance;if(U.dot(h,e.getPositiveFarPoint(n[o]))+d<0)return tj.OUTSIDE;U.dot(h,e.getNegativeFarPoint(n[o]))+d<0&&(i|=l)}}return i}}]),i2=/*#__PURE__*/function(){function t(){/*@__PURE__*/f(I)(this,t),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return /*@__PURE__*/f(P)(t,[{key:"apply",value:function(e){var r,n=this,i=e.renderingService,a=e.renderingContext,o=e.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var l=function(t){t.target.renderable.dirty=!0,i.dirtify()},u=function(t){n.syncTasks.set(t.target,t.detail.affectChildren),i.dirtify()},h=function(t){var e=t.target;iv.enableSizeAttenuation&&iv.styleValueRegistry.updateSizeAttenuation(e,s.getCamera().getZoom())},d=function(t){var e=t.target,r=e.rBushNode;r.aabb&&n.rBush.remove(r.aabb),n.syncTasks.delete(e),iv.sceneGraphService.dirtifyToRoot(e),i.dirtify()};i.hooks.init.tap(t.tag,function(){s.addEventListener(nJ.MOUNTED,h),s.addEventListener(nJ.UNMOUNTED,d),s.addEventListener(nJ.ATTR_MODIFIED,l),s.addEventListener(nJ.BOUNDS_CHANGED,u)}),i.hooks.destroy.tap(t.tag,function(){s.removeEventListener(nJ.MOUNTED,h),s.removeEventListener(nJ.UNMOUNTED,d),s.removeEventListener(nJ.ATTR_MODIFIED,l),s.removeEventListener(nJ.BOUNDS_CHANGED,u),n.syncTasks.clear()});var c=null!==(r=iv.globalThis.requestIdleCallback)&&void 0!==r?r:nu.bind(iv.globalThis);i.hooks.endFrame.tap(t.tag,function(){n.isFirstTimeRendering?(n.isFirstTimeRendering=!1,n.syncing=!0,c(function(){n.syncRTree(!0),n.isFirstTimeRenderingFinished=!0})):n.syncRTree()})}},{key:"syncNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isConnected){var r=t.rBushNode;r.aabb&&this.rBush.remove(r.aabb);var n=t.getRenderBounds();if(n){var i=t.renderable;e&&(i.dirtyRenderBounds||(i.dirtyRenderBounds=new tD),i.dirtyRenderBounds.update(n.center,n.halfExtents));var a=n.getMin(),o=/*@__PURE__*/f(F)(a,2),s=o[0],l=o[1],u=n.getMax(),h=/*@__PURE__*/f(F)(u,2),d=h[0],c=h[1];r.aabb||(r.aabb={}),r.aabb.displayObject=t,r.aabb.minX=s,r.aabb.minY=l,r.aabb.maxX=d,r.aabb.maxY=c}if(r.aabb&&!isNaN(r.aabb.maxX)&&!isNaN(r.aabb.maxX)&&!isNaN(r.aabb.minX)&&!isNaN(r.aabb.minY))return r.aabb}}},{key:"syncRTree",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var r=[],n=new Set,i=function(i){if(!n.has(i)&&i.renderable){var a=t.syncNode(i,e);a&&(r.push(a),n.add(i))}};this.syncTasks.forEach(function(t,e){t&&e.forEach(i);for(var r=e;r;)i(r),r=r.parentElement}),this.rBush.load(r),r.length=0,this.syncing=!1}}}])}();i2.tag="Prepare";var i3=((C={}).READY="ready",C.BEFORE_RENDER="beforerender",C.RERENDER="rerender",C.AFTER_RENDER="afterrender",C.BEFORE_DESTROY="beforedestroy",C.AFTER_DESTROY="afterdestroy",C.RESIZE="resize",C.DIRTY_RECTANGLE="dirtyrectangle",C.RENDERER_CHANGED="rendererchanged",C),i6=new nV(nJ.MOUNTED),i5=new nV(nJ.UNMOUNTED),i4=new nV(i3.BEFORE_RENDER),i8=new nV(i3.RERENDER),i9=new nV(i3.AFTER_RENDER),i7=/*#__PURE__*/function(t){function e(t){/*@__PURE__*/f(I)(this,e),(i=/*@__PURE__*/f(L)(this,e)).Element=iA,i.inited=!1,i.context={},i.document=new iJ,i.document.defaultView=i,i.customElements=new iX;var r,n,i,a=t.container,o=t.canvas,s=t.offscreenCanvas,l=t.width,u=t.height,h=t.devicePixelRatio,d=t.renderer,c=t.background,p=t.cursor,g=t.document,y=t.requestAnimationFrame,v=t.cancelAnimationFrame,m=t.createImage,b=t.enableLargeImageOptimization,x=t.supportsPointerEvents,E=t.supportsTouchEvents,w=t.supportsCSSTransform,_=t.cleanUpOnDestroy,S=void 0===_||_,k=t.supportsMutipleCanvasesInOneContainer,N=t.useNativeClickEvent,O=t.alwaysTriggerPointerEventOnCanvas,T=t.isTouchEvent,M=t.isMouseEvent,A=t.dblClickSpeed;k||function(t,e,r){if(t){var n="string"==typeof t?document.getElementById(t):t;r1.has(n)&&r1.get(n).destroy(r),r1.set(n,e)}}(a,i,S);var C=l,R=u,P=h;return o&&(P=(P=h||r2&&window.devicePixelRatio||1)>=1?Math.ceil(P):1,C=l||("auto"===(r=r4(o,"width"))?o.offsetWidth:parseFloat(r))||o.width/P,R=u||("auto"===(n=r4(o,"height"))?o.offsetHeight:parseFloat(n))||o.height/P),s&&(iv.offscreenCanvas=s),i.devicePixelRatio=P,i.requestAnimationFrame=null!=y?y:nu.bind(iv.globalThis),i.cancelAnimationFrame=null!=v?v:nh.bind(iv.globalThis),i.supportsTouchEvents=null!=E?E:"ontouchstart"in iv.globalThis,i.supportsPointerEvents=null!=x?x:!!iv.globalThis.PointerEvent,i.isTouchEvent=null!=T?T:function(t){return i.supportsTouchEvents&&t instanceof iv.globalThis.TouchEvent},i.isMouseEvent=null!=M?M:function(t){return!iv.globalThis.MouseEvent||t instanceof iv.globalThis.MouseEvent&&(!i.supportsPointerEvents||!(t instanceof iv.globalThis.PointerEvent))},i.dblClickSpeed=null!=A?A:200,i.initRenderingContext({container:a,canvas:o,width:C,height:R,renderer:d,offscreenCanvas:s,devicePixelRatio:P,cursor:p||"default",background:c||"transparent",createImage:m,enableLargeImageOptimization:b,document:g,supportsCSSTransform:w,useNativeClickEvent:N,cleanUpOnDestroy:S,alwaysTriggerPointerEventOnCanvas:O}),i.initDefaultCamera(C,R,d.clipSpaceNearZ),i.initRenderer(d,!0),i}return /*@__PURE__*/f(j)(e,t),/*@__PURE__*/f(P)(e,[{key:"initRenderingContext",value:function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(t,e,r){var n=this,i=new iv.CameraContribution;i.clipSpaceNearZ=r,i.setType(t5.EXPLORING,t4.DEFAULT).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(-(t/2),t/2,e/2,-(e/2),.1,1e3),i.canvas=this,i.eventEmitter.on(t9.UPDATED,function(){n.context.renderingContext.renderReasons.add(nq.CAMERA_CHANGED),iv.enableSizeAttenuation&&n.getConfig().renderer.getConfig().enableSizeAttenuation&&n.updateSizeAttenuation()}),this.context.camera=i}},{key:"updateSizeAttenuation",value:function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(e){iv.styleValueRegistry.updateSizeAttenuation(e,t)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var t=this;return!this.readyPromise&&(this.readyPromise=new Promise(function(e){t.resolveReadyPromise=function(){e(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1?arguments[1]:void 0;void 0===e&&(e=this.getConfig().fastCleanExistingCanvas),e||this.dispatchEvent(new nV(i3.BEFORE_DESTROY)),this.frameId&&this.cancelAnimationFrame(this.frameId);var r=this.getRoot();this.unmountChildren(r),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),e||this.dispatchEvent(new nV(i3.AFTER_DESTROY));var n=function(t){t.currentTarget=null,t.manager=null,t.target=null,t.relatedNode=null};n(i6),n(i5),n(i4),n(i8),n(i9),n(iO),n(iE),n(iw),n(i_)}},{key:"changeSize",value:function(t,e){this.resize(t,e)}},{key:"resize",value:function(t,e){var r=this.context.config;r.width=t,r.height=e,this.getContextService().resize(t,e);var n=this.context.camera,i=n.getProjectionMode();n.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),i===t8.ORTHOGRAPHIC?n.setOrthographic(-(t/2),t/2,e/2,-(e/2),n.getNear(),n.getFar()):n.setAspect(t/e),this.dispatchEvent(new nV(i3.RESIZE,{width:t,height:e}))}},{key:"appendChild",value:function(t,e){return this.document.documentElement.appendChild(t,e)}},{key:"insertBefore",value:function(t,e){return this.document.documentElement.insertBefore(t,e)}},{key:"removeChild",value:function(t){return this.document.documentElement.removeChild(t)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(t){var e=this;t&&(i4.detail=t,i9.detail=t),this.dispatchEvent(i4),this.getRenderingService().render(this.getConfig(),t,function(){e.dispatchEvent(i8)}),this.dispatchEvent(i9)}},{key:"run",value:function(){var t=this,e=function(r,n){t.render(n),t.frameId=t.requestAnimationFrame(e)};e()}},{key:"initRenderer",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)throw Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new tS,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new iQ,new i2,new iZ([new i1])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(/*@__PURE__*/f(R)(/*@__PURE__*/f(R)({},iv),this.context)),this.context.renderingService=new nY(iv,this.context),this.context.eventService=new nH(iv,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,r,!0)):this.context.contextService.initAsync().then(function(){e.initRenderingService(t,r)})}},{key:"initRenderingService",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context.renderingService.init(function(){e.inited=!0,r?n?e.requestAnimationFrame(function(){e.dispatchEvent(new nV(i3.READY))}):e.dispatchEvent(new nV(i3.READY)):e.dispatchEvent(new nV(i3.RENDERER_CHANGED)),e.readyPromise&&e.resolveReadyPromise(),r||e.getRoot().forEach(function(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0,e.dirty=!0)}),e.mountChildren(e.getRoot()),t.getConfig().enableAutoRendering&&e.run()})}},{key:"loadRendererContainerModule",value:function(t){var e=this;t.getPlugins().forEach(function(t){t.context=e.context,t.init(iv)})}},{key:"setRenderer",value:function(t){var e=this.getConfig();if(e.renderer!==t){var r=e.renderer;e.renderer=t,this.destroy(!1,!0),/*@__PURE__*/f(D)((null==r?void 0:r.getPlugins())||[]).reverse().forEach(function(t){t.destroy(iv)}),this.initRenderer(t)}}},{key:"setCursor",value:function(t){this.getConfig().cursor=t,this.getContextService().applyCursorStyle(t)}},{key:"unmountChildren",value:function(t){var e=this;t.childNodes.forEach(function(t){e.unmountChildren(t)}),this.inited&&(t.isMutationObserved?t.dispatchEvent(i5):(i5.target=t,this.dispatchEvent(i5,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()}},{key:"mountChildren",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r7(t);this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,r||(t.isMutationObserved?t.dispatchEvent(i6):(i6.target=t,this.dispatchEvent(i6,!0)))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach(function(t){e.mountChildren(t,r)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()}},{key:"mountFragment",value:function(t){this.mountChildren(t,!1)}},{key:"client2Viewport",value:function(t){return this.getEventService().client2Viewport(t)}},{key:"viewport2Client",value:function(t){return this.getEventService().viewport2Client(t)}},{key:"viewport2Canvas",value:function(t){return this.getEventService().viewport2Canvas(t)}},{key:"canvas2Viewport",value:function(t){return this.getEventService().canvas2Viewport(t)}},{key:"getPointByClient",value:function(t,e){return this.client2Viewport({x:t,y:e})}},{key:"getClientByPoint",value:function(t,e){return this.viewport2Client({x:t,y:e})}}])}(n$)}),v("cbdLd",function(t,e){var r=y("g5Zhu");function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}t.exports=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach(function(e){r(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t},t.exports.__esModule=!0,t.exports.default=t.exports}),v("g5Zhu",function(t,e){var r=y("5DKOa");t.exports=function(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports}),v("5DKOa",function(t,e){var r=y("41YNz").default,n=y("fKGZD");t.exports=function(t){var e=n(t,"string");return"symbol"==r(e)?e:e+""},t.exports.__esModule=!0,t.exports.default=t.exports}),v("41YNz",function(t,e){function r(e){return t.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}),v("fKGZD",function(t,e){var r=y("41YNz").default;t.exports=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)},t.exports.__esModule=!0,t.exports.default=t.exports}),v("fu0YK",function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports}),v("lR7jo",function(t,e){var r=y("5DKOa");function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports}),v("fUHKi",function(t,e){var r=y("5F6pO"),n=y("hAHB6"),i=y("72a6v"),a=y("8UrHA");t.exports=function(t){return r(t)||n(t)||i(t)||a()},t.exports.__esModule=!0,t.exports.default=t.exports}),v("5F6pO",function(t,e){var r=y("2zZPz");t.exports=function(t){if(Array.isArray(t))return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports}),v("2zZPz",function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n},t.exports.__esModule=!0,t.exports.default=t.exports}),v("hAHB6",function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports}),v("72a6v",function(t,e){var r=y("2zZPz");t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=({}).toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}),v("8UrHA",function(t,e){t.exports=function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports}),v("jLNr1",function(t,e){var r=y("cGTaw"),n=y("5HCVq"),i=y("eN9hz");t.exports=function(t,e,a){return e=r(e),i(t,n()?Reflect.construct(e,a||[],r(t).constructor):e.apply(t,a))},t.exports.__esModule=!0,t.exports.default=t.exports}),v("cGTaw",function(t,e){function r(e){return t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}),v("5HCVq",function(t,e){function r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(t.exports=r=function(){return!!e},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}),v("eN9hz",function(t,e){var r=y("41YNz").default,n=y("6zC7B");t.exports=function(t,e){if(e&&("object"==r(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return n(t)},t.exports.__esModule=!0,t.exports.default=t.exports}),v("6zC7B",function(t,e){t.exports=function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports}),v("f8wIT",function(t,e){var r=y("aAhot");t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports}),v("aAhot",function(t,e){function r(e,n){return t.exports=r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,r(e,n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}),v("02Ztr",function(t,e){var r=y("gpDEB"),n=y("kzBhd"),i=y("72a6v"),a=y("dIU5s");t.exports=function(t,e){return r(t)||n(t,e)||i(t,e)||a()},t.exports.__esModule=!0,t.exports.default=t.exports}),v("gpDEB",function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports}),v("kzBhd",function(t,e){t.exports=function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}},t.exports.__esModule=!0,t.exports.default=t.exports}),v("dIU5s",function(t,e){t.exports=function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports}),v("3vRz3",function(t,e){var r=Object.prototype.hasOwnProperty,n="~";function i(){}function a(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,r,i,o){if("function"!=typeof r)throw TypeError("The listener must be a function");var s=new a(r,i||t,o),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function l(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1)),l.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)r.call(t,e)&&i.push(n?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},l.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=Array(a);i<a;i++)o[i]=r[i].fn;return o},l.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},l.prototype.emit=function(t,e,r,i,a,o){var s=n?n+t:t;if(!this._events[s])return!1;var l,u,h=this._events[s],d=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),d){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,r),!0;case 4:return h.fn.call(h.context,e,r,i),!0;case 5:return h.fn.call(h.context,e,r,i,a),!0;case 6:return h.fn.call(h.context,e,r,i,a,o),!0}for(u=1,l=Array(d-1);u<d;u++)l[u-1]=arguments[u];h.fn.apply(h.context,l)}else{var c,f=h.length;for(u=0;u<f;u++)switch(h[u].once&&this.removeListener(t,h[u].fn,void 0,!0),d){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,e);break;case 3:h[u].fn.call(h[u].context,e,r);break;case 4:h[u].fn.call(h[u].context,e,r,i);break;default:if(!l)for(c=1,l=Array(d-1);c<d;c++)l[c-1]=arguments[c];h[u].fn.apply(h[u].context,l)}}return!0},l.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},l.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},l.prototype.removeListener=function(t,e,r,i){var a=n?n+t:t;if(!this._events[a])return this;if(!e)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn!==e||i&&!o.once||r&&o.context!==r||s(this,a);else{for(var l=0,u=[],h=o.length;l<h;l++)(o[l].fn!==e||i&&!o[l].once||r&&o[l].context!==r)&&u.push(o[l]);u.length?this._events[a]=1===u.length?u[0]:u:s(this,a)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&s(this,e)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,t.exports=l}),v("bDSmI",function(t,e){n(t.exports,"create",()=>i),n(t.exports,"fromMat4",()=>a),n(t.exports,"clone",()=>o),n(t.exports,"copy",()=>s),n(t.exports,"fromValues",()=>l),n(t.exports,"set",()=>u),n(t.exports,"identity",()=>h),n(t.exports,"transpose",()=>d),n(t.exports,"invert",()=>c),n(t.exports,"adjoint",()=>f),n(t.exports,"determinant",()=>p),n(t.exports,"multiply",()=>g),n(t.exports,"translate",()=>v),n(t.exports,"rotate",()=>m),n(t.exports,"scale",()=>b),n(t.exports,"fromTranslation",()=>x),n(t.exports,"fromRotation",()=>E),n(t.exports,"fromScaling",()=>w),n(t.exports,"fromMat2d",()=>_),n(t.exports,"fromQuat",()=>S),n(t.exports,"normalFromMat4",()=>k),n(t.exports,"projection",()=>N),n(t.exports,"str",()=>O),n(t.exports,"frob",()=>T),n(t.exports,"add",()=>M),n(t.exports,"subtract",()=>A),n(t.exports,"multiplyScalar",()=>C),n(t.exports,"multiplyScalarAndAdd",()=>R),n(t.exports,"exactEquals",()=>I),n(t.exports,"equals",()=>P),n(t.exports,"mul",()=>D),n(t.exports,"sub",()=>L);var r=y("amnUE");function i(){var t=new r.ARRAY_TYPE(9);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function o(t){var e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function s(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function l(t,e,n,i,a,o,s,l,u){var h=new r.ARRAY_TYPE(9);return h[0]=t,h[1]=e,h[2]=n,h[3]=i,h[4]=a,h[5]=o,h[6]=s,h[7]=l,h[8]=u,h}function u(t,e,r,n,i,a,o,s,l,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t}function h(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function d(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function c(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],h=e[8],d=h*o-s*u,c=-h*a+s*l,f=u*a-o*l,p=r*d+n*c+i*f;return p?(p=1/p,t[0]=d*p,t[1]=(-h*n+i*u)*p,t[2]=(s*n-i*o)*p,t[3]=c*p,t[4]=(h*r-i*l)*p,t[5]=(-s*r+i*a)*p,t[6]=f*p,t[7]=(-u*r+n*l)*p,t[8]=(o*r-n*a)*p,t):null}function f(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],h=e[8];return t[0]=o*h-s*u,t[1]=i*u-n*h,t[2]=n*s-i*o,t[3]=s*l-a*h,t[4]=r*h-i*l,t[5]=i*a-r*s,t[6]=a*u-o*l,t[7]=n*l-r*u,t[8]=r*o-n*a,t}function p(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8];return e*(u*a-o*l)+r*(-u*i+o*s)+n*(l*i-a*s)}function g(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],h=e[7],d=e[8],c=r[0],f=r[1],p=r[2],g=r[3],y=r[4],v=r[5],m=r[6],b=r[7],x=r[8];return t[0]=c*n+f*o+p*u,t[1]=c*i+f*s+p*h,t[2]=c*a+f*l+p*d,t[3]=g*n+y*o+v*u,t[4]=g*i+y*s+v*h,t[5]=g*a+y*l+v*d,t[6]=m*n+b*o+x*u,t[7]=m*i+b*s+x*h,t[8]=m*a+b*l+x*d,t}function v(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],h=e[7],d=e[8],c=r[0],f=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=c*n+f*o+u,t[7]=c*i+f*s+h,t[8]=c*a+f*l+d,t}function m(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],h=e[7],d=e[8],c=Math.sin(r),f=Math.cos(r);return t[0]=f*n+c*o,t[1]=f*i+c*s,t[2]=f*a+c*l,t[3]=f*o-c*n,t[4]=f*s-c*i,t[5]=f*l-c*a,t[6]=u,t[7]=h,t[8]=d,t}function b(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function x(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function E(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function w(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function _(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function S(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,l=i+i,u=r*o,h=n*o,d=n*s,c=i*o,f=i*s,p=i*l,g=a*o,y=a*s,v=a*l;return t[0]=1-d-p,t[3]=h-v,t[6]=c+y,t[1]=h+v,t[4]=1-u-p,t[7]=f-g,t[2]=c-y,t[5]=f+g,t[8]=1-u-d,t}function k(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],h=e[8],d=e[9],c=e[10],f=e[11],p=e[12],g=e[13],y=e[14],v=e[15],m=r*s-n*o,b=r*l-i*o,x=r*u-a*o,E=n*l-i*s,w=n*u-a*s,_=i*u-a*l,S=h*g-d*p,k=h*y-c*p,N=h*v-f*p,O=d*y-c*g,T=d*v-f*g,M=c*v-f*y,A=m*M-b*T+x*O+E*N-w*k+_*S;return A?(A=1/A,t[0]=(s*M-l*T+u*O)*A,t[1]=(l*N-o*M-u*k)*A,t[2]=(o*T-s*N+u*S)*A,t[3]=(i*T-n*M-a*O)*A,t[4]=(r*M-i*N+a*k)*A,t[5]=(n*N-r*T-a*S)*A,t[6]=(g*_-y*w+v*E)*A,t[7]=(y*x-p*_-v*b)*A,t[8]=(p*w-g*x+v*m)*A,t):null}function N(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function O(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function T(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function M(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function A(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function C(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function R(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function I(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function P(t,e){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],h=t[7],d=t[8],c=e[0],f=e[1],p=e[2],g=e[3],y=e[4],v=e[5],m=e[6],b=e[7],x=e[8];return Math.abs(n-c)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-f)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(a-p)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-g)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(s-y)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(l-v)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(u-m)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(h-b)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))&&Math.abs(d-x)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))}var D=g,L=A}),v("amnUE",function(t,e){n(t.exports,"EPSILON",()=>r),n(t.exports,"ARRAY_TYPE",()=>i),n(t.exports,"RANDOM",()=>a);var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,a=Math.random;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})}),v("3iqbd",function(t,e){n(t.exports,"create",()=>i),n(t.exports,"clone",()=>a),n(t.exports,"copy",()=>o),n(t.exports,"fromValues",()=>s),n(t.exports,"set",()=>l),n(t.exports,"identity",()=>u),n(t.exports,"transpose",()=>h),n(t.exports,"invert",()=>d),n(t.exports,"adjoint",()=>c),n(t.exports,"determinant",()=>f),n(t.exports,"multiply",()=>p),n(t.exports,"translate",()=>g),n(t.exports,"scale",()=>v),n(t.exports,"rotate",()=>m),n(t.exports,"rotateX",()=>b),n(t.exports,"rotateY",()=>x),n(t.exports,"rotateZ",()=>E),n(t.exports,"fromTranslation",()=>w),n(t.exports,"fromScaling",()=>_),n(t.exports,"fromRotation",()=>S),n(t.exports,"fromXRotation",()=>k),n(t.exports,"fromYRotation",()=>N),n(t.exports,"fromZRotation",()=>O),n(t.exports,"fromRotationTranslation",()=>T),n(t.exports,"fromQuat2",()=>M),n(t.exports,"getTranslation",()=>A),n(t.exports,"getScaling",()=>C),n(t.exports,"getRotation",()=>R),n(t.exports,"fromRotationTranslationScale",()=>I),n(t.exports,"fromRotationTranslationScaleOrigin",()=>P),n(t.exports,"fromQuat",()=>D),n(t.exports,"frustum",()=>L),n(t.exports,"perspectiveNO",()=>j),n(t.exports,"perspective",()=>F),n(t.exports,"perspectiveZO",()=>B),n(t.exports,"perspectiveFromFieldOfView",()=>z),n(t.exports,"orthoNO",()=>V),n(t.exports,"ortho",()=>G),n(t.exports,"orthoZO",()=>$),n(t.exports,"lookAt",()=>U),n(t.exports,"targetTo",()=>H),n(t.exports,"str",()=>W),n(t.exports,"frob",()=>q),n(t.exports,"add",()=>Y),n(t.exports,"subtract",()=>K),n(t.exports,"multiplyScalar",()=>X),n(t.exports,"multiplyScalarAndAdd",()=>J),n(t.exports,"exactEquals",()=>Z),n(t.exports,"equals",()=>Q),n(t.exports,"mul",()=>tt),n(t.exports,"sub",()=>te);var r=y("amnUE");function i(){var t=new r.ARRAY_TYPE(16);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function a(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function s(t,e,n,i,a,o,s,l,u,h,d,c,f,p,g,y){var v=new r.ARRAY_TYPE(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=i,v[4]=a,v[5]=o,v[6]=s,v[7]=l,v[8]=u,v[9]=h,v[10]=d,v[11]=c,v[12]=f,v[13]=p,v[14]=g,v[15]=y,v}function l(t,e,r,n,i,a,o,s,l,u,h,d,c,f,p,g,y){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t[9]=h,t[10]=d,t[11]=c,t[12]=f,t[13]=p,t[14]=g,t[15]=y,t}function u(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function h(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function d(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],h=e[8],d=e[9],c=e[10],f=e[11],p=e[12],g=e[13],y=e[14],v=e[15],m=r*s-n*o,b=r*l-i*o,x=r*u-a*o,E=n*l-i*s,w=n*u-a*s,_=i*u-a*l,S=h*g-d*p,k=h*y-c*p,N=h*v-f*p,O=d*y-c*g,T=d*v-f*g,M=c*v-f*y,A=m*M-b*T+x*O+E*N-w*k+_*S;return A?(A=1/A,t[0]=(s*M-l*T+u*O)*A,t[1]=(i*T-n*M-a*O)*A,t[2]=(g*_-y*w+v*E)*A,t[3]=(c*w-d*_-f*E)*A,t[4]=(l*N-o*M-u*k)*A,t[5]=(r*M-i*N+a*k)*A,t[6]=(y*x-p*_-v*b)*A,t[7]=(h*_-c*x+f*b)*A,t[8]=(o*T-s*N+u*S)*A,t[9]=(n*N-r*T-a*S)*A,t[10]=(p*w-g*x+v*m)*A,t[11]=(d*x-h*w-f*m)*A,t[12]=(s*k-o*O-l*S)*A,t[13]=(r*O-n*k+i*S)*A,t[14]=(g*b-p*E-y*m)*A,t[15]=(h*E-d*b+c*m)*A,t):null}function c(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],h=e[8],d=e[9],c=e[10],f=e[11],p=e[12],g=e[13],y=e[14],v=e[15];return t[0]=s*(c*v-f*y)-d*(l*v-u*y)+g*(l*f-u*c),t[1]=-(n*(c*v-f*y)-d*(i*v-a*y)+g*(i*f-a*c)),t[2]=n*(l*v-u*y)-s*(i*v-a*y)+g*(i*u-a*l),t[3]=-(n*(l*f-u*c)-s*(i*f-a*c)+d*(i*u-a*l)),t[4]=-(o*(c*v-f*y)-h*(l*v-u*y)+p*(l*f-u*c)),t[5]=r*(c*v-f*y)-h*(i*v-a*y)+p*(i*f-a*c),t[6]=-(r*(l*v-u*y)-o*(i*v-a*y)+p*(i*u-a*l)),t[7]=r*(l*f-u*c)-o*(i*f-a*c)+h*(i*u-a*l),t[8]=o*(d*v-f*g)-h*(s*v-u*g)+p*(s*f-u*d),t[9]=-(r*(d*v-f*g)-h*(n*v-a*g)+p*(n*f-a*d)),t[10]=r*(s*v-u*g)-o*(n*v-a*g)+p*(n*u-a*s),t[11]=-(r*(s*f-u*d)-o*(n*f-a*d)+h*(n*u-a*s)),t[12]=-(o*(d*y-c*g)-h*(s*y-l*g)+p*(s*c-l*d)),t[13]=r*(d*y-c*g)-h*(n*y-i*g)+p*(n*c-i*d),t[14]=-(r*(s*y-l*g)-o*(n*y-i*g)+p*(n*l-i*s)),t[15]=r*(s*c-l*d)-o*(n*c-i*d)+h*(n*l-i*s),t}function f(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],h=t[9],d=t[10],c=t[11],f=t[12],p=t[13],g=t[14],y=t[15];return(e*o-r*a)*(d*y-c*g)-(e*s-n*a)*(h*y-c*p)+(e*l-i*a)*(h*g-d*p)+(r*s-n*o)*(u*y-c*f)-(r*l-i*o)*(u*g-d*f)+(n*l-i*s)*(u*p-h*f)}function p(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],h=e[7],d=e[8],c=e[9],f=e[10],p=e[11],g=e[12],y=e[13],v=e[14],m=e[15],b=r[0],x=r[1],E=r[2],w=r[3];return t[0]=b*n+x*s+E*d+w*g,t[1]=b*i+x*l+E*c+w*y,t[2]=b*a+x*u+E*f+w*v,t[3]=b*o+x*h+E*p+w*m,b=r[4],x=r[5],E=r[6],w=r[7],t[4]=b*n+x*s+E*d+w*g,t[5]=b*i+x*l+E*c+w*y,t[6]=b*a+x*u+E*f+w*v,t[7]=b*o+x*h+E*p+w*m,b=r[8],x=r[9],E=r[10],w=r[11],t[8]=b*n+x*s+E*d+w*g,t[9]=b*i+x*l+E*c+w*y,t[10]=b*a+x*u+E*f+w*v,t[11]=b*o+x*h+E*p+w*m,b=r[12],x=r[13],E=r[14],w=r[15],t[12]=b*n+x*s+E*d+w*g,t[13]=b*i+x*l+E*c+w*y,t[14]=b*a+x*u+E*f+w*v,t[15]=b*o+x*h+E*p+w*m,t}function g(t,e,r){var n,i,a,o,s,l,u,h,d,c,f,p,g=r[0],y=r[1],v=r[2];return e===t?(t[12]=e[0]*g+e[4]*y+e[8]*v+e[12],t[13]=e[1]*g+e[5]*y+e[9]*v+e[13],t[14]=e[2]*g+e[6]*y+e[10]*v+e[14],t[15]=e[3]*g+e[7]*y+e[11]*v+e[15]):(n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],h=e[7],d=e[8],c=e[9],f=e[10],p=e[11],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=u,t[7]=h,t[8]=d,t[9]=c,t[10]=f,t[11]=p,t[12]=n*g+s*y+d*v+e[12],t[13]=i*g+l*y+c*v+e[13],t[14]=a*g+u*y+f*v+e[14],t[15]=o*g+h*y+p*v+e[15]),t}function v(t,e,r){var n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function m(t,e,n,i){var a,o,s,l,u,h,d,c,f,p,g,y,v,m,b,x,E,w,_,S,k,N,O,T,M=i[0],A=i[1],C=i[2],R=Math.hypot(M,A,C);return R<r.EPSILON?null:(M*=R=1/R,A*=R,C*=R,a=Math.sin(n),s=1-(o=Math.cos(n)),l=e[0],u=e[1],h=e[2],d=e[3],c=e[4],f=e[5],p=e[6],g=e[7],y=e[8],v=e[9],m=e[10],b=e[11],x=M*M*s+o,E=A*M*s+C*a,w=C*M*s-A*a,_=M*A*s-C*a,S=A*A*s+o,k=C*A*s+M*a,N=M*C*s+A*a,O=A*C*s-M*a,T=C*C*s+o,t[0]=l*x+c*E+y*w,t[1]=u*x+f*E+v*w,t[2]=h*x+p*E+m*w,t[3]=d*x+g*E+b*w,t[4]=l*_+c*S+y*k,t[5]=u*_+f*S+v*k,t[6]=h*_+p*S+m*k,t[7]=d*_+g*S+b*k,t[8]=l*N+c*O+y*T,t[9]=u*N+f*O+v*T,t[10]=h*N+p*O+m*T,t[11]=d*N+g*O+b*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function b(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],h=e[9],d=e[10],c=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+u*n,t[5]=o*i+h*n,t[6]=s*i+d*n,t[7]=l*i+c*n,t[8]=u*i-a*n,t[9]=h*i-o*n,t[10]=d*i-s*n,t[11]=c*i-l*n,t}function x(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],s=e[2],l=e[3],u=e[8],h=e[9],d=e[10],c=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-u*n,t[1]=o*i-h*n,t[2]=s*i-d*n,t[3]=l*i-c*n,t[8]=a*n+u*i,t[9]=o*n+h*i,t[10]=s*n+d*i,t[11]=l*n+c*i,t}function E(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],h=e[5],d=e[6],c=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+u*n,t[1]=o*i+h*n,t[2]=s*i+d*n,t[3]=l*i+c*n,t[4]=u*i-a*n,t[5]=h*i-o*n,t[6]=d*i-s*n,t[7]=c*i-l*n,t}function w(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function _(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S(t,e,n){var i,a,o,s=n[0],l=n[1],u=n[2],h=Math.hypot(s,l,u);return h<r.EPSILON?null:(s*=h=1/h,l*=h,u*=h,i=Math.sin(e),o=1-(a=Math.cos(e)),t[0]=s*s*o+a,t[1]=l*s*o+u*i,t[2]=u*s*o-l*i,t[3]=0,t[4]=s*l*o-u*i,t[5]=l*l*o+a,t[6]=u*l*o+s*i,t[7]=0,t[8]=s*u*o+l*i,t[9]=l*u*o-s*i,t[10]=u*u*o+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function k(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function O(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function T(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=n+n,l=i+i,u=a+a,h=n*s,d=n*l,c=n*u,f=i*l,p=i*u,g=a*u,y=o*s,v=o*l,m=o*u;return t[0]=1-(f+g),t[1]=d+m,t[2]=c-v,t[3]=0,t[4]=d-m,t[5]=1-(h+g),t[6]=p+y,t[7]=0,t[8]=c+v,t[9]=p-y,t[10]=1-(h+f),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function M(t,e){var n=new r.ARRAY_TYPE(3),i=-e[0],a=-e[1],o=-e[2],s=e[3],l=e[4],u=e[5],h=e[6],d=e[7],c=i*i+a*a+o*o+s*s;return c>0?(n[0]=(l*s+d*i+u*o-h*a)*2/c,n[1]=(u*s+d*a+h*i-l*o)*2/c,n[2]=(h*s+d*o+l*a-u*i)*2/c):(n[0]=(l*s+d*i+u*o-h*a)*2,n[1]=(u*s+d*a+h*i-l*o)*2,n[2]=(h*s+d*o+l*a-u*i)*2),T(t,e,n),t}function A(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function C(t,e){var r=e[0],n=e[1],i=e[2],a=e[4],o=e[5],s=e[6],l=e[8],u=e[9],h=e[10];return t[0]=Math.hypot(r,n,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(l,u,h),t}function R(t,e){var n=new r.ARRAY_TYPE(3);C(n,e);var i=1/n[0],a=1/n[1],o=1/n[2],s=e[0]*i,l=e[1]*a,u=e[2]*o,h=e[4]*i,d=e[5]*a,c=e[6]*o,f=e[8]*i,p=e[9]*a,g=e[10]*o,y=s+d+g,v=0;return y>0?(v=2*Math.sqrt(y+1),t[3]=.25*v,t[0]=(c-p)/v,t[1]=(f-u)/v,t[2]=(l-h)/v):s>d&&s>g?(v=2*Math.sqrt(1+s-d-g),t[3]=(c-p)/v,t[0]=.25*v,t[1]=(l+h)/v,t[2]=(f+u)/v):d>g?(v=2*Math.sqrt(1+d-s-g),t[3]=(f-u)/v,t[0]=(l+h)/v,t[1]=.25*v,t[2]=(c+p)/v):(v=2*Math.sqrt(1+g-s-d),t[3]=(l-h)/v,t[0]=(f+u)/v,t[1]=(c+p)/v,t[2]=.25*v),t}function I(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3],l=i+i,u=a+a,h=o+o,d=i*l,c=i*u,f=i*h,p=a*u,g=a*h,y=o*h,v=s*l,m=s*u,b=s*h,x=n[0],E=n[1],w=n[2];return t[0]=(1-(p+y))*x,t[1]=(c+b)*x,t[2]=(f-m)*x,t[3]=0,t[4]=(c-b)*E,t[5]=(1-(d+y))*E,t[6]=(g+v)*E,t[7]=0,t[8]=(f+m)*w,t[9]=(g-v)*w,t[10]=(1-(d+p))*w,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function P(t,e,r,n,i){var a=e[0],o=e[1],s=e[2],l=e[3],u=a+a,h=o+o,d=s+s,c=a*u,f=a*h,p=a*d,g=o*h,y=o*d,v=s*d,m=l*u,b=l*h,x=l*d,E=n[0],w=n[1],_=n[2],S=i[0],k=i[1],N=i[2],O=(1-(g+v))*E,T=(f+x)*E,M=(p-b)*E,A=(f-x)*w,C=(1-(c+v))*w,R=(y+m)*w,I=(p+b)*_,P=(y-m)*_,D=(1-(c+g))*_;return t[0]=O,t[1]=T,t[2]=M,t[3]=0,t[4]=A,t[5]=C,t[6]=R,t[7]=0,t[8]=I,t[9]=P,t[10]=D,t[11]=0,t[12]=r[0]+S-(O*S+A*k+I*N),t[13]=r[1]+k-(T*S+C*k+P*N),t[14]=r[2]+N-(M*S+R*k+D*N),t[15]=1,t}function D(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,l=i+i,u=r*o,h=n*o,d=n*s,c=i*o,f=i*s,p=i*l,g=a*o,y=a*s,v=a*l;return t[0]=1-d-p,t[1]=h+v,t[2]=c-y,t[3]=0,t[4]=h-v,t[5]=1-u-p,t[6]=f+g,t[7]=0,t[8]=c+y,t[9]=f-g,t[10]=1-u-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function L(t,e,r,n,i,a,o){var s=1/(r-e),l=1/(i-n),u=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*l,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*l,t[10]=(o+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*u,t[15]=0,t}function j(t,e,r,n,i){var a,o=1/Math.tan(e/2);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(n-i),t[10]=(i+n)*a,t[14]=2*i*n*a):(t[10]=-1,t[14]=-2*n),t}var F=j;function B(t,e,r,n,i){var a,o=1/Math.tan(e/2);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(n-i),t[10]=i*a,t[14]=i*n*a):(t[10]=-1,t[14]=-n),t}function z(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(i+a);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((o-s)*l*.5),t[9]=(i-a)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function V(t,e,r,n,i,a,o){var s=1/(e-r),l=1/(n-i),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=(o+a)*u,t[15]=1,t}var G=V;function $(t,e,r,n,i,a,o){var s=1/(e-r),l=1/(n-i),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*l,t[14]=a*u,t[15]=1,t}function U(t,e,n,i){var a,o,s,l,h,d,c,f,p,g,y=e[0],v=e[1],m=e[2],b=i[0],x=i[1],E=i[2],w=n[0],_=n[1],S=n[2];return Math.abs(y-w)<r.EPSILON&&Math.abs(v-_)<r.EPSILON&&Math.abs(m-S)<r.EPSILON?u(t):(g=1/Math.hypot(c=y-w,f=v-_,p=m-S),c*=g,f*=g,p*=g,(g=Math.hypot(a=x*p-E*f,o=E*c-b*p,s=b*f-x*c))?(a*=g=1/g,o*=g,s*=g):(a=0,o=0,s=0),(g=Math.hypot(l=f*s-p*o,h=p*a-c*s,d=c*o-f*a))?(l*=g=1/g,h*=g,d*=g):(l=0,h=0,d=0),t[0]=a,t[1]=l,t[2]=c,t[3]=0,t[4]=o,t[5]=h,t[6]=f,t[7]=0,t[8]=s,t[9]=d,t[10]=p,t[11]=0,t[12]=-(a*y+o*v+s*m),t[13]=-(l*y+h*v+d*m),t[14]=-(c*y+f*v+p*m),t[15]=1,t)}function H(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=n[0],l=n[1],u=n[2],h=i-r[0],d=a-r[1],c=o-r[2],f=h*h+d*d+c*c;f>0&&(h*=f=1/Math.sqrt(f),d*=f,c*=f);var p=l*c-u*d,g=u*h-s*c,y=s*d-l*h;return(f=p*p+g*g+y*y)>0&&(p*=f=1/Math.sqrt(f),g*=f,y*=f),t[0]=p,t[1]=g,t[2]=y,t[3]=0,t[4]=d*y-c*g,t[5]=c*p-h*y,t[6]=h*g-d*p,t[7]=0,t[8]=h,t[9]=d,t[10]=c,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function W(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function q(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Y(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function K(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function X(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function J(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function Z(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Q(t,e){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],h=t[7],d=t[8],c=t[9],f=t[10],p=t[11],g=t[12],y=t[13],v=t[14],m=t[15],b=e[0],x=e[1],E=e[2],w=e[3],_=e[4],S=e[5],k=e[6],N=e[7],O=e[8],T=e[9],M=e[10],A=e[11],C=e[12],R=e[13],I=e[14],P=e[15];return Math.abs(n-b)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(i-x)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-E)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(o-w)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-_)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(l-S)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(u-k)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(h-N)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(d-O)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(c-T)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(f-M)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(p-A)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(g-C)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(C))&&Math.abs(y-R)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(R))&&Math.abs(v-I)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(I))&&Math.abs(m-P)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))}var tt=p,te=K}),v("k1dpP",function(t,e){n(t.exports,"create",()=>f),n(t.exports,"identity",()=>p),n(t.exports,"setAxisAngle",()=>g),n(t.exports,"getAxisAngle",()=>v),n(t.exports,"getAngle",()=>m),n(t.exports,"dot",()=>V),n(t.exports,"multiply",()=>b),n(t.exports,"rotateX",()=>x),n(t.exports,"rotateY",()=>E),n(t.exports,"rotateZ",()=>w),n(t.exports,"calculateW",()=>_),n(t.exports,"exp",()=>S),n(t.exports,"ln",()=>k),n(t.exports,"pow",()=>N),n(t.exports,"scale",()=>z),n(t.exports,"slerp",()=>O),n(t.exports,"random",()=>T),n(t.exports,"invert",()=>M),n(t.exports,"conjugate",()=>A),n(t.exports,"fromMat3",()=>C),n(t.exports,"fromEuler",()=>R),n(t.exports,"str",()=>I),n(t.exports,"clone",()=>P),n(t.exports,"fromValues",()=>D),n(t.exports,"copy",()=>L),n(t.exports,"set",()=>j),n(t.exports,"add",()=>F),n(t.exports,"mul",()=>B),n(t.exports,"lerp",()=>G),n(t.exports,"length",()=>$),n(t.exports,"len",()=>U),n(t.exports,"squaredLength",()=>H),n(t.exports,"sqrLen",()=>W),n(t.exports,"normalize",()=>q),n(t.exports,"exactEquals",()=>Y),n(t.exports,"equals",()=>K),n(t.exports,"rotationTo",()=>X),n(t.exports,"sqlerp",()=>J),n(t.exports,"setAxes",()=>Z);var r,i,a,o,s,l,u=y("amnUE"),h=y("bDSmI"),d=y("eIStk"),c=y("jxhwV");function f(){var t=new u.ARRAY_TYPE(4);return u.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function p(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function g(t,e,r){var n=Math.sin(r*=.5);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function v(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>u.EPSILON?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function m(t,e){var r=V(t,e);return Math.acos(2*r*r-1)}function b(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],l=r[1],u=r[2],h=r[3];return t[0]=n*h+o*s+i*u-a*l,t[1]=i*h+o*l+a*s-n*u,t[2]=a*h+o*u+n*l-i*s,t[3]=o*h-n*s-i*l-a*u,t}function x(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*s,t[1]=i*l+a*s,t[2]=a*l-i*s,t[3]=o*l-n*s,t}function E(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l-a*s,t[1]=i*l+o*s,t[2]=a*l+n*s,t[3]=o*l-i*s,t}function w(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+i*s,t[1]=i*l-n*s,t[2]=a*l+o*s,t[3]=o*l-a*s,t}function _(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t}function S(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=Math.sqrt(r*r+n*n+i*i),s=Math.exp(a),l=o>0?s*Math.sin(o)/o:0;return t[0]=r*l,t[1]=n*l,t[2]=i*l,t[3]=s*Math.cos(o),t}function k(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=Math.sqrt(r*r+n*n+i*i),s=o>0?Math.atan2(o,a)/o:0;return t[0]=r*s,t[1]=n*s,t[2]=i*s,t[3]=.5*Math.log(r*r+n*n+i*i+a*a),t}function N(t,e,r){return k(t,e),z(t,t,r),S(t,t),t}function O(t,e,r,n){var i,a,o,s,l,h=e[0],d=e[1],c=e[2],f=e[3],p=r[0],g=r[1],y=r[2],v=r[3];return(a=h*p+d*g+c*y+f*v)<0&&(a=-a,p=-p,g=-g,y=-y,v=-v),1-a>u.EPSILON?(o=Math.sin(i=Math.acos(a)),s=Math.sin((1-n)*i)/o,l=Math.sin(n*i)/o):(s=1-n,l=n),t[0]=s*h+l*p,t[1]=s*d+l*g,t[2]=s*c+l*y,t[3]=s*f+l*v,t}function T(t){var e=u.RANDOM(),r=u.RANDOM(),n=u.RANDOM(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=a*Math.sin(2*Math.PI*n),t[3]=a*Math.cos(2*Math.PI*n),t}function M(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-i*s,t[3]=a*s,t}function A(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function C(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*o+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*a+o]-e[3*o+a])*r,t[a]=(e[3*a+i]+e[3*i+a])*r,t[o]=(e[3*o+i]+e[3*i+o])*r}return t}function R(t,e,r,n){var i=.5*Math.PI/180,a=Math.sin(e*=i),o=Math.cos(e),s=Math.sin(r*=i),l=Math.cos(r),u=Math.sin(n*=i),h=Math.cos(n);return t[0]=a*l*h-o*s*u,t[1]=o*s*h+a*l*u,t[2]=o*l*u-a*s*h,t[3]=o*l*h+a*s*u,t}function I(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var P=c.clone,D=c.fromValues,L=c.copy,j=c.set,F=c.add,B=b,z=c.scale,V=c.dot,G=c.lerp,$=c.length,U=$,H=c.squaredLength,W=H,q=c.normalize,Y=c.exactEquals,K=c.equals,X=(r=d.create(),i=d.fromValues(1,0,0),a=d.fromValues(0,1,0),function(t,e,n){var o=d.dot(e,n);return o<-.999999?(d.cross(r,i,e),1e-6>d.len(r)&&d.cross(r,a,e),d.normalize(r,r),g(t,r,Math.PI),t):o>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(d.cross(r,e,n),t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=1+o,q(t,t))}),J=(o=f(),s=f(),function(t,e,r,n,i,a){return O(o,e,i,a),O(s,r,n,a),O(t,o,s,2*a*(1-a)),t}),Z=(l=h.create(),function(t,e,r,n){return l[0]=r[0],l[3]=r[1],l[6]=r[2],l[1]=n[0],l[4]=n[1],l[7]=n[2],l[2]=-e[0],l[5]=-e[1],l[8]=-e[2],q(t,C(t,l))})}),v("eIStk",function(t,e){n(t.exports,"create",()=>a),n(t.exports,"clone",()=>o),n(t.exports,"length",()=>s),n(t.exports,"fromValues",()=>l),n(t.exports,"copy",()=>u),n(t.exports,"set",()=>h),n(t.exports,"add",()=>d),n(t.exports,"subtract",()=>c),n(t.exports,"multiply",()=>f),n(t.exports,"divide",()=>p),n(t.exports,"ceil",()=>g),n(t.exports,"floor",()=>v),n(t.exports,"min",()=>m),n(t.exports,"max",()=>b),n(t.exports,"round",()=>x),n(t.exports,"scale",()=>E),n(t.exports,"scaleAndAdd",()=>w),n(t.exports,"distance",()=>_),n(t.exports,"squaredDistance",()=>S),n(t.exports,"squaredLength",()=>k),n(t.exports,"negate",()=>N),n(t.exports,"inverse",()=>O),n(t.exports,"normalize",()=>T),n(t.exports,"dot",()=>M),n(t.exports,"cross",()=>A),n(t.exports,"lerp",()=>C),n(t.exports,"hermite",()=>R),n(t.exports,"bezier",()=>I),n(t.exports,"random",()=>P),n(t.exports,"transformMat4",()=>D),n(t.exports,"transformMat3",()=>L),n(t.exports,"transformQuat",()=>j),n(t.exports,"rotateX",()=>F),n(t.exports,"rotateY",()=>B),n(t.exports,"rotateZ",()=>z),n(t.exports,"angle",()=>V),n(t.exports,"zero",()=>G),n(t.exports,"str",()=>$),n(t.exports,"exactEquals",()=>U),n(t.exports,"equals",()=>H),n(t.exports,"sub",()=>W),n(t.exports,"mul",()=>q),n(t.exports,"div",()=>Y),n(t.exports,"dist",()=>K),n(t.exports,"sqrDist",()=>X),n(t.exports,"len",()=>J),n(t.exports,"sqrLen",()=>Z),n(t.exports,"forEach",()=>Q);var r,i=y("amnUE");function a(){var t=new i.ARRAY_TYPE(3);return i.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=new i.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function s(t){return Math.hypot(t[0],t[1],t[2])}function l(t,e,r){var n=new i.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n}function u(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function h(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function d(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function c(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function f(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function p(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function g(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function v(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function m(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function b(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function x(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function E(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function w(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function _(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function S(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}function k(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function N(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function O(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function T(t,e){var r=e[0],n=e[1],i=e[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function M(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function A(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],l=r[2];return t[0]=i*l-a*s,t[1]=a*o-n*l,t[2]=n*s-i*o,t}function C(t,e,r,n){var i=e[0],a=e[1],o=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t}function R(t,e,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,l=o*(a-2)+a,u=o*(a-1),h=o*(3-2*a);return t[0]=e[0]*s+r[0]*l+n[0]*u+i[0]*h,t[1]=e[1]*s+r[1]*l+n[1]*u+i[1]*h,t[2]=e[2]*s+r[2]*l+n[2]*u+i[2]*h,t}function I(t,e,r,n,i,a){var o=1-a,s=o*o,l=a*a,u=s*o,h=3*a*s,d=3*l*o,c=l*a;return t[0]=e[0]*u+r[0]*h+n[0]*d+i[0]*c,t[1]=e[1]*u+r[1]*h+n[1]*d+i[1]*c,t[2]=e[2]*u+r[2]*h+n[2]*d+i[2]*c,t}function P(t,e){e=e||1;var r=2*i.RANDOM()*Math.PI,n=2*i.RANDOM()-1,a=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=n*e,t}function D(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,t}function L(t,e,r){var n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t}function j(t,e,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=e[0],l=e[1],u=e[2],h=i*u-a*l,d=a*s-n*u,c=n*l-i*s,f=i*c-a*d,p=a*h-n*c,g=n*d-i*h,y=2*o;return h*=y,d*=y,c*=y,f*=2,p*=2,g*=2,t[0]=s+h+f,t[1]=l+d+p,t[2]=u+c+g,t}function F(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function B(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function z(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function V(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],o=e[1],s=e[2],l=Math.sqrt(r*r+n*n+i*i)*Math.sqrt(a*a+o*o+s*s);return Math.acos(Math.min(Math.max(l&&M(t,e)/l,-1),1))}function G(t){return t[0]=0,t[1]=0,t[2]=0,t}function $(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function U(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function H(t,e){var r=t[0],n=t[1],a=t[2],o=e[0],s=e[1],l=e[2];return Math.abs(r-o)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-l)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))}var W=c,q=f,Y=p,K=_,X=S,J=s,Z=k,Q=(r=a(),function(t,e,n,i,a,o){var s,l;for(e||(e=3),n||(n=0),l=i?Math.min(i*e+n,t.length):t.length,s=n;s<l;s+=e)r[0]=t[s],r[1]=t[s+1],r[2]=t[s+2],a(r,r,o),t[s]=r[0],t[s+1]=r[1],t[s+2]=r[2];return t})}),v("jxhwV",function(t,e){n(t.exports,"create",()=>a),n(t.exports,"clone",()=>o),n(t.exports,"fromValues",()=>s),n(t.exports,"copy",()=>l),n(t.exports,"set",()=>u),n(t.exports,"add",()=>h),n(t.exports,"subtract",()=>d),n(t.exports,"multiply",()=>c),n(t.exports,"divide",()=>f),n(t.exports,"ceil",()=>p),n(t.exports,"floor",()=>g),n(t.exports,"min",()=>v),n(t.exports,"max",()=>m),n(t.exports,"round",()=>b),n(t.exports,"scale",()=>x),n(t.exports,"scaleAndAdd",()=>E),n(t.exports,"distance",()=>w),n(t.exports,"squaredDistance",()=>_),n(t.exports,"length",()=>S),n(t.exports,"squaredLength",()=>k),n(t.exports,"negate",()=>N),n(t.exports,"inverse",()=>O),n(t.exports,"normalize",()=>T),n(t.exports,"dot",()=>M),n(t.exports,"cross",()=>A),n(t.exports,"lerp",()=>C),n(t.exports,"random",()=>R),n(t.exports,"transformMat4",()=>I),n(t.exports,"transformQuat",()=>P),n(t.exports,"zero",()=>D),n(t.exports,"str",()=>L),n(t.exports,"exactEquals",()=>j),n(t.exports,"equals",()=>F),n(t.exports,"sub",()=>B),n(t.exports,"mul",()=>z),n(t.exports,"div",()=>V),n(t.exports,"dist",()=>G),n(t.exports,"sqrDist",()=>$),n(t.exports,"len",()=>U),n(t.exports,"sqrLen",()=>H),n(t.exports,"forEach",()=>W);var r,i=y("amnUE");function a(){var t=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function o(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function s(t,e,r,n){var a=new i.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a}function l(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function u(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function h(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function d(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function c(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function f(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function p(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function g(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function v(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function m(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function b(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function x(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function E(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function w(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function _(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return r*r+n*n+i*i+a*a}function S(t){return Math.hypot(t[0],t[1],t[2],t[3])}function k(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function N(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function O(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function T(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=a*o,t}function M(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function A(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],a=r[0]*n[2]-r[2]*n[0],o=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],u=r[2]*n[3]-r[3]*n[2],h=e[0],d=e[1],c=e[2],f=e[3];return t[0]=d*u-c*l+f*s,t[1]=-(h*u)+c*o-f*a,t[2]=h*l-d*o+f*i,t[3]=-(h*s)+d*a-c*i,t}function C(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t[3]=s+n*(r[3]-s),t}function R(t,e){e=e||1;do s=(r=2*i.RANDOM()-1)*r+(n=2*i.RANDOM()-1)*n;while(s>=1)do l=(a=2*i.RANDOM()-1)*a+(o=2*i.RANDOM()-1)*o;while(l>=1)var r,n,a,o,s,l,u=Math.sqrt((1-s)/l);return t[0]=e*r,t[1]=e*n,t[2]=e*a*u,t[3]=e*o*u,t}function I(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,t}function P(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],l=r[2],u=r[3],h=u*n+s*a-l*i,d=u*i+l*n-o*a,c=u*a+o*i-s*n,f=-o*n-s*i-l*a;return t[0]=h*u+-(f*o)+-(d*l)- -(c*s),t[1]=d*u+-(f*s)+-(c*o)- -(h*l),t[2]=c*u+-(f*l)+-(h*s)- -(d*o),t[3]=e[3],t}function D(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function L(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function j(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function F(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],s=e[0],l=e[1],u=e[2],h=e[3];return Math.abs(r-s)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-u)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(o-h)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))}var B=d,z=c,V=f,G=w,$=_,U=S,H=k,W=(r=a(),function(t,e,n,i,a,o){var s,l;for(e||(e=4),n||(n=0),l=i?Math.min(i*e+n,t.length):t.length,s=n;s<l;s+=e)r[0]=t[s],r[1]=t[s+1],r[2]=t[s+2],r[3]=t[s+3],a(r,r,o),t[s]=r[0],t[s+1]=r[1],t[s+2]=r[2],t[s+3]=r[3];return t})}),v("6BoVD",function(t,e){n(t.exports,"create",()=>a),n(t.exports,"clone",()=>o),n(t.exports,"fromValues",()=>s),n(t.exports,"copy",()=>l),n(t.exports,"set",()=>u),n(t.exports,"add",()=>h),n(t.exports,"subtract",()=>d),n(t.exports,"multiply",()=>c),n(t.exports,"divide",()=>f),n(t.exports,"ceil",()=>p),n(t.exports,"floor",()=>g),n(t.exports,"min",()=>v),n(t.exports,"max",()=>m),n(t.exports,"round",()=>b),n(t.exports,"scale",()=>x),n(t.exports,"scaleAndAdd",()=>E),n(t.exports,"distance",()=>w),n(t.exports,"squaredDistance",()=>_),n(t.exports,"length",()=>S),n(t.exports,"squaredLength",()=>k),n(t.exports,"negate",()=>N),n(t.exports,"inverse",()=>O),n(t.exports,"normalize",()=>T),n(t.exports,"dot",()=>M),n(t.exports,"cross",()=>A),n(t.exports,"lerp",()=>C),n(t.exports,"random",()=>R),n(t.exports,"transformMat2",()=>I),n(t.exports,"transformMat2d",()=>P),n(t.exports,"transformMat3",()=>D),n(t.exports,"transformMat4",()=>L),n(t.exports,"rotate",()=>j),n(t.exports,"angle",()=>F),n(t.exports,"zero",()=>B),n(t.exports,"str",()=>z),n(t.exports,"exactEquals",()=>V),n(t.exports,"equals",()=>G),n(t.exports,"len",()=>$),n(t.exports,"sub",()=>U),n(t.exports,"mul",()=>H),n(t.exports,"div",()=>W),n(t.exports,"dist",()=>q),n(t.exports,"sqrDist",()=>Y),n(t.exports,"sqrLen",()=>K),n(t.exports,"forEach",()=>X);var r,i=y("amnUE");function a(){var t=new i.ARRAY_TYPE(2);return i.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function o(t){var e=new i.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e}function s(t,e){var r=new i.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r}function l(t,e){return t[0]=e[0],t[1]=e[1],t}function u(t,e,r){return t[0]=e,t[1]=r,t}function h(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function d(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function c(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function f(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function p(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function g(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function v(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function m(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function b(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function x(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function E(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function w(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function _(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function S(t){return Math.hypot(t[0],t[1])}function k(t){var e=t[0],r=t[1];return e*e+r*r}function N(t,e){return t[0]=-e[0],t[1]=-e[1],t}function O(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function T(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function M(t,e){return t[0]*e[0]+t[1]*e[1]}function A(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}function C(t,e,r,n){var i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t}function R(t,e){e=e||1;var r=2*i.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function I(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t}function P(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function D(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function L(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}function j(t,e,r,n){var i=e[0]-r[0],a=e[1]-r[1],o=Math.sin(n),s=Math.cos(n);return t[0]=i*s-a*o+r[0],t[1]=i*o+a*s+r[1],t}function F(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],o=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+a*a);return Math.acos(Math.min(Math.max(o&&(r*i+n*a)/o,-1),1))}function B(t){return t[0]=0,t[1]=0,t}function z(t){return"vec2("+t[0]+", "+t[1]+")"}function V(t,e){return t[0]===e[0]&&t[1]===e[1]}function G(t,e){var r=t[0],n=t[1],a=e[0],o=e[1];return Math.abs(r-a)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))}var $=S,U=d,H=c,W=f,q=w,Y=_,K=k,X=(r=a(),function(t,e,n,i,a,o){var s,l;for(e||(e=2),n||(n=0),l=i?Math.min(i*e+n,t.length):t.length,s=n;s<l;s+=e)r[0]=t[s],r[1]=t[s+1],a(r,r,o),t[s]=r[0],t[s+1]=r[1];return t})}),v("bnGdl",function(t,e){t.exports=function(t){throw TypeError('"'+t+'" is read-only')},t.exports.__esModule=!0,t.exports.default=t.exports}),v("8hhuV",function(t,e){n(t.exports,"default",()=>r);var r=function(t,e,r){return t<e?e:t>r?r:t}}),v("lIA8Y",function(t,e){n(t.exports,"clonePath",()=>r);function r(t){return t.map(function(t){return Array.isArray(t)?[].concat(t):t})}}),v("aoFex",function(t,e){n(t.exports,"distanceSquareRoot",()=>r);function r(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}}),v("gAC5x",function(t,e){n(t.exports,"equalizeSegments",()=>function t(e,r,n){var i=a(e),o=a(r),s=i.length,l=o.length,u=i.filter(function(t){return t.l}).length,h=o.filter(function(t){return t.l}).length,d=i.filter(function(t){return t.l}).reduce(function(t,e){return t+e.l},0)/u||0,c=o.filter(function(t){return t.l}).reduce(function(t,e){return t+e.l},0)/h||0,f=n||Math.max(s,l),p=[d,c],g=[f-s,f-l],y=0,v=[i,o].map(function(t,e){return t.l===f?t.map(function(t){return t.s}):t.map(function(t,r){return y=r&&g[e]&&t.l>=p[e],g[e]-=y?1:0,y?t.ss:[t.s]}).flat()});return v[0].length===v[1].length?v:t(v[0],v[1],f)});var r=y("8bNtF"),i=y("kJUxO");function a(t){return t.map(function(t,e,n){var a,o,s,l,u,h,d,c,f,p,g,y,v=e&&n[e-1].slice(-2).concat(t.slice(1)),m=e?(0,i.segmentCubicFactory)(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],{bbox:!1}).length:0;return y=e?m?(void 0===a&&(a=.5),o=v.slice(0,2),s=v.slice(2,4),l=v.slice(4,6),u=v.slice(6,8),h=(0,r.midPoint)(o,s,a),d=(0,r.midPoint)(s,l,a),c=(0,r.midPoint)(l,u,a),f=(0,r.midPoint)(h,d,a),p=(0,r.midPoint)(d,c,a),g=(0,r.midPoint)(f,p,a),[["C"].concat(h,f,g),["C"].concat(p,c,u)]):[t,t]:[t],{s:t,ss:y,l:m}})}}),v("8bNtF",function(t,e){n(t.exports,"midPoint",()=>r);function r(t,e,r){var n=t[0],i=t[1];return[n+(e[0]-n)*r,i+(e[1]-i)*r]}}),v("kJUxO",function(t,e){n(t.exports,"segmentCubicFactory",()=>i);var r=y("aoFex");function i(t,e,n,i,a,o,s,l,u,h){var d,c=h.bbox,f=void 0===c||c,p=h.length,g=void 0===p||p,y=h.sampleSize,v=void 0===y?10:y,m="number"==typeof u,b=t,x=e,E=0,w=[b,x,0],_=[b,x],S={x:0,y:0},k=[{x:b,y:x}];m&&u<=0&&(S={x:b,y:x});for(var N=0;N<=v;N+=1){if(b=(d=function(t,e,r,n,i,a,o,s,l){var u=1-l;return{x:Math.pow(u,3)*t+3*Math.pow(u,2)*l*r+3*u*Math.pow(l,2)*i+Math.pow(l,3)*o,y:Math.pow(u,3)*e+3*Math.pow(u,2)*l*n+3*u*Math.pow(l,2)*a+Math.pow(l,3)*s}}(t,e,n,i,a,o,s,l,N/v)).x,x=d.y,f&&k.push({x:b,y:x}),g&&(E+=(0,r.distanceSquareRoot)(_,[b,x])),_=[b,x],m&&E>=u&&u>w[2]){var O=(E-u)/(E-w[2]);S={x:_[0]*(1-O)+w[0]*O,y:_[1]*(1-O)+w[1]*O}}w=[b,x,E]}return m&&u>=E&&(S={x:s,y:l}),{length:E,point:S,min:{x:Math.min.apply(null,k.map(function(t){return t.x})),y:Math.min.apply(null,k.map(function(t){return t.y}))},max:{x:Math.max.apply(null,k.map(function(t){return t.x})),y:Math.max.apply(null,k.map(function(t){return t.y}))}}}}),v("bqypU",function(t,e){n(t.exports,"getDrawDirection",()=>i);var r=y("dgeSM");function i(t){return(0,r.getPathArea)(t)>=0}}),v("dgeSM",function(t,e){n(t.exports,"getPathArea",()=>i);var r=y("7Tbfw");function i(t){var e=0,n=0,i=0;return(0,r.path2Curve)(t).map(function(t){if("M"===t[0])return e=t[1],n=t[2],0;var r,a,o,s=t.slice(1),l=s[0],u=s[1],h=s[2],d=s[3],c=s[4],f=s[5];return a=e,i=3*((f-(o=n))*(l+h)-(c-a)*(u+d)+u*(a-h)-l*(o-d)+f*(h+a/3)-c*(d+o/3))/20,e=(r=t.slice(-2))[0],n=r[1],i}).reduce(function(t,e){return t+e},0)}}),v("7Tbfw",function(t,e){n(t.exports,"path2Curve",()=>u);var r=y("7WQrb"),i=y("98aG8"),a=y("6XFDb"),o=y("dnxxK"),s=y("fRiqm"),l=y("ioCSG");function u(t,e){if(void 0===e&&(e=!1),(0,s.isCurveArray)(t)){var n,u,h=[].concat(t);return e?[h,[]]:h}for(var d=(0,o.normalizePath)(t),c=(0,r.__assign)({},i.paramsParser),f=[],p="",g=d.length,y=[],v=0;v<g;v+=1){d[v]&&(p=d[v][0]),f[v]=p;var m=(0,l.segmentToCubic)(d[v],c);d[v]=m,(0,a.fixArc)(d,f,v),g=d.length,"Z"===p&&y.push(v),u=(n=d[v]).length,c.x1=+n[u-2],c.y1=+n[u-1],c.x2=+n[u-4]||c.x1,c.y2=+n[u-3]||c.y1}return e?[d,y]:d}}),v("7WQrb",function(t,e){n(t.exports,"__extends",()=>i),n(t.exports,"__assign",()=>a),n(t.exports,"__rest",()=>o),n(t.exports,"__awaiter",()=>s),n(t.exports,"__values",()=>l),n(t.exports,"__read",()=>u),n(t.exports,"__spreadArrays",()=>h),n(t.exports,"__spreadArray",()=>d),n(t.exports,"__classPrivateFieldGet",()=>c);var r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function i(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function o(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function s(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})}function l(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,a=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function h(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function d(t,e,r){if(r||2==arguments.length)for(var n,i=0,a=e.length;i<a;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}function c(t,e,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}"function"==typeof SuppressedError&&SuppressedError}),v("98aG8",function(t,e){n(t.exports,"paramsParser",()=>r);var r={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null}}),v("6XFDb",function(t,e){n(t.exports,"fixArc",()=>r);function r(t,e,r){if(t[r].length>7){t[r].shift();for(var n=t[r],i=r;n.length;)e[r]="A",t.splice(i+=1,0,["C"].concat(n.splice(0,6)));t.splice(r,1)}}}),v("dnxxK",function(t,e){n(t.exports,"normalizePath",()=>l);var r=y("7WQrb"),i=y("6M9GU"),a=y("98aG8"),o=y("b7Q1z"),s=y("bwWpb");function l(t){if((0,i.isNormalizedArray)(t))return[].concat(t);for(var e=(0,o.path2Absolute)(t),n=(0,r.__assign)({},a.paramsParser),l=0;l<e.length;l+=1){e[l]=(0,s.normalizeSegment)(e[l],n);var u=e[l],h=u.length;n.x1=+u[h-2],n.y1=+u[h-1],n.x2=+u[h-4]||n.x1,n.y2=+u[h-3]||n.y1}return e}}),v("6M9GU",function(t,e){n(t.exports,"isNormalizedArray",()=>i);var r=y("3n9Zo");function i(t){return(0,r.isAbsoluteArray)(t)&&t.every(function(t){var e=t[0];return"ACLMQZ".includes(e)})}}),v("3n9Zo",function(t,e){n(t.exports,"isAbsoluteArray",()=>i);var r=y("hU5u6");function i(t){return(0,r.isPathArray)(t)&&t.every(function(t){var e=t[0];return e===e.toUpperCase()})}}),v("hU5u6",function(t,e){n(t.exports,"isPathArray",()=>i);var r=y("abSfe");function i(t){return Array.isArray(t)&&t.every(function(t){var e=t[0].toLowerCase();return r.paramsCount[e]===t.length-1&&"achlmqstvz".includes(e)})}}),v("abSfe",function(t,e){n(t.exports,"paramsCount",()=>r);var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0}}),v("b7Q1z",function(t,e){n(t.exports,"path2Absolute",()=>a);var r=y("3n9Zo"),i=y("bvBSG");function a(t){if((0,r.isAbsoluteArray)(t))return[].concat(t);var e=(0,i.parsePathString)(t),n=0,a=0,o=0,s=0;return e.map(function(t){var e,r=t.slice(1).map(Number),i=t[0],l=i.toUpperCase();if("M"===i)return n=r[0],a=r[1],o=n,s=a,["M",n,a];if(i!==l)switch(l){case"A":e=[l,r[0],r[1],r[2],r[3],r[4],r[5]+n,r[6]+a];break;case"V":e=[l,r[0]+a];break;case"H":e=[l,r[0]+n];break;default:e=[l].concat(r.map(function(t,e){return t+(e%2?a:n)}))}else e=[l].concat(r);var u=e.length;switch(l){case"Z":n=o,a=s;break;case"H":n=e[1];break;case"V":a=e[1];break;default:n=e[u-2],a=e[u-1],"M"===l&&(o=n,s=a)}return e})}}),v("bvBSG",function(t,e){n(t.exports,"parsePathString",()=>s);var r=y("hU5u6"),i=y("jfdFp"),a=y("hn6XV"),o=y("hHA8n");function s(t){if((0,r.isPathArray)(t))return[].concat(t);var e=new o.PathParser(t);for((0,a.skipSpaces)(e);e.index<e.max&&!e.err.length;)(0,i.scanSegment)(e);return e.err?e.err:e.segments}}),v("jfdFp",function(t,e){n(t.exports,"scanSegment",()=>d);var r=y("lIhmn"),i=y("abSfe"),a=y("8npYx"),o=y("joolH"),s=y("hn6XV"),l=y("9V4v4"),u=y("4282W"),h=y("inyiT");function d(t){var e=t.max,n=t.pathValue,d=t.index,c=n.charCodeAt(d),f=i.paramsCount[n[d].toLowerCase()];if(t.segmentStart=d,!(0,l.isPathCommand)(c)){t.err='[path-util]: Invalid path value "'.concat(n[d],'" is not a path command');return}if(t.index+=1,(0,s.skipSpaces)(t),t.data=[],!f){(0,r.finalizeSegment)(t);return}for(;;){for(var p=f;p>0;p-=1){if((0,h.isArcCommand)(c)&&(3===p||4===p)?(0,a.scanFlag)(t):(0,o.scanParam)(t),t.err.length)return;t.data.push(t.param),(0,s.skipSpaces)(t),t.index<e&&44===n.charCodeAt(t.index)&&(t.index+=1,(0,s.skipSpaces)(t))}if(t.index>=t.max||!(0,u.isDigitStart)(n.charCodeAt(t.index)))break}(0,r.finalizeSegment)(t)}}),v("lIhmn",function(t,e){n(t.exports,"finalizeSegment",()=>i);var r=y("abSfe");function i(t){for(var e=t.pathValue[t.segmentStart],n=e.toLowerCase(),i=t.data;i.length>=r.paramsCount[n]&&("m"===n&&i.length>2?(t.segments.push([e].concat(i.splice(0,2))),n="l",e="m"===e?"l":"L"):t.segments.push([e].concat(i.splice(0,r.paramsCount[n]))),r.paramsCount[n]););}}),v("8npYx",function(t,e){n(t.exports,"scanFlag",()=>r);function r(t){var e=t.index,r=t.pathValue,n=r.charCodeAt(e);if(48===n){t.param=0,t.index+=1;return}if(49===n){t.param=1,t.index+=1;return}t.err='[path-util]: invalid Arc flag "'.concat(r[e],'", expecting 0 or 1 at index ').concat(e)}}),v("joolH",function(t,e){n(t.exports,"scanParam",()=>i);var r=y("4282W");function i(t){var e,n=t.max,i=t.pathValue,a=t.index,o=a,s=!1,l=!1,u=!1,h=!1;if(o>=n){t.err="[path-util]: Invalid path value at index ".concat(o,', "pathValue" is missing param');return}if((43===(e=i.charCodeAt(o))||45===e)&&(o+=1,e=i.charCodeAt(o)),!(0,r.isDigit)(e)&&46!==e){t.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(i[o],'" is not a number');return}if(46!==e){if(s=48===e,o+=1,e=i.charCodeAt(o),s&&o<n&&e&&(0,r.isDigit)(e)){t.err="[path-util]: Invalid path value at index ".concat(a,', "').concat(i[a],'" illegal number');return}for(;o<n&&(0,r.isDigit)(i.charCodeAt(o));)o+=1,l=!0;e=i.charCodeAt(o)}if(46===e){for(h=!0,o+=1;(0,r.isDigit)(i.charCodeAt(o));)o+=1,u=!0;e=i.charCodeAt(o)}if(101===e||69===e){if(h&&!l&&!u){t.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(i[o],'" invalid float exponent');return}if(o+=1,(43===(e=i.charCodeAt(o))||45===e)&&(o+=1),o<n&&(0,r.isDigit)(i.charCodeAt(o)))for(;o<n&&(0,r.isDigit)(i.charCodeAt(o));)o+=1;else{t.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(i[o],'" invalid integer exponent');return}}t.index=o,t.param=+t.pathValue.slice(a,o)}}),v("4282W",function(t,e){function r(t){return t>=48&&t<=57||43===t||45===t||46===t}function i(t){return t>=48&&t<=57}n(t.exports,"isDigitStart",()=>r),n(t.exports,"isDigit",()=>i)}),v("hn6XV",function(t,e){n(t.exports,"skipSpaces",()=>i);var r=y("aeUrB");function i(t){for(var e=t.pathValue,n=t.max;t.index<n&&(0,r.isSpace)(e.charCodeAt(t.index));)t.index+=1}}),v("aeUrB",function(t,e){n(t.exports,"isSpace",()=>r);function r(t){return 10===t||13===t||8232===t||8233===t||32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(t)}}),v("9V4v4",function(t,e){n(t.exports,"isPathCommand",()=>r);function r(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}}),v("inyiT",function(t,e){n(t.exports,"isArcCommand",()=>r);function r(t){return(32|t)==97}}),v("hHA8n",function(t,e){n(t.exports,"PathParser",()=>r);var r=function(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}}),v("bwWpb",function(t,e){n(t.exports,"normalizeSegment",()=>r);function r(t,e){var r=t[0],n=e.x1,i=e.y1,a=e.x2,o=e.y2,s=t.slice(1).map(Number),l=t;if("TQ".includes(r)||(e.qx=null,e.qy=null),"H"===r)l=["L",t[1],i];else if("V"===r)l=["L",n,t[1]];else if("S"===r){var u=2*n-a,h=2*i-o;e.x1=u,e.y1=h,l=["C",u,h].concat(s)}else if("T"===r){var d=2*n-e.qx,c=2*i-e.qy;e.qx=d,e.qy=c,l=["Q",d,c].concat(s)}else if("Q"===r){var f=s[0],p=s[1];e.qx=f,e.qy=p}return l}}),v("fRiqm",function(t,e){n(t.exports,"isCurveArray",()=>i);var r=y("6M9GU");function i(t){return(0,r.isNormalizedArray)(t)&&t.every(function(t){var e=t[0];return"MC".includes(e)})}}),v("ioCSG",function(t,e){n(t.exports,"segmentToCubic",()=>o);var r=y("2PAX5"),i=y("k0gaE"),a=y("cF3VT");function o(t,e){var n,o=t[0],s=t.slice(1).map(Number),l=s[0],u=s[1],h=e.x1,d=e.y1,c=e.x,f=e.y;switch("TQ".includes(o)||(e.qx=null,e.qy=null),o){case"M":e.x=l,e.y=u;break;case"A":return n=[h,d].concat(s),["C"].concat((0,r.arcToCubic)(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]));case"Q":return e.qx=l,e.qy=u,n=[h,d].concat(s),["C"].concat((0,i.quadToCubic)(n[0],n[1],n[2],n[3],n[4],n[5]));case"L":return["C"].concat((0,a.lineToCubic)(h,d,l,u));case"Z":if(h===c&&d===f)return["C",h,d,c,f,c,f];return["C"].concat((0,a.lineToCubic)(h,d,c,f))}return t}}),v("2PAX5",function(t,e){n(t.exports,"arcToCubic",()=>function t(e,n,i,a,o,s,l,u,h,d){var c,f,p,g,y,v=e,m=n,b=i,x=a,E=u,w=h,_=120*Math.PI/180,S=Math.PI/180*(+o||0),k=[];if(d)f=d[0],p=d[1],g=d[2],y=d[3];else{v=(c=(0,r.rotateVector)(v,m,-S)).x,m=c.y,E=(c=(0,r.rotateVector)(E,w,-S)).x,w=c.y;var N=(v-E)/2,O=(m-w)/2,T=N*N/(b*b)+O*O/(x*x);T>1&&(b*=T=Math.sqrt(T),x*=T);var M=b*b,A=x*x,C=(s===l?-1:1)*Math.sqrt(Math.abs((M*A-M*O*O-A*N*N)/(M*O*O+A*N*N)));g=C*b*O/x+(v+E)/2,y=-(C*x)*N/b+(m+w)/2,f=Math.asin(((m-y)/x*1e9>>0)/1e9),p=Math.asin(((w-y)/x*1e9>>0)/1e9),f=v<g?Math.PI-f:f,p=E<g?Math.PI-p:p,f<0&&(f=2*Math.PI+f),p<0&&(p=2*Math.PI+p),l&&f>p&&(f-=2*Math.PI),!l&&p>f&&(p-=2*Math.PI)}var R=p-f;if(Math.abs(R)>_){var I=p,P=E,D=w;k=t(E=g+b*Math.cos(p=f+_*(l&&p>f?1:-1)),w=y+x*Math.sin(p),b,x,o,0,l,P,D,[p,I,g,y])}R=p-f;var L=Math.cos(f),j=Math.cos(p),F=Math.tan(R/4),B=4/3*b*F,z=4/3*x*F,V=[v,m],G=[v+B*Math.sin(f),m-z*L],$=[E+B*Math.sin(p),w-z*j],U=[E,w];if(G[0]=2*V[0]-G[0],G[1]=2*V[1]-G[1],d)return G.concat($,U,k);k=G.concat($,U,k);for(var H=[],W=0,q=k.length;W<q;W+=1)H[W]=W%2?(0,r.rotateVector)(k[W-1],k[W],S).y:(0,r.rotateVector)(k[W],k[W+1],S).x;return H});var r=y("5V8ou")}),v("5V8ou",function(t,e){n(t.exports,"rotateVector",()=>r);function r(t,e,r){return{x:t*Math.cos(r)-e*Math.sin(r),y:t*Math.sin(r)+e*Math.cos(r)}}}),v("k0gaE",function(t,e){n(t.exports,"quadToCubic",()=>r);function r(t,e,r,n,i,a){return[1/3*t+2/3*r,1/3*e+2/3*n,1/3*i+2/3*r,1/3*a+2/3*n,i,a]}}),v("cF3VT",function(t,e){n(t.exports,"lineToCubic",()=>a);var r=y("7WQrb"),i=y("8bNtF"),a=function(t,e,n,a){var o=(0,i.midPoint)([t,e],[n,a],.5);return(0,r.__spreadArray)((0,r.__spreadArray)([],o,!0),[n,a,n,a],!1)}}),v("3O2w1",function(t,e){n(t.exports,"getPointAtLength",()=>a);var r=y("7WQrb"),i=y("awHWi");function a(t,e,n){return(0,i.pathLengthFactory)(t,e,(0,r.__assign)((0,r.__assign)({},n),{bbox:!1,length:!0})).point}}),v("awHWi",function(t,e){n(t.exports,"pathLengthFactory",()=>l);var r=y("dnxxK"),i=y("4mTD6"),a=y("crxLD"),o=y("kJUxO"),s=y("kDGGX");function l(t,e,n){for(var l,u,h,d,c,f,p,g,y,v=(0,r.normalizePath)(t),m="number"==typeof e,b=[],x=0,E=0,w=0,_=0,S=[],k=[],N=0,O={x:0,y:0},T=O,M=O,A=O,C=0,R=0,I=v.length;R<I;R+=1)b=(p="M"===(g=(y=v[R])[0]))?b:[x,E].concat(y.slice(1)),p?(T=O={x:w=y[1],y:_=y[2]},N=0,m&&e<.001&&(A=O)):"L"===g?(N=(l=(0,i.segmentLineFactory)(b[0],b[1],b[2],b[3],(e||0)-C)).length,O=l.min,T=l.max,M=l.point):"A"===g?(N=(u=(0,a.segmentArcFactory)(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],(e||0)-C,n||{})).length,O=u.min,T=u.max,M=u.point):"C"===g?(N=(h=(0,o.segmentCubicFactory)(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],(e||0)-C,n||{})).length,O=h.min,T=h.max,M=h.point):"Q"===g?(N=(d=(0,s.segmentQuadFactory)(b[0],b[1],b[2],b[3],b[4],b[5],(e||0)-C,n||{})).length,O=d.min,T=d.max,M=d.point):"Z"===g&&(b=[x,E,w,_],N=(c=(0,i.segmentLineFactory)(b[0],b[1],b[2],b[3],(e||0)-C)).length,O=c.min,T=c.max,M=c.point),m&&C<e&&C+N>=e&&(A=M),k.push(T),S.push(O),C+=N,x=(f="Z"!==g?y.slice(-2):[w,_])[0],E=f[1];return m&&e>=C&&(A={x:x,y:E}),{length:C,point:A,min:{x:Math.min.apply(null,S.map(function(t){return t.x})),y:Math.min.apply(null,S.map(function(t){return t.y}))},max:{x:Math.max.apply(null,k.map(function(t){return t.x})),y:Math.max.apply(null,k.map(function(t){return t.y}))}}}}),v("4mTD6",function(t,e){n(t.exports,"segmentLineFactory",()=>a);var r=y("8bNtF"),i=y("aoFex");function a(t,e,n,a,o){var s=(0,i.distanceSquareRoot)([t,e],[n,a]),l={x:0,y:0};if("number"==typeof o){if(o<=0)l={x:t,y:e};else if(o>=s)l={x:n,y:a};else{var u=(0,r.midPoint)([t,e],[n,a],o/s);l={x:u[0],y:u[1]}}}return{length:s,point:l,min:{x:Math.min(t,n),y:Math.min(e,a)},max:{x:Math.max(t,n),y:Math.max(e,a)}}}}),v("crxLD",function(t,e){n(t.exports,"segmentArcFactory",()=>o);var r=y("4mTD6"),i=y("aoFex");function a(t,e){var r=t.x,n=t.y,i=e.x,a=e.y,o=Math.sqrt((Math.pow(r,2)+Math.pow(n,2))*(Math.pow(i,2)+Math.pow(a,2)));return(r*a-n*i<0?-1:1)*Math.acos((r*i+n*a)/o)}function o(t,e,n,o,s,l,u,h,d,c,f){var p,g=f.bbox,y=void 0===g||g,v=f.length,m=void 0===v||v,b=f.sampleSize,x=void 0===b?30:b,E="number"==typeof c,w=t,_=e,S=0,k=[w,_,0],N=[w,_],O={x:0,y:0},T=[{x:w,y:_}];E&&c<=0&&(O={x:w,y:_});for(var M=0;M<=x;M+=1){if(w=(p=function(t,e,n,i,o,s,l,u,h,d){var c=Math.abs,f=Math.sin,p=Math.cos,g=Math.sqrt,y=Math.PI,v=c(n),m=c(i),b=y/180*((o%360+360)%360);if(t===u&&e===h)return{x:t,y:e};if(0===v||0===m)return(0,r.segmentLineFactory)(t,e,u,h,d).point;var x=(t-u)/2,E=(e-h)/2,w={x:p(b)*x+f(b)*E,y:-f(b)*x+p(b)*E},_=Math.pow(w.x,2)/Math.pow(v,2)+Math.pow(w.y,2)/Math.pow(m,2);_>1&&(v*=g(_),m*=g(_));var S=(Math.pow(v,2)*Math.pow(m,2)-Math.pow(v,2)*Math.pow(w.y,2)-Math.pow(m,2)*Math.pow(w.x,2))/(Math.pow(v,2)*Math.pow(w.y,2)+Math.pow(m,2)*Math.pow(w.x,2)),k=(s!==l?1:-1)*g(S=S<0?0:S),N={x:k*(v*w.y/m),y:k*(-(m*w.x)/v)},O={x:p(b)*N.x-f(b)*N.y+(t+u)/2,y:f(b)*N.x+p(b)*N.y+(e+h)/2},T={x:(w.x-N.x)/v,y:(w.y-N.y)/m},M=a({x:1,y:0},T),A=a(T,{x:(-w.x-N.x)/v,y:(-w.y-N.y)/m});!l&&A>0?A-=2*y:l&&A<0&&(A+=2*y);var C=M+(A%=2*y)*d,R=v*p(C),I=m*f(C);return{x:p(b)*R-f(b)*I+O.x,y:f(b)*R+p(b)*I+O.y}}(t,e,n,o,s,l,u,h,d,M/x)).x,_=p.y,y&&T.push({x:w,y:_}),m&&(S+=(0,i.distanceSquareRoot)(N,[w,_])),N=[w,_],E&&S>=c&&c>k[2]){var A=(S-c)/(S-k[2]);O={x:N[0]*(1-A)+k[0]*A,y:N[1]*(1-A)+k[1]*A}}k=[w,_,S]}return E&&c>=S&&(O={x:h,y:d}),{length:S,point:O,min:{x:Math.min.apply(null,T.map(function(t){return t.x})),y:Math.min.apply(null,T.map(function(t){return t.y}))},max:{x:Math.max.apply(null,T.map(function(t){return t.x})),y:Math.max.apply(null,T.map(function(t){return t.y}))}}}}),v("kDGGX",function(t,e){n(t.exports,"segmentQuadFactory",()=>i);var r=y("aoFex");function i(t,e,n,i,a,o,s,l){var u,h=l.bbox,d=void 0===h||h,c=l.length,f=void 0===c||c,p=l.sampleSize,g=void 0===p?10:p,y="number"==typeof s,v=t,m=e,b=0,x=[v,m,0],E=[v,m],w={x:0,y:0},_=[{x:v,y:m}];y&&s<=0&&(w={x:v,y:m});for(var S=0;S<=g;S+=1){if(v=(u=function(t,e,r,n,i,a,o){var s=1-o;return{x:Math.pow(s,2)*t+2*s*o*r+Math.pow(o,2)*i,y:Math.pow(s,2)*e+2*s*o*n+Math.pow(o,2)*a}}(t,e,n,i,a,o,S/g)).x,m=u.y,d&&_.push({x:v,y:m}),f&&(b+=(0,r.distanceSquareRoot)(E,[v,m])),E=[v,m],y&&b>=s&&s>x[2]){var k=(b-s)/(b-x[2]);w={x:E[0]*(1-k)+x[0]*k,y:E[1]*(1-k)+x[1]*k}}x=[v,m,b]}return y&&s>=b&&(w={x:a,y:o}),{length:b,point:w,min:{x:Math.min.apply(null,_.map(function(t){return t.x})),y:Math.min.apply(null,_.map(function(t){return t.y}))},max:{x:Math.max.apply(null,_.map(function(t){return t.x})),y:Math.max.apply(null,_.map(function(t){return t.y}))}}}}),v("ctnG0",function(t,e){n(t.exports,"getRotatedCurve",()=>i);var r=y("aoFex");function i(t,e){var n,i,a=t.length-1,o=[],s=0,l=(i=(n=t.length)-1,t.map(function(e,r){return t.map(function(e,a){var o=r+a;return 0===a||t[o]&&"M"===t[o][0]?["M"].concat(t[o].slice(-2)):(o>=n&&(o-=i),t[o])})}));return l.forEach(function(n,i){t.slice(1).forEach(function(n,o){s+=(0,r.distanceSquareRoot)(t[(i+o)%a].slice(-2),e[o%a].slice(-2))}),o[i]=s,s=0}),l[o.indexOf(Math.min.apply(null,o))]}}),v("iJzUi",function(t,e){n(t.exports,"getTotalLength",()=>a);var r=y("7WQrb"),i=y("awHWi");function a(t,e){return(0,i.pathLengthFactory)(t,void 0,(0,r.__assign)((0,r.__assign)({},e),{bbox:!1,length:!0})).length}}),v("1uF5a",function(t,e){n(t.exports,"default",()=>r);function r(t){return Array.isArray(t)}}),v("2LrCM",function(t,e){n(t.exports,"default",()=>i);var r=y("9E5Oj"),i=function(t){return(0,r.default)(t,"Boolean")}}),v("9E5Oj",function(t,e){n(t.exports,"default",()=>i);var r={}.toString,i=function(t,e){return r.call(t)==="[object "+e+"]"}}),v("ky7aH",function(t,e){n(t.exports,"default",()=>r);function r(t){return"function"==typeof t}}),v("geZBG",function(t,e){n(t.exports,"default",()=>r);function r(t){return null==t}}),v("jyI49",function(t,e){n(t.exports,"default",()=>r);function r(t){return"number"==typeof t}}),v("dFv1j",function(t,e){n(t.exports,"default",()=>r);function r(t,e,r){return void 0===r&&(r=1e-5),t===e||Math.abs(t-e)<r}}),v("6JKSc",function(t,e){n(t.exports,"default",()=>r);var r=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e}}),v("kVcyu",function(t,e){n(t.exports,"default",()=>r);function r(t){return"string"==typeof t}}),v("aFcWQ",function(t,e){n(t.exports,"default",()=>r);var r=function(t){return void 0===t}}),v("bFgqX",function(t,e){n(t.exports,"default",()=>r);function r(t){if(!Array.isArray(t))return-1/0;var e=t.length;if(!e)return-1/0;for(var r=t[0],n=1;n<e;n++)r=Math.max(r,t[n]);return r}}),v("04Wz9",function(t,e){n(t.exports,"default",()=>i);var r=y("1uF5a"),i=function(t){if((0,r.default)(t))return t.reduce(function(t,e){return Math.min(t,e)},t[0])}}),v("fo9PZ",function(t,e){n(t.exports,"default",()=>r);var r=function(t,e){return(t%e+e)%e}}),v("6kBPW",function(t,e){n(t.exports,"reverseCurve",()=>r);function r(t){var e=t.slice(1).map(function(e,r,n){return r?n[r-1].slice(-2).concat(e.slice(1)):t[0].slice(1).concat(e.slice(1))}).map(function(t){return t.map(function(e,r){return t[t.length-r-2*(1-r%2)]})}).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map(function(t){return["C"].concat(t.slice(2))}))}}),v("dPop6",function(t,e){var r=y("dpL0o"),n=y("cGTaw");t.exports=function(t,e,i,a){var o=r(n(1&a?t.prototype:t),e,i);return 2&a&&"function"==typeof o?function(t){return o.apply(i,t)}:o},t.exports.__esModule=!0,t.exports.default=t.exports}),v("dpL0o",function(t,e){var r=y("fkEbL");function n(){return t.exports=n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=r(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}},t.exports.__esModule=!0,t.exports.default=t.exports,n.apply(null,arguments)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}),v("fkEbL",function(t,e){var r=y("cGTaw");t.exports=function(t,e){for(;!({}).hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports}),v("bYoiY",function(t,e){n(t.exports,"Color",()=>i),n(t.exports,"darker",()=>a),n(t.exports,"brighter",()=>o),n(t.exports,"default",()=>E),n(t.exports,"hslConvert",()=>I),n(t.exports,"Rgb",()=>N),n(t.exports,"rgbConvert",()=>S),n(t.exports,"rgb",()=>k),n(t.exports,"hsl",()=>P);var r=y("bfWFq");function i(){}var a=.7,o=1.4285714285714286,s="\\s*([+-]?\\d+)\\s*",l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",h=/^#([0-9a-f]{3,8})$/,d=RegExp(`^rgb\\(${s},${s},${s}\\)$`),c=RegExp(`^rgb\\(${u},${u},${u}\\)$`),f=RegExp(`^rgba\\(${s},${s},${s},${l}\\)$`),p=RegExp(`^rgba\\(${u},${u},${u},${l}\\)$`),g=RegExp(`^hsl\\(${l},${u},${u}\\)$`),v=RegExp(`^hsla\\(${l},${u},${u},${l}\\)$`),m={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function b(){return this.rgb().formatHex()}function x(){return this.rgb().formatRgb()}function E(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=h.exec(t))?(r=e[1].length,e=parseInt(e[1],16),6===r?w(e):3===r?new N(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===r?_(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===r?_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=d.exec(t))?new N(e[1],e[2],e[3],1):(e=c.exec(t))?new N(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=f.exec(t))?_(e[1],e[2],e[3],e[4]):(e=p.exec(t))?_(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=g.exec(t))?R(e[1],e[2]/100,e[3]/100,1):(e=v.exec(t))?R(e[1],e[2]/100,e[3]/100,e[4]):m.hasOwnProperty(t)?w(m[t]):"transparent"===t?new N(NaN,NaN,NaN,0):null}function w(t){return new N(t>>16&255,t>>8&255,255&t,1)}function _(t,e,r,n){return n<=0&&(t=e=r=NaN),new N(t,e,r,n)}function S(t){return(t instanceof i||(t=E(t)),t)?new N((t=t.rgb()).r,t.g,t.b,t.opacity):new N}function k(t,e,r,n){return 1==arguments.length?S(t):new N(t,e,r,null==n?1:n)}function N(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}function O(){return`#${C(this.r)}${C(this.g)}${C(this.b)}`}function T(){let t=M(this.opacity);return`${1===t?"rgb(":"rgba("}${A(this.r)}, ${A(this.g)}, ${A(this.b)}${1===t?")":`, ${t})`}`}function M(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function A(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function C(t){return((t=A(t))<16?"0":"")+t.toString(16)}function R(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new D(t,e,r,n)}function I(t){if(t instanceof D)return new D(t.h,t.s,t.l,t.opacity);if(t instanceof i||(t=E(t)),!t)return new D;if(t instanceof D)return t;var e=(t=t.rgb()).r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),o=Math.max(e,r,n),s=NaN,l=o-a,u=(o+a)/2;return l?(s=e===o?(r-n)/l+(r<n)*6:r===o?(n-e)/l+2:(e-r)/l+4,l/=u<.5?o+a:2-o-a,s*=60):l=u>0&&u<1?0:s,new D(s,l,u,t.opacity)}function P(t,e,r,n){return 1==arguments.length?I(t):new D(t,e,r,null==n?1:n)}function D(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}function L(t){return(t=(t||0)%360)<0?t+360:t}function j(t){return Math.max(0,Math.min(1,t||0))}function F(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}(0,r.default)(i,E,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:b,formatHex:b,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return I(this).formatHsl()},formatRgb:x,toString:x}),(0,r.default)(N,k,(0,r.extend)(i,{brighter(t){return t=null==t?o:Math.pow(o,t),new N(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?a:Math.pow(a,t),new N(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new N(A(this.r),A(this.g),A(this.b),M(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:O,formatHex:O,formatHex8:function(){return`#${C(this.r)}${C(this.g)}${C(this.b)}${C((isNaN(this.opacity)?1:this.opacity)*255)}`},formatRgb:T,toString:T})),(0,r.default)(D,P,(0,r.extend)(i,{brighter(t){return t=null==t?o:Math.pow(o,t),new D(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?a:Math.pow(a,t),new D(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new N(F(t>=240?t-240:t+120,i,n),F(t,i,n),F(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new D(L(this.h),j(this.s),j(this.l),M(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=M(this.opacity);return`${1===t?"hsl(":"hsla("}${L(this.h)}, ${100*j(this.s)}%, ${100*j(this.l)}%${1===t?")":`, ${t})`}`}}))}),v("bfWFq",function(t,e){function r(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function i(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}n(t.exports,"default",()=>r),n(t.exports,"extend",()=>i)}),v("11s8J",function(t,e){n(t.exports,"distance",()=>o),n(t.exports,"arcBox",()=>l),n(t.exports,"lineLength",()=>h),n(t.exports,"linePointAt",()=>d),n(t.exports,"linePointToLine",()=>c),n(t.exports,"cubicBox",()=>g),n(t.exports,"cubicPointDistance",()=>v),n(t.exports,"polylineLength",()=>m),n(t.exports,"quadBox",()=>E),n(t.exports,"quadPointDistance",()=>w);var r=y("7WQrb"),i=y("dFv1j"),a=y("6BoVD");function o(t,e,r,n){var i=t-r,a=e-n;return Math.sqrt(i*i+a*a)}function s(t,e){var n=Math.min.apply(Math,(0,r.__spreadArray)([],(0,r.__read)(t),!1)),i=Math.min.apply(Math,(0,r.__spreadArray)([],(0,r.__read)(e),!1));return{x:n,y:i,width:Math.max.apply(Math,(0,r.__spreadArray)([],(0,r.__read)(t),!1))-n,height:Math.max.apply(Math,(0,r.__spreadArray)([],(0,r.__read)(e),!1))-i}}function l(t,e,r,n,i,a,o){for(var s=Math.atan(-n/r*Math.tan(i)),l=1/0,u=-1/0,h=[a,o],d=-(2*Math.PI);d<=2*Math.PI;d+=Math.PI){var c=s+d;a<o?a<c&&c<o&&h.push(c):o<c&&c<a&&h.push(c)}for(var d=0;d<h.length;d++){var f,p=r*Math.cos(i)*Math.cos(f=h[d])-n*Math.sin(i)*Math.sin(f)+t;p<l&&(l=p),p>u&&(u=p)}for(var g=Math.atan(n/(r*Math.tan(i))),y=1/0,v=-1/0,m=[a,o],d=-(2*Math.PI);d<=2*Math.PI;d+=Math.PI){var b=g+d;a<o?a<b&&b<o&&m.push(b):o<b&&b<a&&m.push(b)}for(var d=0;d<m.length;d++){var x,E=r*Math.sin(i)*Math.cos(x=m[d])+n*Math.cos(i)*Math.sin(x)+e;E<y&&(y=E),E>v&&(v=E)}return{x:l,y:y,width:u-l,height:v-y}}function u(t,e,n,i,a,s){var l=-1,u=1/0,h=[n,i],d=20;s&&s>200&&(d=s/10);for(var c=1/d,f=c/10,p=0;p<=d;p++){var g=p*c,y=[a.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(t.concat([g])),!1)),a.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(e.concat([g])),!1))],v=o(h[0],h[1],y[0],y[1]);v<u&&(l=g,u=v)}if(0===l)return{x:t[0],y:e[0]};if(1===l){var m=t.length;return{x:t[m-1],y:e[m-1]}}u=1/0;for(var p=0;p<32&&!(f<1e-4);p++){var b=l-f,x=l+f,y=[a.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(t.concat([b])),!1)),a.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(e.concat([b])),!1))],v=o(h[0],h[1],y[0],y[1]);if(b>=0&&v<u)l=b,u=v;else{var E=[a.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(t.concat([x])),!1)),a.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(e.concat([x])),!1))],w=o(h[0],h[1],E[0],E[1]);x<=1&&w<u?(l=x,u=w):f*=.5}}return{x:a.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(t.concat([l])),!1)),y:a.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(e.concat([l])),!1))}}function h(t,e,r,n){return o(t,e,r,n)}function d(t,e,r,n,i){return{x:(1-i)*t+i*r,y:(1-i)*e+i*n}}function c(t,e,r,n,i,o){var s=[r-t,n-e];if(a.exactEquals(s,[0,0]))return Math.sqrt((i-t)*(i-t)+(o-e)*(o-e));var l=[-s[1],s[0]];return a.normalize(l,l),Math.abs(a.dot([i-t,o-e],l))}function f(t,e,r,n,i){var a=1-i;return a*a*a*t+3*e*i*a*a+3*r*i*i*a+n*i*i*i}function p(t,e,r,n){var a,o,s,l=-3*t+9*e-9*r+3*n,u=6*t-12*e+6*r,h=3*e-3*t,d=[];if((0,i.default)(l,0))!(0,i.default)(u,0)&&(a=-h/u)>=0&&a<=1&&d.push(a);else{var c=u*u-4*l*h;(0,i.default)(c,0)?d.push(-u/(2*l)):c>0&&(a=(-u+(s=Math.sqrt(c)))/(2*l),o=(-u-s)/(2*l),a>=0&&a<=1&&d.push(a),o>=0&&o<=1&&d.push(o))}return d}function g(t,e,r,n,i,a,o,l){for(var u=[t,o],h=[e,l],d=p(t,r,i,o),c=p(e,n,a,l),g=0;g<d.length;g++)u.push(f(t,r,i,o,d[g]));for(var g=0;g<c.length;g++)h.push(f(e,n,a,l,c[g]));return s(u,h)}function v(t,e,r,n,i,a,s,l,h,d,c){var p=u([t,r,i,s],[e,n,a,l],h,d,f,c);return o(p.x,p.y,h,d)}function m(t){return function(t){if(t.length<2)return 0;for(var e=0,r=0;r<t.length-1;r++){var n=t[r],i=t[r+1];e+=o(n[0],n[1],i[0],i[1])}return e}(t)}function b(t,e,r,n){var i=1-n;return i*i*t+2*n*i*e+n*n*r}function x(t,e,r){var n=t+r-2*e;if((0,i.default)(n,0))return[.5];var a=(t-e)/n;return a<=1&&a>=0?[a]:[]}function E(t,e,r,n,i,a){var o=x(t,r,i)[0],l=x(e,n,a)[0],u=[t,i],h=[e,a];return void 0!==o&&u.push(b(t,r,i,o)),void 0!==l&&h.push(b(e,n,a,l)),s(u,h)}function w(t,e,r,n,i,a,s,l){var h=u([t,r,i],[e,n,a],s,l,b);return o(h.x,h.y,s,l)}}),v("8HV7i",function(t,e){var r=y("41YNz").default;function n(){t.exports=n=function(){return i},t.exports.__esModule=!0,t.exports.default=t.exports;var e,i={},a=Object.prototype,o=a.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},l="function"==typeof Symbol?Symbol:{},u=l.iterator||"@@iterator",h=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function f(t,r,n,i){var a,o,l=Object.create((r&&r.prototype instanceof b?r:b).prototype);return s(l,"_invoke",{value:(a=new A(i||[]),o=g,function(r,i){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===r)throw i;return{value:e,done:!0}}for(a.method=r,a.arg=i;;){var s=a.delegate;if(s){var l=function t(r,n){var i=n.method,a=r.iterator[i];if(a===e)return n.delegate=null,"throw"===i&&r.iterator.return&&(n.method="return",n.arg=e,t(r,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+i+"' method")),m;var o=p(a,r.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[r.resultName]=s.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):s:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,m)}(s,a);if(l){if(l===m)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(o===g)throw o=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);o=y;var u=p(t,n,a);if("normal"===u.type){if(o=a.done?v:"suspendedYield",u.arg===m)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(o=v,a.method="throw",a.arg=u.arg)}})}),l}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}i.wrap=f;var g="suspendedStart",y="executing",v="completed",m={};function b(){}function x(){}function E(){}var w={};c(w,u,function(){return this});var _=Object.getPrototypeOf,S=_&&_(_(C([])));S&&S!==a&&o.call(S,u)&&(w=S);var k=E.prototype=b.prototype=Object.create(w);function N(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function O(t,e){var n;s(this,"_invoke",{value:function(i,a){function s(){return new e(function(n,s){!function n(i,a,s,l){var u=p(t[i],t,a);if("throw"!==u.type){var h=u.arg,d=h.value;return d&&"object"==r(d)&&o.call(d,"__await")?e.resolve(d.__await).then(function(t){n("next",t,s,l)},function(t){n("throw",t,s,l)}):e.resolve(d).then(function(t){h.value=t,s(h)},function(t){return n("throw",t,s,l)})}l(u.arg)}(i,a,n,s)})}return n=n?n.then(s,s):s()}})}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function C(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw TypeError(r(t)+" is not iterable")}return x.prototype=E,s(k,"constructor",{value:E,configurable:!0}),s(E,"constructor",{value:x,configurable:!0}),x.displayName=c(E,d,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,c(t,d,"GeneratorFunction")),t.prototype=Object.create(k),t},i.awrap=function(t){return{__await:t}},N(O.prototype),c(O.prototype,h,function(){return this}),i.AsyncIterator=O,i.async=function(t,e,r,n,a){void 0===a&&(a=Promise);var o=new O(f(t,e,r,n),a);return i.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},N(k),c(k,d,"Generator"),c(k,u,function(){return this}),c(k,"toString",function(){return"[object Generator]"}),i.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},i.values=C,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),M(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;M(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},i}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}),v("fOd0O",function(t,e){function r(t,e,r,n,i,a,o){try{var s=t[a](o),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,i)}t.exports=function(t){return function(){var e=this,n=arguments;return new Promise(function(i,a){var o=t.apply(e,n);function s(t){r(o,i,a,s,l,"next",t)}function l(t){r(o,i,a,s,l,"throw",t)}s(void 0)})}},t.exports.__esModule=!0,t.exports.default=t.exports}),v("8QL5z",function(t,e){var r=y("72a6v");t.exports=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}},t.exports.__esModule=!0,t.exports.default=t.exports}),v("gZU1N",function(t,e){var r=y("c05no");t.exports=function(t,e){if(null==t)return{};var n,i,a=r(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],e.includes(n)||({}).propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a},t.exports.__esModule=!0,t.exports.default=t.exports}),v("c05no",function(t,e){t.exports=function(t,e){if(null==t)return{};var r={};for(var n in t)if(({}).hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r},t.exports.__esModule=!0,t.exports.default=t.exports}),v("6mwJ2",function(t,e){var r;try{r=y("2B9Zv")}catch(t){}r||(r=window.graphlib),t.exports=r}),v("2B9Zv",function(t,e){var r=y("5j6So");t.exports={Graph:r.Graph,json:y("cOdIh"),alg:y("jm1Oa"),version:r.version}}),v("5j6So",function(t,e){t.exports={Graph:y("4JZcb"),version:y("5LcVV")}}),v("4JZcb",function(t,e){var r=y("dOCPl");function n(t){this._isDirected=!r.has(t,"directed")||t.directed,this._isMultigraph=!!r.has(t,"multigraph")&&t.multigraph,this._isCompound=!!r.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function i(t,e){t[e]?t[e]++:t[e]=1}function a(t,e){--t[e]||delete t[e]}function o(t,e,n,i){var a=""+e,o=""+n;if(!t&&a>o){var s=a;a=o,o=s}return a+"\x01"+o+"\x01"+(r.isUndefined(i)?"\0":i)}function s(t,e){return o(t,e.v,e.w,e.name)}t.exports=n,n.prototype._nodeCount=0,n.prototype._edgeCount=0,n.prototype.isDirected=function(){return this._isDirected},n.prototype.isMultigraph=function(){return this._isMultigraph},n.prototype.isCompound=function(){return this._isCompound},n.prototype.setGraph=function(t){return this._label=t,this},n.prototype.graph=function(){return this._label},n.prototype.setDefaultNodeLabel=function(t){return r.isFunction(t)||(t=r.constant(t)),this._defaultNodeLabelFn=t,this},n.prototype.nodeCount=function(){return this._nodeCount},n.prototype.nodes=function(){return r.keys(this._nodes)},n.prototype.sources=function(){var t=this;return r.filter(this.nodes(),function(e){return r.isEmpty(t._in[e])})},n.prototype.sinks=function(){var t=this;return r.filter(this.nodes(),function(e){return r.isEmpty(t._out[e])})},n.prototype.setNodes=function(t,e){var n=arguments,i=this;return r.each(t,function(t){n.length>1?i.setNode(t,e):i.setNode(t)}),this},n.prototype.setNode=function(t,e){return r.has(this._nodes,t)?arguments.length>1&&(this._nodes[t]=e):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]="\0",this._children[t]={},this._children["\0"][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount),this},n.prototype.node=function(t){return this._nodes[t]},n.prototype.hasNode=function(t){return r.has(this._nodes,t)},n.prototype.removeNode=function(t){var e=this;if(r.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],r.each(this.children(t),function(t){e.setParent(t)}),delete this._children[t]),r.each(r.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],r.each(r.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},n.prototype.setParent=function(t,e){if(!this._isCompound)throw Error("Cannot set parent in a non-compound graph");if(r.isUndefined(e))e="\0";else{e+="";for(var n=e;!r.isUndefined(n);n=this.parent(n))if(n===t)throw Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},n.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},n.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if("\0"!==e)return e}},n.prototype.children=function(t){if(r.isUndefined(t)&&(t="\0"),this._isCompound){var e=this._children[t];if(e)return r.keys(e)}else if("\0"===t)return this.nodes();else if(this.hasNode(t))return[]},n.prototype.predecessors=function(t){var e=this._preds[t];if(e)return r.keys(e)},n.prototype.successors=function(t){var e=this._sucs[t];if(e)return r.keys(e)},n.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return r.union(e,this.successors(t))},n.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},n.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var n=this;r.each(this._nodes,function(r,n){t(n)&&e.setNode(n,r)}),r.each(this._edgeObjs,function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,n.edge(t))});var i={};return this._isCompound&&r.each(e.nodes(),function(t){e.setParent(t,function t(r){var a=n.parent(r);return void 0===a||e.hasNode(a)?(i[r]=a,a):a in i?i[a]:t(a)}(t))}),e},n.prototype.setDefaultEdgeLabel=function(t){return r.isFunction(t)||(t=r.constant(t)),this._defaultEdgeLabelFn=t,this},n.prototype.edgeCount=function(){return this._edgeCount},n.prototype.edges=function(){return r.values(this._edgeObjs)},n.prototype.setPath=function(t,e){var n=this,i=arguments;return r.reduce(t,function(t,r){return i.length>1?n.setEdge(t,r,e):n.setEdge(t,r),r}),this},n.prototype.setEdge=function(){var t,e,n,a,s=!1,l=arguments[0];"object"==typeof l&&null!==l&&"v"in l?(t=l.v,e=l.w,n=l.name,2==arguments.length&&(a=arguments[1],s=!0)):(t=l,e=arguments[1],n=arguments[3],arguments.length>2&&(a=arguments[2],s=!0)),t=""+t,e=""+e,r.isUndefined(n)||(n=""+n);var u=o(this._isDirected,t,e,n);if(r.has(this._edgeLabels,u))return s&&(this._edgeLabels[u]=a),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[u]=s?a:this._defaultEdgeLabelFn(t,e,n);var h=function(t,e,r,n){var i=""+e,a=""+r;if(!t&&i>a){var o=i;i=a,a=o}var s={v:i,w:a};return n&&(s.name=n),s}(this._isDirected,t,e,n);return t=h.v,e=h.w,Object.freeze(h),this._edgeObjs[u]=h,i(this._preds[e],t),i(this._sucs[t],e),this._in[e][u]=h,this._out[t][u]=h,this._edgeCount++,this},n.prototype.edge=function(t,e,r){var n=1==arguments.length?s(this._isDirected,arguments[0]):o(this._isDirected,t,e,r);return this._edgeLabels[n]},n.prototype.hasEdge=function(t,e,n){var i=1==arguments.length?s(this._isDirected,arguments[0]):o(this._isDirected,t,e,n);return r.has(this._edgeLabels,i)},n.prototype.removeEdge=function(t,e,r){var n=1==arguments.length?s(this._isDirected,arguments[0]):o(this._isDirected,t,e,r),i=this._edgeObjs[n];return i&&(t=i.v,e=i.w,delete this._edgeLabels[n],delete this._edgeObjs[n],a(this._preds[e],t),a(this._sucs[t],e),delete this._in[e][n],delete this._out[t][n],this._edgeCount--),this},n.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var i=r.values(n);return e?r.filter(i,function(t){return t.v===e}):i}},n.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var i=r.values(n);return e?r.filter(i,function(t){return t.w===e}):i}},n.prototype.nodeEdges=function(t,e){var r=this.inEdges(t,e);if(r)return r.concat(this.outEdges(t,e))}}),v("dOCPl",function(t,e){var r;try{r={clone:y("bTYY2"),constant:y("9HRmE"),each:y("5kE3T"),filter:y("jLJR7"),has:y("jplJt"),isArray:y("o8HxT"),isEmpty:y("44Pmt"),isFunction:y("01ubZ"),isUndefined:y("enrJD"),keys:y("LAMcS"),map:y("437iZ"),reduce:y("2KuAh"),size:y("2RKXE"),transform:y("bGcIb"),union:y("1c10x"),values:y("7D6Gq")}}catch(t){}r||(r=window._),t.exports=r}),v("bTYY2",function(t,e){var r=y("kqX4j");t.exports=function(t){return r(t,4)}}),v("kqX4j",function(t,e){var r=y("g779E"),n=y("bFZGr"),i=y("5i71d"),a=y("XXQDs"),o=y("1djPb"),s=y("uQ1Em"),l=y("aA0pv"),u=y("hIxJe"),h=y("7n7lE"),d=y("apVCl"),c=y("i0kKc"),f=y("67A6V"),p=y("4UmGC"),g=y("btuqH"),v=y("dFJsF"),m=y("o8HxT"),b=y("f504n"),x=y("eJObK"),E=y("lsJ54"),w=y("jZm8C"),_=y("LAMcS"),S=y("f4lqP"),k="[object Arguments]",N="[object Function]",O="[object Object]",T={};T[k]=T["[object Array]"]=T["[object ArrayBuffer]"]=T["[object DataView]"]=T["[object Boolean]"]=T["[object Date]"]=T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Map]"]=T["[object Number]"]=T[O]=T["[object RegExp]"]=T["[object Set]"]=T["[object String]"]=T["[object Symbol]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T["[object Error]"]=T[N]=T["[object WeakMap]"]=!1,t.exports=function t(e,y,M,A,C,R){var I,P=1&y,D=2&y,L=4&y;if(M&&(I=C?M(e,A,C,R):M(e)),void 0!==I)return I;if(!E(e))return e;var j=m(e);if(j){if(I=p(e),!P)return l(e,I)}else{var F=f(e),B=F==N||"[object GeneratorFunction]"==F;if(b(e))return s(e,P);if(F==O||F==k||B&&!C){if(I=D||B?{}:v(e),!P)return D?h(e,o(I,e)):u(e,a(I,e))}else{if(!T[F])return C?e:{};I=g(e,F,P)}}R||(R=new r);var z=R.get(e);if(z)return z;R.set(e,I),w(e)?e.forEach(function(r){I.add(t(r,y,M,r,e,R))}):x(e)&&e.forEach(function(r,n){I.set(n,t(r,y,M,n,e,R))});var V=L?D?c:d:D?S:_,G=j?void 0:V(e);return n(G||e,function(r,n){G&&(r=e[n=r]),i(I,n,t(r,y,M,n,e,R))}),I}}),v("g779E",function(t,e){var r=y("iYOpJ"),n=y("jZSEZ"),i=y("fm6cW"),a=y("b3G1Z"),o=y("5DEbp"),s=y("czPDU");function l(t){var e=this.__data__=new r(t);this.size=e.size}l.prototype.clear=n,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l}),v("iYOpJ",function(t,e){var r=y("bjX1n"),n=y("i2OST"),i=y("fmh4d"),a=y("3AXiV"),o=y("lWpQQ");function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=r,s.prototype.delete=n,s.prototype.get=i,s.prototype.has=a,s.prototype.set=o,t.exports=s}),v("bjX1n",function(t,e){t.exports=function(){this.__data__=[],this.size=0}}),v("i2OST",function(t,e){var r=y("bBnDb"),n=Array.prototype.splice;t.exports=function(t){var e=this.__data__,i=r(e,t);return!(i<0)&&(i==e.length-1?e.pop():n.call(e,i,1),--this.size,!0)}}),v("bBnDb",function(t,e){var r=y("6TC8i");t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return -1}}),v("6TC8i",function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}}),v("fmh4d",function(t,e){var r=y("bBnDb");t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}}),v("3AXiV",function(t,e){var r=y("bBnDb");t.exports=function(t){return r(this.__data__,t)>-1}}),v("lWpQQ",function(t,e){var r=y("bBnDb");t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}}),v("jZSEZ",function(t,e){var r=y("iYOpJ");t.exports=function(){this.__data__=new r,this.size=0}}),v("fm6cW",function(t,e){t.exports=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}}),v("b3G1Z",function(t,e){t.exports=function(t){return this.__data__.get(t)}}),v("5DEbp",function(t,e){t.exports=function(t){return this.__data__.has(t)}}),v("czPDU",function(t,e){var r=y("iYOpJ"),n=y("2cJKd"),i=y("6gDBQ");t.exports=function(t,e){var a=this.__data__;if(a instanceof r){var o=a.__data__;if(!n||o.length<199)return o.push([t,e]),this.size=++a.size,this;a=this.__data__=new i(o)}return a.set(t,e),this.size=a.size,this}}),v("2cJKd",function(t,e){var r=y("6T08O")(y("23YZo"),"Map");t.exports=r}),v("6T08O",function(t,e){var r=y("bhj99"),n=y("ii1B1");t.exports=function(t,e){var i=n(t,e);return r(i)?i:void 0}}),v("bhj99",function(t,e){var r=y("01ubZ"),n=y("87ifd"),i=y("lsJ54"),a=y("dqC5h"),o=/^\[object .+?Constructor\]$/,s=Object.prototype,l=Function.prototype.toString,u=s.hasOwnProperty,h=RegExp("^"+l.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||n(t))&&(r(t)?h:o).test(a(t))}}),v("01ubZ",function(t,e){var r=y("eq6CV"),n=y("lsJ54");t.exports=function(t){if(!n(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}}),v("eq6CV",function(t,e){var r=y("57wYk"),n=y("iMn5C"),i=y("5tDQy"),a=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?n(t):i(t)}}),v("57wYk",function(t,e){var r=y("23YZo").Symbol;t.exports=r}),v("23YZo",function(t,e){var r=y("ljJ8G"),n="object"==typeof self&&self&&self.Object===Object&&self,i=r||n||Function("return this")();t.exports=i}),v("ljJ8G",function(t,e){var r="object"==typeof c&&c&&c.Object===Object&&c;t.exports=r}),v("iMn5C",function(t,e){var r=y("57wYk"),n=Object.prototype,i=n.hasOwnProperty,a=n.toString,o=r?r.toStringTag:void 0;t.exports=function(t){var e=i.call(t,o),r=t[o];try{t[o]=void 0;var n=!0}catch(t){}var s=a.call(t);return n&&(e?t[o]=r:delete t[o]),s}}),v("5tDQy",function(t,e){var r=Object.prototype.toString;t.exports=function(t){return r.call(t)}}),v("lsJ54",function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}}),v("87ifd",function(t,e){var r,n=y("g3dHA"),i=(r=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!i&&i in t}}),v("g3dHA",function(t,e){var r=y("23YZo")["__core-js_shared__"];t.exports=r}),v("dqC5h",function(t,e){var r=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}}),v("ii1B1",function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}}),v("6gDBQ",function(t,e){var r=y("j9XgB"),n=y("5Rqhl"),i=y("g0JTV"),a=y("iaILb"),o=y("4vfJO");function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=r,s.prototype.delete=n,s.prototype.get=i,s.prototype.has=a,s.prototype.set=o,t.exports=s}),v("j9XgB",function(t,e){var r=y("c8dKl"),n=y("iYOpJ"),i=y("2cJKd");t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||n),string:new r}}}),v("c8dKl",function(t,e){var r=y("b4nbb"),n=y("8ink3"),i=y("VQwbj"),a=y("19QNA"),o=y("i8qJC");function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=r,s.prototype.delete=n,s.prototype.get=i,s.prototype.has=a,s.prototype.set=o,t.exports=s}),v("b4nbb",function(t,e){var r=y("k1Z3J");t.exports=function(){this.__data__=r?r(null):{},this.size=0}}),v("k1Z3J",function(t,e){var r=y("6T08O")(Object,"create");t.exports=r}),v("8ink3",function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}}),v("VQwbj",function(t,e){var r=y("k1Z3J"),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return n.call(e,t)?e[t]:void 0}}),v("19QNA",function(t,e){var r=y("k1Z3J"),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:n.call(e,t)}}),v("i8qJC",function(t,e){var r=y("k1Z3J");t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}}),v("5Rqhl",function(t,e){var r=y("gxIuO");t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}}),v("gxIuO",function(t,e){var r=y("PZpyR");t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}}),v("PZpyR",function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}}),v("g0JTV",function(t,e){var r=y("gxIuO");t.exports=function(t){return r(this,t).get(t)}}),v("iaILb",function(t,e){var r=y("gxIuO");t.exports=function(t){return r(this,t).has(t)}}),v("4vfJO",function(t,e){var r=y("gxIuO");t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}}),v("bFZGr",function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}}),v("5i71d",function(t,e){var r=y("cWbJD"),n=y("6TC8i"),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,a){var o=t[e];i.call(t,e)&&n(o,a)&&(void 0!==a||e in t)||r(t,e,a)}}),v("cWbJD",function(t,e){var r=y("4hwTc");t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}}),v("4hwTc",function(t,e){var r=y("6T08O"),n=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=n}),v("XXQDs",function(t,e){var r=y("cYlGN"),n=y("LAMcS");t.exports=function(t,e){return t&&r(e,n(e),t)}}),v("cYlGN",function(t,e){var r=y("5i71d"),n=y("cWbJD");t.exports=function(t,e,i,a){var o=!i;i||(i={});for(var s=-1,l=e.length;++s<l;){var u=e[s],h=a?a(i[u],t[u],u,i,t):void 0;void 0===h&&(h=t[u]),o?n(i,u,h):r(i,u,h)}return i}}),v("LAMcS",function(t,e){var r=y("8C60w"),n=y("jViFF"),i=y("eMthh");t.exports=function(t){return i(t)?r(t):n(t)}}),v("8C60w",function(t,e){var r=y("fdM6B"),n=y("aJD6g"),i=y("o8HxT"),a=y("f504n"),o=y("iyUuu"),s=y("1Q21n"),l=Object.prototype.hasOwnProperty;t.exports=function(t,e){var u=i(t),h=!u&&n(t),d=!u&&!h&&a(t),c=!u&&!h&&!d&&s(t),f=u||h||d||c,p=f?r(t.length,String):[],g=p.length;for(var y in t)(e||l.call(t,y))&&!(f&&("length"==y||d&&("offset"==y||"parent"==y)||c&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||o(y,g)))&&p.push(y);return p}}),v("fdM6B",function(t,e){t.exports=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}}),v("aJD6g",function(t,e){var r=y("lB3aj"),n=y("8l89S"),i=Object.prototype,a=i.hasOwnProperty,o=i.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(t){return n(t)&&a.call(t,"callee")&&!o.call(t,"callee")};t.exports=s}),v("lB3aj",function(t,e){var r=y("eq6CV"),n=y("8l89S");t.exports=function(t){return n(t)&&"[object Arguments]"==r(t)}}),v("8l89S",function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}}),v("o8HxT",function(t,e){var r=Array.isArray;t.exports=r}),v("f504n",function(t,e){var r=y("23YZo"),n=y("fiQnm"),i=e&&!e.nodeType&&e,a=i&&t&&!t.nodeType&&t,o=a&&a.exports===i?r.Buffer:void 0,s=o?o.isBuffer:void 0;t.exports=s||n}),v("fiQnm",function(t,e){t.exports=function(){return!1}}),v("iyUuu",function(t,e){var r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var n=typeof t;return!!(e=null==e?0x1fffffffffffff:e)&&("number"==n||"symbol"!=n&&r.test(t))&&t>-1&&t%1==0&&t<e}}),v("1Q21n",function(t,e){var r=y("dtRoq"),n=y("91Qdd"),i=y("jIny1"),a=i&&i.isTypedArray,o=a?n(a):r;t.exports=o}),v("dtRoq",function(t,e){var r=y("eq6CV"),n=y("1S9lz"),i=y("8l89S"),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&n(t.length)&&!!a[r(t)]}}),v("1S9lz",function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=0x1fffffffffffff}}),v("91Qdd",function(t,e){t.exports=function(t){return function(e){return t(e)}}}),v("jIny1",function(t,e){var r=y("ljJ8G"),n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,a=i&&i.exports===n&&r.process,o=function(){try{var t=i&&i.require&&i.require("util").types;if(t)return t;return a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=o}),v("jViFF",function(t,e){var r=y("3wZFp"),n=y("Xlg65"),i=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return n(t);var e=[];for(var a in Object(t))i.call(t,a)&&"constructor"!=a&&e.push(a);return e}}),v("3wZFp",function(t,e){var r=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}}),v("Xlg65",function(t,e){var r=y("lW2Sc")(Object.keys,Object);t.exports=r}),v("lW2Sc",function(t,e){t.exports=function(t,e){return function(r){return t(e(r))}}}),v("eMthh",function(t,e){var r=y("01ubZ"),n=y("1S9lz");t.exports=function(t){return null!=t&&n(t.length)&&!r(t)}}),v("1djPb",function(t,e){var r=y("cYlGN"),n=y("f4lqP");t.exports=function(t,e){return t&&r(e,n(e),t)}}),v("f4lqP",function(t,e){var r=y("8C60w"),n=y("4ECPT"),i=y("eMthh");t.exports=function(t){return i(t)?r(t,!0):n(t)}}),v("4ECPT",function(t,e){var r=y("lsJ54"),n=y("3wZFp"),i=y("7w1ie"),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=n(t),o=[];for(var s in t)"constructor"==s&&(e||!a.call(t,s))||o.push(s);return o}}),v("7w1ie",function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}}),v("uQ1Em",function(t,e){var r=y("23YZo"),n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,a=i&&i.exports===n?r.Buffer:void 0,o=a?a.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,n=o?o(r):new t.constructor(r);return t.copy(n),n}}),v("aA0pv",function(t,e){t.exports=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}}),v("hIxJe",function(t,e){var r=y("cYlGN"),n=y("6YcYN");t.exports=function(t,e){return r(t,n(t),e)}}),v("6YcYN",function(t,e){var r=y("8H9RZ"),n=y("clnSu"),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,o=a?function(t){return null==t?[]:r(a(t=Object(t)),function(e){return i.call(t,e)})}:n;t.exports=o}),v("8H9RZ",function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length,i=0,a=[];++r<n;){var o=t[r];e(o,r,t)&&(a[i++]=o)}return a}}),v("clnSu",function(t,e){t.exports=function(){return[]}}),v("7n7lE",function(t,e){var r=y("cYlGN"),n=y("aiaLi");t.exports=function(t,e){return r(t,n(t),e)}}),v("aiaLi",function(t,e){var r=y("hynws"),n=y("cdnOB"),i=y("6YcYN"),a=y("clnSu"),o=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)r(e,i(t)),t=n(t);return e}:a;t.exports=o}),v("hynws",function(t,e){t.exports=function(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}}),v("cdnOB",function(t,e){var r=y("lW2Sc")(Object.getPrototypeOf,Object);t.exports=r}),v("apVCl",function(t,e){var r=y("ctgi8"),n=y("6YcYN"),i=y("LAMcS");t.exports=function(t){return r(t,i,n)}}),v("ctgi8",function(t,e){var r=y("hynws"),n=y("o8HxT");t.exports=function(t,e,i){var a=e(t);return n(t)?a:r(a,i(t))}}),v("i0kKc",function(t,e){var r=y("ctgi8"),n=y("aiaLi"),i=y("f4lqP");t.exports=function(t){return r(t,i,n)}}),v("67A6V",function(t,e){var r=y("5Ehf1"),n=y("2cJKd"),i=y("f7yH3"),a=y("vH4x0"),o=y("f0N2p"),s=y("eq6CV"),l=y("dqC5h"),u="[object Map]",h="[object Promise]",d="[object Set]",c="[object WeakMap]",f="[object DataView]",p=l(r),g=l(n),v=l(i),m=l(a),b=l(o),x=s;(r&&x(new r(new ArrayBuffer(1)))!=f||n&&x(new n)!=u||i&&x(i.resolve())!=h||a&&x(new a)!=d||o&&x(new o)!=c)&&(x=function(t){var e=s(t),r="[object Object]"==e?t.constructor:void 0,n=r?l(r):"";if(n)switch(n){case p:return f;case g:return u;case v:return h;case m:return d;case b:return c}return e}),t.exports=x}),v("5Ehf1",function(t,e){var r=y("6T08O")(y("23YZo"),"DataView");t.exports=r}),v("f7yH3",function(t,e){var r=y("6T08O")(y("23YZo"),"Promise");t.exports=r}),v("vH4x0",function(t,e){var r=y("6T08O")(y("23YZo"),"Set");t.exports=r}),v("f0N2p",function(t,e){var r=y("6T08O")(y("23YZo"),"WeakMap");t.exports=r}),v("4UmGC",function(t,e){var r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&r.call(t,"index")&&(n.index=t.index,n.input=t.input),n}}),v("btuqH",function(t,e){var r=y("jjbq1"),n=y("aKTvD"),i=y("5IIrB"),a=y("jxFRj"),o=y("5JAGM");t.exports=function(t,e,s){var l=t.constructor;switch(e){case"[object ArrayBuffer]":return r(t);case"[object Boolean]":case"[object Date]":return new l(+t);case"[object DataView]":return n(t,s);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return o(t,s);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(t);case"[object RegExp]":return i(t);case"[object Symbol]":return a(t)}}}),v("jjbq1",function(t,e){var r=y("lx3EF");t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}}),v("lx3EF",function(t,e){var r=y("23YZo").Uint8Array;t.exports=r}),v("aKTvD",function(t,e){var r=y("jjbq1");t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}}),v("5IIrB",function(t,e){var r=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,r.exec(t));return e.lastIndex=t.lastIndex,e}}),v("jxFRj",function(t,e){var r=y("57wYk"),n=r?r.prototype:void 0,i=n?n.valueOf:void 0;t.exports=function(t){return i?Object(i.call(t)):{}}}),v("5JAGM",function(t,e){var r=y("jjbq1");t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}}),v("dFJsF",function(t,e){var r=y("4XGZt"),n=y("cdnOB"),i=y("3wZFp");t.exports=function(t){return"function"!=typeof t.constructor||i(t)?{}:r(n(t))}}),v("4XGZt",function(t,e){var r=y("lsJ54"),n=Object.create,i=function(){function t(){}return function(e){if(!r(e))return{};if(n)return n(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();t.exports=i}),v("eJObK",function(t,e){var r=y("9ORep"),n=y("91Qdd"),i=y("jIny1"),a=i&&i.isMap,o=a?n(a):r;t.exports=o}),v("9ORep",function(t,e){var r=y("67A6V"),n=y("8l89S");t.exports=function(t){return n(t)&&"[object Map]"==r(t)}}),v("jZm8C",function(t,e){var r=y("eFk8g"),n=y("91Qdd"),i=y("jIny1"),a=i&&i.isSet,o=a?n(a):r;t.exports=o}),v("eFk8g",function(t,e){var r=y("67A6V"),n=y("8l89S");t.exports=function(t){return n(t)&&"[object Set]"==r(t)}}),v("9HRmE",function(t,e){t.exports=function(t){return function(){return t}}}),v("5kE3T",function(t,e){t.exports=y("iWSff")}),v("iWSff",function(t,e){var r=y("bFZGr"),n=y("4DjQp"),i=y("4c8Zb"),a=y("o8HxT");t.exports=function(t,e){return(a(t)?r:n)(t,i(e))}}),v("4DjQp",function(t,e){var r=y("4xK4A"),n=y("kCOH9")(r);t.exports=n}),v("4xK4A",function(t,e){var r=y("dEvx9"),n=y("LAMcS");t.exports=function(t,e){return t&&r(t,e,n)}}),v("dEvx9",function(t,e){var r=y("jTvRt")();t.exports=r}),v("jTvRt",function(t,e){t.exports=function(t){return function(e,r,n){for(var i=-1,a=Object(e),o=n(e),s=o.length;s--;){var l=o[t?s:++i];if(!1===r(a[l],l,a))break}return e}}}),v("kCOH9",function(t,e){var r=y("eMthh");t.exports=function(t,e){return function(n,i){if(null==n)return n;if(!r(n))return t(n,i);for(var a=n.length,o=e?a:-1,s=Object(n);(e?o--:++o<a)&&!1!==i(s[o],o,s););return n}}}),v("4c8Zb",function(t,e){var r=y("4Nq5y");t.exports=function(t){return"function"==typeof t?t:r}}),v("4Nq5y",function(t,e){t.exports=function(t){return t}}),v("jLJR7",function(t,e){var r=y("8H9RZ"),n=y("agamk"),i=y("7MWok"),a=y("o8HxT");t.exports=function(t,e){return(a(t)?r:n)(t,i(e,3))}}),v("agamk",function(t,e){var r=y("4DjQp");t.exports=function(t,e){var n=[];return r(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}}),v("7MWok",function(t,e){var r=y("jShkp"),n=y("in5n5"),i=y("4Nq5y"),a=y("o8HxT"),o=y("bAYPD");t.exports=function(t){return"function"==typeof t?t:null==t?i:"object"==typeof t?a(t)?n(t[0],t[1]):r(t):o(t)}}),v("jShkp",function(t,e){var r=y("kgn8n"),n=y("9dd8D"),i=y("2IhDm");t.exports=function(t){var e=n(t);return 1==e.length&&e[0][2]?i(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}}),v("kgn8n",function(t,e){var r=y("g779E"),n=y("abgWr");t.exports=function(t,e,i,a){var o=i.length,s=o,l=!a;if(null==t)return!s;for(t=Object(t);o--;){var u=i[o];if(l&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<s;){var h=(u=i[o])[0],d=t[h],c=u[1];if(l&&u[2]){if(void 0===d&&!(h in t))return!1}else{var f=new r;if(a)var p=a(d,c,h,t,e,f);if(!(void 0===p?n(c,d,3,a,f):p))return!1}}return!0}}),v("abgWr",function(t,e){var r=y("7qq40"),n=y("8l89S");t.exports=function t(e,i,a,o,s){return e===i||(null!=e&&null!=i&&(n(e)||n(i))?r(e,i,a,o,t,s):e!=e&&i!=i)}}),v("7qq40",function(t,e){var r=y("g779E"),n=y("1pRE7"),i=y("g3aCZ"),a=y("eOqMj"),o=y("67A6V"),s=y("o8HxT"),l=y("f504n"),u=y("1Q21n"),h="[object Arguments]",d="[object Array]",c="[object Object]",f=Object.prototype.hasOwnProperty;t.exports=function(t,e,p,g,y,v){var m=s(t),b=s(e),x=m?d:o(t),E=b?d:o(e);x=x==h?c:x,E=E==h?c:E;var w=x==c,_=E==c,S=x==E;if(S&&l(t)){if(!l(e))return!1;m=!0,w=!1}if(S&&!w)return v||(v=new r),m||u(t)?n(t,e,p,g,y,v):i(t,e,x,p,g,y,v);if(!(1&p)){var k=w&&f.call(t,"__wrapped__"),N=_&&f.call(e,"__wrapped__");if(k||N){var O=k?t.value():t,T=N?e.value():e;return v||(v=new r),y(O,T,p,g,v)}}return!!S&&(v||(v=new r),a(t,e,p,g,y,v))}}),v("1pRE7",function(t,e){var r=y("dXA7v"),n=y("eFBTL"),i=y("2l8n7");t.exports=function(t,e,a,o,s,l){var u=1&a,h=t.length,d=e.length;if(h!=d&&!(u&&d>h))return!1;var c=l.get(t),f=l.get(e);if(c&&f)return c==e&&f==t;var p=-1,g=!0,y=2&a?new r:void 0;for(l.set(t,e),l.set(e,t);++p<h;){var v=t[p],m=e[p];if(o)var b=u?o(m,v,p,e,t,l):o(v,m,p,t,e,l);if(void 0!==b){if(b)continue;g=!1;break}if(y){if(!n(e,function(t,e){if(!i(y,e)&&(v===t||s(v,t,a,o,l)))return y.push(e)})){g=!1;break}}else if(!(v===m||s(v,m,a,o,l))){g=!1;break}}return l.delete(t),l.delete(e),g}}),v("dXA7v",function(t,e){var r=y("6gDBQ"),n=y("j1Tfx"),i=y("8NkYQ");function a(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}a.prototype.add=a.prototype.push=n,a.prototype.has=i,t.exports=a}),v("j1Tfx",function(t,e){t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}}),v("8NkYQ",function(t,e){t.exports=function(t){return this.__data__.has(t)}}),v("eFBTL",function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}}),v("2l8n7",function(t,e){t.exports=function(t,e){return t.has(e)}}),v("g3aCZ",function(t,e){var r=y("57wYk"),n=y("lx3EF"),i=y("6TC8i"),a=y("1pRE7"),o=y("cwfcG"),s=y("1xAji"),l=r?r.prototype:void 0,u=l?l.valueOf:void 0;t.exports=function(t,e,r,l,h,d,c){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)break;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":if(t.byteLength!=e.byteLength||!d(new n(t),new n(e)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var f=o;case"[object Set]":var p=1&l;if(f||(f=s),t.size!=e.size&&!p)break;var g=c.get(t);if(g)return g==e;l|=2,c.set(t,e);var y=a(f(t),f(e),l,h,d,c);return c.delete(t),y;case"[object Symbol]":if(u)return u.call(t)==u.call(e)}return!1}}),v("cwfcG",function(t,e){t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}}),v("1xAji",function(t,e){t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}}),v("eOqMj",function(t,e){var r=y("apVCl"),n=Object.prototype.hasOwnProperty;t.exports=function(t,e,i,a,o,s){var l=1&i,u=r(t),h=u.length;if(h!=r(e).length&&!l)return!1;for(var d=h;d--;){var c=u[d];if(!(l?c in e:n.call(e,c)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var g=!0;s.set(t,e),s.set(e,t);for(var y=l;++d<h;){var v=t[c=u[d]],m=e[c];if(a)var b=l?a(m,v,c,e,t,s):a(v,m,c,t,e,s);if(!(void 0===b?v===m||o(v,m,i,a,s):b)){g=!1;break}y||(y="constructor"==c)}if(g&&!y){var x=t.constructor,E=e.constructor;x!=E&&"constructor"in t&&"constructor"in e&&!("function"==typeof x&&x instanceof x&&"function"==typeof E&&E instanceof E)&&(g=!1)}return s.delete(t),s.delete(e),g}}),v("9dd8D",function(t,e){var r=y("1n1hd"),n=y("LAMcS");t.exports=function(t){for(var e=n(t),i=e.length;i--;){var a=e[i],o=t[a];e[i]=[a,o,r(o)]}return e}}),v("1n1hd",function(t,e){var r=y("lsJ54");t.exports=function(t){return t==t&&!r(t)}}),v("2IhDm",function(t,e){t.exports=function(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in Object(r))}}}),v("in5n5",function(t,e){var r=y("abgWr"),n=y("i51gj"),i=y("2VBx6"),a=y("kPpic"),o=y("1n1hd"),s=y("2IhDm"),l=y("6DSvu");t.exports=function(t,e){return a(t)&&o(e)?s(l(t),e):function(a){var o=n(a,t);return void 0===o&&o===e?i(a,t):r(e,o,3)}}}),v("i51gj",function(t,e){var r=y("lJEX1");t.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}}),v("lJEX1",function(t,e){var r=y("4RK0h"),n=y("6DSvu");t.exports=function(t,e){e=r(e,t);for(var i=0,a=e.length;null!=t&&i<a;)t=t[n(e[i++])];return i&&i==a?t:void 0}}),v("4RK0h",function(t,e){var r=y("o8HxT"),n=y("kPpic"),i=y("lnP3M"),a=y("l6E2L");t.exports=function(t,e){return r(t)?t:n(t,e)?[t]:i(a(t))}}),v("kPpic",function(t,e){var r=y("o8HxT"),n=y("9dr3u"),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var o=typeof t;return!!("number"==o||"symbol"==o||"boolean"==o||null==t||n(t))||a.test(t)||!i.test(t)||null!=e&&t in Object(e)}}),v("9dr3u",function(t,e){var r=y("eq6CV"),n=y("8l89S");t.exports=function(t){return"symbol"==typeof t||n(t)&&"[object Symbol]"==r(t)}}),v("lnP3M",function(t,e){var r=y("99Rk8"),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=r(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(n,function(t,r,n,a){e.push(n?a.replace(i,"$1"):r||t)}),e});t.exports=a}),v("99Rk8",function(t,e){var r=y("23xpV");t.exports=function(t){var e=r(t,function(t){return 500===n.size&&n.clear(),t}),n=e.cache;return e}}),v("23xpV",function(t,e){var r=y("6gDBQ");function n(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var i=function(){var r=arguments,n=e?e.apply(this,r):r[0],a=i.cache;if(a.has(n))return a.get(n);var o=t.apply(this,r);return i.cache=a.set(n,o)||a,o};return i.cache=new(n.Cache||r),i}n.Cache=r,t.exports=n}),v("l6E2L",function(t,e){var r=y("kJ9w3");t.exports=function(t){return null==t?"":r(t)}}),v("kJ9w3",function(t,e){var r=y("57wYk"),n=y("i46jW"),i=y("o8HxT"),a=y("9dr3u"),o=1/0,s=r?r.prototype:void 0,l=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(i(e))return n(e,t)+"";if(a(e))return l?l.call(e):"";var r=e+"";return"0"==r&&1/e==-o?"-0":r}}),v("i46jW",function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}}),v("6DSvu",function(t,e){var r=y("9dr3u"),n=1/0;t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-n?"-0":e}}),v("2VBx6",function(t,e){var r=y("ij33W"),n=y("btvBm");t.exports=function(t,e){return null!=t&&n(t,e,r)}}),v("ij33W",function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}}),v("btvBm",function(t,e){var r=y("4RK0h"),n=y("aJD6g"),i=y("o8HxT"),a=y("iyUuu"),o=y("1S9lz"),s=y("6DSvu");t.exports=function(t,e,l){e=r(e,t);for(var u=-1,h=e.length,d=!1;++u<h;){var c=s(e[u]);if(!(d=null!=t&&l(t,c)))break;t=t[c]}return d||++u!=h?d:!!(h=null==t?0:t.length)&&o(h)&&a(c,h)&&(i(t)||n(t))}}),v("bAYPD",function(t,e){var r=y("ielIK"),n=y("jfdoV"),i=y("kPpic"),a=y("6DSvu");t.exports=function(t){return i(t)?r(a(t)):n(t)}}),v("ielIK",function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}}),v("jfdoV",function(t,e){var r=y("lJEX1");t.exports=function(t){return function(e){return r(e,t)}}}),v("jplJt",function(t,e){var r=y("5aSdf"),n=y("btvBm");t.exports=function(t,e){return null!=t&&n(t,e,r)}}),v("5aSdf",function(t,e){var r=Object.prototype.hasOwnProperty;t.exports=function(t,e){return null!=t&&r.call(t,e)}}),v("44Pmt",function(t,e){var r=y("jViFF"),n=y("67A6V"),i=y("aJD6g"),a=y("o8HxT"),o=y("eMthh"),s=y("f504n"),l=y("3wZFp"),u=y("1Q21n"),h=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(o(t)&&(a(t)||"string"==typeof t||"function"==typeof t.splice||s(t)||u(t)||i(t)))return!t.length;var e=n(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(l(t))return!r(t).length;for(var d in t)if(h.call(t,d))return!1;return!0}}),v("enrJD",function(t,e){t.exports=function(t){return void 0===t}}),v("437iZ",function(t,e){var r=y("i46jW"),n=y("7MWok"),i=y("fDc61"),a=y("o8HxT");t.exports=function(t,e){return(a(t)?r:i)(t,n(e,3))}}),v("fDc61",function(t,e){var r=y("4DjQp"),n=y("eMthh");t.exports=function(t,e){var i=-1,a=n(t)?Array(t.length):[];return r(t,function(t,r,n){a[++i]=e(t,r,n)}),a}}),v("2KuAh",function(t,e){var r=y("1FZZ3"),n=y("4DjQp"),i=y("7MWok"),a=y("aJqKN"),o=y("o8HxT");t.exports=function(t,e,s){var l=o(t)?r:a,u=arguments.length<3;return l(t,i(e,4),s,u,n)}}),v("1FZZ3",function(t,e){t.exports=function(t,e,r,n){var i=-1,a=null==t?0:t.length;for(n&&a&&(r=t[++i]);++i<a;)r=e(r,t[i],i,t);return r}}),v("aJqKN",function(t,e){t.exports=function(t,e,r,n,i){return i(t,function(t,i,a){r=n?(n=!1,t):e(r,t,i,a)}),r}}),v("2RKXE",function(t,e){var r=y("jViFF"),n=y("67A6V"),i=y("eMthh"),a=y("1SJGG"),o=y("irc76");t.exports=function(t){if(null==t)return 0;if(i(t))return a(t)?o(t):t.length;var e=n(t);return"[object Map]"==e||"[object Set]"==e?t.size:r(t).length}}),v("1SJGG",function(t,e){var r=y("eq6CV"),n=y("o8HxT"),i=y("8l89S");t.exports=function(t){return"string"==typeof t||!n(t)&&i(t)&&"[object String]"==r(t)}}),v("irc76",function(t,e){var r=y("ijOWR"),n=y("05hp8"),i=y("etsxF");t.exports=function(t){return n(t)?i(t):r(t)}}),v("ijOWR",function(t,e){var r=y("ielIK")("length");t.exports=r}),v("05hp8",function(t,e){var r=RegExp("[\\u200d\ud800-\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.exports=function(t){return r.test(t)}}),v("etsxF",function(t,e){var r="\ud800-\udfff",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\ud83c[\udffb-\udfff]",a="[^"+r+"]",o="(?:\ud83c[\udde6-\uddff]){2}",s="[\ud800-\udbff][\udc00-\udfff]",l="(?:"+n+"|"+i+")?",u="[\\ufe0e\\ufe0f]?",h="(?:\\u200d(?:"+[a,o,s].join("|")+")"+u+l+")*",d=RegExp(i+"(?="+i+")|(?:"+[a+n+"?",n,o,s,"["+r+"]"].join("|")+")"+(u+l+h),"g");t.exports=function(t){for(var e=d.lastIndex=0;d.test(t);)++e;return e}}),v("bGcIb",function(t,e){var r=y("bFZGr"),n=y("4XGZt"),i=y("4xK4A"),a=y("7MWok"),o=y("cdnOB"),s=y("o8HxT"),l=y("f504n"),u=y("01ubZ"),h=y("lsJ54"),d=y("1Q21n");t.exports=function(t,e,c){var f=s(t),p=f||l(t)||d(t);if(e=a(e,4),null==c){var g=t&&t.constructor;c=p?f?new g:[]:h(t)&&u(g)?n(o(t)):{}}return(p?r:i)(t,function(t,r,n){return e(c,t,r,n)}),c}}),v("1c10x",function(t,e){var r=y("fgBHx"),n=y("5iyRF"),i=y("5VSS6"),a=y("jGP9B"),o=n(function(t){return i(r(t,1,a,!0))});t.exports=o}),v("fgBHx",function(t,e){var r=y("hynws"),n=y("hStNq");t.exports=function t(e,i,a,o,s){var l=-1,u=e.length;for(a||(a=n),s||(s=[]);++l<u;){var h=e[l];i>0&&a(h)?i>1?t(h,i-1,a,o,s):r(s,h):o||(s[s.length]=h)}return s}}),v("hStNq",function(t,e){var r=y("57wYk"),n=y("aJD6g"),i=y("o8HxT"),a=r?r.isConcatSpreadable:void 0;t.exports=function(t){return i(t)||n(t)||!!(a&&t&&t[a])}}),v("5iyRF",function(t,e){var r=y("4Nq5y"),n=y("b86t6"),i=y("iGMVy");t.exports=function(t,e){return i(n(t,e,r),t+"")}}),v("b86t6",function(t,e){var r=y("jpWht"),n=Math.max;t.exports=function(t,e,i){return e=n(void 0===e?t.length-1:e,0),function(){for(var a=arguments,o=-1,s=n(a.length-e,0),l=Array(s);++o<s;)l[o]=a[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=a[o];return u[e]=i(l),r(t,this,u)}}}),v("jpWht",function(t,e){t.exports=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}}),v("iGMVy",function(t,e){var r=y("2yzAw"),n=y("7WhTB")(r);t.exports=n}),v("2yzAw",function(t,e){var r=y("9HRmE"),n=y("4hwTc"),i=y("4Nq5y"),a=n?function(t,e){return n(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:i;t.exports=a}),v("7WhTB",function(t,e){var r=Date.now;t.exports=function(t){var e=0,n=0;return function(){var i=r(),a=16-(i-n);if(n=i,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}}),v("5VSS6",function(t,e){var r=y("dXA7v"),n=y("ebE2M"),i=y("eSdxB"),a=y("2l8n7"),o=y("5sRi0"),s=y("1xAji");t.exports=function(t,e,l){var u=-1,h=n,d=t.length,c=!0,f=[],p=f;if(l)c=!1,h=i;else if(d>=200){var g=e?null:o(t);if(g)return s(g);c=!1,h=a,p=new r}else p=e?[]:f;n:for(;++u<d;){var y=t[u],v=e?e(y):y;if(y=l||0!==y?y:0,c&&v==v){for(var m=p.length;m--;)if(p[m]===v)continue n;e&&p.push(v),f.push(y)}else h(p,v,l)||(p!==f&&p.push(v),f.push(y))}return f}}),v("ebE2M",function(t,e){var r=y("7pFTU");t.exports=function(t,e){return!!(null==t?0:t.length)&&r(t,e,0)>-1}}),v("7pFTU",function(t,e){var r=y("eAor6"),n=y("h2dHy"),i=y("dU1uo");t.exports=function(t,e,a){return e==e?i(t,e,a):r(t,n,a)}}),v("eAor6",function(t,e){t.exports=function(t,e,r,n){for(var i=t.length,a=r+(n?1:-1);n?a--:++a<i;)if(e(t[a],a,t))return a;return -1}}),v("h2dHy",function(t,e){t.exports=function(t){return t!=t}}),v("dU1uo",function(t,e){t.exports=function(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return -1}}),v("eSdxB",function(t,e){t.exports=function(t,e,r){for(var n=-1,i=null==t?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}}),v("5sRi0",function(t,e){var r=y("vH4x0"),n=y("9iECD"),i=y("1xAji"),a=r&&1/i(new r([,-0]))[1]==1/0?function(t){return new r(t)}:n;t.exports=a}),v("9iECD",function(t,e){t.exports=function(){}}),v("jGP9B",function(t,e){var r=y("eMthh"),n=y("8l89S");t.exports=function(t){return n(t)&&r(t)}}),v("7D6Gq",function(t,e){var r=y("jaYdQ"),n=y("LAMcS");t.exports=function(t){return null==t?[]:r(t,n(t))}}),v("jaYdQ",function(t,e){var r=y("i46jW");t.exports=function(t,e){return r(e,function(e){return t[e]})}}),v("5LcVV",function(t,e){t.exports="2.1.8"}),v("cOdIh",function(t,e){var r=y("dOCPl"),n=y("4JZcb");t.exports={write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:r.map(t.nodes(),function(e){var n=t.node(e),i=t.parent(e),a={v:e};return r.isUndefined(n)||(a.value=n),r.isUndefined(i)||(a.parent=i),a}),edges:r.map(t.edges(),function(e){var n=t.edge(e),i={v:e.v,w:e.w};return r.isUndefined(e.name)||(i.name=e.name),r.isUndefined(n)||(i.value=n),i})};return r.isUndefined(t.graph())||(e.value=r.clone(t.graph())),e},read:function(t){var e=new n(t.options).setGraph(t.value);return r.each(t.nodes,function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)}),r.each(t.edges,function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)}),e}}}),v("jm1Oa",function(t,e){t.exports={components:y("c3Kkn"),dijkstra:y("a8y4J"),dijkstraAll:y("3uso6"),findCycles:y("6pFca"),floydWarshall:y("2yn2B"),isAcyclic:y("3hBSd"),postorder:y("dX1tj"),preorder:y("e890l"),prim:y("ifTuH"),tarjan:y("38Zd5"),topsort:y("8UkLw")}}),v("c3Kkn",function(t,e){var r=y("dOCPl");t.exports=function(t){var e,n={},i=[];return r.each(t.nodes(),function(a){e=[],function i(a){r.has(n,a)||(n[a]=!0,e.push(a),r.each(t.successors(a),i),r.each(t.predecessors(a),i))}(a),e.length&&i.push(e)}),i}}),v("a8y4J",function(t,e){var r=y("dOCPl"),n=y("5ZDax");t.exports=function(t,e,r,a){return function(t,e,r,i){var a,o,s={},l=new n,u=function(t){var e=t.v!==a?t.v:t.w,n=s[e],i=r(t),u=o.distance+i;if(i<0)throw Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);u<n.distance&&(n.distance=u,n.predecessor=a,l.decrease(e,u))};for(t.nodes().forEach(function(t){var r=t===e?0:Number.POSITIVE_INFINITY;s[t]={distance:r},l.add(t,r)});l.size()>0&&(o=s[a=l.removeMin()]).distance!==Number.POSITIVE_INFINITY;)i(a).forEach(u);return s}(t,String(e),r||i,a||function(e){return t.outEdges(e)})};var i=r.constant(1)}),v("5ZDax",function(t,e){var r=y("dOCPl");function n(){this._arr=[],this._keyIndices={}}t.exports=n,n.prototype.size=function(){return this._arr.length},n.prototype.keys=function(){return this._arr.map(function(t){return t.key})},n.prototype.has=function(t){return r.has(this._keyIndices,t)},n.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},n.prototype.min=function(){if(0===this.size())throw Error("Queue underflow");return this._arr[0].key},n.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),!r.has(n,t)){var i=this._arr,a=i.length;return n[t]=a,i.push({key:t,priority:e}),this._decrease(a),!0}return!1},n.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},n.prototype.decrease=function(t,e){var r=this._keyIndices[t];if(e>this._arr[r].priority)throw Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+e);this._arr[r].priority=e,this._decrease(r)},n.prototype._heapify=function(t){var e=this._arr,r=2*t,n=r+1,i=t;r<e.length&&(i=e[r].priority<e[i].priority?r:i,n<e.length&&(i=e[n].priority<e[i].priority?n:i),i!==t&&(this._swap(t,i),this._heapify(i)))},n.prototype._decrease=function(t){for(var e,r=this._arr,n=r[t].priority;0!==t&&!(r[e=t>>1].priority<n);)this._swap(t,e),t=e},n.prototype._swap=function(t,e){var r=this._arr,n=this._keyIndices,i=r[t],a=r[e];r[t]=a,r[e]=i,n[a.key]=t,n[i.key]=e}}),v("3uso6",function(t,e){var r=y("a8y4J"),n=y("dOCPl");t.exports=function(t,e,i){return n.transform(t.nodes(),function(n,a){n[a]=r(t,a,e,i)},{})}}),v("6pFca",function(t,e){var r=y("dOCPl"),n=y("38Zd5");t.exports=function(t){return r.filter(n(t),function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])})}}),v("38Zd5",function(t,e){var r=y("dOCPl");t.exports=function(t){var e=0,n=[],i={},a=[];return t.nodes().forEach(function(o){r.has(i,o)||function o(s){var l=i[s]={onStack:!0,lowlink:e,index:e++};if(n.push(s),t.successors(s).forEach(function(t){r.has(i,t)?i[t].onStack&&(l.lowlink=Math.min(l.lowlink,i[t].index)):(o(t),l.lowlink=Math.min(l.lowlink,i[t].lowlink))}),l.lowlink===l.index){var u,h=[];do i[u=n.pop()].onStack=!1,h.push(u);while(s!==u)a.push(h)}}(o)}),a}}),v("2yn2B",function(t,e){var r=y("dOCPl");t.exports=function(t,e,r){var i,a,o,s;return i=e||n,a=r||function(e){return t.outEdges(e)},o={},(s=t.nodes()).forEach(function(t){o[t]={},o[t][t]={distance:0},s.forEach(function(e){t!==e&&(o[t][e]={distance:Number.POSITIVE_INFINITY})}),a(t).forEach(function(e){var r=e.v===t?e.w:e.v,n=i(e);o[t][r]={distance:n,predecessor:t}})}),s.forEach(function(t){var e=o[t];s.forEach(function(r){var n=o[r];s.forEach(function(r){var i=n[t],a=e[r],o=n[r],s=i.distance+a.distance;s<o.distance&&(o.distance=s,o.predecessor=a.predecessor)})})}),o};var n=r.constant(1)}),v("3hBSd",function(t,e){var r=y("8UkLw");t.exports=function(t){try{r(t)}catch(t){if(t instanceof r.CycleException)return!1;throw t}return!0}}),v("8UkLw",function(t,e){var r=y("dOCPl");function n(t){var e={},n={},a=[];if(r.each(t.sinks(),function o(s){if(r.has(n,s))throw new i;r.has(e,s)||(n[s]=!0,e[s]=!0,r.each(t.predecessors(s),o),delete n[s],a.push(s))}),r.size(e)!==t.nodeCount())throw new i;return a}function i(){}t.exports=n,n.CycleException=i,i.prototype=Error()}),v("dX1tj",function(t,e){var r=y("aCKt6");t.exports=function(t,e){return r(t,e,"post")}}),v("aCKt6",function(t,e){var r=y("dOCPl");t.exports=function(t,e,n){r.isArray(e)||(e=[e]);var i=(t.isDirected()?t.successors:t.neighbors).bind(t),a=[],o={};return r.each(e,function(e){if(!t.hasNode(e))throw Error("Graph does not have node: "+e);(function t(e,n,i,a,o,s){!r.has(a,n)&&(a[n]=!0,i||s.push(n),r.each(o(n),function(r){t(e,r,i,a,o,s)}),i&&s.push(n))})(t,e,"post"===n,o,i,a)}),a}}),v("e890l",function(t,e){var r=y("aCKt6");t.exports=function(t,e){return r(t,e,"pre")}}),v("ifTuH",function(t,e){var r=y("dOCPl"),n=y("4JZcb"),i=y("5ZDax");t.exports=function(t,e){var a,o=new n,s={},l=new i;function u(t){var r=t.v===a?t.w:t.v,n=l.priority(r);if(void 0!==n){var i=e(t);i<n&&(s[r]=a,l.decrease(r,i))}}if(0===t.nodeCount())return o;r.each(t.nodes(),function(t){l.add(t,Number.POSITIVE_INFINITY),o.setNode(t)}),l.decrease(t.nodes()[0],0);for(var h=!1;l.size()>0;){if(a=l.removeMin(),r.has(s,a))o.setEdge(a,s[a]);else if(h)throw Error("Input graph is not connected: "+t);else h=!0;t.nodeEdges(a).forEach(u)}return o}}),v("VZEn7",function(t,e){var r=y("bqfL5"),n=y("61rsw"),i=y("fi6eg"),a=y("hv32p"),o=y("1kMKg"),s=o.normalizeRanks,l=y("eBG2O"),o=y("1kMKg"),u=o.removeEmptyRanks,h=y("YdQc0"),d=y("fSZns"),c=y("lWVsJ"),f=y("3dyGB"),p=y("j257S"),o=y("1kMKg"),g=y("6mwJ2").Graph;t.exports=function(t,e){var y=e&&e.debugTiming?o.time:o.notime;y("layout",function(){var e=y("  buildLayoutGraph",function(){var e,n;return e=new g({multigraph:!0,compound:!0}),n=N(t.graph()),e.setGraph(r.merge({},m,k(n,v),r.pick(n,b))),r.forEach(t.nodes(),function(n){var i=N(t.node(n));e.setNode(n,r.defaults(k(i,x),E)),e.setParent(n,t.parent(n))}),r.forEach(t.edges(),function(n){var i=N(t.edge(n));e.setEdge(n,r.merge({},_,k(i,w),r.pick(i,S)))}),e});y("  runLayout",function(){y("    makeSpaceForEdgeLabels",function(){var t;t=e.graph(),t.ranksep/=2,r.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,"c"!==n.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?n.width+=n.labeloffset:n.height+=n.labeloffset)})}),y("    removeSelfEdges",function(){r.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}),y("    acyclic",function(){n.run(e)}),y("    nestingGraph.run",function(){h.run(e)}),y("    rank",function(){a(o.asNonCompoundGraph(e))}),y("    injectEdgeLabelProxies",function(){r.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),i={rank:(e.node(t.w).rank-n.rank)/2+n.rank,e:t};o.addDummyNode(e,"edge-proxy",i,"_ep")}})}),y("    removeEmptyRanks",function(){u(e)}),y("    nestingGraph.cleanup",function(){h.cleanup(e)}),y("    normalizeRanks",function(){s(e)}),y("    assignRankMinMax",function(){var t;t=0,r.forEach(e.nodes(),function(n){var i=e.node(n);i.borderTop&&(i.minRank=e.node(i.borderTop).rank,i.maxRank=e.node(i.borderBottom).rank,t=r.max(t,i.maxRank))}),e.graph().maxRank=t}),y("    removeEdgeLabelProxies",function(){r.forEach(e.nodes(),function(t){var r=e.node(t);"edge-proxy"===r.dummy&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}),y("    normalize.run",function(){i.run(e)}),y("    parentDummyChains",function(){l(e)}),y("    addBorderSegments",function(){d(e)}),y("    order",function(){f(e)}),y("    insertSelfEdges",function(){var t;t=o.buildLayerMatrix(e),r.forEach(t,function(t){var n=0;r.forEach(t,function(t,i){var a=e.node(t);a.order=i+n,r.forEach(a.selfEdges,function(t){o.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:a.rank,order:i+ ++n,e:t.e,label:t.label},"_se")}),delete a.selfEdges})})}),y("    adjustCoordinateSystem",function(){c.adjust(e)}),y("    position",function(){p(e)}),y("    positionSelfEdges",function(){r.forEach(e.nodes(),function(t){var r=e.node(t);if("selfedge"===r.dummy){var n=e.node(r.e.v),i=n.x+n.width/2,a=n.y,o=r.x-i,s=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],r.label.x=r.x,r.label.y=r.y}})}),y("    removeBorderNodes",function(){r.forEach(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),i=e.node(n.borderTop),a=e.node(n.borderBottom),o=e.node(r.last(n.borderLeft)),s=e.node(r.last(n.borderRight));n.width=Math.abs(s.x-o.x),n.height=Math.abs(a.y-i.y),n.x=o.x+n.width/2,n.y=i.y+n.height/2}}),r.forEach(e.nodes(),function(t){"border"===e.node(t).dummy&&e.removeNode(t)})}),y("    normalize.undo",function(){i.undo(e)}),y("    fixupEdgeLabelCoords",function(){r.forEach(e.edges(),function(t){var n=e.edge(t);if(r.has(n,"x"))switch(("l"===n.labelpos||"r"===n.labelpos)&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}})}),y("    undoCoordinateSystem",function(){c.undo(e)}),y("    translateGraph",function(){(function(t){var e=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,a=0,o=t.graph(),s=o.marginx||0,l=o.marginy||0;function u(t){var r=t.x,o=t.y,s=t.width,l=t.height;e=Math.min(e,r-s/2),n=Math.max(n,r+s/2),i=Math.min(i,o-l/2),a=Math.max(a,o+l/2)}r.forEach(t.nodes(),function(e){u(t.node(e))}),r.forEach(t.edges(),function(e){var n=t.edge(e);r.has(n,"x")&&u(n)}),e-=s,i-=l,r.forEach(t.nodes(),function(r){var n=t.node(r);n.x-=e,n.y-=i}),r.forEach(t.edges(),function(n){var a=t.edge(n);r.forEach(a.points,function(t){t.x-=e,t.y-=i}),r.has(a,"x")&&(a.x-=e),r.has(a,"y")&&(a.y-=i)}),o.width=n-e+s,o.height=a-i+l})(e)}),y("    assignNodeIntersects",function(){r.forEach(e.edges(),function(t){var r,n,i=e.edge(t),a=e.node(t.v),s=e.node(t.w);i.points?(r=i.points[0],n=i.points[i.points.length-1]):(i.points=[],r=s,n=a),i.points.unshift(o.intersectRect(a,r)),i.points.push(o.intersectRect(s,n))})}),y("    reversePoints",function(){r.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}),y("    acyclic.undo",function(){n.undo(e)})}),y("  updateInputGraph",function(){r.forEach(t.nodes(),function(r){var n=t.node(r),i=e.node(r);n&&(n.x=i.x,n.y=i.y,e.children(r).length&&(n.width=i.width,n.height=i.height))}),r.forEach(t.edges(),function(n){var i=t.edge(n),a=e.edge(n);i.points=a.points,r.has(a,"x")&&(i.x=a.x,i.y=a.y)}),t.graph().width=e.graph().width,t.graph().height=e.graph().height})})};var v=["nodesep","edgesep","ranksep","marginx","marginy"],m={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},b=["acyclicer","ranker","rankdir","align"],x=["width","height"],E={width:0,height:0},w=["minlen","weight","width","height","labeloffset"],_={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},S=["labelpos"];function k(t,e){return r.mapValues(r.pick(t,e),Number)}function N(t){var e={};return r.forEach(t,function(t,r){e[r.toLowerCase()]=t}),e}}),v("bqfL5",function(t,e){var r;try{r={cloneDeep:y("iGQLm"),constant:y("9HRmE"),defaults:y("1SWLj"),each:y("5kE3T"),filter:y("jLJR7"),find:y("8I8e5"),flatten:y("20Rgr"),forEach:y("iWSff"),forIn:y("jojmF"),has:y("jplJt"),isUndefined:y("enrJD"),last:y("hkfXi"),map:y("437iZ"),mapValues:y("1Z7cU"),max:y("aK6kk"),merge:y("5W3lT"),min:y("3Ne9k"),minBy:y("5oTLF"),now:y("9nn6T"),pick:y("12eN8"),range:y("fpRwA"),reduce:y("2KuAh"),sortBy:y("47O2q"),uniqueId:y("g0ikZ"),values:y("7D6Gq"),zipObject:y("d0lTW")}}catch(t){}r||(r=window._),t.exports=r}),v("iGQLm",function(t,e){var r=y("kqX4j");t.exports=function(t){return r(t,5)}}),v("1SWLj",function(t,e){var r=y("5iyRF"),n=y("6TC8i"),i=y("b8mN0"),a=y("f4lqP"),o=Object.prototype,s=o.hasOwnProperty,l=r(function(t,e){t=Object(t);var r=-1,l=e.length,u=l>2?e[2]:void 0;for(u&&i(e[0],e[1],u)&&(l=1);++r<l;)for(var h=e[r],d=a(h),c=-1,f=d.length;++c<f;){var p=d[c],g=t[p];(void 0===g||n(g,o[p])&&!s.call(t,p))&&(t[p]=h[p])}return t});t.exports=l}),v("b8mN0",function(t,e){var r=y("6TC8i"),n=y("eMthh"),i=y("iyUuu"),a=y("lsJ54");t.exports=function(t,e,o){if(!a(o))return!1;var s=typeof e;return("number"==s?!!(n(o)&&i(e,o.length)):"string"==s&&e in o)&&r(o[e],t)}}),v("8I8e5",function(t,e){var r=y("ePhxS")(y("cpmrH"));t.exports=r}),v("ePhxS",function(t,e){var r=y("7MWok"),n=y("eMthh"),i=y("LAMcS");t.exports=function(t){return function(e,a,o){var s=Object(e);if(!n(e)){var l=r(a,3);e=i(e),a=function(t){return l(s[t],t,s)}}var u=t(e,a,o);return u>-1?s[l?e[u]:u]:void 0}}}),v("cpmrH",function(t,e){var r=y("eAor6"),n=y("7MWok"),i=y("2MGGR"),a=Math.max;t.exports=function(t,e,o){var s=null==t?0:t.length;if(!s)return -1;var l=null==o?0:i(o);return l<0&&(l=a(s+l,0)),r(t,n(e,3),l)}}),v("2MGGR",function(t,e){var r=y("9lLgO");t.exports=function(t){var e=r(t),n=e%1;return e==e?n?e-n:e:0}}),v("9lLgO",function(t,e){var r=y("iV4PZ"),n=1/0;t.exports=function(t){return t?(t=r(t))===n||t===-n?(t<0?-1:1)*17976931348623157e292:t==t?t:0:0===t?t:0}}),v("iV4PZ",function(t,e){var r=y("s0iWz"),n=y("lsJ54"),i=y("9dr3u"),a=0/0,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(i(t))return a;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=r(t);var h=s.test(t);return h||l.test(t)?u(t.slice(2),h?2:8):o.test(t)?a:+t}}),v("s0iWz",function(t,e){var r=y("kzo8D"),n=/^\s+/;t.exports=function(t){return t?t.slice(0,r(t)+1).replace(n,""):t}}),v("kzo8D",function(t,e){var r=/\s/;t.exports=function(t){for(var e=t.length;e--&&r.test(t.charAt(e)););return e}}),v("20Rgr",function(t,e){var r=y("fgBHx");t.exports=function(t){return(null==t?0:t.length)?r(t,1):[]}}),v("jojmF",function(t,e){var r=y("dEvx9"),n=y("4c8Zb"),i=y("f4lqP");t.exports=function(t,e){return null==t?t:r(t,n(e),i)}}),v("hkfXi",function(t,e){t.exports=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}}),v("1Z7cU",function(t,e){var r=y("cWbJD"),n=y("4xK4A"),i=y("7MWok");t.exports=function(t,e){var a={};return e=i(e,3),n(t,function(t,n,i){r(a,n,e(t,n,i))}),a}}),v("aK6kk",function(t,e){var r=y("gv3JG"),n=y("iK245"),i=y("4Nq5y");t.exports=function(t){return t&&t.length?r(t,i,n):void 0}}),v("gv3JG",function(t,e){var r=y("9dr3u");t.exports=function(t,e,n){for(var i=-1,a=t.length;++i<a;){var o=t[i],s=e(o);if(null!=s&&(void 0===l?s==s&&!r(s):n(s,l)))var l=s,u=o}return u}}),v("iK245",function(t,e){t.exports=function(t,e){return t>e}}),v("5W3lT",function(t,e){var r=y("4uZ7x"),n=y("i1jm6")(function(t,e,n){r(t,e,n)});t.exports=n}),v("4uZ7x",function(t,e){var r=y("g779E"),n=y("7RXmv"),i=y("dEvx9"),a=y("cTZHA"),o=y("lsJ54"),s=y("f4lqP"),l=y("1ys2O");t.exports=function t(e,u,h,d,c){e!==u&&i(u,function(i,s){if(c||(c=new r),o(i))a(e,u,s,h,t,d,c);else{var f=d?d(l(e,s),i,s+"",e,u,c):void 0;void 0===f&&(f=i),n(e,s,f)}},s)}}),v("7RXmv",function(t,e){var r=y("cWbJD"),n=y("6TC8i");t.exports=function(t,e,i){(void 0===i||n(t[e],i))&&(void 0!==i||e in t)||r(t,e,i)}}),v("cTZHA",function(t,e){var r=y("7RXmv"),n=y("uQ1Em"),i=y("5JAGM"),a=y("aA0pv"),o=y("dFJsF"),s=y("aJD6g"),l=y("o8HxT"),u=y("jGP9B"),h=y("f504n"),d=y("01ubZ"),c=y("lsJ54"),f=y("xMy82"),p=y("1Q21n"),g=y("1ys2O"),v=y("kp2OI");t.exports=function(t,e,y,m,b,x,E){var w=g(t,y),_=g(e,y),S=E.get(_);if(S){r(t,y,S);return}var k=x?x(w,_,y+"",t,e,E):void 0,N=void 0===k;if(N){var O=l(_),T=!O&&h(_),M=!O&&!T&&p(_);k=_,O||T||M?l(w)?k=w:u(w)?k=a(w):T?(N=!1,k=n(_,!0)):M?(N=!1,k=i(_,!0)):k=[]:f(_)||s(_)?(k=w,s(w)?k=v(w):(!c(w)||d(w))&&(k=o(_))):N=!1}N&&(E.set(_,k),b(k,_,m,x,E),E.delete(_)),r(t,y,k)}}),v("xMy82",function(t,e){var r=y("eq6CV"),n=y("cdnOB"),i=y("8l89S"),a=Object.prototype,o=Function.prototype.toString,s=a.hasOwnProperty,l=o.call(Object);t.exports=function(t){if(!i(t)||"[object Object]"!=r(t))return!1;var e=n(t);if(null===e)return!0;var a=s.call(e,"constructor")&&e.constructor;return"function"==typeof a&&a instanceof a&&o.call(a)==l}}),v("1ys2O",function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}}),v("kp2OI",function(t,e){var r=y("cYlGN"),n=y("f4lqP");t.exports=function(t){return r(t,n(t))}}),v("i1jm6",function(t,e){var r=y("5iyRF"),n=y("b8mN0");t.exports=function(t){return r(function(e,r){var i=-1,a=r.length,o=a>1?r[a-1]:void 0,s=a>2?r[2]:void 0;for(o=t.length>3&&"function"==typeof o?(a--,o):void 0,s&&n(r[0],r[1],s)&&(o=a<3?void 0:o,a=1),e=Object(e);++i<a;){var l=r[i];l&&t(e,l,i,o)}return e})}}),v("3Ne9k",function(t,e){var r=y("gv3JG"),n=y("hGcz8"),i=y("4Nq5y");t.exports=function(t){return t&&t.length?r(t,i,n):void 0}}),v("hGcz8",function(t,e){t.exports=function(t,e){return t<e}}),v("5oTLF",function(t,e){var r=y("gv3JG"),n=y("7MWok"),i=y("hGcz8");t.exports=function(t,e){return t&&t.length?r(t,n(e,2),i):void 0}}),v("9nn6T",function(t,e){var r=y("23YZo");t.exports=function(){return r.Date.now()}}),v("12eN8",function(t,e){var r=y("1AWBt"),n=y("8KK0w")(function(t,e){return null==t?{}:r(t,e)});t.exports=n}),v("1AWBt",function(t,e){var r=y("6IXDN"),n=y("2VBx6");t.exports=function(t,e){return r(t,e,function(e,r){return n(t,r)})}}),v("6IXDN",function(t,e){var r=y("lJEX1"),n=y("eJzCK"),i=y("4RK0h");t.exports=function(t,e,a){for(var o=-1,s=e.length,l={};++o<s;){var u=e[o],h=r(t,u);a(h,u)&&n(l,i(u,t),h)}return l}}),v("eJzCK",function(t,e){var r=y("5i71d"),n=y("4RK0h"),i=y("iyUuu"),a=y("lsJ54"),o=y("6DSvu");t.exports=function(t,e,s,l){if(!a(t))return t;e=n(e,t);for(var u=-1,h=e.length,d=h-1,c=t;null!=c&&++u<h;){var f=o(e[u]),p=s;if("__proto__"===f||"constructor"===f||"prototype"===f)break;if(u!=d){var g=c[f];void 0===(p=l?l(g,f,c):void 0)&&(p=a(g)?g:i(e[u+1])?[]:{})}r(c,f,p),c=c[f]}return t}}),v("8KK0w",function(t,e){var r=y("20Rgr"),n=y("b86t6"),i=y("iGMVy");t.exports=function(t){return i(n(t,void 0,r),t+"")}}),v("fpRwA",function(t,e){var r=y("hDGMd")();t.exports=r}),v("hDGMd",function(t,e){var r=y("ia9lU"),n=y("b8mN0"),i=y("9lLgO");t.exports=function(t){return function(e,a,o){return o&&"number"!=typeof o&&n(e,a,o)&&(a=o=void 0),e=i(e),void 0===a?(a=e,e=0):a=i(a),o=void 0===o?e<a?1:-1:i(o),r(e,a,o,t)}}}),v("ia9lU",function(t,e){var r=Math.ceil,n=Math.max;t.exports=function(t,e,i,a){for(var o=-1,s=n(r((e-t)/(i||1)),0),l=Array(s);s--;)l[a?s:++o]=t,t+=i;return l}}),v("47O2q",function(t,e){var r=y("fgBHx"),n=y("jrtNg"),i=y("5iyRF"),a=y("b8mN0"),o=i(function(t,e){if(null==t)return[];var i=e.length;return i>1&&a(t,e[0],e[1])?e=[]:i>2&&a(e[0],e[1],e[2])&&(e=[e[0]]),n(t,r(e,1),[])});t.exports=o}),v("jrtNg",function(t,e){var r=y("i46jW"),n=y("lJEX1"),i=y("7MWok"),a=y("fDc61"),o=y("9xZGY"),s=y("91Qdd"),l=y("fyGSR"),u=y("4Nq5y"),h=y("o8HxT");t.exports=function(t,e,d){e=e.length?r(e,function(t){return h(t)?function(e){return n(e,1===t.length?t[0]:t)}:t}):[u];var c=-1;return e=r(e,s(i)),o(a(t,function(t,n,i){return{criteria:r(e,function(e){return e(t)}),index:++c,value:t}}),function(t,e){return l(t,e,d)})}}),v("9xZGY",function(t,e){t.exports=function(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}}),v("fyGSR",function(t,e){var r=y("1HU00");t.exports=function(t,e,n){for(var i=-1,a=t.criteria,o=e.criteria,s=a.length,l=n.length;++i<s;){var u=r(a[i],o[i]);if(u){if(i>=l)return u;return u*("desc"==n[i]?-1:1)}}return t.index-e.index}}),v("1HU00",function(t,e){var r=y("9dr3u");t.exports=function(t,e){if(t!==e){var n=void 0!==t,i=null===t,a=t==t,o=r(t),s=void 0!==e,l=null===e,u=e==e,h=r(e);if(!l&&!h&&!o&&t>e||o&&s&&u&&!l&&!h||i&&s&&u||!n&&u||!a)return 1;if(!i&&!o&&!h&&t<e||h&&n&&a&&!i&&!o||l&&n&&a||!s&&a||!u)return -1}return 0}}),v("g0ikZ",function(t,e){var r=y("l6E2L"),n=0;t.exports=function(t){var e=++n;return r(t)+e}}),v("d0lTW",function(t,e){var r=y("5i71d"),n=y("gMJL8");t.exports=function(t,e){return n(t||[],e||[],r)}}),v("gMJL8",function(t,e){t.exports=function(t,e,r){for(var n=-1,i=t.length,a=e.length,o={};++n<i;){var s=n<a?e[n]:void 0;r(o,t[n],s)}return o}}),v("61rsw",function(t,e){var r=y("bqfL5"),n=y("7azAU");t.exports={run:function(t){var e,i,a,o="greedy"===t.graph().acyclicer?n(t,function(e){return t.edge(e).weight}):(e=[],i={},a={},r.forEach(t.nodes(),function n(o){r.has(a,o)||(a[o]=!0,i[o]=!0,r.forEach(t.outEdges(o),function(t){r.has(i,t.w)?e.push(t):n(t.w)}),delete i[o])}),e);r.forEach(o,function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,r.uniqueId("rev"))})},undo:function(t){r.forEach(t.edges(),function(e){var r=t.edge(e);if(r.reversed){t.removeEdge(e);var n=r.forwardName;delete r.reversed,delete r.forwardName,t.setEdge(e.w,e.v,r,n)}})}}}),v("7azAU",function(t,e){var r=y("bqfL5"),n=y("6mwJ2").Graph,i=y("1Gvoz");t.exports=function(t,e){if(1>=t.nodeCount())return[];var l,u,h,d,c,f,p=(l=e||a,u=new n,h=0,d=0,r.forEach(t.nodes(),function(t){u.setNode(t,{v:t,in:0,out:0})}),r.forEach(t.edges(),function(t){var e=u.edge(t.v,t.w)||0,r=l(t);u.setEdge(t.v,t.w,e+r),d=Math.max(d,u.node(t.v).out+=r),h=Math.max(h,u.node(t.w).in+=r)}),c=r.range(d+h+3).map(function(){return new i}),f=h+1,r.forEach(u.nodes(),function(t){s(c,f,u.node(t))}),{graph:u,buckets:c,zeroIdx:f}),g=function(t,e,r){for(var n,i=[],a=e[e.length-1],s=e[0];t.nodeCount();){for(;n=s.dequeue();)o(t,e,r,n);for(;n=a.dequeue();)o(t,e,r,n);if(t.nodeCount()){for(var l=e.length-2;l>0;--l)if(n=e[l].dequeue()){i=i.concat(o(t,e,r,n,!0));break}}}return i}(p.graph,p.buckets,p.zeroIdx);return r.flatten(r.map(g,function(e){return t.outEdges(e.v,e.w)}),!0)};var a=r.constant(1);function o(t,e,n,i,a){var o=a?[]:void 0;return r.forEach(t.inEdges(i.v),function(r){var i=t.edge(r),l=t.node(r.v);a&&o.push({v:r.v,w:r.w}),l.out-=i,s(e,n,l)}),r.forEach(t.outEdges(i.v),function(r){var i=t.edge(r),a=r.w,o=t.node(a);o.in-=i,s(e,n,o)}),t.removeNode(i.v),o}function s(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)}}),v("1Gvoz",function(t,e){function r(){var t={};t._next=t._prev=t,this._sentinel=t}function n(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function i(t,e){if("_next"!==t&&"_prev"!==t)return e}t.exports=r,r.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return n(e),e},r.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&n(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e},r.prototype.toString=function(){for(var t=[],e=this._sentinel,r=e._prev;r!==e;)t.push(JSON.stringify(r,i)),r=r._prev;return"["+t.join(", ")+"]"}}),v("fi6eg",function(t,e){var r=y("bqfL5"),n=y("1kMKg");t.exports={run:function(t){t.graph().dummyChains=[],r.forEach(t.edges(),function(e){(function(t,e){var r,i,a,o=e.v,s=t.node(o).rank,l=e.w,u=t.node(l).rank,h=e.name,d=t.edge(e),c=d.labelRank;if(u!==s+1){for(t.removeEdge(e),a=0,++s;s<u;++a,++s)d.points=[],i={width:0,height:0,edgeLabel:d,edgeObj:e,rank:s},r=n.addDummyNode(t,"edge",i,"_d"),s===c&&(i.width=d.width,i.height=d.height,i.dummy="edge-label",i.labelpos=d.labelpos),t.setEdge(o,r,{weight:d.weight},h),0===a&&t.graph().dummyChains.push(r),o=r;t.setEdge(o,l,{weight:d.weight},h)}})(t,e)})},undo:function(t){r.forEach(t.graph().dummyChains,function(e){var r,n=t.node(e),i=n.edgeLabel;for(t.setEdge(n.edgeObj,i);n.dummy;)r=t.successors(e)[0],t.removeNode(e),i.points.push({x:n.x,y:n.y}),"edge-label"===n.dummy&&(i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height),e=r,n=t.node(e)})}}}),v("1kMKg",function(t,e){var r=y("bqfL5"),n=y("6mwJ2").Graph;function i(t,e,n,i){var a;do a=r.uniqueId(i);while(t.hasNode(a))return n.dummy=e,t.setNode(a,n),a}function a(t){return r.max(r.map(t.nodes(),function(e){var n=t.node(e).rank;if(!r.isUndefined(n))return n}))}t.exports={addDummyNode:i,simplify:function(t){var e=new n().setGraph(t.graph());return r.forEach(t.nodes(),function(r){e.setNode(r,t.node(r))}),r.forEach(t.edges(),function(r){var n=e.edge(r.v,r.w)||{weight:0,minlen:1},i=t.edge(r);e.setEdge(r.v,r.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),e},asNonCompoundGraph:function(t){var e=new n({multigraph:t.isMultigraph()}).setGraph(t.graph());return r.forEach(t.nodes(),function(r){t.children(r).length||e.setNode(r,t.node(r))}),r.forEach(t.edges(),function(r){e.setEdge(r,t.edge(r))}),e},successorWeights:function(t){var e=r.map(t.nodes(),function(e){var n={};return r.forEach(t.outEdges(e),function(e){n[e.w]=(n[e.w]||0)+t.edge(e).weight}),n});return r.zipObject(t.nodes(),e)},predecessorWeights:function(t){var e=r.map(t.nodes(),function(e){var n={};return r.forEach(t.inEdges(e),function(e){n[e.v]=(n[e.v]||0)+t.edge(e).weight}),n});return r.zipObject(t.nodes(),e)},intersectRect:function(t,e){var r,n,i=t.x,a=t.y,o=e.x-i,s=e.y-a,l=t.width/2,u=t.height/2;if(!o&&!s)throw Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*l>Math.abs(o)*u?(s<0&&(u=-u),r=u*o/s,n=u):(o<0&&(l=-l),r=l,n=l*s/o),{x:i+r,y:a+n}},buildLayerMatrix:function(t){var e=r.map(r.range(a(t)+1),function(){return[]});return r.forEach(t.nodes(),function(n){var i=t.node(n),a=i.rank;r.isUndefined(a)||(e[a][i.order]=n)}),e},normalizeRanks:function(t){var e=r.min(r.map(t.nodes(),function(e){return t.node(e).rank}));r.forEach(t.nodes(),function(n){var i=t.node(n);r.has(i,"rank")&&(i.rank-=e)})},removeEmptyRanks:function(t){var e=r.min(r.map(t.nodes(),function(e){return t.node(e).rank})),n=[];r.forEach(t.nodes(),function(r){var i=t.node(r).rank-e;n[i]||(n[i]=[]),n[i].push(r)});var i=0,a=t.graph().nodeRankFactor;r.forEach(n,function(e,n){r.isUndefined(e)&&n%a!=0?--i:i&&r.forEach(e,function(e){t.node(e).rank+=i})})},addBorderNode:function(t,e,r,n){var a={width:0,height:0};return arguments.length>=4&&(a.rank=r,a.order=n),i(t,"border",a,e)},maxRank:a,partition:function(t,e){var n={lhs:[],rhs:[]};return r.forEach(t,function(t){e(t)?n.lhs.push(t):n.rhs.push(t)}),n},time:function(t,e){var n=r.now();try{return e()}finally{console.log(t+" time: "+(r.now()-n)+"ms")}},notime:function(t,e){return e()}}}),v("hv32p",function(t,e){var r=y("7JZFZ").longestPath,n=y("8eEo6"),i=y("fT8MR");t.exports=function(t){switch(t.graph().ranker){case"network-simplex":default:i(t);break;case"tight-tree":r(t),n(t);break;case"longest-path":a(t)}};var a=r}),v("7JZFZ",function(t,e){var r=y("bqfL5");t.exports={longestPath:function(t){var e={};r.forEach(t.sources(),function n(i){var a=t.node(i);if(r.has(e,i))return a.rank;e[i]=!0;var o=r.min(r.map(t.outEdges(i),function(e){return n(e.w)-t.edge(e).minlen}));return(o===Number.POSITIVE_INFINITY||null==o)&&(o=0),a.rank=o})},slack:function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}}}),v("8eEo6",function(t,e){var r=y("bqfL5"),n=y("6mwJ2").Graph,i=y("7JZFZ").slack;t.exports=function(t){var e,a,o=new n({directed:!1}),s=t.nodes()[0],l=t.nodeCount();for(o.setNode(s,{});r.forEach(o.nodes(),function e(n){r.forEach(t.nodeEdges(n),function(r){var a=r.v,s=n===a?r.w:a;o.hasNode(s)||i(t,r)||(o.setNode(s,{}),o.setEdge(n,s,{}),e(s))})}),o.nodeCount()<l;)e=function(t,e){return r.minBy(e.edges(),function(r){if(t.hasNode(r.v)!==t.hasNode(r.w))return i(e,r)})}(o,t),a=o.hasNode(e.v)?i(t,e):-i(t,e),function(t,e,n){r.forEach(t.nodes(),function(t){e.node(t).rank+=n})}(o,t,a);return o}}),v("fT8MR",function(t,e){var r=y("bqfL5"),n=y("8eEo6"),i=y("7JZFZ"),a=i.slack,i=y("7JZFZ"),o=i.longestPath,s=y("6mwJ2").alg.preorder,l=y("6mwJ2").alg.postorder,u=y("1kMKg").simplify;function h(t){o(t=u(t));var e,r,i=n(t);for(f(i),d(i,t);e=p(i);)r=g(i,t,e),v(i,t,e,r)}function d(t,e){var n=l(t,t.nodes());n=n.slice(0,n.length-1),r.forEach(n,function(r){var n;n=t.node(r).parent,t.edge(r,n).cutvalue=c(t,e,r)})}function c(t,e,n){var i=t.node(n).parent,a=!0,o=e.edge(n,i),s=0;return o||(a=!1,o=e.edge(i,n)),s=o.weight,r.forEach(e.nodeEdges(n),function(r){var o=r.v===n,l=o?r.w:r.v;if(l!==i){var u=o===a,h=e.edge(r).weight;if(s+=u?h:-h,t.hasEdge(n,l)){var d=t.edge(n,l).cutvalue;s+=u?-d:d}}}),s}function f(t,e){arguments.length<2&&(e=t.nodes()[0]),function t(e,n,i,a,o){var s=i,l=e.node(a);return n[a]=!0,r.forEach(e.neighbors(a),function(o){r.has(n,o)||(i=t(e,n,i,o,a))}),l.low=s,l.lim=i++,o?l.parent=o:delete l.parent,i}(t,{},1,e)}function p(t){return r.find(t.edges(),function(e){return t.edge(e).cutvalue<0})}function g(t,e,n){var i=n.v,o=n.w;e.hasEdge(i,o)||(i=n.w,o=n.v);var s=t.node(i),l=t.node(o),u=s,h=!1;s.lim>l.lim&&(u=l,h=!0);var d=r.filter(e.edges(),function(e){return h===m(t,t.node(e.v),u)&&h!==m(t,t.node(e.w),u)});return r.minBy(d,function(t){return a(e,t)})}function v(t,e,n,i){var a,o,l=n.v,u=n.w;t.removeEdge(l,u),t.setEdge(i.v,i.w,{}),f(t),d(t,e),a=r.find(t.nodes(),function(t){return!e.node(t).parent}),o=(o=s(t,a)).slice(1),r.forEach(o,function(r){var n=t.node(r).parent,i=e.edge(r,n),a=!1;i||(i=e.edge(n,r),a=!0),e.node(r).rank=e.node(n).rank+(a?i.minlen:-i.minlen)})}function m(t,e,r){return r.low<=e.lim&&e.lim<=r.lim}t.exports=h,h.initLowLimValues=f,h.initCutValues=d,h.calcCutValue=c,h.leaveEdge=p,h.enterEdge=g,h.exchangeEdges=v}),v("eBG2O",function(t,e){var r=y("bqfL5");t.exports=function(t){var e,n,i=(e={},n=0,r.forEach(t.children(),function i(a){var o=n;r.forEach(t.children(a),i),e[a]={low:o,lim:n++}}),e);r.forEach(t.graph().dummyChains,function(e){for(var r=t.node(e),n=r.edgeObj,a=function(t,e,r,n){var i,a,o=[],s=[],l=Math.min(e[r].low,e[n].low),u=Math.max(e[r].lim,e[n].lim);i=r;do o.push(i=t.parent(i));while(i&&(e[i].low>l||u>e[i].lim))for(a=i,i=n;(i=t.parent(i))!==a;)s.push(i);return{path:o.concat(s.reverse()),lca:a}}(t,i,n.v,n.w),o=a.path,s=a.lca,l=0,u=o[0],h=!0;e!==n.w;){if(r=t.node(e),h){for(;(u=o[l])!==s&&t.node(u).maxRank<r.rank;)l++;u===s&&(h=!1)}if(!h){for(;l<o.length-1&&t.node(u=o[l+1]).minRank<=r.rank;)l++;u=o[l]}t.setParent(e,u),e=t.successors(e)[0]}})}}),v("YdQc0",function(t,e){var r=y("bqfL5"),n=y("1kMKg");t.exports={run:function(t){var e,i=n.addDummyNode(t,"root",{},"_root"),a=(e={},r.forEach(t.children(),function(n){!function n(i,a){var o=t.children(i);o&&o.length&&r.forEach(o,function(t){n(t,a+1)}),e[i]=a}(n,1)}),e),o=r.max(r.values(a))-1,s=2*o+1;t.graph().nestingRoot=i,r.forEach(t.edges(),function(e){t.edge(e).minlen*=s});var l=r.reduce(t.edges(),function(e,r){return e+t.edge(r).weight},0)+1;r.forEach(t.children(),function(e){(function t(e,i,a,o,s,l,u){var h=e.children(u);if(!h.length){u!==i&&e.setEdge(i,u,{weight:0,minlen:a});return}var d=n.addBorderNode(e,"_bt"),c=n.addBorderNode(e,"_bb"),f=e.node(u);e.setParent(d,u),f.borderTop=d,e.setParent(c,u),f.borderBottom=c,r.forEach(h,function(r){t(e,i,a,o,s,l,r);var n=e.node(r),h=n.borderTop?n.borderTop:r,f=n.borderBottom?n.borderBottom:r,p=n.borderTop?o:2*o,g=h!==f?1:s-l[u]+1;e.setEdge(d,h,{weight:p,minlen:g,nestingEdge:!0}),e.setEdge(f,c,{weight:p,minlen:g,nestingEdge:!0})}),e.parent(u)||e.setEdge(i,d,{weight:0,minlen:s+l[u]})})(t,i,s,l,o,a,e)}),t.graph().nodeRankFactor=s},cleanup:function(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,r.forEach(t.edges(),function(e){t.edge(e).nestingEdge&&t.removeEdge(e)})}}}),v("fSZns",function(t,e){var r=y("bqfL5"),n=y("1kMKg");function i(t,e,r,i,a,o){var s=a[e][o-1],l=n.addDummyNode(t,"border",{width:0,height:0,rank:o,borderType:e},r);a[e][o]=l,t.setParent(l,i),s&&t.setEdge(s,l,{weight:1})}t.exports=function(t){r.forEach(t.children(),function e(n){var a=t.children(n),o=t.node(n);if(a.length&&r.forEach(a,e),r.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var s=o.minRank,l=o.maxRank+1;s<l;++s)i(t,"borderLeft","_bl",n,o,s),i(t,"borderRight","_br",n,o,s)}})}}),v("lWVsJ",function(t,e){var r=y("bqfL5");function n(t){r.forEach(t.nodes(),function(e){i(t.node(e))}),r.forEach(t.edges(),function(e){i(t.edge(e))})}function i(t){var e=t.width;t.width=t.height,t.height=e}function a(t){t.y=-t.y}function o(t){var e=t.x;t.x=t.y,t.y=e}t.exports={adjust:function(t){var e=t.graph().rankdir.toLowerCase();("lr"===e||"rl"===e)&&n(t)},undo:function(t){var e=t.graph().rankdir.toLowerCase();("bt"===e||"rl"===e)&&(r.forEach(t.nodes(),function(e){a(t.node(e))}),r.forEach(t.edges(),function(e){var n=t.edge(e);r.forEach(n.points,a),r.has(n,"y")&&a(n)})),("lr"===e||"rl"===e)&&(r.forEach(t.nodes(),function(e){o(t.node(e))}),r.forEach(t.edges(),function(e){var n=t.edge(e);r.forEach(n.points,o),r.has(n,"x")&&o(n)}),n(t))}}}),v("3dyGB",function(t,e){var r=y("bqfL5"),n=y("7H72Y"),i=y("lesrU"),a=y("3CKyT"),o=y("lvOrT"),s=y("7mMpT"),l=y("6mwJ2").Graph,u=y("1kMKg");function h(t,e,n){return r.map(e,function(e){return o(t,e,n)})}function d(t,e){r.forEach(e,function(e){r.forEach(e,function(e,r){t.node(e).order=r})})}t.exports=function(t){var e=u.maxRank(t),o=h(t,r.range(1,e+1),"inEdges"),c=h(t,r.range(e-1,-1,-1),"outEdges"),f=n(t);d(t,f);for(var p,g=Number.POSITIVE_INFINITY,y=0,v=0;v<4;++y,++v){(function(t,e){var n=new l;r.forEach(t,function(t){var i=t.graph().root,o=a(t,i,n,e);r.forEach(o.vs,function(e,r){t.node(e).order=r}),s(t,n,o.vs)})})(y%2?o:c,y%4>=2),f=u.buildLayerMatrix(t);var m=i(t,f);m<g&&(v=0,p=r.cloneDeep(f),g=m)}d(t,p)}}),v("7H72Y",function(t,e){var r=y("bqfL5");t.exports=function(t){var e={},n=r.filter(t.nodes(),function(e){return!t.children(e).length}),i=r.max(r.map(n,function(e){return t.node(e).rank})),a=r.map(r.range(i+1),function(){return[]}),o=r.sortBy(n,function(e){return t.node(e).rank});return r.forEach(o,function n(i){r.has(e,i)||(e[i]=!0,a[t.node(i).rank].push(i),r.forEach(t.successors(i),n))}),a}}),v("lesrU",function(t,e){var r=y("bqfL5");t.exports=function(t,e){for(var n=0,i=1;i<e.length;++i)n+=function(t,e,n){for(var i=r.zipObject(n,r.map(n,function(t,e){return e})),a=r.flatten(r.map(e,function(e){return r.sortBy(r.map(t.outEdges(e),function(e){return{pos:i[e.w],weight:t.edge(e).weight}}),"pos")}),!0),o=1;o<n.length;)o<<=1;var s=2*o-1;o-=1;var l=r.map(Array(s),function(){return 0}),u=0;return r.forEach(a.forEach(function(t){var e=t.pos+o;l[e]+=t.weight;for(var r=0;e>0;)e%2&&(r+=l[e+1]),e=e-1>>1,l[e]+=t.weight;u+=t.weight*r})),u}(t,e[i-1],e[i]);return n}}),v("3CKyT",function(t,e){var r=y("bqfL5"),n=y("6dVLr"),i=y("7P6no"),a=y("6WEME");t.exports=function t(e,o,s,l){var u=e.children(o),h=e.node(o),d=h?h.borderLeft:void 0,c=h?h.borderRight:void 0,f={};d&&(u=r.filter(u,function(t){return t!==d&&t!==c}));var p=n(e,u);r.forEach(p,function(n){if(e.children(n.v).length){var i=t(e,n.v,s,l);f[n.v]=i,r.has(i,"barycenter")&&(r.isUndefined(n.barycenter)?(n.barycenter=i.barycenter,n.weight=i.weight):(n.barycenter=(n.barycenter*n.weight+i.barycenter*i.weight)/(n.weight+i.weight),n.weight+=i.weight))}});var g=i(p,s);r.forEach(g,function(t){t.vs=r.flatten(t.vs.map(function(t){return f[t]?f[t].vs:t}),!0)});var y=a(g,l);if(d&&(y.vs=r.flatten([d,y.vs,c],!0),e.predecessors(d).length)){var v=e.node(e.predecessors(d)[0]),m=e.node(e.predecessors(c)[0]);r.has(y,"barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+v.order+m.order)/(y.weight+2),y.weight+=2}return y}}),v("6dVLr",function(t,e){var r=y("bqfL5");t.exports=function(t,e){return r.map(e,function(e){var n=t.inEdges(e);if(!n.length)return{v:e};var i=r.reduce(n,function(e,r){var n=t.edge(r),i=t.node(r.v);return{sum:e.sum+n.weight*i.order,weight:e.weight+n.weight}},{sum:0,weight:0});return{v:e,barycenter:i.sum/i.weight,weight:i.weight}})}}),v("7P6no",function(t,e){var r=y("bqfL5");t.exports=function(t,e){var n={};return r.forEach(t,function(t,e){var i=n[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};r.isUndefined(t.barycenter)||(i.barycenter=t.barycenter,i.weight=t.weight)}),r.forEach(e.edges(),function(t){var e=n[t.v],i=n[t.w];r.isUndefined(e)||r.isUndefined(i)||(i.indegree++,e.out.push(n[t.w]))}),function(t){for(var e=[];t.length;){var n=t.pop();e.push(n),r.forEach(n.in.reverse(),function(t){return function(e){!e.merged&&(r.isUndefined(e.barycenter)||r.isUndefined(t.barycenter)||e.barycenter>=t.barycenter)&&function(t,e){var r=0,n=0;t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.vs=e.vs.concat(t.vs),t.barycenter=r/n,t.weight=n,t.i=Math.min(e.i,t.i),e.merged=!0}(t,e)}}(n)),r.forEach(n.out,function(e){return function(r){r.in.push(e),0==--r.indegree&&t.push(r)}}(n))}return r.map(r.filter(e,function(t){return!t.merged}),function(t){return r.pick(t,["vs","i","barycenter","weight"])})}(r.filter(n,function(t){return!t.indegree}))}}),v("6WEME",function(t,e){var r=y("bqfL5"),n=y("1kMKg");function i(t,e,n){for(var i;e.length&&(i=r.last(e)).i<=n;)e.pop(),t.push(i.vs),n++;return n}t.exports=function(t,e){var a,o=n.partition(t,function(t){return r.has(t,"barycenter")}),s=o.lhs,l=r.sortBy(o.rhs,function(t){return-t.i}),u=[],h=0,d=0,c=0;s.sort((a=!!e,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:a?e.i-t.i:t.i-e.i})),c=i(u,l,c),r.forEach(s,function(t){c+=t.vs.length,u.push(t.vs),h+=t.barycenter*t.weight,d+=t.weight,c=i(u,l,c)});var f={vs:r.flatten(u,!0)};return d&&(f.barycenter=h/d,f.weight=d),f}}),v("lvOrT",function(t,e){var r=y("bqfL5"),n=y("6mwJ2").Graph;t.exports=function(t,e,i){var a=function(t){for(var e;t.hasNode(e=r.uniqueId("_root")););return e}(t),o=new n({compound:!0}).setGraph({root:a}).setDefaultNodeLabel(function(e){return t.node(e)});return r.forEach(t.nodes(),function(n){var s=t.node(n),l=t.parent(n);(s.rank===e||s.minRank<=e&&e<=s.maxRank)&&(o.setNode(n),o.setParent(n,l||a),r.forEach(t[i](n),function(e){var i=e.v===n?e.w:e.v,a=o.edge(i,n),s=r.isUndefined(a)?0:a.weight;o.setEdge(i,n,{weight:t.edge(e).weight+s})}),r.has(s,"minRank")&&o.setNode(n,{borderLeft:s.borderLeft[e],borderRight:s.borderRight[e]}))}),o}}),v("7mMpT",function(t,e){var r=y("bqfL5");t.exports=function(t,e,n){var i,a={};r.forEach(n,function(r){for(var n,o,s=t.parent(r);s;){if((n=t.parent(s))?(o=a[n],a[n]=s):(o=i,i=s),o&&o!==s){e.setEdge(o,s);return}s=n}})}}),v("j257S",function(t,e){var r=y("bqfL5"),n=y("1kMKg"),i=y("94mUQ").positionX;t.exports=function(t){var e,a,o,s;e=t=n.asNonCompoundGraph(t),a=n.buildLayerMatrix(e),o=e.graph().ranksep,s=0,r.forEach(a,function(t){var n=r.max(r.map(t,function(t){return e.node(t).height}));r.forEach(t,function(t){e.node(t).y=s+n/2}),s+=n+o}),r.forEach(i(t),function(e,r){t.node(r).x=e})}}),v("94mUQ",function(t,e){var r=y("bqfL5"),n=y("6mwJ2").Graph,i=y("1kMKg");function a(t,e){var n={};return r.reduce(e,function(e,i){var a=0,o=0,l=e.length,u=r.last(i);return r.forEach(i,function(e,h){var d=function(t,e){if(t.node(e).dummy)return r.find(t.predecessors(e),function(e){return t.node(e).dummy})}(t,e),c=d?t.node(d).order:l;(d||e===u)&&(r.forEach(i.slice(o,h+1),function(e){r.forEach(t.predecessors(e),function(r){var i=t.node(r),o=i.order;(o<a||c<o)&&!(i.dummy&&t.node(e).dummy)&&s(n,r,e)})}),o=h+1,a=c)}),i}),n}function o(t,e){var n={};function i(e,i,a,o,l){var u;r.forEach(r.range(i,a),function(i){u=e[i],t.node(u).dummy&&r.forEach(t.predecessors(u),function(e){var r=t.node(e);r.dummy&&(r.order<o||r.order>l)&&s(n,e,u)})})}return r.reduce(e,function(e,n){var a,o=-1,s=0;return r.forEach(n,function(r,l){if("border"===t.node(r).dummy){var u=t.predecessors(r);u.length&&(a=t.node(u[0]).order,i(n,s,l,o,a),s=l,o=a)}i(n,s,n.length,a,e.length)}),n}),n}function s(t,e,r){if(e>r){var n=e;e=r,r=n}var i=t[e];i||(t[e]=i={}),i[r]=!0}function l(t,e,n){if(e>n){var i=e;e=n,n=i}return r.has(t[e],n)}function u(t,e,n,i){var a={},o={},s={};return r.forEach(e,function(t){r.forEach(t,function(t,e){a[t]=t,o[t]=t,s[t]=e})}),r.forEach(e,function(t){var e=-1;r.forEach(t,function(t){var u=i(t);if(u.length)for(var h=((u=r.sortBy(u,function(t){return s[t]})).length-1)/2,d=Math.floor(h),c=Math.ceil(h);d<=c;++d){var f=u[d];o[t]===t&&e<s[f]&&!l(n,t,f)&&(o[f]=t,o[t]=a[t]=a[f],e=s[f])}})}),{root:a,align:o}}function h(t,e,i,a,o){var s,l,u,h,d,c={},f=(u=new n,s=(h=t.graph()).nodesep,l=h.edgesep,d=function(t,e,n){var i,a,u=t.node(e),h=t.node(n);if(i=0+u.width/2,r.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":a=-u.width/2;break;case"r":a=u.width/2}if(a&&(i+=o?a:-a),a=0,i+=(u.dummy?l:s)/2,i+=(h.dummy?l:s)/2,i+=h.width/2,r.has(h,"labelpos"))switch(h.labelpos.toLowerCase()){case"l":a=h.width/2;break;case"r":a=-h.width/2}return a&&(i+=o?a:-a),a=0,i},r.forEach(e,function(e){var n;r.forEach(e,function(e){var r=i[e];if(u.setNode(r),n){var a=i[n],o=u.edge(a,r);u.setEdge(a,r,Math.max(d(t,e,n),o||0))}n=e})}),u),p=o?"borderLeft":"borderRight";function g(t,e){for(var r=f.nodes(),n=r.pop(),i={};n;)i[n]?t(n):(i[n]=!0,r.push(n),r=r.concat(e(n))),n=r.pop()}return g(function(t){c[t]=f.inEdges(t).reduce(function(t,e){return Math.max(t,c[e.v]+f.edge(e))},0)},f.predecessors.bind(f)),g(function(e){var r=f.outEdges(e).reduce(function(t,e){return Math.min(t,c[e.w]-f.edge(e))},Number.POSITIVE_INFINITY),n=t.node(e);r!==Number.POSITIVE_INFINITY&&n.borderType!==p&&(c[e]=Math.max(c[e],r))},f.successors.bind(f)),r.forEach(a,function(t){c[t]=c[i[t]]}),c}function d(t,e){return r.minBy(r.values(e),function(e){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return r.forIn(e,function(e,r){var a=t.node(r).width/2;n=Math.max(e+a,n),i=Math.min(e-a,i)}),n-i})}function c(t,e){var n=r.values(e),i=r.min(n),a=r.max(n);r.forEach(["u","d"],function(n){r.forEach(["l","r"],function(o){var s,l=n+o,u=t[l];if(u!==e){var h=r.values(u);(s="l"===o?i-r.min(h):a-r.max(h))&&(t[l]=r.mapValues(u,function(t){return t+s}))}})})}function f(t,e){return r.mapValues(t.ul,function(n,i){if(e)return t[e.toLowerCase()][i];var a=r.sortBy(r.map(t,i));return(a[1]+a[2])/2})}t.exports={positionX:function(t){var e,n=i.buildLayerMatrix(t),s=r.merge(a(t,n),o(t,n)),l={};r.forEach(["u","d"],function(i){e="u"===i?n:r.values(n).reverse(),r.forEach(["l","r"],function(n){"r"===n&&(e=r.map(e,function(t){return r.values(t).reverse()}));var a=("u"===i?t.predecessors:t.successors).bind(t),o=u(t,e,s,a),d=h(t,e,o.root,o.align,"r"===n);"r"===n&&(d=r.mapValues(d,function(t){return-t})),l[i+n]=d})});var p=d(t,l);return c(l,p),f(l,t.graph().align)},findType1Conflicts:a,findType2Conflicts:o,addConflict:s,hasConflict:l,verticalAlignment:u,horizontalCompaction:h,alignCoordinates:c,findSmallestWidthAlignment:d,balance:f}}),v("8XBdx",function(t,e){var r=y("bqfL5"),n=y("1kMKg"),i=y("6mwJ2").Graph;t.exports={debugOrdering:function(t){var e=n.buildLayerMatrix(t),a=new i({compound:!0,multigraph:!0}).setGraph({});return r.forEach(t.nodes(),function(e){a.setNode(e,{label:e}),a.setParent(e,"layer"+t.node(e).rank)}),r.forEach(t.edges(),function(t){a.setEdge(t.v,t.w,{},t.name)}),r.forEach(e,function(t,e){a.setNode("layer"+e,{rank:"same"}),r.reduce(t,function(t,e){return a.setEdge(t,e,{style:"invis"}),e})}),a}}}),v("9Grre",function(t,e){t.exports="0.8.5"});var m=y("6ZWSX"),b={};b="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:c):e=>(t||(t=Promise.resolve())).then(e).catch(t=>setTimeout(()=>{throw t},0));const x="http://www.w3.org/1999/02/22-rdf-syntax-ns#",E="http://www.w3.org/2001/XMLSchema#",w="http://www.w3.org/2000/10/swap/";var _={xsd:{decimal:`${E}decimal`,boolean:`${E}boolean`,double:`${E}double`,integer:`${E}integer`,string:`${E}string`},rdf:{type:`${x}type`,nil:`${x}nil`,first:`${x}first`,rest:`${x}rest`,langString:`${x}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${w}reify#forSome`,forAll:`${w}reify#forAll`},log:{implies:`${w}log#implies`}};const{xsd:S}=_,k=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,N={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},O=/[\x00-\x20<>\\"\{\}\|\^\`]/,T={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},M=/$0^/;class A{constructor(t){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,t=t||{},this._lineMode=!!t.lineMode)for(let t in this._n3Mode=!1,this)!(t in T)&&this[t]instanceof RegExp&&(this[t]=M);else this._n3Mode=!1!==t.n3;this.comments=!!t.comments,this._literalClosingPos=0}_tokenizeToEnd(t,e){let r=this._input,n=r.length;for(;;){let t,o;for(;t=this._newline.exec(r);)this.comments&&(o=this._comment.exec(t[0]))&&i("comment",o[1],"",this._line,t[0].length),n=(r=r.substr(t[0].length,r.length)).length,this._line++;if(!t&&(t=this._whitespace.exec(r))&&(r=r.substr(t[0].length,r.length)),this._endOfFile.test(r))return e&&(this.comments&&(o=this._comment.exec(r))&&i("comment",o[1],"",this._line,r.length),r=null,i("eof","","",this._line,0)),this._input=r;let s=this._line,l=r[0],u="",h="",d="",c=null,f=0,p=!1;switch(l){case"^":if(r.length<3)break;if("^"===r[1]){if(this._previousMarker="^^","<"!==(r=r.substr(2))[0]){p=!0;break}}else{this._n3Mode&&(f=1,u="^");break}case"<":if(c=this._unescapedIri.exec(r))u="IRI",h=c[1];else if(c=this._iri.exec(r)){if(null===(h=this._unescape(c[1]))||O.test(h))return a(this);u="IRI"}else r.length>1&&"<"===r[1]?(u="<<",f=2):this._n3Mode&&r.length>1&&"="===r[1]&&(u="inverse",f=2,h=">");break;case">":r.length>1&&">"===r[1]&&(u=">>",f=2);break;case"_":((c=this._blank.exec(r))||e&&(c=this._blank.exec(`${r} `)))&&(u="blank",d="_",h=c[1]);break;case'"':if(c=this._simpleQuotedString.exec(r))h=c[1];else if({value:h,matchLength:f}=this._parseLiteral(r),null===h)return a(this);(null!==c||0!==f)&&(u="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(c=this._simpleApostropheString.exec(r))h=c[1];else if({value:h,matchLength:f}=this._parseLiteral(r),null===h)return a(this);(null!==c||0!==f)&&(u="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(c=this._variable.exec(r))&&(u="var",h=c[0]);break;case"@":"literal"===this._previousMarker&&(c=this._langcode.exec(r))?(u="langcode",h=c[1]):(c=this._keyword.exec(r))&&(u=c[0]);break;case".":if(1===r.length?e:r[1]<"0"||r[1]>"9"){u=".",f=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(c=this._number.exec(r)||e&&(c=this._number.exec(`${r} `)))&&(u="literal",h=c[0],d="string"==typeof c[1]?S.double:"string"==typeof c[2]?S.decimal:S.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(c=this._sparqlKeyword.exec(r))?u=c[0].toUpperCase():p=!0;break;case"f":case"t":(c=this._boolean.exec(r))?(u="literal",h=c[0],d=S.boolean):p=!0;break;case"a":(c=this._shortPredicates.exec(r))?(u="abbreviation",h="a"):p=!0;break;case"=":this._n3Mode&&r.length>1&&(u="abbreviation",">"!==r[1]?(f=1,h="="):(f=2,h=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"}":this._lineMode||(f=1,u=l);break;case"{":!this._lineMode&&r.length>=2&&("|"===r[1]?(u="{|",f=2):(u=l,f=1));break;case"|":r.length>=2&&"}"===r[1]&&(u="|}",f=2);break;default:p=!0}if(p&&(("@prefix"===this._previousMarker||"PREFIX"===this._previousMarker)&&(c=this._prefix.exec(r))?(u="prefix",h=c[1]||""):((c=this._prefixed.exec(r))||e&&(c=this._prefixed.exec(`${r} `)))&&(u="prefixed",d=c[1]||"",h=this._unescape(c[2]))),"^^"===this._previousMarker)switch(u){case"prefixed":u="type";break;case"IRI":u="typeIRI";break;default:u=""}if(!u){if(e||!/^'''|^"""/.test(r)&&/\n|\r/.test(r))return a(this);return this._input=r}let g=f||c[0].length,y=i(u,h,d,s,g);this.previousToken=y,this._previousMarker=u,r=r.substr(g,r.length)}function i(e,i,a,o,s){let l=r?n-r.length:n,u={type:e,value:i,prefix:a,line:o,start:l,end:l+s};return t(null,u),u}function a(e){t(e._syntaxError(/^\S*/.exec(r)[0]))}}_unescape(t){let e=!1,r=t.replace(k,(t,r,n,i)=>{if("string"==typeof r)return String.fromCharCode(Number.parseInt(r,16));if("string"==typeof n){let t=Number.parseInt(n,16);return t<=65535?String.fromCharCode(Number.parseInt(n,16)):String.fromCharCode(55296+((t-=65536)>>10),56320+(1023&t))}return i in N?N[i]:(e=!0,"")});return e?null:r}_parseLiteral(t){if(t.length>=3){let e=t.match(/^(?:"""|"|'''|'|)/)[0],r=e.length,n=Math.max(this._literalClosingPos,r);for(;(n=t.indexOf(e,n))>0;){let e=0;for(;"\\"===t[n-e-1];)e++;if(e%2==0){let e=t.substring(r,n),i=e.split(/\r\n|\r|\n/).length-1,a=n+r;if(1===r&&0!==i||3===r&&this._lineMode)break;return this._line+=i,{value:this._unescape(e),matchLength:a}}n++}this._literalClosingPos=t.length-r+1}return{value:"",matchLength:0}}_syntaxError(t){this._input=null;let e=Error(`Unexpected "${t}" on line ${this._line}.`);return e.context={token:void 0,line:this._line,previousToken:this.previousToken},e}_readStartingBom(t){return t.startsWith("\uFEFF")?t.substr(1):t}tokenize(t,e){if(this._line=1,"string"==typeof t){if(this._input=this._readStartingBom(t),"function"==typeof e)/*@__PURE__*/f(b)(()=>this._tokenizeToEnd(e,!0));else{let t;let e=[];if(this._tokenizeToEnd((r,n)=>r?t=r:e.push(n),!0),t)throw t;return e}}else this._pendingBuffer=null,"function"==typeof t.setEncoding&&t.setEncoding("utf8"),t.on("data",t=>{null!==this._input&&0!==t.length&&(this._pendingBuffer&&(t=(0,m.Buffer).concat([this._pendingBuffer,t]),this._pendingBuffer=null),128&t[t.length-1]?this._pendingBuffer=t:(void 0===this._input?this._input=this._readStartingBom("string"==typeof t?t:t.toString()):this._input+=t,this._tokenizeToEnd(e,!1)))}),t.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(e,!0)}),t.on("error",e)}}const{rdf:C,xsd:R}=_;let I=0;const P={namedNode:G,blankNode:$,variable:H,literal:U,defaultGraph:function(){return e},quad:W,triple:W,fromTerm:q,fromQuad:Y};class D{constructor(t){this.id=t}get value(){return this.id}equals(t){return t instanceof D?this.id===t.id:!!t&&this.termType===t.termType&&this.value===t.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class L extends D{get termType(){return"NamedNode"}}class j extends D{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){let t=this.id,e=t.lastIndexOf('"')+1;return e<t.length&&"@"===t[e++]?t.substr(e).toLowerCase():""}get datatype(){return new L(this.datatypeString)}get datatypeString(){let t=this.id,e=t.lastIndexOf('"')+1,r=e<t.length?t[e]:"";return"^"===r?t.substr(e+2):"@"!==r?R.string:C.langString}equals(t){return t instanceof j?this.id===t.id:!!t&&!!t.datatype&&this.termType===t.termType&&this.value===t.value&&this.language===t.language&&this.datatype.value===t.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class F extends D{constructor(t){super(`_:${t}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class B extends D{constructor(t){super(`?${t}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}function z(t,r){if("string"==typeof t)return t;if(t instanceof D&&"Quad"!==t.termType)return t.id;if(!t)return e.id;switch(t.termType){case"NamedNode":return t.value;case"BlankNode":return`_:${t.value}`;case"Variable":return`?${t.value}`;case"DefaultGraph":return"";case"Literal":return`"${t.value}"${t.language?`@${t.language}`:t.datatype&&t.datatype.value!==R.string?`^^${t.datatype.value}`:""}`;case"Quad":let n=[z(t.subject,!0),z(t.predicate,!0),z(t.object,!0)];return t.graph&&"DefaultGraph"!==t.graph.termType&&n.push(z(t.graph,!0)),r?n:JSON.stringify(n);default:throw Error(`Unexpected termType: ${t.termType}`)}}e=new class extends D{constructor(){return super(""),e||this}get termType(){return"DefaultGraph"}equals(t){return this===t||!!t&&this.termType===t.termType}};class V extends D{constructor(t,r,n,i){super(""),this._subject=t,this._predicate=r,this._object=n,this._graph=i||e}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(t){return!!t&&this._subject.equals(t.subject)&&this._predicate.equals(t.predicate)&&this._object.equals(t.object)&&this._graph.equals(t.graph)}}function G(t){return new L(t)}function $(t){return new F(t||`n3-${I++}`)}function U(t,e){if("string"==typeof e)return new j(`"${t}"@${e.toLowerCase()}`);let r=e?e.value:"";return""!==r||("boolean"==typeof t?r=R.boolean:"number"!=typeof t||(Number.isFinite(t)?r=Number.isInteger(t)?R.integer:R.double:(r=R.double,Number.isNaN(t)||(t=t>0?"INF":"-INF")))),new j(""===r||r===R.string?`"${t}"`:`"${t}"^^${r}`)}function H(t){return new B(t)}function W(t,e,r,n){return new V(t,e,r,n)}function q(t){if(t instanceof D)return t;switch(t.termType){case"NamedNode":return G(t.value);case"BlankNode":return $(t.value);case"Variable":return H(t.value);case"DefaultGraph":return e;case"Literal":return U(t.value,t.language||t.datatype);case"Quad":return Y(t);default:throw Error(`Unexpected termType: ${t.termType}`)}}function Y(t){if(t instanceof V)return t;if("Quad"!==t.termType)throw Error(`Unexpected termType: ${t.termType}`);return W(q(t.subject),q(t.predicate),q(t.object),q(t.graph))}let K=0;class X{constructor(t){this._contextStack=[],this._graph=null,t=t||{},this._setBase(t.baseIRI),t.factory&&Z(this,t.factory);let e="string"==typeof t.format?t.format.match(/\w*$/)[0].toLowerCase():"",r=/turtle/.test(e),n=/trig/.test(e),i=/triple/.test(e),a=/quad/.test(e),o=this._n3Mode=/n3/.test(e),s=i||a;(this._supportsNamedGraphs=!(r||o))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||n||i||o),this._supportsRDFStar=""===e||/star|\*$/.test(e),s&&(this._resolveRelativeIRI=t=>null),this._blankNodePrefix="string"!=typeof t.blankNodePrefix?"":t.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=t.lexer||new A({lineMode:s,n3:o}),this._explicitQuantifiers=!!t.explicitQuantifiers}static _resetBlankNodePrefix(){K=0}_setBase(t){if(t){let e=t.indexOf("#");e>=0&&(t=t.substr(0,e)),this._base=t,this._basePath=0>t.indexOf("/")?t:t.replace(/[^\/?]*(?:\?.*)?$/,""),t=t.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=t[0],this._baseScheme=t[1]}else this._base="",this._basePath=""}_saveContext(t,e,r,n,i){let a=this._n3Mode;this._contextStack.push({type:t,subject:r,predicate:n,object:i,graph:e,inverse:!!a&&this._inversePredicate,blankPrefix:a?this._prefixes._:"",quantified:a?this._quantified:null}),a&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(t,e){let r=this._contextStack.pop();if(!r||r.type!==t)return this._error(`Unexpected ${e.type}`,e);this._subject=r.subject,this._predicate=r.predicate,this._object=r.object,this._graph=r.graph,this._n3Mode&&(this._inversePredicate=r.inverse,this._prefixes._=r.blankPrefix,this._quantified=r.quantified)}_readInTopContext(t){switch(t.type){case"eof":if(null!==this._graph)return this._error("Unclosed graph",t);return delete this._prefixes._,this._callback(null,null,this._prefixes);case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(t)}}_readEntity(t,e){let r;switch(t.type){case"IRI":case"typeIRI":let n=this._resolveIRI(t.value);if(null===n)return this._error("Invalid IRI",t);r=this._factory.namedNode(n);break;case"type":case"prefixed":let i=this._prefixes[t.prefix];if(void 0===i)return this._error(`Undefined prefix "${t.prefix}:"`,t);r=this._factory.namedNode(i+t.value);break;case"blank":r=this._factory.blankNode(this._prefixes[t.prefix]+t.value);break;case"var":r=this._factory.variable(t.value.substr(1));break;default:return this._error(`Expected entity but got ${t.type}`,t)}return!e&&this._n3Mode&&r.id in this._quantified&&(r=this._quantified[r.id]),r}_readSubject(t){switch(this._predicate=null,t.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._factory.blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":if(!this._n3Mode)return this._error("Unexpected graph",t);return this._saveContext("formula",this._graph,this._graph=this._factory.blankNode(),null,null),this._readSubject;case"}":return this._readPunctuation(t);case"@forSome":if(!this._n3Mode)return this._error('Unexpected "@forSome"',t);return this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier="blankNode",this._readQuantifierList;case"@forAll":if(!this._n3Mode)return this._error('Unexpected "@forAll"',t);return this._subject=null,this._predicate=this.N3_FORALL,this._quantifier="variable",this._readQuantifierList;case"literal":if(!this._n3Mode)return this._error("Unexpected literal",t);if(0===t.prefix.length)return this._literalValue=t.value,this._completeSubjectLiteral;this._subject=this._factory.literal(t.value,this._factory.namedNode(t.prefix));break;case"<<":if(!this._supportsRDFStar)return this._error("Unexpected RDF-star syntax",t);return this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject;default:if(void 0===(this._subject=this._readEntity(t)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(t){let e=t.type;switch(e){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[t.value];break;case".":case"]":case"}":if(null===this._predicate)return this._error(`Unexpected ${e}`,t);return this._subject=null,"]"===e?this._readBlankNodeTail(t):this._readPunctuation(t);case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",t);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._factory.blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",t);default:if(void 0===(this._predicate=this._readEntity(t)))return}return this._readObject}_readObject(t){switch(t.type){case"literal":if(0===t.prefix.length)return this._literalValue=t.value,this._readDataTypeOrLang;this._object=this._factory.literal(t.value,this._factory.namedNode(t.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._factory.blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":if(!this._n3Mode)return this._error("Unexpected graph",t);return this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._factory.blankNode()),this._readSubject;case"<<":if(!this._supportsRDFStar)return this._error("Unexpected RDF-star syntax",t);return this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject;default:if(void 0===(this._object=this._readEntity(t)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(t){return"{"===t.type?this._readGraph(t):this._readPredicate(t)}_readGraph(t){return"{"!==t.type?this._error(`Expected graph but got ${t.type}`,t):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(t){return"]"===t.type?(this._subject=null,this._readBlankNodeTail(t)):(this._predicate=null,this._readPredicate(t))}_readBlankNodeTail(t){if("]"!==t.type)return this._readBlankNodePunctuation(t);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);let e=null===this._predicate;return(this._restoreContext("blank",t),null!==this._object)?this._getContextEndReader():null!==this._predicate?this._readObject:e?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(t){switch(t.type){case".":case"}":return this._subject=null,this._readPunctuation(t);default:return this._readPredicate(t)}}_readListItem(t){let e=null,r=null,n=this._readListItem,i=this._subject,a=this._contextStack,o=a[a.length-1];switch(t.type){case"[":this._saveContext("blank",this._graph,r=this._factory.blankNode(),this.RDF_FIRST,this._subject=e=this._factory.blankNode()),n=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,r=this._factory.blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",t),0!==a.length&&"list"===a[a.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(n=this._readPredicate,this._subject===this.RDF_NIL)return n}else if(n=this._getContextEndReader(),this._object===this.RDF_NIL)return n;r=this.RDF_NIL;break;case"literal":0===t.prefix.length?(this._literalValue=t.value,n=this._readListItemDataTypeOrLang):(e=this._factory.literal(t.value,this._factory.namedNode(t.prefix)),n=this._getContextEndReader());break;case"{":if(!this._n3Mode)return this._error("Unexpected graph",t);return this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._factory.blankNode()),this._readSubject;default:if(void 0===(e=this._readEntity(t)))return}if(null===r&&(this._subject=r=this._factory.blankNode()),null===i?null===o.predicate?o.subject=r:o.object=r:this._emit(i,this.RDF_REST,r,this._graph),null!==e){if(this._n3Mode&&("IRI"===t.type||"prefixed"===t.type))return this._saveContext("item",this._graph,r,this.RDF_FIRST,e),this._subject=e,this._predicate=null,this._getPathReader(this._readListItem);this._emit(r,this.RDF_FIRST,e,this._graph)}return n}_readDataTypeOrLang(t){return this._completeObjectLiteral(t,!1)}_readListItemDataTypeOrLang(t){return this._completeObjectLiteral(t,!0)}_completeLiteral(t){let e=this._factory.literal(this._literalValue);switch(t.type){case"type":case"typeIRI":let r=this._readEntity(t);if(void 0===r)return;e=this._factory.literal(this._literalValue,r),t=null;break;case"langcode":e=this._factory.literal(this._literalValue,t.value),t=null}return{token:t,literal:e}}_completeSubjectLiteral(t){return this._subject=this._completeLiteral(t).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(t,e){let r=this._completeLiteral(t);if(r)return(this._object=r.literal,e&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===r.token)?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(r.token))}_readFormulaTail(t){return"}"!==t.type?this._readPunctuation(t):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",t),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(t){let e,r=this._graph,n=this._subject,i=this._inversePredicate;switch(t.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",t);if(this._n3Mode)return this._readFormulaTail(t);this._graph=null;case".":this._subject=null,e=this._contextStack.length?this._readSubject:this._readInTopContext,i&&(this._inversePredicate=!1);break;case";":e=this._readPredicate;break;case",":e=this._readObject;break;case"{|":if(!this._supportsRDFStar)return this._error("Unexpected RDF-star syntax",t);let a=this._predicate,o=this._object;this._subject=this._factory.quad(n,a,o,this.DEFAULTGRAPH),e=this._readPredicate;break;case"|}":if("Quad"!==this._subject.termType)return this._error("Unexpected asserted triple closing",t);this._subject=null,e=this._readPunctuation;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(r=this._readEntity(t))){e=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,t)}if(null!==n){let t=this._predicate,e=this._object;i?this._emit(e,t,n,r):this._emit(n,t,e,r)}return e}_readBlankNodePunctuation(t){let e;switch(t.type){case";":e=this._readPredicate;break;case",":e=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,t)}return this._emit(this._subject,this._predicate,this._object,this._graph),e}_readQuadPunctuation(t){return"."!==t.type?this._error("Expected dot to follow quad",t):this._readInTopContext}_readPrefix(t){return"prefix"!==t.type?this._error("Expected prefix to follow @prefix",t):(this._prefix=t.value,this._readPrefixIRI)}_readPrefixIRI(t){if("IRI"!==t.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,t);let e=this._readEntity(t);return this._prefixes[this._prefix]=e.value,this._prefixCallback(this._prefix,e),this._readDeclarationPunctuation}_readBaseIRI(t){let e="IRI"===t.type&&this._resolveIRI(t.value);return e?(this._setBase(e),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",t)}_readNamedGraphLabel(t){switch(t.type){case"IRI":case"blank":case"prefixed":return this._readSubject(t),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",t)}}_readNamedGraphBlankLabel(t){return"]"!==t.type?this._error("Invalid graph label",t):(this._subject=this._factory.blankNode(),this._readGraph)}_readDeclarationPunctuation(t){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(t)):"."!==t.type?this._error("Expected declaration to end with a dot",t):this._readInTopContext}_readQuantifierList(t){let e;switch(t.type){case"IRI":case"prefixed":if(void 0!==(e=this._readEntity(t,!0)))break;default:return this._error(`Unexpected ${t.type}`,t)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._factory.blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._factory.blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,e,this.QUANTIFIERS_GRAPH)):this._quantified[e.id]=this._factory[this._quantifier](this._factory.blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(t){return","===t.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(t))}_getPathReader(t){return this._afterPath=t,this._readPath}_readPath(t){switch(t.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:let e=this._contextStack,r=e.length&&e[e.length-1];if(r&&"item"===r.type){let e=this._subject;this._restoreContext("item",t),this._emit(this._subject,this.RDF_FIRST,e,this._graph)}return this._afterPath(t)}}_readForwardPath(t){let e,r;let n=this._factory.blankNode();if(void 0!==(r=this._readEntity(t)))return null===this._predicate?(e=this._subject,this._subject=n):(e=this._object,this._object=n),this._emit(e,r,n,this._graph),this._readPath}_readBackwardPath(t){let e,r;let n=this._factory.blankNode();if(void 0!==(e=this._readEntity(t)))return null===this._predicate?(r=this._subject,this._subject=n):(r=this._object,this._object=n),this._emit(n,e,r,this._graph),this._readPath}_readRDFStarTailOrGraph(t){return">>"!==t.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(t))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,t):this._readRDFStarTail(t)}_readRDFStarTail(t){if(">>"!==t.type)return this._error(`Expected >> but got ${t.type}`,t);let e=this._factory.quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return(this._restoreContext("<<",t),null===this._subject)?(this._subject=e,this._readPredicate):(this._object=e,this._getContextEndReader())}_getContextEndReader(){let t=this._contextStack;if(!t.length)return this._readPunctuation;switch(t[t.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(t,e,r,n){this._callback(null,this._factory.quad(t,e,r,n||this.DEFAULTGRAPH))}_error(t,e){let r=Error(`${t} on line ${e.line}.`);r.context={token:e,line:e.line,previousToken:this._lexer.previousToken},this._callback(r),this._callback=J}_resolveIRI(t){return/^[a-z][a-z0-9+.-]*:/i.test(t)?t:this._resolveRelativeIRI(t)}_resolveRelativeIRI(t){if(!t.length)return this._base;switch(t[0]){case"#":return this._base+t;case"?":return this._base.replace(/(?:\?.*)?$/,t);case"/":return("/"===t[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(t);default:return/^[^/:]*:/.test(t)?null:this._removeDotSegments(this._basePath+t)}}_removeDotSegments(t){if(!/(^|\/)\.\.?($|[/#?])/.test(t))return t;let e=t.length,r="",n=-1,i=-1,a=0,o="/";for(;n<e;){switch(o){case":":if(i<0&&"/"===t[++n]&&"/"===t[++n])for(;(i=n+1)<e&&"/"!==t[i];)n=i;break;case"?":case"#":n=e;break;case"/":if("."===t[n+1])switch(o=t[++n+1]){case"/":r+=t.substring(a,n-1),a=n+1;break;case void 0:case"?":case"#":return r+t.substring(a,n)+t.substr(n+1);case".":if(void 0===(o=t[++n+1])||"/"===o||"?"===o||"#"===o){if(r+=t.substring(a,n-2),(a=r.lastIndexOf("/"))>=i&&(r=r.substr(0,a)),"/"!==o)return`${r}/${t.substr(n+1)}`;a=n+1}}}o=t[++n]}return r+t.substring(a)}parse(t,e,r){let n,i,a;if(e&&(e.onQuad||e.onPrefix||e.onComment)?(n=e.onQuad,i=e.onPrefix,a=e.onComment):(n=e,i=r),this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${K++}_`,this._prefixCallback=i||J,this._inversePredicate=!1,this._quantified=Object.create(null),!n){let e;let r=[];if(this._callback=(t,n)=>{t?e=t:n&&r.push(n)},this._lexer.tokenize(t).every(t=>this._readCallback=this._readCallback(t)),e)throw e;return r}let o=(t,e)=>{null!==t?(this._callback(t),this._callback=J):this._readCallback&&(this._readCallback=this._readCallback(e))};a&&(this._lexer.comments=!0,o=(t,e)=>{null!==t?(this._callback(t),this._callback=J):this._readCallback&&("comment"===e.type?a(e.value):this._readCallback=this._readCallback(e))}),this._callback=n,this._lexer.tokenize(t,o)}}function J(){}function Z(t,e){t._factory=e,t.DEFAULTGRAPH=e.defaultGraph(),t.RDF_FIRST=e.namedNode(_.rdf.first),t.RDF_REST=e.namedNode(_.rdf.rest),t.RDF_NIL=e.namedNode(_.rdf.nil),t.N3_FORALL=e.namedNode(_.r.forAll),t.N3_FORSOME=e.namedNode(_.r.forSome),t.ABBREVIATIONS={a:e.namedNode(_.rdf.type),"=":e.namedNode(_.owl.sameAs),">":e.namedNode(_.log.implies)},t.QUANTIFIERS_GRAPH=e.namedNode("urn:n3:quantifiers")}Z(X.prototype,P);var Q={};function tt(t){return!!t&&"NamedNode"===t.termType}function te(t){return!!t&&"BlankNode"===t.termType}function tr(t){return!!t&&"Literal"===t.termType}function tn(t){return!!t&&"Variable"===t.termType}function ti(t){return!!t&&"DefaultGraph"===t.termType}function ta(t){return ti(t.graph)}function to(t,e){return ts({"":t.value||t},e)("")}function ts(t,e){let r=Object.create(null);for(let e in t)n(e,t[e]);function n(t,n){if("string"==typeof n){let i=Object.create(null);r[t]=t=>i[t]||(i[t]=e.namedNode(n+t))}else if(!(t in r))throw Error(`Unknown prefix: ${t}`);return r[t]}return e=e||P,n}n(Q,"isNamedNode",()=>tt),n(Q,"isBlankNode",()=>te),n(Q,"isLiteral",()=>tr),n(Q,"isVariable",()=>tn),n(Q,"isDefaultGraph",()=>ti),n(Q,"inDefaultGraph",()=>ta),n(Q,"prefix",()=>to),n(Q,"prefixes",()=>ts);const tl=P.defaultGraph(),{rdf:tu,xsd:th}=_,td=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,tc=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,tf={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class tp extends D{equals(t){return t===this}}class tg{constructor(t,e){if(this._prefixRegex=/$0^/,t&&"function"!=typeof t.write&&(e=t,t=null),e=e||{},this._lists=e.lists,t)this._outputStream=t,this._endStream=void 0===e.end||!!e.end;else{let t="";this._outputStream={write(e,r,n){t+=e,n&&n()},end:e=>{e&&e(null,t)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(e.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=tl,this._prefixIRIs=Object.create(null),e.prefixes&&this.addPrefixes(e.prefixes),e.baseIRI&&(this._baseMatcher=RegExp(`^${tv(e.baseIRI)}${e.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=e.baseIRI.length))}get _inDefaultGraph(){return tl.equals(this._graph)}_write(t,e){this._outputStream.write(t,"utf8",e)}_writeQuad(t,e,r,n,i){try{n.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(tl.equals(n)?"":`${this._encodeIriOrBlank(n)} {
`)),this._graph=n,this._subject=null),t.equals(this._subject)?e.equals(this._predicate)?this._write(`, ${this._encodeObject(r)}`,i):this._write(`;
    ${this._encodePredicate(this._predicate=e)} ${this._encodeObject(r)}`,i):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=t)} ${this._encodePredicate(this._predicate=e)} ${this._encodeObject(r)}`,i)}catch(t){i&&i(t)}}_writeQuadLine(t,e,r,n,i){delete this._prefixMatch,this._write(this.quadToString(t,e,r,n),i)}quadToString(t,e,r,n){return`${this._encodeSubject(t)} ${this._encodeIriOrBlank(e)} ${this._encodeObject(r)}${n&&n.value?` ${this._encodeIriOrBlank(n)} .
`:" .\n"}`}quadsToString(t){let e="";for(let r of t)e+=this.quadToString(r.subject,r.predicate,r.object,r.graph);return e}_encodeSubject(t){return"Quad"===t.termType?this._encodeQuad(t):this._encodeIriOrBlank(t)}_encodeIriOrBlank(t){if("NamedNode"!==t.termType)return this._lists&&t.value in this._lists&&(t=this.list(this._lists[t.value])),"id"in t?t.id:`_:${t.value}`;let e=t.value;this._baseMatcher&&this._baseMatcher.test(e)&&(e=e.substr(this._baseLength)),td.test(e)&&(e=e.replace(tc,ty));let r=this._prefixRegex.exec(e);return r?r[1]?this._prefixIRIs[r[1]]+r[2]:e:`<${e}>`}_encodeLiteral(t){let e=t.value;if(td.test(e)&&(e=e.replace(tc,ty)),t.language)return`"${e}"@${t.language}`;if(this._lineMode){if(t.datatype.value===th.string)return`"${e}"`}else switch(t.datatype.value){case th.string:return`"${e}"`;case th.boolean:if("true"===e||"false"===e)return e;break;case th.integer:if(/^[+-]?\d+$/.test(e))return e;break;case th.decimal:if(/^[+-]?\d*\.\d+$/.test(e))return e;break;case th.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(e))return e}return`"${e}"^^${this._encodeIriOrBlank(t.datatype)}`}_encodePredicate(t){return t.value===tu.type?"a":this._encodeIriOrBlank(t)}_encodeObject(t){switch(t.termType){case"Quad":return this._encodeQuad(t);case"Literal":return this._encodeLiteral(t);default:return this._encodeIriOrBlank(t)}}_encodeQuad({subject:t,predicate:e,object:r,graph:n}){return`<<${this._encodeSubject(t)} ${this._encodePredicate(e)} ${this._encodeObject(r)}${ti(n)?"":` ${this._encodeIriOrBlank(n)}`}>>`}_blockedWrite(){throw Error("Cannot write because the writer has been closed.")}addQuad(t,e,r,n,i){void 0===r?this._writeQuad(t.subject,t.predicate,t.object,t.graph,e):"function"==typeof n?this._writeQuad(t,e,r,tl,n):this._writeQuad(t,e,r,n||tl,i)}addQuads(t){for(let e=0;e<t.length;e++)this.addQuad(t[e])}addPrefix(t,e,r){let n={};n[t]=e,this.addPrefixes(n,r)}addPrefixes(t,e){if(!this._prefixIRIs)return e&&e();let r=!1;for(let e in t){let n=t[e];"string"!=typeof n&&(n=n.value),r=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[n]=e+=":",this._write(`@prefix ${e} <${n}>.
`)}if(r){let t="",e="";for(let r in this._prefixIRIs)t+=t?`|${r}`:r,e+=(e?"|":"")+this._prefixIRIs[r];t=tv(t,/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=RegExp(`^(?:${e})[^/]*$|^(${t})([_a-zA-Z0-9][\\-_a-zA-Z0-9]*)$`)}this._write(r?"\n":"",e)}blank(t,e){let r=t,n,i;switch(void 0===t?r=[]:t.termType?r=[{predicate:t,object:e}]:"length"in t||(r=[t]),i=r.length){case 0:return new tp("[]");case 1:if(!((n=r[0]).object instanceof tp))return new tp(`[ ${this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)} ]`);default:let a="[";for(let e=0;e<i;e++)(n=r[e]).predicate.equals(t)?a+=`, ${this._encodeObject(n.object)}`:(a+=`${(e?";\n  ":"\n  ")+this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)}`,t=n.predicate);return new tp(`${a}
]`)}}list(t){let e=t&&t.length||0,r=Array(e);for(let n=0;n<e;n++)r[n]=this._encodeObject(t[n]);return new tp(`(${r.join(" ")})`)}end(t){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let e=t&&((r,n)=>{e=null,t(r,n)});if(this._endStream)try{return this._outputStream.end(e)}catch(t){}e&&e()}}function ty(t){let e=tf[t];return void 0===e&&(1===t.length?(e=t.charCodeAt(0).toString(16),e="\\u0000".substr(0,6-e.length)+e):(e=((t.charCodeAt(0)-55296)*1024+t.charCodeAt(1)+9216).toString(16),e="\\U00000000".substr(0,10-e.length)+e)),e}function tv(t){return t.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}var tm=y("7K0Nk");const tb=Symbol("iter");function tx(t,e,r=4){if(0===r)return Object.assign(t,e);for(let n in e)t[n]=tx(t[n]||Object.create(null),e[n],r-1);return t}class tE{constructor(t={}){this._id=1,this._ids=Object.create(null),this._ids[""]=1,this._entities=Object.create(null),this._entities[1]="",this._blankNodeIndex=0,this._factory=t.factory||P}_termFromId(t){if("."===t[0]){let e=this._entities,r=t.split(".");return this._factory.quad(this._termFromId(e[r[1]]),this._termFromId(e[r[2]]),this._termFromId(e[r[3]]),r[4]&&this._termFromId(e[r[4]]))}return function t(e,r,n){if(r=r||P,!e)return r.defaultGraph();switch(e[0]){case"?":return r.variable(e.substr(1));case"_":return r.blankNode(e.substr(2));case'"':if(r===P)return new j(e);if('"'===e[e.length-1])return r.literal(e.substr(1,e.length-2));let i=e.lastIndexOf('"',e.length-1);return r.literal(e.substr(1,i-1),"@"===e[i+1]?e.substr(i+2):r.namedNode(e.substr(i+3)));case"[":e=JSON.parse(e);break;default:if(!n||!Array.isArray(e))return r.namedNode(e)}return r.quad(t(e[0],r,!0),t(e[1],r,!0),t(e[2],r,!0),e[3]&&t(e[3],r,!0))}(t,this._factory)}_termToNumericId(t){if("Quad"===t.termType){let e;let r=this._termToNumericId(t.subject),n=this._termToNumericId(t.predicate),i=this._termToNumericId(t.object);return r&&n&&i&&(ti(t.graph)||(e=this._termToNumericId(t.graph)))&&this._ids[e?`.${r}.${n}.${i}.${e}`:`.${r}.${n}.${i}`]}return this._ids[z(t)]}_termToNewNumericId(t){let e=t&&"Quad"===t.termType?`.${this._termToNewNumericId(t.subject)}.${this._termToNewNumericId(t.predicate)}.${this._termToNewNumericId(t.object)}${ti(t.graph)?"":`.${this._termToNewNumericId(t.graph)}`}`:z(t);return this._ids[e]||(this._ids[this._entities[++this._id]=e]=this._id)}createBlankNode(t){let e,r;if(t)for(e=t=`_:${t}`,r=1;this._ids[e];)e=t+r++;else do e=`_:b${this._blankNodeIndex++}`;while(this._ids[e])return this._ids[e]=++this._id,this._entities[this._id]=e,this._factory.blankNode(e.substr(2))}}class tw{constructor(t,e){this._size=0,this._graphs=Object.create(null),e||!t||t[0]||(e=t,t=null),e=e||{},this._factory=e.factory||P,this._entityIndex=e.entityIndex||new tE({factory:this._factory}),this._entities=this._entityIndex._entities,this._termFromId=this._entityIndex._termFromId.bind(this._entityIndex),this._termToNumericId=this._entityIndex._termToNumericId.bind(this._entityIndex),this._termToNewNumericId=this._entityIndex._termToNewNumericId.bind(this._entityIndex),t&&this.addQuads(t)}get size(){let t,e,r=this._size;if(null!==r)return r;r=0;let n=this._graphs;for(let i in n)for(let a in t=n[i].subjects)for(let n in e=t[a])r+=Object.keys(e[n]).length;return this._size=r}_addToIndex(t,e,r,n){let i=t[e]||(t[e]={}),a=i[r]||(i[r]={}),o=n in a;return o||(a[n]=null),!o}_removeFromIndex(t,e,r,n){let i=t[e],a=i[r];for(let t in delete a[n],a)return;for(let t in delete i[r],i)return;delete t[e]}*_findInIndex(t,e,r,n,i,a,o,s){let l,u,h;let d=this._entities,c=this._termFromId(d[s]),f={subject:null,predicate:null,object:null};for(let s in e&&((l=t,t={})[e]=l[e]),t)if(u=t[s]){for(let t in f[i]=this._termFromId(d[s]),r&&((l=u,u={})[r]=l[r]),u)if(h=u[t]){f[a]=this._termFromId(d[t]);let e=n?n in h?[n]:[]:Object.keys(h);for(let t=0;t<e.length;t++)f[o]=this._termFromId(d[e[t]]),yield this._factory.quad(f.subject,f.predicate,f.object,c)}}}_loop(t,e){for(let r in t)e(r)}_loopByKey0(t,e,r){let n,i;if(n=t[e])for(i in n)r(i)}_loopByKey1(t,e,r){let n;for(n in t)t[n][e]&&r(n)}_loopBy2Keys(t,e,r,n){let i,a,o;if((i=t[e])&&(a=i[r]))for(o in a)n(o)}_countInIndex(t,e,r,n){let i=0,a,o,s;for(let l in e&&((a=t,t={})[e]=a[e]),t)if(o=t[l])for(let t in r&&((a=o,o={})[r]=a[r]),o)(s=o[t])&&(n?n in s&&i++:i+=Object.keys(s).length);return i}_getGraphs(t){return"number"!=typeof(t=""===t?1:t&&(this._termToNumericId(t)||-1))?this._graphs:{[t]:this._graphs[t]}}_uniqueEntities(t){let e=Object.create(null);return r=>{r in e||(e[r]=!0,t(this._termFromId(this._entities[r],this._factory)))}}add(t){return this.addQuad(t),this}addQuad(t,e,r,n){e||(n=t.graph,r=t.object,e=t.predicate,t=t.subject),n=n?this._termToNewNumericId(n):1;let i=this._graphs[n];return i||Object.freeze(i=this._graphs[n]={subjects:{},predicates:{},objects:{}}),t=this._termToNewNumericId(t),e=this._termToNewNumericId(e),r=this._termToNewNumericId(r),!!this._addToIndex(i.subjects,t,e,r)&&(this._addToIndex(i.predicates,e,r,t),this._addToIndex(i.objects,r,t,e),this._size=null,!0)}addQuads(t){for(let e=0;e<t.length;e++)this.addQuad(t[e])}delete(t){return this.removeQuad(t),this}has(t,e,r,n){return t&&t.subject&&({subject:t,predicate:e,object:r,graph:n}=t),!this.readQuads(t,e,r,n).next().done}import(t){return t.on("data",t=>{this.addQuad(t)}),t}removeQuad(t,e,r,n){let i,a,o;e||({subject:t,predicate:e,object:r,graph:n}=t),n=n?this._termToNumericId(n):1;let s=this._graphs;if(!(t=t&&this._termToNumericId(t))||!(e=e&&this._termToNumericId(e))||!(r=r&&this._termToNumericId(r))||!(i=s[n])||!(a=i.subjects[t])||!(o=a[e])||!(r in o))return!1;for(t in this._removeFromIndex(i.subjects,t,e,r),this._removeFromIndex(i.predicates,e,r,t),this._removeFromIndex(i.objects,r,t,e),null!==this._size&&this._size--,i.subjects)return!0;return delete s[n],!0}removeQuads(t){for(let e=0;e<t.length;e++)this.removeQuad(t[e])}remove(t){return t.on("data",t=>{this.removeQuad(t)}),t}removeMatches(t,e,r,n){let i=new tm.Readable({objectMode:!0}),a=this.readQuads(t,e,r,n);return i._read=t=>{for(;--t>=0;){let{done:t,value:e}=a.next();if(t){i.push(null);return}i.push(e)}},this.remove(i)}deleteGraph(t){return this.removeMatches(null,null,null,t)}getQuads(t,e,r,n){return[...this.readQuads(t,e,r,n)]}*readQuads(t,e,r,n){let i,a,o,s;let l=this._getGraphs(n);if((!t||(a=this._termToNumericId(t)))&&(!e||(o=this._termToNumericId(e)))&&(!r||(s=this._termToNumericId(r))))for(let t in l)(i=l[t])&&(a?s?yield*this._findInIndex(i.objects,s,a,o,"object","subject","predicate",t):yield*this._findInIndex(i.subjects,a,o,null,"subject","predicate","object",t):o?yield*this._findInIndex(i.predicates,o,s,null,"predicate","object","subject",t):s?yield*this._findInIndex(i.objects,s,null,null,"object","subject","predicate",t):yield*this._findInIndex(i.subjects,null,null,null,"subject","predicate","object",t))}match(t,e,r,n){return new tS(this,t,e,r,n,{entityIndex:this._entityIndex})}countQuads(t,e,r,n){let i=this._getGraphs(n),a=0,o,s,l,u;if(t&&!(s=this._termToNumericId(t))||e&&!(l=this._termToNumericId(e))||r&&!(u=this._termToNumericId(r)))return 0;for(let n in i)(o=i[n])&&(t?r?a+=this._countInIndex(o.objects,u,s,l):a+=this._countInIndex(o.subjects,s,l,u):e?a+=this._countInIndex(o.predicates,l,u,s):a+=this._countInIndex(o.objects,u,s,l));return a}forEach(t,e,r,n,i){this.some(e=>(t(e,this),!1),e,r,n,i)}every(t,e,r,n,i){return!this.some(e=>!t(e,this),e,r,n,i)}some(t,e,r,n,i){for(let a of this.readQuads(e,r,n,i))if(t(a))return!0;return!1}getSubjects(t,e,r){let n=[];return this.forSubjects(t=>{n.push(t)},t,e,r),n}forSubjects(t,e,r,n){let i,a,o;let s=this._getGraphs(n);if(t=this._uniqueEntities(t),(!e||(a=this._termToNumericId(e)))&&(!r||(o=this._termToNumericId(r))))for(n in s)(i=s[n])&&(a?o?this._loopBy2Keys(i.predicates,a,o,t):this._loopByKey1(i.subjects,a,t):o?this._loopByKey0(i.objects,o,t):this._loop(i.subjects,t))}getPredicates(t,e,r){let n=[];return this.forPredicates(t=>{n.push(t)},t,e,r),n}forPredicates(t,e,r,n){let i,a,o;let s=this._getGraphs(n);if(t=this._uniqueEntities(t),(!e||(a=this._termToNumericId(e)))&&(!r||(o=this._termToNumericId(r))))for(n in s)(i=s[n])&&(a?o?this._loopBy2Keys(i.objects,o,a,t):this._loopByKey0(i.subjects,a,t):o?this._loopByKey1(i.predicates,o,t):this._loop(i.predicates,t))}getObjects(t,e,r){let n=[];return this.forObjects(t=>{n.push(t)},t,e,r),n}forObjects(t,e,r,n){let i,a,o;let s=this._getGraphs(n);if(t=this._uniqueEntities(t),(!e||(a=this._termToNumericId(e)))&&(!r||(o=this._termToNumericId(r))))for(n in s)(i=s[n])&&(a?o?this._loopBy2Keys(i.subjects,a,o,t):this._loopByKey1(i.objects,a,t):o?this._loopByKey0(i.predicates,o,t):this._loop(i.objects,t))}getGraphs(t,e,r){let n=[];return this.forGraphs(t=>{n.push(t)},t,e,r),n}forGraphs(t,e,r,n){for(let i in this._graphs)this.some(e=>(t(e.graph),!0),e,r,n,this._termFromId(this._entities[i]))}createBlankNode(t){return this._entityIndex.createBlankNode(t)}extractLists({remove:t=!1,ignoreErrors:e=!1}={}){let r={},n=e?()=>!0:(t,e)=>{throw Error(`${t.value} ${e}`)},i=this.getQuads(null,_.rdf.rest,_.rdf.nil,null),a=t?[...i]:[];return i.forEach(e=>{let i,o;let s=[],l=!1,u=e.graph,h=e.subject;for(;h&&!l;){let t=this.getQuads(null,null,h,null),e=this.getQuads(h,null,null,null),r,d=null,c=null,f=null;for(let s=0;s<e.length&&!l;s++)(r=e[s]).graph.equals(u)?i?l=n(h,"has non-list arcs out"):r.predicate.value===_.rdf.first?d?l=n(h,"has multiple rdf:first arcs"):a.push(d=r):r.predicate.value===_.rdf.rest?c?l=n(h,"has multiple rdf:rest arcs"):a.push(c=r):t.length?l=n(h,"can't be subject and object"):(i=r,o="subject"):l=n(h,"not confined to single graph");for(let e=0;e<t.length&&!l;++e)r=t[e],i?l=n(h,"can't have coreferences"):r.predicate.value===_.rdf.rest?f?l=n(h,"has incoming rdf:rest arcs"):f=r:(i=r,o="object");d?s.unshift(d.object):l=n(h,"has no list head"),h=f&&f.subject}l?t=!1:i&&(r[i[o].value]=s)}),t&&this.removeQuads(a),r}addAll(t){if(t instanceof tS&&(t=t.filtered),Array.isArray(t))this.addQuads(t);else if(t instanceof tw&&t._entityIndex===this._entityIndex)0!==t._size&&(this._graphs=tx(this._graphs,t._graphs),this._size=null);else for(let e of t)this.add(e);return this}contains(t){let e,r,n,i,a;if(t instanceof tS&&(t=t.filtered),t===this)return!0;if(!(t instanceof tw)||this._entityIndex!==t._entityIndex)return t.every(t=>this.has(t));let o=this._graphs,s=t._graphs;for(let t in s){if(!(e=o[t]))return!1;for(let o in e=e.subjects,r=s[t].subjects){if(!(n=e[o]))return!1;for(let t in i=r[o]){if(!(a=n[t]))return!1;for(let e in i[t])if(!(e in a))return!1}}}return!0}deleteMatches(t,e,r,n){for(let i of this.match(t,e,r,n))this.removeQuad(i);return this}difference(t){if(t&&t instanceof tS&&(t=t.filtered),t===this)return new tw({entityIndex:this._entityIndex});if(t instanceof tw&&t._entityIndex===this._entityIndex){let e=new tw({entityIndex:this._entityIndex}),r=function t(e,r,n=4){let i=!1;for(let a in e)if(a in r){if(0!==n){let o=t(e[a],r[a],n-1);if(!1!==o)(i=i||Object.create(null))[a]=o;else if(3===n)return!1}}else(i=i||Object.create(null))[a]=0===n?null:tx({},e[a],n-1);return i}(this._graphs,t._graphs);return r&&(e._graphs=r,e._size=null),e}return this.filter(e=>!t.has(e))}equals(t){return t instanceof tS&&(t=t.filtered),t===this||this.size===t.size&&this.contains(t)}filter(t){let e=new tw({entityIndex:this._entityIndex});for(let r of this)t(r,this)&&e.add(r);return e}intersection(t){if(t instanceof tS&&(t=t.filtered),t===this){let t=new tw({entityIndex:this._entityIndex});return t._graphs=tx(Object.create(null),this._graphs),t._size=this._size,t}if(t instanceof tw&&this._entityIndex===t._entityIndex){let e=new tw({entityIndex:this._entityIndex}),r=function t(e,r,n=4){let i=!1;for(let a in e)if(a in r){let o=0===n?null:t(e[a],r[a],n-1);if(!1!==o)(i=i||Object.create(null))[a]=o;else if(3===n)return!1}return i}(t._graphs,this._graphs);return r&&(e._graphs=r,e._size=null),e}return this.filter(e=>t.has(e))}map(t){let e=new tw({entityIndex:this._entityIndex});for(let r of this)e.add(t(r,this));return e}reduce(t,e){let r=this.readQuads(),n=void 0===e?r.next().value:e;for(let e of r)n=t(n,e,this);return n}toArray(){return this.getQuads()}toCanonical(){throw Error("not implemented")}toStream(){return this.match()}toString(){return new tg().quadsToString(this)}union(t){let e=new tw({entityIndex:this._entityIndex});return e._graphs=tx(Object.create(null),this._graphs),e._size=this._size,e.addAll(t),e}*[Symbol.iterator](){yield*this.readQuads()}}function t_(t,e,r=0){let n=e[r];if(n&&!(n in t))return!1;let i=!1;for(let a in n?{[n]:t[n]}:t){let n=2===r?null:t_(t[a],e,r+1);!1!==n&&((i=i||Object.create(null))[a]=n)}return i}class tS extends tm.Readable{constructor(t,e,r,n,i,a){super({objectMode:!0}),Object.assign(this,{n3Store:t,subject:e,predicate:r,object:n,graph:i,options:a})}get filtered(){if(!this._filtered){let t,e,r;let{n3Store:n,graph:i,object:a,predicate:o,subject:s}=this,l=this._filtered=new tw({factory:n._factory,entityIndex:this.options.entityIndex});if(s&&!(t=l._termToNumericId(s))||o&&!(e=l._termToNumericId(o))||a&&!(r=l._termToNumericId(a)))return l;let u=n._getGraphs(i);for(let n in u){let i,a,o;!t&&e?(a=t_(u[n].predicates,[e,r,t]))&&(i=t_(u[n].subjects,[t,e,r]),o=t_(u[n].objects,[r,t,e])):r?(o=t_(u[n].objects,[r,t,e]))&&(i=t_(u[n].subjects,[t,e,r]),a=t_(u[n].predicates,[e,r,t])):(i=t_(u[n].subjects,[t,e,r]))&&(a=t_(u[n].predicates,[e,r,t]),o=t_(u[n].objects,[r,t,e])),i&&(l._graphs[n]={subjects:i,predicates:a,objects:o})}l._size=null}return this._filtered}get size(){return this.filtered.size}_read(t){t>0&&!this[tb]&&(this[tb]=this[Symbol.iterator]());let e=this[tb];for(;--t>=0;){let{done:t,value:r}=e.next();if(t){this.push(null);return}this.push(r)}}addAll(t){return this.filtered.addAll(t)}contains(t){return this.filtered.contains(t)}deleteMatches(t,e,r,n){return this.filtered.deleteMatches(t,e,r,n)}difference(t){return this.filtered.difference(t)}equals(t){return this.filtered.equals(t)}every(t,e,r,n,i){return this.filtered.every(t,e,r,n,i)}filter(t){return this.filtered.filter(t)}forEach(t,e,r,n,i){return this.filtered.forEach(t,e,r,n,i)}import(t){return this.filtered.import(t)}intersection(t){return this.filtered.intersection(t)}map(t){return this.filtered.map(t)}some(t,e,r,n,i){return this.filtered.some(t,e,r,n,i)}toCanonical(){return this.filtered.toCanonical()}toStream(){return this._filtered?this._filtered.toStream():this.n3Store.match(this.subject,this.predicate,this.object,this.graph)}union(t){return this._filtered?this._filtered.union(t):this.n3Store.match(this.subject,this.predicate,this.object,this.graph).addAll(t)}toArray(){return this._filtered?this._filtered.toArray():this.n3Store.getQuads(this.subject,this.predicate,this.object,this.graph)}reduce(t,e){return this.filtered.reduce(t,e)}toString(){return new tg().quadsToString(this)}add(t){return this.filtered.add(t)}delete(t){return this.filtered.delete(t)}has(t){return this.filtered.has(t)}match(t,e,r,n){return new tS(this.filtered,t,e,r,n,this.options)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}var tm=y("7K0Nk");class tk extends tm.Transform{constructor(t){let e,r;super({decodeStrings:!0}),this._readableState.objectMode=!0;let n=new X(t),i={onQuad:(t,e)=>{t&&this.emit("error",t)||e&&this.push(e)},onPrefix:(t,e)=>{this.emit("prefix",t,e)}};t&&t.comments&&(i.onComment=t=>{this.emit("comment",t)}),n.parse({on:(t,n)=>{switch(t){case"data":e=n;break;case"end":r=n}}},i),this._transform=(t,r,n)=>{e(t),n()},this._flush=t=>{r(),t()}}import(t){return t.on("data",t=>{this.write(t)}),t.on("end",()=>{this.end()}),t.on("error",t=>{this.emit("error",t)}),this}}var tm=y("7K0Nk");class tN{constructor(t,{bind:e=!1}={}){for(let r of(this._factories=t.slice(),this._factories))for(let t of("function"==typeof r.prototype.init&&r.prototype.init.call(this),r.exports||[]))e?this[t]=r.prototype[t].bind(this):this[t]=r.prototype[t]}clone(){let t=new tN(this._factories);for(let e of t._factories)"function"==typeof e.prototype.clone&&e.prototype.clone.call(t,this);return t}}var tm=y("7K0Nk");async function tO(t){let e=[];for await(let r of t)e.push(r);return e}var tT=function(t){let e=new Uint8Array(t.reduce((t,e)=>t+e.length,0)),r=0;for(let n of t)e.set(n,r),r+=n.length;return e},tM=y("eNRCS");async function tA(t,e){let r=new tM.StringDecoder(e),n="";for await(let e of t)n+=r.write(e);return n+r.end()}async function tC(t,e,r){let n="PUT"===e.method?"write":"read";if(!r.ok)throw Error(`can't ${n} data ${"read"===n?"from":"to"} <${t.toString()}>[${r.status}]: ${await r.text()}`)}const tR=new Map([["json","application/ld+json"],["n3","text/n3"],["nq","application/n-quads"],["nt","application/n-triples"],["rdf","application/rdf+xml"],["trig","application/trig"],["ttl","text/turtle"]]);var tI=function(t,e){let r=new Headers,n=t.toString().match(/\.([a-z]+)$/),i=tR.get(n&&n[1]);return i&&r.set("content-type",i),{method:"PUT",headers:r,body:e}};async function tP(t,e,{factory:r,...n}){let i=r.formats.parsers.get(t);if(!i)throw Error(`unknown media type: ${t}`);let a=r.dataset();for await(let t of i.import((0,tm.Readable).from([e]),n))a.add(t);return a}async function tD(t,{factory:e,mediaType:r,...n}){let i=await e.fetch(t,{...n,method:"GET"});return await tC(t,{},i),r&&i.headers.set("content-type",r),i.dataset()}async function tL(t,e,{factory:r,prefixes:n,...i}){let a=r.formats.serializers.get(t);if(!a)throw Error(`unknown media type: ${t}`);return tA(a.import((0,tm.Readable).from(e),{...i,prefixes:n}),"utf-8")}async function tj(t,e,{factory:r,prefixes:n,...i}){let a=tI(t,(0,tm.Readable).from(e)),o=await r.fetch(t,{...i,...a,prefixes:n});await tC(t,a,o)}const tF=new Set(["_write","_writableState","writable"]);var tB=function(t){return new Proxy(t,{has(t,e){return!tF.has(e)&&Reflect.has(...arguments)},get(t,e){if(tF.has(e))return;let r=Reflect.get(...arguments);return r&&"function"==typeof r.bind?r.bind(t):r},set(t,e,r){if(!tF.has(e))return Reflect.set(...arguments)}})},tm=y("7K0Nk");async function tz(t,e,{factory:r,prefixes:n,...i}){let a=r.formats.serializers.get(t);if(!a)throw Error(`unknown media type: ${t}`);return tA(a.import(e,{...i,prefixes:n}),"utf-8")}async function tV(t,e,{factory:r,prefixes:n,...i}){let a=tI(t,e),o=await r.fetch(t,{...i,...a,prefixes:n});await tC(t,a,o)}var tG=class{init(){this.io={dataset:{fromText:(t,e,r)=>tP(t,e,{...r,factory:this}),fromURL:(t,e)=>tD(t,{...e,factory:this}),toText:(t,e,r)=>tL(t,e,{...r,factory:this}),toURL:(t,e,r)=>tj(t,e,{...r,factory:this})},stream:{fromText:(t,e,r)=>(function(t,e,{factory:r,...n}){let i=r.formats.parsers.get(t);return i?i.import((0,tm.Readable).from([e]),n):new tm.Readable({read(){this.destroy(Error(`unknown media type: ${t}`))}})})(t,e,{...r,factory:this}),fromURL:(t,e)=>(function(t,{factory:e,mediaType:r,...n}){let i=new tm.PassThrough({objectMode:!0});return setTimeout(async()=>{try{let a=await e.fetch(t,{...n,method:"GET"});await tC(t,{},a),r&&a.headers.set("content-type",r),(await a.quadStream()).on("error",t=>i.destroy(t)).pipe(i)}catch(t){i.destroy(t)}},0),tB(i)})(t,{...e,factory:this}),toText:(t,e,r)=>tz(t,e,{...r,factory:this}),toURL:(t,e,r)=>tV(t,{...r,factory:this})}}}};class t${constructor(t){this.value=t}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value}}t$.prototype.termType="BlankNode";var tU=t$;class tH{equals(t){return!!t&&t.termType===this.termType}}tH.prototype.termType="DefaultGraph",tH.prototype.value="";var tW=tH,tq=function(t,e){if(!e)return null;if("BlankNode"===e.termType)return t.blankNode(e.value);if("DefaultGraph"===e.termType)return t.defaultGraph();if("Literal"===e.termType)return t.literal(e.value,e.language||t.namedNode(e.datatype.value));if("NamedNode"===e.termType)return t.namedNode(e.value);if("Quad"===e.termType){let r=t.fromTerm(e.subject),n=t.fromTerm(e.predicate),i=t.fromTerm(e.object),a=t.fromTerm(e.graph);return t.quad(r,n,i,a)}if("Variable"===e.termType)return t.variable(e.value);throw Error(`unknown termType ${e.termType}`)};class tY{constructor(t,e,r){this.value=t,this.language=e,this.datatype=r}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value&&t.language===this.language&&t.datatype.equals(this.datatype)}}tY.prototype.termType="Literal";var tK=tY;class tX{constructor(t){this.value=t}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value}}tX.prototype.termType="NamedNode";var tJ=tX;class tZ{constructor(t,e,r,n){this.subject=t,this.predicate=e,this.object=r,this.graph=n}equals(t){return!!t&&("Quad"===t.termType||!t.termType)&&t.subject.equals(this.subject)&&t.predicate.equals(this.predicate)&&t.object.equals(this.object)&&t.graph.equals(this.graph)}}tZ.prototype.termType="Quad",tZ.prototype.value="";var tQ=tZ;class t0{constructor(t){this.value=t}equals(t){return!!t&&t.termType===this.termType&&t.value===this.value}}t0.prototype.termType="Variable";var t1=t0;const t2=new tJ("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),t3=new tJ("http://www.w3.org/2001/XMLSchema#string");class t6{constructor(){this.init()}init(){this._data={blankNodeCounter:0,defaultGraph:new tW}}namedNode(t){return new tJ(t)}blankNode(t){return new tU(t=t||"b"+ ++this._data.blankNodeCounter)}literal(t,e){return"string"==typeof e?new tK(t,e,t2):new tK(t,"",e||t3)}variable(t){return new t1(t)}defaultGraph(){return this._data.defaultGraph}quad(t,e,r,n=this.defaultGraph()){return new tQ(t,e,r,n)}fromTerm(t){return tq(this,t)}fromQuad(t){return tq(this,t)}}t6.exports=["blankNode","defaultGraph","fromQuad","fromTerm","literal","namedNode","quad","variable"];const t5=new t6,t4={apply:(t,e,r)=>t(r[0]),get:(t,e)=>t(e)};var t8=function(t,{factory:e=t5}={}){let r=(r="")=>e.namedNode(`${t}${r.raw||r}`);return"undefined"==typeof Proxy?r:new Proxy(r,t4)};class t9{namespace(t){return t8(t,{factory:this})}}t9.exports=["namespace"];var tm=y("7K0Nk");class t7 extends Map{constructor(t=[],{factory:e}){super(t),this.factory=e}resolve(t){if(t.value.includes("://"))return null;let[e,r]=t.value.split(":",2);return void 0!==r&&this.has(e)?this.factory.namedNode(`${this.get(e).value}${r}`):null}shrink(t){if(!t)return null;let[e]=[...this].filter(([,e])=>t.value.startsWith(e.value)).sort((t,e)=>e[1].value.length-t[1].value.length);return void 0===e?null:this.factory.namedNode(`${e[0]}:${t.value.slice(e[1].value.length)}`)}import(t){return t.on("prefix",(t,e)=>{this.set(t,e)}),new Promise((e,r)=>{(0,tm.finished)(t,t=>{t?r(t):e(this)})})}export(t){for(let[e,r]of this)t.emit("prefix",e,r);return this}}class et{init(){this.prefixes=new t7([],{factory:this})}clone(t){if(t.prefixes)for(let[e,r]of t.prefixes)this.prefixes.set(e,r)}prefixMap(t){return new t7(t,{factory:this})}}et.exports=["prefixMap"];var ee=function({factor:t,score:e}){return({dataset:r,graph:n,terms:i=[]})=>e({dataset:r,graph:n,terms:i}).map(e=>(e.score*=t,e))},er=function(t){return"<"+t.value+">"};const en=/["\\\\\n\r]/,ei=/["\\\\\n\r]/g,ea={'"':'\\"',"\\":"\\\\","\n":"\\n","\r":"\\r"};function eo(t){return ea[t]}var es=function(t){var e;let r=(e=t.value,en.test(e)?e.replace(ei,eo):e);return"http://www.w3.org/2001/XMLSchema#string"===t.datatype.value?'"'+r+'"':"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"===t.datatype.value?'"'+r+'"@'+t.language:'"'+r+'"^^'+er(t.datatype)},el=function(t,e){let r=e(t.subject),n=e(t.predicate),i=e(t.object),a=e(t.graph);return`${r} ${n} ${i} ${a?a+" ":""}.`},eu=function t(e){if(!e)return null;if("BlankNode"===e.termType)return"_:"+e.value;if("DefaultGraph"===e.termType)return"";if("Literal"===e.termType)return es(e);if("NamedNode"===e.termType)return er(e);if("Quad"===e.termType||e.subject&&e.predicate&&e.object&&e.graph)return el(e,t);if("Variable"===e.termType)return"?"+e.value;if(e[Symbol.iterator]){var r;return r=t,[...e].map(t=>r(t)).join("\n")+"\n"}throw Error(`unknown termType ${e.termType}`)};class eh extends Set{constructor(t=[]){for(let e of(super(),this._index=new Map,t))this.add(e)}add(t){return this._index.set(eh.key(t),t),super.add(t)}delete(t){let e=this._index.get(eh.key(t));return super.delete(e)}has(t){return this._index.has(eh.key(t))}static key(t){return t.map(t=>t&&eu(t)||"undefined").join(" ")}}class ed extends Map{constructor(t=[]){for(let[e,r]of(super(),this._keys=new Map,t))this.set(e,r)}delete(t){let e=ed.key(t);return this._keys.delete(e),super.delete(e)}get(t){return super.get(ed.key(t))}has(t){return super.has(ed.key(t))}keys(){return new eh(this._keys.values())}set(t,e){let r=ed.key(t);return this._keys.set(r,t),super.set(r,e)}static key(t){return t.map(t=>t&&eu(t)||"undefined").join(" ")}}var ec=function(t){return({dataset:e,graph:r,terms:n=[]})=>{let i=new ed;for(let a=0;a<t.length;a++)for(let o of(0,t[a])({dataset:e,graph:r,terms:n})){let t=i.get([o.term,r]);t?t.score+=o.score:i.set([o.term,r],o)}return[...i.values()]}};function ef(t){let e=1/t.length;return ec(t.map(t=>ee({factor:e,score:t})))}ef.prioritized=function(t){let e=2/(t.length*(t.length+1));return ec(t.map((r,n)=>ee({factor:(t.length-n)*e,score:r})))};var ep=function(t){return({dataset:e,graph:r,terms:n=[]})=>t.flatMap(t=>t({dataset:e,graph:r,terms:n}))};class eg{constructor(t){if(this.index=new Map,t)for(let[e,r]of t)this.set(e,r)}get size(){return this.index.size}clear(){this.index.clear()}delete(t){return this.index.delete(eu(t))}*entries(){for(let[,{term:t,value:e}]of this.index)yield[t,e]}forEach(t,e){for(let r of this.entries())t.call(e,r[1],r[0],this)}get(t){let e=this.index.get(eu(t));return e&&e.value}has(t){return this.index.has(eu(t))}*keys(){for(let[,{term:t}]of this.index)yield t}set(t,e){let r=eu(t);return this.index.set(r,{term:t,value:e}),this}*values(){for(let[,{value:t}]of this.index)yield t}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}var ey=function({graph:t,object:e,predicate:r,subject:n=!0}={}){let i={subject:n,predicate:r,object:e,graph:t};return({dataset:t,graph:e,terms:r=[]})=>{let n=new eg,a=0,o=i=>{for(let o of r){let r=["subject"===i&&o,"predicate"===i&&o,"object"===i&&o,e||"graph"===i&&o];for(let e of t.match(...r)){let t=e[i],r=n.get(t)||{count:0};n.has(t)||n.set(t,r),r.count++,a++}}};for(let t of["subject","predicate","object","graph"])i[t]&&o(t);let s=[];for(let[r,i]of n)s.push({dataset:t,graph:e,term:r,score:i.count/a});return s}},ev=function(t){let e=new ed;for(let r of t){let t=e.get([r.term,r.graph]);t?t.score<r.score&&(e.delete([r.term,r.graph]),e.set([r.term,r.graph],r)):e.set([r.term,r.graph],r)}return[...e.values()]},em=function({graph:t,object:e,predicate:r,subject:n}){let i={subject:n,predicate:r,object:e,graph:t};return({dataset:t,graph:e,terms:r=[]})=>{for(let n of r){let r=[{dataset:t,graph:e,term:n,score:1}];if(i.subject&&i.subject.equals(n)&&t.match(n,null,null,e).size>0||i.predicate&&i.predicate.equals(n)&&t.match(null,n,null,e).size>0||i.object&&i.object.equals(n)&&t.match(null,null,n,e).size>0||i.graph&&i.graph.equals(n)&&(!e||i.graph.equals(e))&&t.match(null,null,null,e).size>0)return r}return[]}},eb=function(t){return({dataset:e,graph:r,terms:n=[]})=>{for(let i of t){let t=i({dataset:e,graph:r,terms:n});if(t.length>0)return t}return[]}},ex=function(t){return({dataset:e,graph:r,terms:n=[]})=>{for(let i of n)if(i.equals(t))return[{dataset:e,graph:r,term:i,score:1}];return[]}},eE=function(t){let e;let r=new Map;for(let[n,i]of Object.entries(t)){let a=1-n/t.length;"*"===i?e=a:r.set(i,a)}return({dataset:t,graph:n,terms:i=[]})=>{let a=[];for(let o of i){let i=r.get(o.language);void 0===i&&"string"==typeof o.language&&e&&(i=e),void 0!==i&&a.push({dataset:t,graph:n,term:o,score:i})}return a}};function ew(t){try{return eu(t)}catch(t){return null}}class e_{constructor(t){if(this.index=new Map,t)for(let e of t)this.add(e)}get size(){return this.index.size}add(t){let e=eu(t);return this.index.has(e)||this.index.set(e,t),this}clear(){this.index.clear()}delete(t){return!!t&&this.index.delete(ew(t))}entries(){return this.values().entries()}forEach(t,e){return this.values().forEach(t,e)}has(t){return!!t&&this.index.has(ew(t))}values(){return new Set(this.index.values())}keys(){return this.values()}[Symbol.iterator](){return this.index.values()}}var eS=function({alpha:t=.85,epsilon:e=1e-6}={}){return({dataset:r,graph:n,terms:i})=>{i=new e_(i);let a=new eg,o=1/i.size,s=1;for(let t of i){let e=r.match(null,null,t,n);a.set(t,{weight:o,outbound:e.size,subjects:[...e].map(t=>t.subject).filter(t=>i.has(t))})}for(;s>e;){let e=new eg,r=0;for(let[t,n]of a)e.set(t,n.weight),0===n.outbound&&(r+=n.weight),n.weight=0;for(let[n,i]of(r*=t,a)){for(let r of i.subjects)a.get(r).weight+=t*e.get(n)/i.outbound;i.weight+=(1-t)*o+r*o}for(let[t,r]of(s=0,a))s+=Math.abs(r.weight-e.get(t))}let l=[];for(let[t,e]of a)l.push({dataset:r,graph:n,term:t,score:e.weight});return l}},ek=function(){return({dataset:t,graph:e,terms:r=[]})=>{let n=[];for(let i of r){let r=Number.EPSILON;if("NamedNode"===i.termType){let t=new URL(i.value).pathname;t.endsWith("/")&&(t=t.slice(0,-1)),r=1/t.split("/").length}n.push({dataset:t,graph:e,term:i,score:r})}return n}},eN=function(t){return({dataset:e,graph:r,terms:n=[]})=>{let i=[],a=2/(t.length*(t.length+1));for(let o=0;o<t.length;o++)for(let s of ee({factor:(t.length-o)*a,score:t[o]})({dataset:e,graph:r,terms:n}))i.push(s);return i}},eO=function(t){return({dataset:e,graph:r,terms:n=[]})=>{if(0===t.length)return[];let i=new ed(t[0]({dataset:e,graph:r,terms:n}).map(t=>[[t.term,r],t]));for(let a=1;a<t.length;a++){let o=t[a],s=i.keys();for(let t of o({dataset:e,graph:r,terms:n})){let e=i.get([t.term,r]);e&&(e.score*=t.score),s.delete([t.term,r])}for(let t of s)i.delete(t)}return[...i.values()]}},eT=function(t){return t.slice().sort((t,e)=>{let r=e.score-t.score;return 0!==r?r:t.term.value.localeCompare(e.term.value)})},eM=function({dataset:t,objects:e,score:r,termCallback:n=t=>t.term}={}){let i=new eg(e.map(t=>[n(t),t]));return eT(ev(r({dataset:t,terms:e.map(t=>n(t))}))).map(({term:t})=>i.get(t))},eA=function(t){let e={rdf:{type:t5.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type")}};return({dataset:r,graph:n,terms:i=[]})=>{let a=[];for(let o of i)for(let i of r.match(o,e.rdf.type,t,n))a.push({dataset:r,graph:i.graph,term:o,score:1});return a}},eC=class{init(){this.score={combine:ef,concat:ep,count:ey,distinct:ev,exists:em,fallback:eb,fixed:ex,language:eE,pageRank:eS,pathDepth:ek,prioritized:eN,product:eO,scale:ee,sort:eT,sortObjects:eM,sum:ec,type:eA}}};class eR{termMap(t){return new eg(t)}}eR.exports=["termMap"];class eI{termSet(t){return new e_(t)}}eI.exports=["termSet"];class eP{constructor(){this.quadLevel=new Map}add(t,e){this.quadLevel.set(eu(t),e)}has(t,e){let r=this.quadLevel.get(eu(t));return void 0!==r&&r<=e}}function eD({backward:t,callback:e,dataset:r,filter:n,forward:i,term:a,visited:o=new eP}){let s=(a,l)=>{let u=a=>{for(let u of a){if(o.has(u,l))continue;o.add(u,l);let a={dataset:r,level:l,quad:u};n(a)&&(e(a),i&&s(u.object,l+1),t&&s(u.subject,l+1))}};i&&u(r.match(a)),t&&u(r.match(null,null,a))};s(a,0)}var eL=class{constructor(t,{backward:e=!1,factory:r,forward:n=!0}){this.backward=e,this.factory=r,this.filter=t,this.forward=n}forEach({term:t,dataset:e},r){eD({backward:this.backward,callback:r,dataset:e,filter:this.filter,forward:this.forward,term:t})}match({term:t,dataset:e}){let r=this.factory.dataset();return eD({backward:this.backward,callback:({quad:t})=>r.add(t),dataset:e,filter:this.filter,forward:this.forward,term:t}),r}reduce({term:t,dataset:e},r,n){let i=n;return eD({backward:this.backward,callback:t=>{i=r(t,i)},dataset:e,filter:this.filter,forward:this.forward,term:t}),i}};class ej{traverser(t,{backward:e=!1,forward:r=!0}={}){return new eL(t,{backward:e,factory:this,forward:r})}}ej.exports=["traverser"];var eF=class{constructor({dataset:t,end:e,quad:r,start:n}){this.dataset=t,this.end=e,this.quad=r,this.start=n}get term(){return this.quad[this.end]}get graph(){return this.quad.graph}get startTerm(){return this.quad[this.start]}};function eB(t,{factory:e}){return r=>"NamedNode"!==r.termType||/^[a-z]+:\/\//.test(r.value)?r:e.namedNode(new URL(r.value,t.value).toString())}const ez=/^[a-z][a-z0-9+.-]*:/;t8("http://www.w3.org/2001/XMLSchema#");const eV=t8("http://www.w3.org/1999/02/22-rdf-syntax-ns#");t8("http://www.w3.org/2000/01/rdf-schema#");class eG{static add({ptr:t,start:e,end:r,subjects:n=[null],predicates:i=[null],objects:a=[null],graphs:o,callback:s}={}){if(!t.factory)throw Error("add operation requires a factory");let l=()=>{};for(let u of(s&&(l=n=>{s(new eF({dataset:t.dataset,start:e,end:r,quad:n}))}),n))for(let r of i)for(let n of a)for(let i of o){let a={subject:u,predicate:r,object:n,graph:i};a[e]=t.term;let o=t.factory.quad(a.subject,a.predicate,a.object,a.graph);t.dataset.add(o),l(o)}return t}static addList({ptr:t,predicates:e,items:r,graphs:n}){if(t.isAny())throw Error("can't attach a list to an any ptr");for(let i of e)for(let e of n){let n=r.map(()=>t.factory.blankNode());t.dataset.add(t.factory.quad(t.term,i,n[0]||eV.nil,e));for(let i=0;i<n.length;i++)t.dataset.add(t.factory.quad(n[i],eV.first,r[i],e)),t.dataset.add(t.factory.quad(n[i],eV.rest,n[i+1]||eV.nil,e))}return t}static delete({ptr:t,start:e,subjects:r=[null],predicates:n=[null],objects:i=[null]}){for(let a of r)for(let r of n)for(let n of i){let i={subject:a,predicate:r,object:n};for(let r of(i[e]=t.term,t.dataset.match(i.subject,i.predicate,i.object)))t.dataset.delete(r)}return t}static deleteList({ptr:t,predicates:e}){let r=[];for(let n of e)for(let e of t.dataset.match(t.term,n)){let n=e.object;for(r.push(e);!eV.nil.equals(n);){n=r[r.length-1].object;let e=t.dataset.match(n);if(0===e.size)break;for(let t of e)r.push(t)}}for(let e of r)t.dataset.delete(e);return t}static execute({ptr:t,operation:e="traverse",quantifier:r,start:n,end:i,subjects:a,predicates:o,objects:s,graphs:l,items:u,callback:h}={}){if("add"===e)return eG.add({ptr:t,start:n,end:i,subjects:a,predicates:o,objects:s,graphs:l,callback:h});if("addList"===e)return eG.addList({ptr:t,predicates:o,items:u,graphs:l});if("delete"===e)return eG.delete({ptr:t,start:n,subjects:a,predicates:o,objects:s});if("deleteList"===e)return eG.deleteList({ptr:t,predicates:o});if("isList"===e)return eG.isList({ptr:t});if("list"===e)return eG.list({ptr:t});if("traverse"===e)return eG.traverse({ptr:t,quantifier:r,start:n,end:i,subjects:a,predicates:o,objects:s,graphs:l});throw Error(`unknown operation ${e}`)}static isList({ptr:t}){return!t.isAny()&&(!!eV.nil.equals(t.term)||1===eG.traverse({ptr:t,predicates:[eV.first]}).length)}static list({ptr:t}){if(t.isList())return{*[Symbol.iterator](){for(;t&&!t.term.equals(eV.nil);){let e=t.out([eV.first]);if(1!==e.length)throw Error(`Invalid list: rdf:first count not equals one on ${t.value}`);let r=t.out([eV.rest]);if(1!==r.length)throw Error(`Invalid list: rdf:rest count not equals one on ${t.value}`);yield e[0],t=r[0]}}}}static traverse({ptr:t,quantifier:e="one",start:r="subject",end:n="object",subjects:i=[null],predicates:a=[null],objects:o=[null],graphs:s=[null],callback:l}){if("one"===e)return eG.traverseOne({ptr:t,start:r,end:n,subjects:i,predicates:a,objects:o,graphs:s,callback:l});if("oneOrMore"===e){let e=eG.traverse({ptr:t,end:n,start:r,subjects:i,predicates:a,objects:o,graphs:s,callback:l});return eG.traverseMore({ptrs:e,end:n,start:r,subjects:i,predicates:a,objects:o,graphs:s,callback:l})}if("zeroOrMore"===e)return eG.traverseMore({ptrs:[t],end:n,start:r,subjects:i,predicates:a,objects:o,graphs:s,callback:l});if("zeroOrOne"===e)return[t,...eG.traverse({ptr:t,end:n,start:r,subjects:i,predicates:a,objects:o,graphs:s,callback:l})];throw Error(`unknown quantifier ${e}`)}static traverseMore({ptrs:t,end:e,start:r,subjects:n,predicates:i,objects:a,graphs:o,callback:s}={}){let l,u,h=[...t];do{for(let u of(l=[],t))l=[...l,...eG.traverseOne({ptr:u,end:e,start:r,subjects:n,predicates:i,objects:a,graphs:o,callback:s})];u&&(l=l.filter(t=>!u.has(t.term))),t=l,u=new e_((h=[...h,...l]).map(t=>t.term))}while(l.length>0)return h}static traverseOne({ptr:t,start:e,end:r,subjects:n,predicates:i,objects:a,graphs:o,callback:s=(t,e)=>e.extend(t)}={}){let l=[];for(let u of n)for(let n of i)for(let i of a)for(let a of o){let o={subject:u,predicate:n,object:i,graph:a};for(let n of(o[e]=t.term,t.dataset.match(o.subject,o.predicate,o.object,o.graph)))l.push(s(new eF({dataset:t.dataset,end:r,quad:n,start:e}),t))}return l}}function e$(t,e){return e?r=>e(t.extend(r)):()=>{}}var eU=class{constructor({dataset:t,edges:e=[],factory:r,graph:n,term:i}){if(!t&&0===e.length)throw Error("dataset or edges is required");if(0===e.length&&void 0===i||e.length>0&&i)throw Error("edges or term must be given");this.dataset=t||e[e.length-1].dataset,this.edges=e,this.factory=r,this._graph=n,0===e.length&&(this._term=i)}get edge(){return this.edges[this.edges.length-1]}get graph(){return"object"==typeof this._graph?this._graph:this.edge&&this.edge.graph}get length(){return void 0!==this._term?1:this.edges.length+1}get startTerm(){return this._term||this.edges[0].startTerm}get term(){return void 0!==this._term?this._term:this.edge.term}get value(){let t=this.term;return null===t?void 0:t.value}addIn(t,e,r){return eG.add({ptr:this,start:"object",end:"subject",subjects:e,predicates:t,graphs:[this.graph||this.factory.defaultGraph()],callback:e$(this,r)})}addList(t,e){return eG.addList({ptr:this,predicates:t,graphs:[this.graph||this.factory.defaultGraph()],items:e})}addOut(t,e,r){return eG.add({ptr:this,start:"subject",end:"object",predicates:t,objects:e,graphs:[this.graph||this.factory.defaultGraph()],callback:e$(this,r)})}deleteIn(t,e){return eG.delete({ptr:this,start:"object",subjects:e,predicates:t})}deleteList(t){return eG.deleteList({ptr:this,predicates:t})}deleteOut(t,e){return eG.delete({ptr:this,start:"subject",predicates:t,objects:e})}execute({operation:t,quantifier:e,start:r,end:n,subjects:i,predicates:a,objects:o,graphs:s,items:l,callback:u}){return eG.execute({ptr:this,operation:t,quantifier:e,start:r,end:n,subjects:i,predicates:a,objects:o,graphs:s,items:l,callback:u})}extend(t){return new this.constructor({dataset:this.dataset,edges:[...this.edges,t],factory:this.factory,graph:this._graph})}hasIn(t,e){return eG.traverse({ptr:this,start:"object",end:"object",subjects:e,predicates:t,graphs:[this.graph]})}hasOut(t,e){return eG.traverse({ptr:this,start:"subject",end:"subject",predicates:t,objects:e,graphs:[this.graph]})}in(t,e){return eG.traverse({ptr:this,start:"object",end:"subject",subjects:e,predicates:t,graphs:[this.graph]})}isAny(){return!this.term}isList(){return eG.isList({ptr:this})}list(){return eG.list({ptr:this})}*nodes(){for(let t=0;t<this.length;t++)void 0!==this._term?yield{dataset:this.dataset,term:this._term}:this.edges.length>t?yield{dataset:this.edges[t].dataset,term:this.edges[t].startTerm}:this.edges.length===t&&(yield{dataset:this.edges[t-1].dataset,term:this.edges[t-1].term})}out(t,e){return eG.traverse({ptr:this,predicates:t,objects:e,graphs:[this.graph]})}*quads(){for(let{quad:t}of this.edges)yield t}trim(){return new this.constructor({dataset:this.dataset,factory:this.factory,graph:this.graph,term:this.term})}},eH=function(t,{factory:e}){if(null===t)return null;if(void 0===t)return;if("string"==typeof t)return e.literal(t);if("URL"===t.constructor.name)return e.namedNode(t.toString());if(t.termType)return t;let r=t.term;if(void 0!==r)return r;throw Error(`can't convert ${t.toString()} to a Term object`)},eW=function(t,{dataset:e,factory:r,graph:n}){return null===t?null:void 0!==t?t instanceof eU?t:new eU("object"==typeof t.term&&"object"==typeof t.dataset?{dataset:t.dataset,graph:t.graph,term:t.term,factory:t.factory||r}:{dataset:e,graph:n,term:eH(t,{factory:r}),factory:r}):void 0},eq=function(t,{factory:e}){try{t=[eH(t,{factory:e})]}catch(t){}return t[Symbol.iterator]&&(t=[...t]),t=t.map(t=>eH(t,{factory:e}))},eY=function(t,{dataset:e,factory:r,graph:n}){try{t=[eW(t,{dataset:e,factory:r,graph:n})]}catch(t){}return t[Symbol.iterator]&&(t=[...t]),t.flatMap(t=>eq(n,{factory:r}).flatMap(n=>eW(t,{dataset:e,factory:r,graph:n})))},eK=function(t,e){return t?t.equals(e):t===e};function eX(t,e){return e?r=>e(new t.constructor({factory:t.factory,ptrs:[r]})):()=>{}}class eJ{constructor({dataset:t,factory:e,ptrs:r,terms:n,graphs:i}){if(this.factory=e,r)this.ptrs=[...r];else for(let r of(this.ptrs=[],n||[null]))for(let n of i||[null])this.ptrs.push(new eU({dataset:t,factory:e,graph:n,term:r}))}get dataset(){let t=new Set(this.datasets);return 1!==t.size?null:t[Symbol.iterator]().next().value}get datasets(){return this.ptrs.map(t=>t.dataset)}get term(){let t=new e_(this.terms);if(1===t.size)return t[Symbol.iterator]().next().value}get terms(){return this.ptrs.map(t=>t.term)}get value(){let t=this.term;return null==t?void 0:t.value}get values(){return this.ptrs.map(t=>t.value)}addIn(t,e,r){let n=eX(this,r);for(let r of this.ptrs)r.addIn(t,e,n);return this}addList(t,e){if(this.isAny())throw Error("can't attach a list to an any ptr");for(let r of this.ptrs)r.addList(t,e);return this}addOut(t,e,r){let n=eX(this,r);for(let r of this.ptrs)r.addOut(t,e,n);return this}clone(t){return new this.constructor({factory:this.factory,ptrs:this.ptrs,...t})}deleteIn(t,e){for(let r of this.ptrs)r.deleteIn(t,e);return this}deleteList(t){for(let e of this.ptrs)e.deleteList(t);return this}deleteOut(t,e){for(let r of this.ptrs)r.deleteOut(t,e);return this}distinct(){let t=this.ptrs.reduce((t,e)=>(t.some(t=>!!(t.dataset===e.dataset&&eK(t.graph,e.graph)&&eK(t.term,e.term)))||t.push(e.trim()),t),[]);return this.clone({ptrs:t})}execute(t){return this.clone({ptrs:this.ptrs.flatMap(e=>e.execute(t))})}executeAll(t){let e=this;for(let r of t)e=e.execute(r);return e}filter(t){return this.clone({ptrs:[...this].filter(t).map(t=>t.ptrs[0])})}hasIn(t,e){return this.clone({ptrs:this.ptrs.flatMap(r=>r.hasIn(t,e))})}hasOut(t,e){return this.clone({ptrs:this.ptrs.flatMap(r=>r.hasOut(t,e))})}in(t,e){return this.clone({ptrs:this.ptrs.flatMap(r=>r.in(t,e))})}isAny(){return this.ptrs.length>0&&this.ptrs.some(t=>t.isAny())}isList(){return 1===this.ptrs.length&&this.ptrs[0].isList()}list(){if(!this.isList())return;let t=this.ptrs[0].list(),e=this;return function*(){for(let r of t)yield e.clone({ptrs:[r]})}()}map(t){return[...this].map(t)}node(t){let e=this.dataset,r=[...t].map(t=>new eU({dataset:e,factory:this.factory,term:t}));return this.clone({ptrs:r})}out(t,e){return this.clone({ptrs:this.ptrs.flatMap(r=>r.out(t,e))})}*quads(){for(let{edges:t}of this.ptrs)for(let{quad:e}of t)yield e}trim(){return this.clone({ptrs:this.ptrs.map(t=>t.trim())})}*[Symbol.iterator](){for(let t of this.ptrs)yield this.clone({ptrs:[t]})}}var eZ=eJ,eQ=class extends eZ{constructor({dataset:t,factory:e,ptrs:r,term:n,terms:i,graph:a,graphs:o}){(n||i)&&(i=i||n),(a||o)&&(o=o||a),!r&&i&&(r=eY(i,{dataset:t,factory:e,graph:o})),super({dataset:t,factory:e,ptrs:r,graphs:o})}_toTerm(t){return eH(t,{factory:this.factory})}_toTermArray(t){return eq(t,{factory:this.factory})}addIn(t,e,r){return"function"==typeof e&&(r=e,e=null),e||(e=[this.factory.blankNode()]),super.addIn(this._toTermArray(t),this._toTermArray(e),r)}addList(t,e){return super.addList(this._toTermArray(t),this._toTermArray(e))}addOut(t,e,r){return"function"==typeof e&&(r=e,e=null),e||(e=[this.factory.blankNode()]),super.addOut(this._toTermArray(t),this._toTermArray(e),r)}base(t){if(!t)throw Error("base parameter is required");for(let e of(t=this._toTerm(t),this.ptrs))(function(t,{factory:e}){let r=function(t,{factory:e}){let r=eB(t,{factory:e});return t=>{let n=r(t.subject),i=r(t.predicate),a=r(t.object);return n===t.subject&&i===t.predicate&&a===t.object?t:e.quad(n,i,a,t.graph)}}(t,{factory:e});return t=>{for(let e of[...t]){let n=r(e);n!==e&&(t.delete(e),t.add(n))}}})(t,{factory:this.factory})(e.dataset);return this.node(eB(t,{factory:this.factory})(this.term))}best(t){return this.score(t,{limit:1})}deleteIn(t,e){return super.deleteIn(this._toTermArray(t),this._toTermArray(e))}deleteList(t){return super.deleteList(this._toTermArray(t))}deleteOut(t,e){return super.deleteOut(this._toTermArray(t),this._toTermArray(e))}hasIn(t,e){return super.hasIn(this._toTermArray(t),this._toTermArray(e))}hasOut(t,e){return super.hasOut(this._toTermArray(t),this._toTermArray(e))}in(t,e){return super.in(this._toTermArray(t),this._toTermArray(e))}out(t,e){return super.out(this._toTermArray(t),this._toTermArray(e))}node(t=null){return super.node(this._toTermArray(t))}rebase(t){if(!t)throw Error("base parameter is required");for(let e of(t=this._toTerm(t),this.ptrs))(function(t,e,{factory:r}){let n=function(t,e,{factory:r}){let n=function(t,e,{factory:r}){return n=>"NamedNode"===n.termType&&n.value.startsWith(t.value)&&ez.test(n.value)===ez.test(t.value)?r.namedNode(e.value+n.value.slice(t.value.length)):n}(t,e,{factory:r});return t=>{let e=n(t.subject),i=n(t.predicate),a=n(t.object);return e===t.subject&&i===t.predicate&&a===t.object?t:r.quad(e,i,a,t.graph)}}(t,e,{factory:r});return t=>{for(let e of[...t]){let r=n(e);r!==e&&(t.delete(e),t.add(r))}}})(e.term,t,{factory:this.factory})(e.dataset);return this.node(t)}replace(t){if(!t)throw Error("replacement parameter is required");for(let e of(t=this._toTerm(t),this.ptrs))(function(t,e,{factory:r}){let n=function(t,e,{factory:r}){let n=function(t,e){return r=>r.equals(t)?e:r}(t,e);return t=>{let e=n(t.subject),i=n(t.predicate),a=n(t.object);return e===t.subject&&i===t.predicate&&a===t.object?t:r.quad(e,i,a,t.graph)}}(t,e,{factory:r});return e=>{for(let r of[...e.match(t),...e.match(null,t),...e.match(null,null,t)]){let t=n(r);t!==r&&(e.delete(r),e.add(t))}}})(e.term,t,{factory:this.factory})(e.dataset);return this.node(t)}score(t,{limit:e=1/0,offset:r=0}={}){let n=t(this).slice().sort((t,e)=>{let r=e.score-t.score;return 0!==r?r:t.term.value.localeCompare(e.term.value)}).slice(r,r+e).map(t=>new eU({...t,factory:this.factory}));return this.clone({ptrs:n})}};class e0{grapoi({...t}={}){return t.dataset||"function"!=typeof this.dataset||(t.dataset=this.dataset()),new eQ({...t,factory:this})}}e0.exports=["grapoi"];var e1=class extends tU{toCanonical(){return eu(this)}toString(){return this.toCanonical()}},e2=class extends tW{toCanonical(){return eu(this)}toString(){return this.toCanonical()}},e3=class extends tK{toCanonical(){return eu(this)}toString(){return this.value}},e6=class extends tJ{toCanonical(){return eu(this)}toString(){return this.value}toURL(){return new URL(this.value)}},e5=class extends tQ{toCanonical(){return eu(this)}toString(){return this.toCanonical()}},e4=class extends t1{toCanonical(){return eu(this)}toString(){return this.toCanonical()}};const e8=new e6("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),e9=new e6("http://www.w3.org/2001/XMLSchema#string");class e7{init(){this._data={blankNodeCounter:0,defaultGraph:new e2}}namedNode(t){return"string"!=typeof t&&(t=t.toString()),new e6(t)}blankNode(t){return new e1(t=t||"b"+ ++this._data.blankNodeCounter)}literal(t,e){return"string"==typeof e?new e3(t,e,e8):new e3(t,"",e||e9)}variable(t){return new e4(t)}defaultGraph(){return this._data.defaultGraph}quad(t,e,r,n=this.defaultGraph()){return new e5(t,e,r,n)}fromTerm(t){return tq(this,t)}fromQuad(t){return tq(this,t)}}function rt(t){return"string"==typeof t||t instanceof String}function re(t){let e,r,n,i;if("string"==typeof t)return t;if(!t)return"";if(void 0!==t.id&&"Quad"!==t.termType)return t.id;switch(t.termType){case"NamedNode":return t.value;case"BlankNode":return`_:${t.value}`;case"Variable":return`?${t.value}`;case"DefaultGraph":return"";case"Literal":if(t.language)return`"${t.value}"@${t.language}`;return`"${t.value}"${t.datatype&&"http://www.w3.org/2001/XMLSchema#string"!==t.datatype.value?`^^${t.datatype.value}`:""}`;case"Quad":return e=rn(re(t.subject)),r=rn(re(t.predicate)),n=rn(re(t.object)),i="DefaultGraph"===t.graph.termType?"":` ${re(t.graph)}`,`<<${e} ${r} ${n}${i}>>`;default:throw Error(`Unexpected termType: ${t.termType}`)}}e7.exports=["namedNode","blankNode","literal","variable","defaultGraph","quad","fromTerm","fromQuad"];const rr=/^"(.*".*)(?="[^"]*$)/;function rn(t){return t.replace(rr,(t,e)=>`"${e.replace(/"/g,'""')}`)}class ri{constructor(t){if(this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._quads=new Map,t)for(let e of t)this.add(e)}get size(){let t,e,r=this._size;if(null!==r)return r;r=0;let n=this._graphs;for(let i in n)for(let a in t=n[i].subjects)for(let n in e=t[a])r+=Object.keys(e[n]).length;return this._size=r,this._size}add(t){let e=re(t.subject),r=re(t.predicate),n=re(t.object),i=re(t.graph),a=this._graphs[i];a||Object.freeze(a=this._graphs[i]={subjects:{},predicates:{},objects:{}});let o=this._ids,s=this._entities;return e=o[e]||(o[s[++this._id]=e]=this._id),r=o[r]||(o[s[++this._id]=r]=this._id),n=o[n]||(o[s[++this._id]=n]=this._id),this._addToIndex(a.subjects,e,r,n),this._addToIndex(a.predicates,r,n,e),this._addToIndex(a.objects,n,e,r),this._setQuad(e,r,n,i,t),this._size=null,this}delete(t){let e,r,n,i=re(t.subject),a=re(t.predicate),o=re(t.object),s=re(t.graph),l=this._ids,u=this._graphs;if(!(i=l[i])||!(a=l[a])||!(o=l[o])||!(e=u[s])||!(r=e.subjects[i])||!(n=r[a])||!(o in n))return this;for(i in this._removeFromIndex(e.subjects,i,a,o),this._removeFromIndex(e.predicates,a,o,i),this._removeFromIndex(e.objects,o,i,a),null!==this._size&&this._size--,this._deleteQuad(i,a,o,s),e.subjects)return this;return delete u[s],this}has(t){let e,r,n;let i=re(t.subject),a=re(t.predicate),o=re(t.object),s=re(t.graph),l=this._graphs[s];if(!l)return!1;let u=this._ids;return!(rt(i)&&!(e=u[i])||rt(a)&&!(r=u[a])||rt(o)&&!(n=u[o]))&&1===this._countInIndex(l.objects,n,e,r)}match(t,e,r,n){return this._createDataset(this._match(t,e,r,n))}[Symbol.iterator](){return this._match()[Symbol.iterator]()}_addToIndex(t,e,r,n){let i=t[e]||(t[e]={}),a=i[r]||(i[r]={}),o=n in a;return o||(a[n]=null),!o}_removeFromIndex(t,e,r,n){let i=t[e],a=i[r];for(let t in delete a[n],a)return;for(let t in delete i[r],i)return;delete t[e]}_findInIndex(t,e,r,n,i,a,o,s,l,u){let h,d,c;for(let f in e&&((h=t,t={})[e]=h[e]),t)if(d=t[f]){for(let t in r&&((h=d,d={})[r]=h[r]),d)if(c=d[t]){let e=n?n in c?[n]:[]:Object.keys(c);for(let r=0;r<e.length;r++){let n={[i]:f,[a]:t,[o]:e[r]},h=this._getQuad(n.subject,n.predicate,n.object,s);if(u)u.push(h);else if(l(h))return!0}}}return u}_countInIndex(t,e,r,n){let i,a,o,s=0;for(let l in e&&((i=t,t={})[e]=i[e]),t)if(a=t[l])for(let t in r&&((i=a,a={})[r]=i[r]),a)(o=a[t])&&(n?n in o&&s++:s+=Object.keys(o).length);return s}_getGraphs(t){return rt(t)?{[t]:this._graphs[t]}:this._graphs}_match(t,e,r,n){let i,a,o,s;t=t&&re(t),e=e&&re(e),r=r&&re(r),n=n&&re(n);let l=[],u=this._getGraphs(n),h=this._ids;if(rt(t)&&!(a=h[t])||rt(e)&&!(o=h[e])||rt(r)&&!(s=h[r]))return l;for(let t in u)(i=u[t])&&(a?s?this._findInIndex(i.objects,s,a,o,"object","subject","predicate",t,null,l):this._findInIndex(i.subjects,a,o,null,"subject","predicate","object",t,null,l):o?this._findInIndex(i.predicates,o,s,null,"predicate","object","subject",t,null,l):s?this._findInIndex(i.objects,s,null,null,"object","subject","predicate",t,null,l):this._findInIndex(i.subjects,null,null,null,"subject","predicate","object",t,null,l));return l}_getQuad(t,e,r,n){return this._quads.get(this._toId(t,e,r,n))}_setQuad(t,e,r,n,i){this._quads.set(this._toId(t,e,r,n),i)}_deleteQuad(t,e,r,n){this._quads.delete(this._toId(t,e,r,n))}_createDataset(t){return new this.constructor(t)}_toId(t,e,r,n){return`${t}:${e}:${r}:${n}`}}var ra=ri,ro={},rs={};rs=class t{constructor(t,e=new Map,r=0){this.prefix=t,this._existing=e,this.counter=r}clone(){let{prefix:e,_existing:r,counter:n}=this;return new t(e,new Map(r),n)}getId(t){let e=t&&this._existing.get(t);if(e)return e;let r=this.prefix+this.counter;return this.counter++,t&&this._existing.set(t,r),r}hasId(t){return this._existing.has(t)}getOldIds(){return[...this._existing.keys()]}};var rl={};y("jGbML"),yC=globalThis.crypto;const ru=[];for(let t=0;t<=255;++t)ru.push(t.toString(16).padStart(2,"0"));yR=function(t){let e="",r=new Uint8Array(t);for(let t=0;t<r.length;++t)e+=ru[r[t]];return e};const rh=new Map([["sha256","SHA-256"],["SHA256","SHA-256"],["SHA-256","SHA-256"],["sha384","SHA-384"],["SHA384","SHA-384"],["SHA-384","SHA-384"],["sha512","SHA-512"],["SHA512","SHA-512"],["SHA-512","SHA-512"]]);rl=class{constructor(t){if(!(yC&&yC.subtle))throw Error("crypto.subtle not found.");if(!rh.has(t))throw Error(`Unsupported algorithm "${t}".`);this.algorithm=rh.get(t),this._content=""}update(t){this._content+=t}async digest(){let t=new TextEncoder().encode(this._content);return yR(await yC.subtle.digest(this.algorithm,t))}};var rd={};rd=class{constructor(t){this.current=t.sort(),this.done=!1,this.dir=new Map;for(let e=0;e<t.length;++e)this.dir.set(t[e],!0)}hasNext(){return!this.done}next(){let{current:t,dir:e}=this,r=t.slice(),n=null,i=0,a=t.length;for(let r=0;r<a;++r){let o=t[r],s=e.get(o);(null===n||o>n)&&(s&&r>0&&o>t[r-1]||!s&&r<a-1&&o>t[r+1])&&(n=o,i=r)}if(null===n)this.done=!0;else{let r=e.get(n)?i-1:i+1;for(let a of(t[i]=t[r],t[r]=n,t))a>n&&e.set(a,!e.get(a))}return r}};var rc={};const rf="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",rp="http://www.w3.org/2001/XMLSchema#string",rg="NamedNode",ry="BlankNode",rv="Literal",rm={};(()=>{let t="A-Za-z-----------_",e=t+"0-9---",r='(?:<((?:[^\0- <>"{}|^`\\\\]|\\\\u[0-9A-Fa-f]{4}|\\\\U[0-9A-Fa-f]{8})*)>)',n="_:((?:["+t+"0-9])(?:(?:["+e+".])*(?:["+e+"]))?)",i="[ \\t]+",a="[ \\t]*";rm.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,rm.empty=RegExp("^"+a+"$"),rm.quad=RegExp("^"+a+("(?:"+r+"|")+n+")"+i+(r+i)+("(?:"+r+"|"+n+'|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^'+r)+")|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))"+a+("(?:\\.|(?:(?:"+r+"|"+n)+")"+a+"\\.))"+a+"$")})(),rc=class t{static parse(t){let e=[],r={},n=t.split(rm.eoln),i=0;for(let t of n){var a;if(i++,rm.empty.test(t))continue;let n=t.match(rm.quad);if(null===n)throw Error("N-Quads parse error on line "+i+".");let o={subject:null,predicate:null,object:null,graph:null};if(void 0!==n[1]?o.subject={termType:rg,value:rN(n[1])}:o.subject={termType:ry,value:n[2]},o.predicate={termType:rg,value:rN(n[3])},void 0!==n[4]?o.object={termType:rg,value:rN(n[4])}:void 0!==n[5]?o.object={termType:ry,value:n[5]}:(o.object={termType:rv,value:void 0,datatype:{termType:rg}},void 0!==n[7]?o.object.datatype.value=rN(n[7]):void 0!==n[8]?(o.object.datatype.value=rf,o.object.language=n[8]):o.object.datatype.value=rp,o.object.value=(a=n[6],rE.test(a)?a.replace(rE,function(t,e,r,n){if(e)switch(e){case"b":return"\b";case"t":return"	";case"n":return"\n";case"f":return"\f";case"r":return"\r";case'"':return'"';case"'":return"'";case"\\":return"\\"}return r?String.fromCharCode(parseInt(r,16)):n?String.fromCodePoint(parseInt(n,16)):void 0}):a)),void 0!==n[9]?o.graph={termType:rg,value:rN(n[9])}:void 0!==n[10]?o.graph={termType:ry,value:n[10]}:o.graph={termType:"DefaultGraph",value:""},o.graph.value in r){let t=!0,n=r[o.graph.value];for(let e of n)if(e.subject.termType===o.subject.termType&&e.object.termType===o.object.termType&&e.subject.value===o.subject.value&&e.predicate.value===o.predicate.value&&e.object.value===o.object.value&&(e.object.termType!==rv||e.object.datatype.termType===o.object.datatype.termType&&e.object.language===o.object.language&&e.object.datatype.value===o.object.datatype.value)){t=!1;break}t&&(n.push(o),e.push(o))}else r[o.graph.value]=[o],e.push(o)}return e}static serialize(e){let r=[];for(let n of e)r.push(t.serializeQuad(n));return r.sort().join("")}static serializeQuadComponents(t,e,r,n){var i;let a="";return t.termType===rg?a+=`<${rS(t.value)}>`:a+=`_:${t.value}`,e.termType===rg?a+=` <${rS(e.value)}> `:a+=` _:${e.value} `,r.termType===rg?a+=`<${rS(r.value)}>`:r.termType===ry?a+=`_:${r.value}`:(a+=`"${i=r.value,rb.test(i)?i.replace(rb,function(t){return rx[t.codePointAt(0)]}):i}"`,r.datatype.value===rf?r.language&&(a+=`@${r.language}`):r.datatype.value!==rp&&(a+=`^^<${rS(r.datatype.value)}>`)),n.termType===rg?a+=` <${rS(n.value)}>`:n.termType===ry&&(a+=` _:${n.value}`),a+=" .\n"}static serializeQuad(e){return t.serializeQuadComponents(e.subject,e.predicate,e.object,e.graph)}};const rb=/[\u0000-\u001F\u007F"\\]/g,rx=[];for(let t=0;t<=127;++t)rb.test(String.fromCharCode(t))&&(rx[t]="\\u"+t.toString(16).toUpperCase().padStart(4,"0"),rb.lastIndex=0);rx["\b".codePointAt(0)]="\\b",rx["	".codePointAt(0)]="\\t",rx["\n".codePointAt(0)]="\\n",rx["\f".codePointAt(0)]="\\f",rx["\r".codePointAt(0)]="\\r",rx['"'.codePointAt(0)]='\\"',rx["\\".codePointAt(0)]="\\\\";const rE=/(?:\\([btnfr"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g,rw=/[\u0000-\u0020<>"{}|^`\\]/g,r_=[];for(let t=0;t<=127;++t)rw.test(String.fromCharCode(t))&&(r_[t]="\\u"+t.toString(16).toUpperCase().padStart(4,"0"),rw.lastIndex=0);function rS(t){return rw.test(t)?t.replace(rw,function(t){return r_[t.codePointAt(0)]}):t}const rk=/(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g;function rN(t){return rk.test(t)?t.replace(rk,function(t,e,r){return e?String.fromCharCode(parseInt(e,16)):r?String.fromCodePoint(parseInt(r,16)):void 0}):t}function rO(t,e){return t.hash<e.hash?-1:t.hash>e.hash?1:0}function rT(t){return"BlankNode"===t.termType?{termType:"BlankNode",value:`_:${t.value}`}:t}ro=class{constructor({createMessageDigest:t=null,messageDigestAlgorithm:e="sha256",canonicalIdMap:r=new Map,maxWorkFactor:n=1,maxDeepIterations:i=-1,timeout:a=0}={}){this.name="RDFC-1.0",this.blankNodeInfo=new Map,this.canonicalIssuer=new rs("c14n",r),this.createMessageDigest=t||(()=>new rl(e)),this.maxWorkFactor=n,this.maxDeepIterations=i,this.remainingDeepIterations=0,this.timeout=a,a>0&&(this.startTime=Date.now()),this.quads=null}main(t){for(let e of(this.quads=t,t))this._addBlankNodeQuadInfo({quad:e,component:e.subject}),this._addBlankNodeQuadInfo({quad:e,component:e.object}),this._addBlankNodeQuadInfo({quad:e,component:e.graph});let e=new Map;for(let t of[...this.blankNodeInfo.keys()])this._hashAndTrackBlankNode({id:t,hashToBlankNodes:e});let r=[...e.keys()].sort(),n=[];for(let t of r){let r=e.get(t);if(r.length>1){n.push(r);continue}let i=r[0];this.canonicalIssuer.getId(i)}if(this.maxDeepIterations<0){if(0===this.maxWorkFactor)this.maxDeepIterations=0;else if(this.maxWorkFactor===1/0)this.maxDeepIterations=1/0;else{let t=n.reduce((t,e)=>t+e.length,0);this.maxDeepIterations=t**this.maxWorkFactor}}for(let t of(this.maxDeepIterations>Number.MAX_SAFE_INTEGER&&(this.maxDeepIterations=1/0),this.remainingDeepIterations=this.maxDeepIterations,n)){let e=[];for(let r of t){if(this.canonicalIssuer.hasId(r))continue;let t=new rs("b");t.getId(r);let n=this.hashNDegreeQuads(r,t);e.push(n)}for(let t of(e.sort(rO),e))for(let e of t.issuer.getOldIds())this.canonicalIssuer.getId(e)}let i=[];for(let t of this.quads){let e=rc.serializeQuadComponents(this._componentWithCanonicalId(t.subject),t.predicate,this._componentWithCanonicalId(t.object),this._componentWithCanonicalId(t.graph));i.push(e)}return i.sort(),i.join("")}hashFirstDegreeQuads(t){let e=[],r=this.blankNodeInfo.get(t);for(let n of r.quads)e.push(rc.serializeQuadComponents(this.modifyFirstDegreeComponent(t,n.subject,"subject"),n.predicate,this.modifyFirstDegreeComponent(t,n.object,"object"),this.modifyFirstDegreeComponent(t,n.graph,"graph")));e.sort();let n=this.createMessageDigest();for(let t of e)n.update(t);return r.hash=n.digest(),r.hash}hashRelatedBlankNode(t,e,r,n){let i;let a=this.createMessageDigest();return a.update(n),"g"!==n&&a.update(this.getRelatedPredicate(e)),i=this.canonicalIssuer.hasId(t)?"_:"+this.canonicalIssuer.getId(t):r.hasId(t)?"_:"+r.getId(t):this.blankNodeInfo.get(t).hash,a.update(i),a.digest()}hashNDegreeQuads(t,e){if(0===this.remainingDeepIterations)throw Error(`Maximum deep iterations exceeded (${this.maxDeepIterations}).`);this.remainingDeepIterations--;let r=this.createMessageDigest(),n=this.createHashToRelated(t,e);for(let t of[...n.keys()].sort()){let i;r.update(t);let a="",o=new rd(n.get(t)),s=0;for(;o.hasNext();){let t=o.next();if(++s%3==0&&this.timeout>0&&Date.now()-this.startTime>this.timeout)throw Error("Canonize timeout.");let r=e.clone(),n="",l=[],u=!1;for(let e of t)if(this.canonicalIssuer.hasId(e)?n+="_:"+this.canonicalIssuer.getId(e):(r.hasId(e)||l.push(e),n+="_:"+r.getId(e)),0!==a.length&&n>a){u=!0;break}if(!u){for(let t of l){let e=this.hashNDegreeQuads(t,r);if(n+="_:"+r.getId(t)+`<${e.hash}>`,r=e.issuer,0!==a.length&&n>a){u=!0;break}}!u&&(0===a.length||n<a)&&(a=n,i=r)}}r.update(a),e=i}return{hash:r.digest(),issuer:e}}modifyFirstDegreeComponent(t,e){return"BlankNode"!==e.termType?e:{termType:"BlankNode",value:e.value===t?"a":"z"}}getRelatedPredicate(t){return`<${t.predicate.value}>`}createHashToRelated(t,e){let r=new Map;for(let n of this.blankNodeInfo.get(t).quads)this._addRelatedBlankNodeHash({quad:n,component:n.subject,position:"s",id:t,issuer:e,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:n,component:n.object,position:"o",id:t,issuer:e,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:n,component:n.graph,position:"g",id:t,issuer:e,hashToRelated:r});return r}_hashAndTrackBlankNode({id:t,hashToBlankNodes:e}){let r=this.hashFirstDegreeQuads(t),n=e.get(r);n?n.push(t):e.set(r,[t])}_addBlankNodeQuadInfo({quad:t,component:e}){if("BlankNode"!==e.termType)return;let r=e.value,n=this.blankNodeInfo.get(r);n?n.quads.add(t):this.blankNodeInfo.set(r,{quads:new Set([t]),hash:null})}_addRelatedBlankNodeHash({quad:t,component:e,position:r,id:n,issuer:i,hashToRelated:a}){if(!("BlankNode"===e.termType&&e.value!==n))return;let o=e.value,s=this.hashRelatedBlankNode(o,t,i,r),l=a.get(s);l?l.push(o):a.set(s,[o])}_componentWithCanonicalId(t){return"BlankNode"!==t.termType||t.value.startsWith(this.canonicalIssuer.prefix)?t:{termType:"BlankNode",value:this.canonicalIssuer.getId(t.value)}}};var tm=y("7K0Nk");function rM(t,e){return new t.constructor(e)}var rA=class extends ra{addAll(t){for(let e of t)this.add(e);return this}clone(){return rM(this,this)}deleteMatches(t,e,r,n){for(let i of this.match(t,e,r,n))this.delete(i);return this}difference(t){return this.filter(e=>!t.has(e))}equals(t){return this.toCanonical()===t.toCanonical()}every(t){return Array.from(this).every(e=>t(e,this))}filter(t){return rM(this,Array.from(this).filter(e=>t(e,this)))}forEach(t){Array.from(this).forEach(e=>t(e,this))}import(t){return t.on("data",t=>this.add(t)),new Promise((e,r)=>{(0,tm.finished)(t,t=>{t?r(t):e(this)})})}intersection(t){return this.filter(e=>t.has(e))}map(t){return rM(this,Array.from(this).map(e=>t(e,this)))}merge(t){return this.clone().addAll(t)}reduce(t,e){return Array.from(this).reduce((e,r,n)=>t(e,r,n,this),e)}some(t){return Array.from(this).some(e=>t(e,this))}toCanonical(){return new/*@__PURE__*/(f(ro))({maxDeepIterations:500}).main([...this].map(t=>({subject:rT(t.subject),predicate:rT(t.predicate),object:rT(t.object),graph:rT(t.graph)})))}toStream(){return(0,tm.Readable).from(this)}toString(){return eu(this)}};class rC{dataset(t,e){let r=new rA;if(t){if(e)for(let n of t)r.add(this.quad(n.subject,n.predicate,n.object,e));else r.addAll(t)}return r}}async function rR(t={}){if(!t.body||!t.body.readable)return t;let e=await tO(t.body);return e.length>0?1===e[0].BYTES_PER_ELEMENT?t.body=tT(e):t.body=e.join(""):t.body="",t}rC.exports=["dataset"];var tm=y("7K0Nk"),rI={},rP={},rD=y("2MGGR");rP=function(t,e){var r;if("function"!=typeof e)throw TypeError("Expected a function");return t=rD(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=void 0),r}},rI=function(t){return rP(2,t)};var tm=y("7K0Nk");class rL{constructor(t,e){for(let[r,n]of(this.obj=t,Object.entries(e)))this[r]=n;for(let e of rL.properties(t))e in this||("function"==typeof this.obj[e]?this[e]=(...r)=>this.obj[e].call(t,r):Object.defineProperty(this,e,{get:()=>this.obj[e],set:t=>{this.obj[e]=t},enumerable:!0,configurable:!0}))}static properties(t){return Object.getOwnPropertyNames(Object.getPrototypeOf(t))}}var tm=y("7K0Nk"),rj=function(t){var e,r;if(t.bodyUsed){let e=new tm.Readable({read:()=>e.destroy(Error("body already in use"))});return t.body=e,t}return t.body&&t.body.readable?t:t.body&&"function"==typeof t.body.getReader?new rL(t,{body:(e=t.body.getReader(),new tm.Readable({read:async function(){try{let t,r;do(t=await e.read()).done?this.push(null):r=!this.push(t.value);while(!t.done&&!r)}catch(t){this.destroy(t)}}}))}):(t.body=(r=()=>t.arrayBuffer(),new tm.Readable({read:/*@__PURE__*/f(rI)(async function(){try{this.push(new Uint8Array(await r())),this.push(null)}catch(t){this.destroy(t)}})})),t)};const rF=window.Headers;function rB(t,e){return rR(e).then(e=>fetch(t,e).then(t=>rj(t)))}var tm=y("7K0Nk"),rz=function(t,e){if(t.headers=new rF(t.headers),t.headers.has("accept")||t.headers.set("accept",[...e.parsers.keys()].join(", ")),!t.body||"string"==typeof t.body)return t;let r=t.headers.get("content-type");if(r&&!e.serializers.has(r))throw Error(`no serializer found for media type: ${t.headers.get("content-type")}`);return r||(r=e.serializers.keys().next().value,t.headers.set("content-type",r)),!function(t,{checkOpen:e=!0}={}){return function(t,{checkOpen:e=!0}={}){return null!==t&&"object"==typeof t&&(t.writable||t.readable||!e||void 0===t.writable&&void 0===t.readable)&&"function"==typeof t.pipe}(t,{checkOpen:e})&&(t.readable||!e)&&"function"==typeof t.read&&"boolean"==typeof t.readable&&"boolean"==typeof t.readableObjectMode&&"function"==typeof t.destroy&&"boolean"==typeof t.destroyed}(t.body)&&t.body[Symbol.iterator]&&(t.body=(0,tm.Readable).from(t.body)),t.body=e.serializers.import(r,t.body,{prefixes:t.prefixes}),t};async function rV(t,e){for await(let r of e)t.add(r);return t}var rG=function(t,e){t.dataset=async()=>{let r=await t.quadStream();return rV(e.dataset(),r)}};const r$=/<(.*)>/;var rU=function(t,e){if("application/json"!==e||!t.headers.has("link"))return null;let r=t.headers.get("link").split(",").map(t=>t.trim()).find(t=>t.includes('rel="http://www.w3.org/ns/json-ld#context"'));if(!r)return null;let n=(r$.exec(r)||[]).slice(-1)[0];return n?new URL(n,t.url).toString():null},rH=function(t,e,r){t.quadStream=async()=>{let n;if(!t.headers.get("content-type"))throw Error("Content-Type header missing: couldn't determine parser");let i=t.headers.get("content-type").split(";")[0],a=rU(t,i);return(a&&(i="application/ld+json"),r.has(i))?(a&&(n=await e(a).then(t=>t.json())),r.import(i,t.body,{baseIRI:t.url,context:n})):Promise.reject(Error(`unknown content type: ${i}`))}},rW=function(t,e,r,n){let i=[...t.headers.keys()].some(t=>t.startsWith("content-")),a="chunked"===t.headers.get("transfer-encoding");return(i||a)&&(rH(t,r,n),e&&rG(t,e)),t};async function rq(t,e={}){let r=e.factory,n=e.fetch||rB,i=e.formats;if(!i)throw Error("no formats given");return e=rz(e,i),rW(await n(t,e),r,n,i.parsers)}var rY=class{init(){this._fetch={fetch:null},this.fetch=function(t){let e=function(e,r={}){let n="function"==typeof t.dataset?t:null;return rq(e,{fetch:t._fetch.fetch,formats:t.formats,...r,factory:n})};return e.config=function(e,r){t._fetch[e]=r},e.Headers=rF,e}(this)}clone(t){for(let[e,r]of Object.entries(t._fetch))this._fetch[e]=r}},rK=class extends rY{init(){super.init(),this.fetch.config("fetch",rB)}},rX=class{constructor(t,e){this.Impl=t,this.options=e}import(t,e){let r=new this.Impl(t,{...this.options,...e});return t.on("end",()=>{r.readable||r.emit("end")}),t.on("error",t=>{r.emit("error",t)}),r}},rJ={},rZ=rJ&&rJ.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),rQ=rJ&&rJ.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||rZ(e,t,r)};Object.defineProperty(rJ,"__esModule",{value:!0}),rQ(y("3llXF"),rJ);var tm=y("7K0Nk");const r0="null:";var r1=class{constructor(t,{baseIRI:e=r0,context:r=null,documentLoader:n,factory:i=t5}={}){let a=new rJ.JsonLdParser({baseIRI:e,context:r,dataFactory:i,documentLoader:n,streamingProfile:!1});t.pipe(a);let o=function(t){let e=e=>"NamedNode"===e.termType&&e.value.startsWith(r0)?t.namedNode(e.value.slice(r0.length)):null;return r=>{let n=e(r.subject),i=e(r.predicate),a=e(r.object),o=e(r.graph);return n||i||a||o?t.quad(n||r.subject,i||r.predicate,a||r.object,o||r.graph):r}}(i),s=new tm.Transform({objectMode:!0,transform:(t,e,r)=>{r(null,o(t))}});return a.on("context",t=>{Object.entries(t).forEach(([t,e])=>{s.emit("prefix",t,i.namedNode(e))})}),a.on("error",t=>s.destroy(t)),a.pipe(s),tB(s)}},r2=class extends rX{constructor(t){super(r1,t)}},r3=class{constructor(t,{baseIRI:e="",factory:r=t5,...n}={}){let i=new tk({baseIRI:e,factory:{blankNode:r.blankNode.bind(r),defaultGraph:r.defaultGraph.bind(r),literal:r.literal.bind(r),namedNode:r.namedNode.bind(r),quad:r.quad.bind(r)},...n});return t.pipe(i),tB(i)}},r6=class extends rX{constructor(t){super(r3,t)}},tm=y("7K0Nk"),r5=class{constructor(t){let e=new tm.Transform({objectMode:!0,transform:(t,e,r)=>{r(null,`${eu(t)}
`)}});return t.pipe(e),tB(e)}},r4=class extends rX{constructor(){super(r5)}},tm=y("7K0Nk");t8("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),t8("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),t8("http://www.w3.org/2001/XMLSchema#");class r8 extends Map{import(t,e,r){let n=this.get(t);return n?n.import(e,r):null}}var tm=y("7K0Nk"),r9=class{constructor(t){this.stream=t,this.array=[]}push(t){this.array.push(t)}end(){this.stream.push(this.array),this.stream.push(null)}},r7=class{constructor(t){this.stream=t,this.first=!0,this.stream.push("[")}push(t){this.first?this.first=!1:this.stream.push(","),this.stream.push(JSON.stringify(t))}end(){this.stream.push("]"),this.stream.push(null)}};class nt extends tm.Readable{constructor(t,{encoding:e="object"}={}){if(super({objectMode:!0,read:()=>{}}),"object"===e&&(this.encoder=new r9(this)),"string"===e&&(this.encoder=new r7(this)),!this.encoder)throw Error(`unknown encoding: ${e}`);t.on("data",t=>{let e={},r=e;"DefaultGraph"!==t.graph.termType&&(e["@id"]=t.graph.value,e["@graph"]={},r=e["@graph"]),r["@id"]=nt.subjectValue(t.subject),"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===t.predicate.value?r["@type"]=nt.subjectValue(t.object):r[t.predicate.value]=nt.objectValue(t.object),this.encoder.push(e)}),t.on("end",()=>this.encoder.end()),t.on("error",t=>this.emit("error",t))}static subjectValue(t){return"BlankNode"===t.termType?"_:"+t.value:t.value}static objectValue(t){return"NamedNode"===t.termType?{"@id":t.value}:"BlankNode"===t.termType?{"@id":"_:"+t.value}:t.language?{"@language":t.language,"@value":t.value}:t.datatype&&"http://www.w3.org/2001/XMLSchema#string"!==t.datatype.value?{"@type":t.datatype.value,"@value":t.value}:t.value}}var ne=class extends rX{constructor(t){super(nt,t)}},nr=class extends ne{constructor({...t}={}){super({...t,encoding:"string"})}},nn=y("h0LIu"),ni={},na={},no=y("85rA0"),ns=no.parseLinkHeader,nl=no.buildHeaders,nu={};const nh="http://www.w3.org/1999/02/22-rdf-syntax-ns#",nd="http://www.w3.org/2001/XMLSchema#";var nc=(nu={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:nh,RDF_LIST:nh+"List",RDF_FIRST:nh+"first",RDF_REST:nh+"rest",RDF_NIL:nh+"nil",RDF_TYPE:nh+"type",RDF_PLAIN_LITERAL:nh+"PlainLiteral",RDF_XML_LITERAL:nh+"XMLLiteral",RDF_JSON_LITERAL:nh+"JSON",RDF_OBJECT:nh+"object",RDF_LANGSTRING:nh+"langString",XSD:nd,XSD_BOOLEAN:nd+"boolean",XSD_DOUBLE:nd+"double",XSD_INTEGER:nd+"integer",XSD_STRING:nd+"string"}).LINK_HEADER_CONTEXT,nf=y("3Yszg"),np=y("jUcZG"),ng=y("c0VXR"),ny=ng.prependBase;const nv=/(^|(\r\n))link:/i;na=({secure:t,headers:e={},xhr:r}={headers:{}})=>{return e=nl(e),new np().wrapLoader(n);async function n(i){let a,o;if(0!==i.indexOf("http:")&&0!==i.indexOf("https:"))throw new nf('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:i});if(t&&0!==i.indexOf("https"))throw new nf('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:i});try{a=await function(t,e,r){let n=new(t=t||XMLHttpRequest);return new Promise((t,i)=>{for(let a in n.onload=()=>t(n),n.onerror=t=>i(t),n.open("GET",e,!0),r)n.setRequestHeader(a,r[a]);n.send()})}(r,i,e)}catch(t){throw new nf("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:i,cause:t})}if(a.status>=400)throw new nf("URL could not be dereferenced: "+a.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:i,httpStatusCode:a.status});let s={contextUrl:null,documentUrl:i,document:a.response},l=null,u=a.getResponseHeader("Content-Type");if(nv.test(a.getAllResponseHeaders())&&(o=a.getResponseHeader("Link")),o&&"application/ld+json"!==u){let t=ns(o),e=t[nc];if(Array.isArray(e))throw new nf("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:i});e&&(s.contextUrl=e.target),(l=t.alternate)&&"application/ld+json"==l.type&&!(u||"").match(/^application\/(\w*\+)?json$/)&&(s=await n(ny(i,l.target)))}return s}};const nm={};ni=nm,nm.setupDocumentLoaders=function(t){"undefined"!=typeof XMLHttpRequest&&(t.documentLoaders.xhr=na,t.useDocumentLoader("xhr"))},nm.setupGlobals=function(t){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:t.JsonLdProcessor})};var no=y("85rA0"),nb={},nx=y("guzPY"),nE=nx.isArray,nw=nx.isObject,n_=nx.isString,no=y("85rA0"),nS=no.asArray,ng=y("c0VXR"),nk=ng.prependBase,nf=y("3Yszg"),nN={},nO={},nT={};function nM(t){var e=this;if(e instanceof nM||(e=new nM),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach(function(t){e.push(t)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)e.push(arguments[r]);return e}function nA(t,e,r,n){if(!(this instanceof nA))return new nA(t,e,r,n);this.list=n,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}nT=nM,nM.Node=nA,nM.create=nM,nM.prototype.removeNode=function(t){if(t.list!==this)throw Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e},nM.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},nM.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},nM.prototype.push=function(){for(var t,e=0,r=arguments.length;e<r;e++)t=arguments[e],this.tail=new nA(t,this.tail,null,this),this.head||(this.head=this.tail),this.length++;return this.length},nM.prototype.unshift=function(){for(var t,e=0,r=arguments.length;e<r;e++)t=arguments[e],this.head=new nA(t,null,this.head,this),this.tail||(this.tail=this.head),this.length++;return this.length},nM.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},nM.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},nM.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,n=0;null!==r;n++)t.call(e,r.value,n,this),r=r.next},nM.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,n=this.length-1;null!==r;n--)t.call(e,r.value,n,this),r=r.prev},nM.prototype.get=function(t){for(var e=0,r=this.head;null!==r&&e<t;e++)r=r.next;if(e===t&&null!==r)return r.value},nM.prototype.getReverse=function(t){for(var e=0,r=this.tail;null!==r&&e<t;e++)r=r.prev;if(e===t&&null!==r)return r.value},nM.prototype.map=function(t,e){e=e||this;for(var r=new nM,n=this.head;null!==n;)r.push(t.call(e,n.value,this)),n=n.next;return r},nM.prototype.mapReverse=function(t,e){e=e||this;for(var r=new nM,n=this.tail;null!==n;)r.push(t.call(e,n.value,this)),n=n.prev;return r},nM.prototype.reduce=function(t,e){var r,n=this.head;if(arguments.length>1)r=e;else if(this.head)n=this.head.next,r=this.head.value;else throw TypeError("Reduce of empty list with no initial value");for(var i=0;null!==n;i++)r=t(r,n.value,i),n=n.next;return r},nM.prototype.reduceReverse=function(t,e){var r,n=this.tail;if(arguments.length>1)r=e;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;null!==n;i--)r=t(r,n.value,i),n=n.prev;return r},nM.prototype.toArray=function(){for(var t=Array(this.length),e=0,r=this.head;null!==r;e++)t[e]=r.value,r=r.next;return t},nM.prototype.toArrayReverse=function(){for(var t=Array(this.length),e=0,r=this.tail;null!==r;e++)t[e]=r.value,r=r.prev;return t},nM.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var r=new nM;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=0,i=this.head;null!==i&&n<t;n++)i=i.next;for(;null!==i&&n<e;n++,i=i.next)r.push(i.value);return r},nM.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var r=new nM;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=this.length,i=this.tail;null!==i&&n>e;n--)i=i.prev;for(;null!==i&&n>t;n--,i=i.prev)r.push(i.value);return r},nM.prototype.splice=function(t,e,...r){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var n=0,i=this.head;null!==i&&n<t;n++)i=i.next;for(var a=[],n=0;i&&n<e;n++)a.push(i.value),i=this.removeNode(i);null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<r.length;n++)i=function(t,e,r){var n=e===t.head?new nA(r,null,e,t):new nA(r,e,e.next,t);return null===n.next&&(t.tail=n),null===n.prev&&(t.head=n),t.length++,n}(this,i,r[n]);return a},nM.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=e,this.tail=t,this};try{y("fcGo5")(nM)}catch(t){}const nC=Symbol("max"),nR=Symbol("length"),nI=Symbol("lengthCalculator"),nP=Symbol("allowStale"),nD=Symbol("maxAge"),nL=Symbol("dispose"),nj=Symbol("noDisposeOnSet"),nF=Symbol("lruList"),nB=Symbol("cache"),nz=Symbol("updateAgeOnGet"),nV=()=>1,nG=(t,e,r)=>{let n=t[nB].get(e);if(n){let e=n.value;if(n$(t,e)){if(nH(t,n),!t[nP])return}else r&&(t[nz]&&(n.value.now=Date.now()),t[nF].unshiftNode(n));return e.value}},n$=(t,e)=>{if(!e||!e.maxAge&&!t[nD])return!1;let r=Date.now()-e.now;return e.maxAge?r>e.maxAge:t[nD]&&r>t[nD]},nU=t=>{if(t[nR]>t[nC])for(let e=t[nF].tail;t[nR]>t[nC]&&null!==e;){let r=e.prev;nH(t,e),e=r}},nH=(t,e)=>{if(e){let r=e.value;t[nL]&&t[nL](r.key,r.value),t[nR]-=r.length,t[nB].delete(r.key),t[nF].removeNode(e)}};class nW{constructor(t,e,r,n,i){this.key=t,this.value=e,this.length=r,this.now=n,this.maxAge=i||0}}const nq=(t,e,r,n)=>{let i=r.value;n$(t,i)&&(nH(t,r),t[nP]||(i=void 0)),i&&e.call(n,i.value,i.key,t)};nO=class{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw TypeError("max must be a non-negative number");this[nC]=t.max||1/0;let e=t.length||nV;if(this[nI]="function"!=typeof e?nV:e,this[nP]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw TypeError("maxAge must be a number");this[nD]=t.maxAge||0,this[nL]=t.dispose,this[nj]=t.noDisposeOnSet||!1,this[nz]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw TypeError("max must be a non-negative number");this[nC]=t||1/0,nU(this)}get max(){return this[nC]}set allowStale(t){this[nP]=!!t}get allowStale(){return this[nP]}set maxAge(t){if("number"!=typeof t)throw TypeError("maxAge must be a non-negative number");this[nD]=t,nU(this)}get maxAge(){return this[nD]}set lengthCalculator(t){"function"!=typeof t&&(t=nV),t!==this[nI]&&(this[nI]=t,this[nR]=0,this[nF].forEach(t=>{t.length=this[nI](t.value,t.key),this[nR]+=t.length})),nU(this)}get lengthCalculator(){return this[nI]}get length(){return this[nR]}get itemCount(){return this[nF].length}rforEach(t,e){e=e||this;for(let r=this[nF].tail;null!==r;){let n=r.prev;nq(this,t,r,e),r=n}}forEach(t,e){e=e||this;for(let r=this[nF].head;null!==r;){let n=r.next;nq(this,t,r,e),r=n}}keys(){return this[nF].toArray().map(t=>t.key)}values(){return this[nF].toArray().map(t=>t.value)}reset(){this[nL]&&this[nF]&&this[nF].length&&this[nF].forEach(t=>this[nL](t.key,t.value)),this[nB]=new Map,this[nF]=new nT,this[nR]=0}dump(){return this[nF].map(t=>!n$(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[nF]}set(t,e,r){if((r=r||this[nD])&&"number"!=typeof r)throw TypeError("maxAge must be a number");let n=r?Date.now():0,i=this[nI](e,t);if(this[nB].has(t)){if(i>this[nC])return nH(this,this[nB].get(t)),!1;let a=this[nB].get(t).value;return this[nL]&&!this[nj]&&this[nL](t,a.value),a.now=n,a.maxAge=r,a.value=e,this[nR]+=i-a.length,a.length=i,this.get(t),nU(this),!0}let a=new nW(t,e,i,n,r);return a.length>this[nC]?(this[nL]&&this[nL](t,e),!1):(this[nR]+=a.length,this[nF].unshift(a),this[nB].set(t,this[nF].head),nU(this),!0)}has(t){return!!this[nB].has(t)&&!n$(this,this[nB].get(t).value)}get(t){return nG(this,t,!0)}peek(t){return nG(this,t,!1)}pop(){let t=this[nF].tail;return t?(nH(this,t),t.value):null}del(t){nH(this,this[nB].get(t))}load(t){this.reset();let e=Date.now();for(let r=t.length-1;r>=0;r--){let n=t[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{let t=i-e;t>0&&this.set(n.k,n.v,t)}}}prune(){this[nB].forEach((t,e)=>nG(this,e,!1))}},nN=class{constructor({document:t}){this.document=t,this.cache=new nO({max:10})}getProcessed(t){return this.cache.get(t)}setProcessed(t,e){this.cache.set(t,e)}},nb=class{constructor({sharedCache:t}){this.perOpCache=new Map,this.sharedCache=t}async resolve({activeCtx:t,context:e,documentLoader:r,base:n,cycles:i=new Set}){e&&nw(e)&&e["@context"]&&(e=e["@context"]);let a=[];for(let o of e=nS(e)){if(n_(o)){let e=this._get(o);e||(e=await this._resolveRemoteContext({activeCtx:t,url:o,documentLoader:r,base:n,cycles:i})),nE(e)?a.push(...e):a.push(e);continue}if(null===o){a.push(new nN({document:null}));continue}nw(o)||function(t){throw new nf("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:t})}(e);let s=JSON.stringify(o),l=this._get(s);l||(l=new nN({document:o}),this._cacheResolvedContext({key:s,resolved:l,tag:"static"})),a.push(l)}return a}_get(t){let e=this.perOpCache.get(t);if(!e){let r=this.sharedCache.get(t);r&&(e=r.get("static"))&&this.perOpCache.set(t,e)}return e}_cacheResolvedContext({key:t,resolved:e,tag:r}){if(this.perOpCache.set(t,e),void 0!==r){let n=this.sharedCache.get(t);n||(n=new Map,this.sharedCache.set(t,n)),n.set(r,e)}return e}async _resolveRemoteContext({activeCtx:t,url:e,documentLoader:r,base:n,cycles:i}){e=nk(n,e);let{context:a,remoteDoc:o}=await this._fetchContext({activeCtx:t,url:e,documentLoader:r,cycles:i});!function t({context:e,base:r}){if(!e)return;let n=e["@context"];if(n_(n)){e["@context"]=nk(r,n);return}if(nE(n)){for(let e=0;e<n.length;++e){let i=n[e];if(n_(i)){n[e]=nk(r,i);continue}nw(i)&&t({context:{"@context":i},base:r})}return}if(nw(n))for(let e in n)t({context:n[e],base:r})}({context:a,base:n=o.documentUrl||e});let s=await this.resolve({activeCtx:t,context:a,documentLoader:r,base:n,cycles:i});return this._cacheResolvedContext({key:e,resolved:s,tag:o.tag}),s}async _fetchContext({activeCtx:t,url:e,documentLoader:r,cycles:n}){let i,a;if(n.size>10)throw new nf("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===t.processingMode?"loading remote context failed":"context overflow",max:10});if(n.has(e))throw new nf("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===t.processingMode?"recursive context inclusion":"context overflow",url:e});n.add(e);try{i=(a=await r(e)).document||null,n_(i)&&(i=JSON.parse(i))}catch(t){throw new nf("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:e,cause:t})}if(!nw(i))throw new nf("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:e});return i="@context"in i?{"@context":i["@context"]}:{"@context":{}},a.contextUrl&&(nE(i["@context"])||(i["@context"]=[i["@context"]]),i["@context"].push(a.contextUrl)),{context:i,remoteDoc:a}}};const nY=no.IdentifierIssuer;var nf=y("3Yszg"),nK={};nK=y("h0LIu").NQuads;var nX={},nf=y("3Yszg"),nx=y("guzPY"),nJ=nx.isArray,nZ=nx.isObject,nQ=nx.isEmptyObject,n0=nx.isString,n1=nx.isUndefined,n2=y("dEapz"),n3=n2.isList,n6=n2.isValue,n5=n2.isGraph,n4=n2.isSubject,n8=y("frGHZ"),n9=n8.expandIri,n7=n8.getContextValue,it=n8.isKeyword,ie=n8.process,ir=n8.processingMode,ng=y("c0VXR"),ii=ng.isAbsolute,no=y("85rA0"),ia=no.REGEX_BCP47,io=no.REGEX_KEYWORD,is=no.addValue,il=no.asArray,iu=no.getValues,ih=no.validateTypeValue,id=y("8qp2g"),ic=id.handleEvent;const ip={};function ig({value:t,count:e,options:r}){if(0===e||"@value"in t||"@list"in t||1===e&&"@id"in t){if(r.eventHandler){let n,i;0===e?(n="empty object",i="Dropping empty object."):"@value"in t?(n="object with only @value",i="Dropping object with only @value."):"@list"in t?(n="object with only @list",i="Dropping object with only @list."):1===e&&"@id"in t&&(n="object with only @id",i="Dropping object with only @id."),ic({event:{type:["JsonLdEvent"],code:n,level:"warning",message:i,details:{value:t}},options:r})}return null}return t}async function iy({activeCtx:t,activeProperty:e,expandedActiveProperty:r,element:n,expandedParent:i,options:a={},insideList:o,typeKey:s,typeScopedContext:l}){let u;let h=Object.keys(n).sort(),d=[],c=n[s]&&"@json"===n9(t,nJ(n[s])?n[s][0]:n[s],{vocab:!0},{...a,typeExpansion:!0});for(let o of h){let s,h=n[o];if("@context"===o)continue;let f=n9(t,o,{vocab:!0},a);if(null===f||!(ii(f)||it(f))){a.eventHandler&&ic({event:{type:["JsonLdEvent"],code:"invalid property",level:"warning",message:"Dropping property that did not expand into an absolute IRI or keyword.",details:{property:o,expandedProperty:f}},options:a});continue}if(it(f)){if("@reverse"===r)throw new nf("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:h});if(f in i&&"@included"!==f&&"@type"!==f)throw new nf("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:f})}if("@id"===f){if(!n0(h)){if(!a.isFrame)throw new nf('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:h});if(nZ(h)){if(!nQ(h))throw new nf('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:h})}else if(nJ(h)){if(!h.every(t=>n0(t)))throw new nf('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:h})}else throw new nf('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:h})}is(i,"@id",il(h).map(e=>{if(n0(e)){let r=n9(t,e,{base:!0},a);return a.eventHandler&&(null===r?null===e?ic({event:{type:["JsonLdEvent"],code:"null @id value",level:"warning",message:"Null @id found.",details:{id:e}},options:a}):ic({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:e}},options:a}):ii(r)||ic({event:{type:["JsonLdEvent"],code:"relative @id reference",level:"warning",message:"Relative @id reference found.",details:{id:e,expandedId:r}},options:a})),r}return e}),{propertyIsArray:a.isFrame});continue}if("@type"===f){nZ(h)&&(h=Object.fromEntries(Object.entries(h).map(([t,e])=>[n9(l,t,{vocab:!0}),il(e).map(t=>n9(l,t,{base:!0,vocab:!0},{...a,typeExpansion:!0}))]))),ih(h,a.isFrame),is(i,"@type",il(h).map(t=>{if(n0(t)){let e=n9(l,t,{base:!0,vocab:!0},{...a,typeExpansion:!0});return"@json"!==e&&!ii(e)&&a.eventHandler&&ic({event:{type:["JsonLdEvent"],code:"relative @type reference",level:"warning",message:"Relative @type reference found.",details:{type:t}},options:a}),e}return t}),{propertyIsArray:!!a.isFrame});continue}if("@included"===f&&ir(t,1.1)){let r=il(await ip.expand({activeCtx:t,activeProperty:e,element:h,options:a}));if(!r.every(t=>n4(t)))throw new nf("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:h});is(i,"@included",r,{propertyIsArray:!0});continue}if("@graph"===f&&!(nZ(h)||nJ(h)))throw new nf('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:h});if("@value"===f){u=h,c&&ir(t,1.1)?i["@value"]=h:is(i,"@value",h,{propertyIsArray:a.isFrame});continue}if("@language"===f){if(null===h)continue;if(!n0(h)&&!a.isFrame)throw new nf('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:h});for(let t of h=il(h).map(t=>n0(t)?t.toLowerCase():t))n0(t)&&!t.match(ia)&&a.eventHandler&&ic({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:t}},options:a});is(i,"@language",h,{propertyIsArray:a.isFrame});continue}if("@direction"===f){if(!n0(h)&&!a.isFrame)throw new nf('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:h});for(let t of h=il(h))if(n0(t)&&"ltr"!==t&&"rtl"!==t)throw new nf('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:h});is(i,"@direction",h,{propertyIsArray:a.isFrame});continue}if("@index"===f){if(!n0(h))throw new nf('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:h});is(i,"@index",h);continue}if("@reverse"===f){if(!nZ(h))throw new nf('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:h});if("@reverse"in(s=await ip.expand({activeCtx:t,activeProperty:"@reverse",element:h,options:a})))for(let t in s["@reverse"])is(i,t,s["@reverse"][t],{propertyIsArray:!0});let e=i["@reverse"]||null;for(let t in s){if("@reverse"===t)continue;null===e&&(e=i["@reverse"]={}),is(e,t,[],{propertyIsArray:!0});let r=s[t];for(let n=0;n<r.length;++n){let i=r[n];if(n6(i)||n3(i))throw new nf('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:s});is(e,t,i,{propertyIsArray:!0})}}continue}if("@nest"===f){d.push(o);continue}let p=t,g=n7(t,o,"@context");n1(g)||(p=await ie({activeCtx:t,localCtx:g,propagate:!0,overrideProtected:!0,options:a}));let y=n7(t,o,"@container")||[];if(y.includes("@language")&&nZ(h)){let t=n7(p,o,"@direction");s=function(t,e,r,n){let i=[];for(let a of Object.keys(e).sort()){let o=n9(t,a,{vocab:!0},n),s=e[a];for(let t of(nJ(s)||(s=[s]),s)){if(null===t)continue;if(!n0(t))throw new nf("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:e});let s={"@value":t};"@none"!==o&&(!a.match(ia)&&n.eventHandler&&ic({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:a}},options:n}),s["@language"]=a.toLowerCase()),r&&(s["@direction"]=r),i.push(s)}}return i}(p,h,t,a)}else if(y.includes("@index")&&nZ(h)){let e=y.includes("@graph"),r=n7(p,o,"@index")||"@index",n="@index"!==r&&n9(t,r,{vocab:!0},a);s=await im({activeCtx:p,options:a,activeProperty:o,value:h,asGraph:e,indexKey:r,propertyIndex:n})}else if(y.includes("@id")&&nZ(h)){let t=y.includes("@graph");s=await im({activeCtx:p,options:a,activeProperty:o,value:h,asGraph:t,indexKey:"@id"})}else if(y.includes("@type")&&nZ(h))s=await im({activeCtx:p.revertToPreviousContext(),options:a,activeProperty:o,value:h,asGraph:!1,indexKey:"@type"});else{let n="@list"===f;if(n||"@set"===f){let t=e;n&&"@graph"===r&&(t=null),s=await ip.expand({activeCtx:p,activeProperty:t,element:h,options:a,insideList:n})}else s="@json"===n7(t,o,"@type")?{"@type":"@json","@value":h}:await ip.expand({activeCtx:p,activeProperty:o,element:h,options:a,insideList:!1})}if(null!==s||"@value"===f){if("@list"!==f&&!n3(s)&&y.includes("@list")&&(s={"@list":il(s)}),y.includes("@graph")&&!y.some(t=>"@id"===t||"@index"===t)){if(s=il(s),a.isFrame||(s=s.filter(t=>{let e=Object.keys(t).length;return null!==ig({value:t,count:e,options:a})})),0===s.length)continue;s=s.map(t=>({"@graph":il(t)}))}if(p.mappings.has(o)&&p.mappings.get(o).reverse){let t=i["@reverse"]=i["@reverse"]||{};s=il(s);for(let e=0;e<s.length;++e){let r=s[e];if(n6(r)||n3(r))throw new nf('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:s});is(t,f,r,{propertyIsArray:!0})}continue}is(i,f,s,{propertyIsArray:!0})}}if("@value"in i){if("@json"===i["@type"]&&ir(t,1.1));else if((nZ(u)||nJ(u))&&!a.isFrame)throw new nf('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:u})}for(let u of d)for(let h of nJ(n[u])?n[u]:[n[u]]){if(!nZ(h)||Object.keys(h).some(e=>"@value"===n9(t,e,{vocab:!0},a)))throw new nf("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:h});await iy({activeCtx:t,activeProperty:e,expandedActiveProperty:r,element:h,expandedParent:i,options:a,insideList:o,typeScopedContext:l,typeKey:s})}}function iv({activeCtx:t,activeProperty:e,value:r,options:n}){if(null==r)return null;let i=n9(t,e,{vocab:!0},n);if("@id"===i)return n9(t,r,{base:!0},n);if("@type"===i)return n9(t,r,{vocab:!0,base:!0},{...n,typeExpansion:!0});let a=n7(t,e,"@type");if(("@id"===a||"@graph"===i)&&n0(r)){let i=n9(t,r,{base:!0},n);return null===i&&r.match(io)&&n.eventHandler&&ic({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:e}},options:n}),{"@id":i}}if("@vocab"===a&&n0(r))return{"@id":n9(t,r,{vocab:!0,base:!0},n)};if(it(i))return r;let o={};if(a&&!["@id","@vocab","@none"].includes(a))o["@type"]=a;else if(n0(r)){let r=n7(t,e,"@language");null!==r&&(o["@language"]=r);let n=n7(t,e,"@direction");null!==n&&(o["@direction"]=n)}return["boolean","number","string"].includes(typeof r)||(r=r.toString()),o["@value"]=r,o}async function im({activeCtx:t,options:e,activeProperty:r,value:n,asGraph:i,indexKey:a,propertyIndex:o}){let s=[],l=Object.keys(n).sort(),u="@type"===a;for(let h of l){let l;if(u){let r=n7(t,h,"@context");n1(r)||(t=await ie({activeCtx:t,localCtx:r,propagate:!1,options:e}))}let d=n[h];for(let n of(nJ(d)||(d=[d]),d=await ip.expand({activeCtx:t,activeProperty:r,element:d,options:e,insideList:!1,insideIndex:!0}),l=o?"@none"===h?"@none":iv({activeCtx:t,activeProperty:a,value:h,options:e}):n9(t,h,{vocab:!0},e),"@id"===a?h=n9(t,h,{base:!0},e):u&&(h=l),d)){if(i&&!n5(n)&&(n={"@graph":[n]}),"@type"===a)"@none"===l||(n["@type"]?n["@type"]=[h].concat(n["@type"]):n["@type"]=[h]);else if(n6(n)&&!["@language","@type","@index"].includes(a))throw new nf(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${a}".`,"jsonld.SyntaxError",{code:"invalid value object",value:n});else o?"@none"!==l&&is(n,o,l,{propertyIsArray:!0,prependValue:!0}):"@none"===l||a in n||(n[a]=h);s.push(n)}}return s}nX=ip,ip.expand=async({activeCtx:t,activeProperty:e=null,element:r,options:n={},insideList:i=!1,insideIndex:a=!1,typeScopedContext:o=null})=>{if(null==r)return null;if("@default"===e&&(n=Object.assign({},n,{isFrame:!1})),!nJ(r)&&!nZ(r))return i||null!==e&&"@graph"!==n9(t,e,{vocab:!0},n)?iv({activeCtx:t,activeProperty:e,value:r,options:n}):(n.eventHandler&&ic({event:{type:["JsonLdEvent"],code:"free-floating scalar",level:"warning",message:"Dropping free-floating scalar not in a list.",details:{value:r}},options:n}),null);if(nJ(r)){let s=[],l=n7(t,e,"@container")||[];i=i||l.includes("@list");for(let l=0;l<r.length;++l){let u=await ip.expand({activeCtx:t,activeProperty:e,element:r[l],options:n,insideIndex:a,typeScopedContext:o});i&&nJ(u)&&(u={"@list":u}),null!==u&&(nJ(u)?s=s.concat(u):s.push(u))}return s}let s=n9(t,e,{vocab:!0},n),l=n7(t,e,"@context");o=o||(t.previousContext?t:null);let u=Object.keys(r).sort(),h=!a;if(h&&o&&u.length<=2&&!u.includes("@context"))for(let e of u){let r=n9(o,e,{vocab:!0},n);if("@value"===r){h=!1,t=o;break}if("@id"===r&&1===u.length){h=!1;break}}h&&(t=t.revertToPreviousContext()),n1(l)||(t=await ie({activeCtx:t,localCtx:l,propagate:!0,overrideProtected:!0,options:n})),"@context"in r&&(t=await ie({activeCtx:t,localCtx:r["@context"],options:n})),o=t;let d=null;for(let e of u)if("@type"===n9(t,e,{vocab:!0},n)){d=d||e;let i=r[e];for(let e of Array.isArray(i)?i.length>1?i.slice().sort():i:[i]){let r=n7(o,e,"@context");n1(r)||(t=await ie({activeCtx:t,localCtx:r,options:n,propagate:!1}))}}let c={};await iy({activeCtx:t,activeProperty:e,expandedActiveProperty:s,element:r,expandedParent:c,options:n,insideList:i,typeKey:d,typeScopedContext:o});let f=(u=Object.keys(c)).length;if("@value"in c){if("@type"in c&&("@language"in c||"@direction"in c))throw new nf('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:c});let e=f-1;if("@type"in c&&(e-=1),"@index"in c&&(e-=1),"@language"in c&&(e-=1),"@direction"in c&&(e-=1),0!==e)throw new nf('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:c});let r=null===c["@value"]?[]:il(c["@value"]),i=iu(c,"@type");if(ir(t,1.1)&&i.includes("@json")&&1===i.length);else if(0===r.length)n.eventHandler&&ic({event:{type:["JsonLdEvent"],code:"null @value value",level:"warning",message:"Dropping null @value value.",details:{value:c}},options:n}),c=null;else if(!r.every(t=>n0(t)||nQ(t))&&"@language"in c)throw new nf("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:c});else if(!i.every(t=>ii(t)&&!(n0(t)&&0===t.indexOf("_:"))||nQ(t)))throw new nf('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:c})}else if("@type"in c&&!nJ(c["@type"]))c["@type"]=[c["@type"]];else if("@set"in c||"@list"in c){if(f>1&&!(2===f&&"@index"in c))throw new nf('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:c});"@set"in c&&(f=(u=Object.keys(c=c["@set"])).length)}else 1===f&&"@language"in c&&(n.eventHandler&&ic({event:{type:["JsonLdEvent"],code:"object with only @language",level:"warning",message:"Dropping object with only @language.",details:{value:c}},options:n}),c=null);return nZ(c)&&!n.keepFreeFloatingNodes&&!i&&(null===e||"@graph"===s||(n7(t,e,"@container")||[]).includes("@graph"))&&(c=ig({value:c,count:f,options:n})),c};var ib=nX.expand,ix={},n2=y("dEapz"),iE=n2.isSubjectReference,iw={},n8=y("frGHZ"),i_=n8.isKeyword,n2=y("dEapz"),nx=y("guzPY"),no=y("85rA0"),nf=y("3Yszg");const iS={};iw=iS,iS.createMergedNodeMap=(t,e)=>{let r=(e=e||{}).issuer||new no.IdentifierIssuer("_:b"),n={"@default":{}};return iS.createNodeMap(t,n,"@default",r),iS.mergeNodeMaps(n)},iS.createNodeMap=(t,e,r,n,i,a)=>{if(nx.isArray(t)){for(let i of t)iS.createNodeMap(i,e,r,n,void 0,a);return}if(!nx.isObject(t)){a&&a.push(t);return}if(n2.isValue(t)){if("@type"in t){let e=t["@type"];0===e.indexOf("_:")&&(t["@type"]=e=n.getId(e))}a&&a.push(t);return}if(a&&n2.isList(t)){let o=[];iS.createNodeMap(t["@list"],e,r,n,i,o),a.push({"@list":o});return}if("@type"in t)for(let e of t["@type"])0===e.indexOf("_:")&&n.getId(e);nx.isUndefined(i)&&(i=n2.isBlankNode(t)?n.getId(t["@id"]):t["@id"]),a&&a.push({"@id":i});let o=e[r],s=o[i]=o[i]||{};for(let a of(s["@id"]=i,Object.keys(t).sort())){if("@id"===a)continue;if("@reverse"===a){let a={"@id":i},s=t["@reverse"];for(let t in s)for(let i of s[t]){let s=i["@id"];n2.isBlankNode(i)&&(s=n.getId(s)),iS.createNodeMap(i,e,r,n,s),no.addValue(o[s],t,a,{propertyIsArray:!0,allowDuplicate:!1})}continue}if("@graph"===a){i in e||(e[i]={}),iS.createNodeMap(t[a],e,i,n);continue}if("@included"===a){iS.createNodeMap(t[a],e,r,n);continue}if("@type"!==a&&i_(a)){if("@index"===a&&a in s&&(t[a]!==s[a]||t[a]["@id"]!==s[a]["@id"]))throw new nf("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:s});s[a]=t[a];continue}let l=t[a];if(0===a.indexOf("_:")&&(a=n.getId(a)),0===l.length){no.addValue(s,a,[],{propertyIsArray:!0});continue}for(let t of l)if("@type"===a&&(t=0===t.indexOf("_:")?n.getId(t):t),n2.isSubject(t)||n2.isSubjectReference(t)){if("@id"in t&&!t["@id"])continue;let i=n2.isBlankNode(t)?n.getId(t["@id"]):t["@id"];no.addValue(s,a,{"@id":i},{propertyIsArray:!0,allowDuplicate:!1}),iS.createNodeMap(t,e,r,n,i)}else if(n2.isValue(t))no.addValue(s,a,t,{propertyIsArray:!0,allowDuplicate:!1});else if(n2.isList(t)){let o=[];iS.createNodeMap(t["@list"],e,r,n,i,o),t={"@list":o},no.addValue(s,a,t,{propertyIsArray:!0,allowDuplicate:!1})}else iS.createNodeMap(t,e,r,n,i),no.addValue(s,a,t,{propertyIsArray:!0,allowDuplicate:!1})}},iS.mergeNodeMapGraphs=t=>{let e={};for(let r of Object.keys(t).sort())for(let n of Object.keys(t[r]).sort()){let i=t[r][n];n in e||(e[n]={"@id":n});let a=e[n];for(let t of Object.keys(i).sort())if(i_(t)&&"@type"!==t)a[t]=no.clone(i[t]);else for(let e of i[t])no.addValue(a,t,no.clone(e),{propertyIsArray:!0,allowDuplicate:!1})}return e},iS.mergeNodeMaps=t=>{let e=t["@default"];for(let r of Object.keys(t).sort()){if("@default"===r)continue;let n=t[r],i=e[r];i?"@graph"in i||(i["@graph"]=[]):e[r]=i={"@id":r,"@graph":[]};let a=i["@graph"];for(let t of Object.keys(n).sort()){let e=n[t];n2.isSubjectReference(e)||a.push(e)}}return e};var ik=iw.createMergedNodeMap;const iN={};ix=iN,iN.flatten=t=>{let e=ik(t),r=[],n=Object.keys(e).sort();for(let t=0;t<n.length;++t){let i=e[n[t]];iE(i)||r.push(i)}return r};var iO=ix.flatten,iT={},nf=y("3Yszg"),n2=y("dEapz"),nx=y("guzPY"),no=y("85rA0"),iM=no.REGEX_BCP47,iA=no.addValue,id=y("8qp2g"),iC=id.handleEvent,iR=nu.RDF_LIST,iI=nu.RDF_FIRST,iP=nu.RDF_REST,iD=nu.RDF_NIL,iL=nu.RDF_TYPE,ij=nu.RDF_JSON_LITERAL,iF=nu.XSD_BOOLEAN,iB=nu.XSD_DOUBLE,iz=nu.XSD_INTEGER,iV=nu.XSD_STRING;const iG={};iT=iG,iG.fromRDF=async(t,e)=>{let{useRdfType:r=!1,useNativeTypes:n=!1,rdfDirection:i=null}=e,a={},o={"@default":a},s={};if(i){if("compound-literal"===i)throw new nf("Unsupported rdfDirection value.","jsonld.InvalidRdfDirection",{value:i});if("i18n-datatype"!==i)throw new nf("Unknown rdfDirection value.","jsonld.InvalidRdfDirection",{value:i})}for(let l of t){let t="DefaultGraph"===l.graph.termType?"@default":l.graph.value;t in o||(o[t]={}),"@default"===t||t in a||(a[t]={"@id":t});let u=o[t],h=l.subject.value,d=l.predicate.value,c=l.object;h in u||(u[h]={"@id":h});let f=u[h],p=c.termType.endsWith("Node");if(!p||c.value in u||(u[c.value]={"@id":c.value}),d===iL&&!r&&p){iA(f,"@type",c.value,{propertyIsArray:!0});continue}let g=function(t,e,r,n){if(t.termType.endsWith("Node"))return{"@id":t.value};let i={"@value":t.value};if(t.language)!t.language.match(iM)&&n.eventHandler&&iC({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:t.language}},options:n}),i["@language"]=t.language;else{let a=t.datatype.value;if(a||(a=iV),a===ij){a="@json";try{i["@value"]=JSON.parse(i["@value"])}catch(t){throw new nf("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:i["@value"],cause:t})}}if(e){if(a===iF)"true"===i["@value"]?i["@value"]=!0:"false"===i["@value"]&&(i["@value"]=!1);else if(nx.isNumeric(i["@value"])){if(a===iz){let t=parseInt(i["@value"],10);t.toFixed(0)===i["@value"]&&(i["@value"]=t)}else a===iB&&(i["@value"]=parseFloat(i["@value"]))}[iF,iz,iB,iV].includes(a)||(i["@type"]=a)}else if("i18n-datatype"===r&&a.startsWith("https://www.w3.org/ns/i18n#")){let[,t,e]=a.split(/[#_]/);t.length>0&&(i["@language"]=t,!t.match(iM)&&n.eventHandler&&iC({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:t}},options:n})),i["@direction"]=e}else a!==iV&&(i["@type"]=a)}return i}(c,n,i,e);if(iA(f,d,g,{propertyIsArray:!0}),p){if(c.value===iD){let t=u[c.value];"usages"in t||(t.usages=[]),t.usages.push({node:f,property:d,value:g})}else c.value in s?s[c.value]=!1:s[c.value]={node:f,property:d,value:g}}}for(let t in o){let e=o[t];if(!(iD in e))continue;let r=e[iD];if(r.usages){for(let t of r.usages){let r=t.node,n=t.property,i=t.value,a=[],o=[],l=Object.keys(r).length;for(;n===iP&&nx.isObject(s[r["@id"]])&&nx.isArray(r[iI])&&1===r[iI].length&&nx.isArray(r[iP])&&1===r[iP].length&&(3===l||4===l&&nx.isArray(r["@type"])&&1===r["@type"].length&&r["@type"][0]===iR)&&(a.push(r[iI][0]),o.push(r["@id"]),r=(t=s[r["@id"]]).node,n=t.property,i=t.value,l=Object.keys(r).length,n2.isBlankNode(r)););for(let t of(delete i["@id"],i["@list"]=a.reverse(),o))delete e[t]}delete r.usages}}let l=[];for(let t of Object.keys(a).sort()){let e=a[t];if(t in o){let r=e["@graph"]=[],n=o[t];for(let t of Object.keys(n).sort()){let e=n[t];n2.isSubjectReference(e)||r.push(e)}}n2.isSubjectReference(e)||l.push(e)}return l};var i$=iT.fromRDF,iU={},iH=iw.createNodeMap,n8=y("frGHZ"),iW=n8.isKeyword,n2=y("dEapz"),iq=y("kRKFi"),nf=y("3Yszg"),nx=y("guzPY"),no=y("85rA0"),id=y("8qp2g"),iY=id.handleEvent,iK=nu.RDF_FIRST,iX=nu.RDF_REST,iJ=nu.RDF_NIL,iZ=nu.RDF_TYPE,iQ=nu.RDF_JSON_LITERAL,i0=nu.RDF_LANGSTRING,i1=nu.XSD_BOOLEAN,i2=nu.XSD_DOUBLE,i3=nu.XSD_INTEGER,i6=nu.XSD_STRING,ng=y("c0VXR"),i5=ng.isAbsolute;const i4={};iU=i4,i4.toRDF=(t,e)=>{let r=new no.IdentifierIssuer("_:b"),n={"@default":{}};iH(t,n,"@default",r);let i=[];for(let t of Object.keys(n).sort()){let a;if("@default"===t)a={termType:"DefaultGraph",value:""};else if(i5(t))(a=t.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"}).value=t;else{e.eventHandler&&iY({event:{type:["JsonLdEvent"],code:"relative graph reference",level:"warning",message:"Relative graph reference found.",details:{graph:t}},options:e});continue}(function(t,e,r,n,i){for(let a of Object.keys(e).sort()){let o=e[a];for(let e of Object.keys(o).sort()){let s=o[e];if("@type"===e)e=iZ;else if(iW(e))continue;for(let o of s){let s={termType:a.startsWith("_:")?"BlankNode":"NamedNode",value:a};if(!i5(a)){i.eventHandler&&iY({event:{type:["JsonLdEvent"],code:"relative subject reference",level:"warning",message:"Relative subject reference found.",details:{subject:a}},options:i});continue}let l={termType:e.startsWith("_:")?"BlankNode":"NamedNode",value:e};if(!i5(e)){i.eventHandler&&iY({event:{type:["JsonLdEvent"],code:"relative predicate reference",level:"warning",message:"Relative predicate reference found.",details:{predicate:e}},options:i});continue}if("BlankNode"===l.termType&&!i.produceGeneralizedRdf){i.eventHandler&&iY({event:{type:["JsonLdEvent"],code:"blank node predicate",level:"warning",message:"Dropping blank node predicate.",details:{property:n.getOldIds().find(t=>n.getId(t)===e)}},options:i});continue}let u=function t(e,r,n,i,a,o){let s={};if(n2.isValue(e)){s.termType="Literal",s.value=void 0,s.datatype={termType:"NamedNode"};let t=e["@value"],r=e["@type"]||null;if("@json"===r)s.value=iq(t),s.datatype.value=iQ;else if(nx.isBoolean(t))s.value=t.toString(),s.datatype.value=r||i1;else if(nx.isDouble(t)||r===i2)nx.isDouble(t)||(t=parseFloat(t)),s.value=t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),s.datatype.value=r||i2;else if(nx.isNumber(t))s.value=t.toFixed(0),s.datatype.value=r||i3;else if("@direction"in e&&"i18n-datatype"===a){let r=(e["@language"]||"").toLowerCase(),n=e["@direction"],i=`https://www.w3.org/ns/i18n#${r}_${n}`;s.datatype.value=i,s.value=t}else if("@direction"in e&&"compound-literal"===a)throw new nf("Unsupported rdfDirection value.","jsonld.InvalidRdfDirection",{value:a});else if("@direction"in e&&a)throw new nf("Unknown rdfDirection value.","jsonld.InvalidRdfDirection",{value:a});else"@language"in e?("@direction"in e&&!a&&o.eventHandler&&iY({event:{type:["JsonLdEvent"],code:"rdfDirection not set",level:"warning",message:"rdfDirection not set for @direction.",details:{object:s.value}},options:o}),s.value=t,s.datatype.value=r||i0,s.language=e["@language"]):("@direction"in e&&!a&&o.eventHandler&&iY({event:{type:["JsonLdEvent"],code:"rdfDirection not set",level:"warning",message:"rdfDirection not set for @direction.",details:{object:s.value}},options:o}),s.value=t,s.datatype.value=r||i6)}else if(n2.isList(e)){let l=function(e,r,n,i,a,o){let s={termType:"NamedNode",value:iK},l={termType:"NamedNode",value:iX},u={termType:"NamedNode",value:iJ},h=e.pop(),d=h?{termType:"BlankNode",value:r.getId()}:u,c=d;for(let u of e){let e=t(u,r,n,i,a,o),h={termType:"BlankNode",value:r.getId()};n.push({subject:c,predicate:s,object:e,graph:i}),n.push({subject:c,predicate:l,object:h,graph:i}),c=h}if(h){let e=t(h,r,n,i,a,o);n.push({subject:c,predicate:s,object:e,graph:i}),n.push({subject:c,predicate:l,object:u,graph:i})}return d}(e["@list"],r,n,i,a,o);s.termType=l.termType,s.value=l.value}else{let t=nx.isObject(e)?e["@id"]:e;s.termType=t.startsWith("_:")?"BlankNode":"NamedNode",s.value=t}return"NamedNode"!==s.termType||i5(s.value)?s:(o.eventHandler&&iY({event:{type:["JsonLdEvent"],code:"relative object reference",level:"warning",message:"Relative object reference found.",details:{object:s.value}},options:o}),null)}(o,n,t,r,i.rdfDirection,i);u&&t.push({subject:s,predicate:l,object:u,graph:r})}}}})(i,n[t],a,r,e)}return i};var i8=iU.toRDF,i9={},n8=y("frGHZ"),i7=n8.isKeyword,n2=y("dEapz"),nx=y("guzPY"),no=y("85rA0"),ng=y("c0VXR"),nf=y("3Yszg"),at=iw.createNodeMap,ae=iw.mergeNodeMapGraphs;const ar={};function an(t){let e={};for(let r in t)void 0!==t[r]&&(e["@"+r]=[t[r]]);return[e]}function ai(t,e,r){let n="@"+r,i=n in t?t[n][0]:e[r];if("embed"===r){if(!0===i)i="@once";else if(!1===i)i="@never";else if("@always"!==i&&"@never"!==i&&"@link"!==i&&"@first"!==i&&"@last"!==i&&"@once"!==i)throw new nf("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:t})}return i}function aa(t){if(!nx.isArray(t)||1!==t.length||!nx.isObject(t[0]))throw new nf("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:t});if("@id"in t[0]){for(let e of no.asArray(t[0]["@id"]))if(!(nx.isObject(e)||ng.isAbsolute(e))||nx.isString(e)&&0===e.indexOf("_:"))throw new nf("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:t})}if("@type"in t[0]){for(let e of no.asArray(t[0]["@type"]))if(!(nx.isObject(e)||ng.isAbsolute(e)||"@json"===e)||nx.isString(e)&&0===e.indexOf("_:"))throw new nf("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:t})}}function ao(t,e,r,n){let i=!0,a=!1;for(let o in r){let s=!1,l=no.getValues(e,o),u=0===no.getValues(r,o).length;if("@id"===o){if(nx.isEmptyObject(r["@id"][0]||{})?s=!0:r["@id"].length>=0&&(s=r["@id"].includes(l[0])),!n.requireAll)return s}else if("@type"===o){if(i=!1,u){if(l.length>0)return!1;s=!0}else if(1===r["@type"].length&&nx.isEmptyObject(r["@type"][0]))s=l.length>0;else for(let t of r["@type"])s=!!nx.isObject(t)&&"@default"in t||s||l.some(e=>e===t);if(!n.requireAll)return s}else{if(i7(o))continue;let e=no.getValues(r,o)[0],a=!1;if(e&&(aa([e]),a="@default"in e),i=!1,0===l.length&&a)continue;if(l.length>0&&u)return!1;if(void 0===e){if(l.length>0)return!1;s=!0}else if(n2.isList(e)){let r=e["@list"][0];if(n2.isList(l[0])){let e=l[0]["@list"];n2.isValue(r)?s=e.some(t=>au(r,t)):(n2.isSubject(r)||n2.isSubjectReference(r))&&(s=e.some(e=>al(t,r,e,n)))}}else s=n2.isValue(e)?l.some(t=>au(e,t)):n2.isSubjectReference(e)?l.some(r=>al(t,e,r,n)):!!nx.isObject(e)&&l.length>0}if(!s&&n.requireAll)return!1;a=a||s}return i||a}function as(t,e,r){nx.isObject(t)?no.addValue(t,e,r,{propertyIsArray:!0}):t.push(r)}function al(t,e,r,n){if(!("@id"in r))return!1;let i=t.subjects[r["@id"]];return i&&ao(t,i,e,n)}function au(t,e){let r=e["@value"],n=e["@type"],i=e["@language"],a=t["@value"]?nx.isArray(t["@value"])?t["@value"]:[t["@value"]]:[],o=t["@type"]?nx.isArray(t["@type"])?t["@type"]:[t["@type"]]:[],s=t["@language"]?nx.isArray(t["@language"])?t["@language"]:[t["@language"]]:[];return 0===a.length&&0===o.length&&0===s.length||!!((a.includes(r)||nx.isEmptyObject(a[0]))&&(!n&&0===o.length||o.includes(n)||n&&nx.isEmptyObject(o[0]))&&(!i&&0===s.length||s.includes(i)||i&&nx.isEmptyObject(s[0])))}i9=ar,ar.frameMergedOrDefault=(t,e,r)=>{let n={options:r,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},i=new no.IdentifierIssuer("_:b");at(t,n.graphMap,"@default",i),r.merged&&(n.graphMap["@merged"]=ae(n.graphMap),n.graph="@merged"),n.subjects=n.graphMap[n.graph];let a=[];return ar.frame(n,Object.keys(n.subjects).sort(),e,a),r.pruneBlankNodeIdentifiers&&(r.bnodesToClear=Object.keys(n.bnodeMap).filter(t=>1===n.bnodeMap[t].length)),// remove @preserve from results
r.link={},/**
 * Removes the @preserve keywords from expanded result of framing.
 *
 * @param input the framed, framed output.
 * @param options the framing options used.
 *
 * @return the resulting output.
 */function t(e,r){if(nx.isArray(e))return e.map(e=>t(e,r));if(nx.isObject(e)){// remove @preserve
if("@preserve"in e)return e["@preserve"][0];if(n2.isValue(e))return e;if(n2.isList(e))return e["@list"]=t(e["@list"],r),e;if("@id"in e){let t=e["@id"];if(r.link.hasOwnProperty(t)){let n=r.link[t].indexOf(e);if(-1!==n)return r.link[t][n];r.link[t].push(e)}else r.link[t]=[e]}for(let n in e){if("@id"===n&&r.bnodesToClear.includes(e[n])){delete e["@id"];continue}e[n]=t(e[n],r)}}return e}(a,r)},ar.frame=(t,e,r,n,i=null)=>{aa(r),r=r[0];let a=t.options,o={embed:ai(r,a,"embed"),explicit:ai(r,a,"explicit"),requireAll:ai(r,a,"requireAll")};t.link.hasOwnProperty(t.graph)||(t.link[t.graph]={});let s=t.link[t.graph],l=function(t,e,r,n){let i={};for(let a of e){let e=t.graphMap[t.graph][a];ao(t,e,r,n)&&(i[a]=e)}return i}(t,e,r,o);for(let u of Object.keys(l).sort()){let h=l[u];if(null===i?t.uniqueEmbeds={[t.graph]:{}}:t.uniqueEmbeds[t.graph]=t.uniqueEmbeds[t.graph]||{},"@link"===o.embed&&u in s){as(n,i,s[u]);continue}let d={"@id":u};if(0===u.indexOf("_:")&&no.addValue(t.bnodeMap,u,d,{propertyIsArray:!0}),s[u]=d,("@first"===o.embed||"@last"===o.embed)&&t.is11)throw new nf("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:r});if(!(!t.embedded&&t.uniqueEmbeds[t.graph].hasOwnProperty(u))){if(t.embedded&&("@never"===o.embed||function(t,e,r){for(let n=r.length-1;n>=0;--n){let i=r[n];if(i.graph===e&&i.subject["@id"]===t["@id"])return!0}return!1}(h,t.graph,t.subjectStack))||t.embedded&&("@first"==o.embed||"@once"==o.embed)&&t.uniqueEmbeds[t.graph].hasOwnProperty(u)){as(n,i,d);continue}if("@last"===o.embed&&u in t.uniqueEmbeds[t.graph]&&function(t,e){let r=t.uniqueEmbeds[t.graph],n=r[e],i=n.parent,a=n.property,o={"@id":e};if(nx.isArray(i)){for(let t=0;t<i.length;++t)if(no.compareValues(i[t],o)){i[t]=o;break}}else{let t=nx.isArray(i[a]);no.removeValue(i,a,o,{propertyIsArray:t}),no.addValue(i,a,o,{propertyIsArray:t})}let s=t=>{for(let e of Object.keys(r))e in r&&nx.isObject(r[e].parent)&&r[e].parent["@id"]===t&&(delete r[e],s(e))};s(e)}(t,u),t.uniqueEmbeds[t.graph][u]={parent:n,property:i},t.subjectStack.push({subject:h,graph:t.graph}),u in t.graphMap){let e=!1,n=null;"@graph"in r?(n=r["@graph"][0],e=!("@merged"===u||"@default"===u),nx.isObject(n)||(n={})):(e="@merged"!==t.graph,n={}),e&&ar.frame({...t,graph:u,embedded:!1},Object.keys(t.graphMap[u]).sort(),[n],d,"@graph")}for(let n of("@included"in r&&ar.frame({...t,embedded:!1},e,r["@included"],d,"@included"),Object.keys(h).sort())){if(i7(n)){if(d[n]=no.clone(h[n]),"@type"===n)for(let e of h["@type"])0===e.indexOf("_:")&&no.addValue(t.bnodeMap,e,d,{propertyIsArray:!0});continue}if(!o.explicit||n in r)for(let e of h[n]){let i=n in r?r[n]:an(o);if(n2.isList(e)){let i=r[n]&&r[n][0]&&r[n][0]["@list"]?r[n][0]["@list"]:an(o),a={"@list":[]};for(let r of(as(d,n,a),e["@list"]))n2.isSubjectReference(r)?ar.frame({...t,embedded:!0},[r["@id"]],i,a,"@list"):as(a,"@list",no.clone(r))}else n2.isSubjectReference(e)?ar.frame({...t,embedded:!0},[e["@id"]],i,d,n):au(i[0],e)&&as(d,n,no.clone(e))}}for(let t of Object.keys(r).sort()){if("@type"===t){if(!nx.isObject(r[t][0])||!("@default"in r[t][0]))continue}else if(i7(t))continue;let e=r[t][0]||{};if(!ai(e,a,"omitDefault")&&!(t in d)){let r="@null";"@default"in e&&(r=no.clone(e["@default"])),nx.isArray(r)||(r=[r]),d[t]=[{"@preserve":r}]}}for(let e of Object.keys(r["@reverse"]||{}).sort()){let n=r["@reverse"][e];for(let r of Object.keys(t.subjects))no.getValues(t.subjects[r],e).some(t=>t["@id"]===u)&&(d["@reverse"]=d["@reverse"]||{},no.addValue(d["@reverse"],e,[],{propertyIsArray:!0}),ar.frame({...t,embedded:!0},[r],n,d["@reverse"][e],i))}as(n,i,d),t.subjectStack.pop()}}},ar.cleanupNull=(t,e)=>{if(nx.isArray(t))return t.map(t=>ar.cleanupNull(t,e)).filter(t=>t);if("@null"===t)return null;if(nx.isObject(t)){if("@id"in t){let r=t["@id"];if(e.link.hasOwnProperty(r)){let n=e.link[r].indexOf(t);if(-1!==n)return e.link[r][n];e.link[r].push(t)}else e.link[r]=[t]}for(let r in t)t[r]=ar.cleanupNull(t[r],e)}return t};var ah=i9.frameMergedOrDefault,ad=i9.cleanupNull,nx=y("guzPY"),ac=nx.isArray,af=nx.isObject,ap=nx.isString,n2=y("dEapz"),ag=n2.isSubjectReference,ay=y("frGHZ").expandIri,av=y("frGHZ").getInitialContext,am=y("frGHZ").process,ab=y("frGHZ").processingMode,ax={},nf=y("3Yszg"),nx=y("guzPY"),aE=nx.isArray,aw=nx.isObject,a_=nx.isString,aS=nx.isUndefined,n2=y("dEapz"),ak=n2.isList,aN=n2.isValue,aO=n2.isGraph,aT=n2.isSimpleGraph,aM=n2.isSubjectReference,n8=y("frGHZ"),aA=n8.expandIri,aC=n8.getContextValue,aR=n8.isKeyword,aI=n8.process,aP=n8.processingMode,ng=y("c0VXR"),aD=ng.removeBase,aL=ng.prependBase,no=y("85rA0"),aj=no.REGEX_KEYWORD,aF=no.addValue,aB=no.asArray,az=no.compareShortestLeast;const aV={};function aG(t,e,r){if("@nest"!==aA(t,e,{vocab:!0},r))throw new nf("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}ax=aV,aV.compact=async({activeCtx:t,activeProperty:e=null,element:r,options:n={}})=>{if(aE(r)){let i=[];for(let a=0;a<r.length;++a){let o=await aV.compact({activeCtx:t,activeProperty:e,element:r[a],options:n});null!==o&&i.push(o)}return n.compactArrays&&1===i.length&&0===(aC(t,e,"@container")||[]).length&&(i=i[0]),i}let i=aC(t,e,"@context");if(aS(i)||(t=await aI({activeCtx:t,localCtx:i,propagate:!0,overrideProtected:!0,options:n})),aw(r)){if(n.link&&"@id"in r&&n.link.hasOwnProperty(r["@id"])){let t=n.link[r["@id"]];for(let e=0;e<t.length;++e)if(t[e].expanded===r)return t[e].compacted}if(aN(r)||aM(r)){let i=aV.compactValue({activeCtx:t,activeProperty:e,value:r,options:n});return n.link&&aM(r)&&(n.link.hasOwnProperty(r["@id"])||(n.link[r["@id"]]=[]),n.link[r["@id"]].push({expanded:r,compacted:i})),i}if(ak(r)&&(aC(t,e,"@container")||[]).includes("@list"))return aV.compact({activeCtx:t,activeProperty:e,element:r["@list"],options:n});let i="@reverse"===e,a={},o=t;aN(r)||aM(r)||(t=t.revertToPreviousContext());let s=aC(o,e,"@context");aS(s)||(t=await aI({activeCtx:t,localCtx:s,propagate:!0,overrideProtected:!0,options:n})),n.link&&"@id"in r&&(n.link.hasOwnProperty(r["@id"])||(n.link[r["@id"]]=[]),n.link[r["@id"]].push({expanded:r,compacted:a}));let l=r["@type"]||[];l.length>1&&(l=Array.from(l).sort());let u=t;for(let e of l){let r=aC(o,aV.compactIri({activeCtx:u,iri:e,relativeTo:{vocab:!0}}),"@context");aS(r)||(t=await aI({activeCtx:t,localCtx:r,options:n,propagate:!1}))}for(let s of Object.keys(r).sort()){let l=r[s];if("@id"===s){let e=aB(l).map(e=>aV.compactIri({activeCtx:t,iri:e,relativeTo:{vocab:!1},base:n.base}));1===e.length&&(e=e[0]),a[aV.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}})]=e;continue}if("@type"===s){let e=aB(l).map(t=>aV.compactIri({activeCtx:o,iri:t,relativeTo:{vocab:!0}}));1===e.length&&(e=e[0]);let r=aV.compactIri({activeCtx:t,iri:"@type",relativeTo:{vocab:!0}}),n=(aC(t,r,"@container")||[]).includes("@set")&&aP(t,1.1)||aE(e)&&0===l.length;aF(a,r,e,{propertyIsArray:n});continue}if("@reverse"===s){let e=await aV.compact({activeCtx:t,activeProperty:"@reverse",element:l,options:n});for(let r in e)if(t.mappings.has(r)&&t.mappings.get(r).reverse){let i=e[r],o=(aC(t,r,"@container")||[]).includes("@set")||!n.compactArrays;aF(a,r,i,{propertyIsArray:o}),delete e[r]}Object.keys(e).length>0&&aF(a,aV.compactIri({activeCtx:t,iri:s,relativeTo:{vocab:!0}}),e);continue}if("@preserve"===s){let r=await aV.compact({activeCtx:t,activeProperty:e,element:l,options:n});aE(r)&&0===r.length||aF(a,s,r);continue}if("@index"===s){if((aC(t,e,"@container")||[]).includes("@index"))continue;aF(a,aV.compactIri({activeCtx:t,iri:s,relativeTo:{vocab:!0}}),l);continue}if("@graph"!==s&&"@list"!==s&&"@included"!==s&&aR(s)){aF(a,aV.compactIri({activeCtx:t,iri:s,relativeTo:{vocab:!0}}),l);continue}if(!aE(l))throw new nf("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===l.length){let e=aV.compactIri({activeCtx:t,iri:s,value:l,relativeTo:{vocab:!0},reverse:i}),r=t.mappings.has(e)?t.mappings.get(e)["@nest"]:null,o=a;r&&(aG(t,r,n),aw(a[r])||(a[r]={}),o=a[r]),aF(o,e,l,{propertyIsArray:!0})}for(let e of l){let r;let o=aV.compactIri({activeCtx:t,iri:s,value:e,relativeTo:{vocab:!0},reverse:i}),l=t.mappings.has(o)?t.mappings.get(o)["@nest"]:null,u=a;l&&(aG(t,l,n),aw(a[l])||(a[l]={}),u=a[l]);let h=aC(t,o,"@container")||[],d=aO(e),c=ak(e);c?r=e["@list"]:d&&(r=e["@graph"]);let f=await aV.compact({activeCtx:t,activeProperty:o,element:c||d?r:e,options:n});if(c){if(aE(f)||(f=[f]),h.includes("@list")){aF(u,o,f,{valueIsArray:!0,allowDuplicate:!0});continue}f={[aV.compactIri({activeCtx:t,iri:"@list",relativeTo:{vocab:!0}})]:f},"@index"in e&&(f[aV.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=e["@index"])}if(d){if(h.includes("@graph")&&(h.includes("@id")||h.includes("@index")&&aT(e))){let r;u.hasOwnProperty(o)?r=u[o]:u[o]=r={},aF(r,(h.includes("@id")?e["@id"]:e["@index"])||aV.compactIri({activeCtx:t,iri:"@none",relativeTo:{vocab:!0}}),f,{propertyIsArray:!n.compactArrays||h.includes("@set")})}else h.includes("@graph")&&aT(e)?aE(f)&&f.length>1&&(f={"@included":f}):(aE(f)&&1===f.length&&n.compactArrays&&(f=f[0]),f={[aV.compactIri({activeCtx:t,iri:"@graph",relativeTo:{vocab:!0}})]:f},"@id"in e&&(f[aV.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}})]=e["@id"]),"@index"in e&&(f[aV.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=e["@index"])),aF(u,o,f,{propertyIsArray:!n.compactArrays||h.includes("@set")})}else if(h.includes("@language")||h.includes("@index")||h.includes("@id")||h.includes("@type")){let r,i;if(u.hasOwnProperty(o)?r=u[o]:u[o]=r={},h.includes("@language"))aN(f)&&(f=f["@value"]),i=e["@language"];else if(h.includes("@index")){let r=aC(t,o,"@index")||"@index",n=aV.compactIri({activeCtx:t,iri:r,relativeTo:{vocab:!0}});if("@index"===r)i=e["@index"],delete f[n];else{let t;if([i,...t]=aB(f[r]||[]),a_(i))switch(t.length){case 0:delete f[r];break;case 1:f[r]=t[0];break;default:f[r]=t}else i=null}}else if(h.includes("@id")){let e=aV.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}});i=f[e],delete f[e]}else if(h.includes("@type")){let r;let a=aV.compactIri({activeCtx:t,iri:"@type",relativeTo:{vocab:!0}});switch([i,...r]=aB(f[a]||[]),r.length){case 0:delete f[a];break;case 1:f[a]=r[0];break;default:f[a]=r}1===Object.keys(f).length&&"@id"in e&&(f=await aV.compact({activeCtx:t,activeProperty:o,element:{"@id":e["@id"]},options:n}))}i||(i=aV.compactIri({activeCtx:t,iri:"@none",relativeTo:{vocab:!0}})),aF(r,i,f,{propertyIsArray:h.includes("@set")})}else{let t=!n.compactArrays||h.includes("@set")||h.includes("@list")||aE(f)&&0===f.length||"@list"===s||"@graph"===s;aF(u,o,f,{propertyIsArray:t})}}}return a}return r},aV.compactIri=({activeCtx:t,iri:e,value:r=null,relativeTo:n={vocab:!1},reverse:i=!1,base:a=null})=>{if(null===e)return e;t.isPropertyTermScoped&&t.previousContext&&(t=t.previousContext);let o=t.getInverse();if(aR(e)&&e in o&&"@none"in o[e]&&"@type"in o[e]["@none"]&&"@none"in o[e]["@none"]["@type"])return o[e]["@none"]["@type"]["@none"];if(n.vocab&&e in o){let n=t["@language"]||"@none",a=[];aw(r)&&"@index"in r&&!("@graph"in r)&&a.push("@index","@index@set"),aw(r)&&"@preserve"in r&&(r=r["@preserve"][0]),aO(r)?("@index"in r&&a.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r&&a.push("@graph@id","@graph@id@set"),a.push("@graph","@graph@set","@set"),"@index"in r||a.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r||a.push("@graph@id","@graph@id@set")):aw(r)&&!aN(r)&&a.push("@id","@id@set","@type","@set@type");let o="@language",s="@null";if(i)o="@type",s="@reverse",a.push("@set");else if(ak(r)){"@index"in r||a.push("@list");let t=r["@list"];if(0===t.length)o="@any",s="@none";else{let e=0===t.length?n:null,r=null;for(let n=0;n<t.length;++n){let i=t[n],a="@none",o="@none";if(aN(i)){if("@direction"in i){let t=(i["@language"]||"").toLowerCase(),e=i["@direction"];a=`${t}_${e}`}else"@language"in i?a=i["@language"].toLowerCase():"@type"in i?o=i["@type"]:a="@null"}else o="@id";if(null===e?e=a:a!==e&&aN(i)&&(e="@none"),null===r?r=o:o!==r&&(r="@none"),"@none"===e&&"@none"===r)break}e=e||"@none","@none"!==(r=r||"@none")?(o="@type",s=r):s=e}}else{if(aN(r)){if("@language"in r&&!("@index"in r)){a.push("@language","@language@set"),s=r["@language"];let t=r["@direction"];t&&(s=`${s}_${t}`)}else"@direction"in r&&!("@index"in r)?s=`_${r["@direction"]}`:"@type"in r&&(o="@type",s=r["@type"])}else o="@type",s="@id";a.push("@set")}a.push("@none"),!aw(r)||"@index"in r||a.push("@index","@index@set"),aN(r)&&1===Object.keys(r).length&&a.push("@language","@language@set");let l=function(t,e,r,n,i,a){null===a&&(a="@null");let o=[];if(("@id"===a||"@reverse"===a)&&aw(r)&&"@id"in r){"@reverse"===a&&o.push("@reverse");let e=aV.compactIri({activeCtx:t,iri:r["@id"],relativeTo:{vocab:!0}});t.mappings.has(e)&&t.mappings.get(e)&&t.mappings.get(e)["@id"]===r["@id"]?o.push.apply(o,["@vocab","@id"]):o.push.apply(o,["@id","@vocab"])}else{o.push(a);let t=o.find(t=>t.includes("_"));t&&o.push(t.replace(/^[^_]+_/,"_"))}o.push("@none");let s=t.inverse[e];for(let t of n){if(!(t in s))continue;let e=s[t][i];for(let t of o)if(t in e)return e[t]}return null}(t,e,r,a,o,s);if(null!==l)return l}if(n.vocab&&"@vocab"in t){let r=t["@vocab"];if(0===e.indexOf(r)&&e!==r){let n=e.substr(r.length);if(!t.mappings.has(n))return n}}let s=null,l=[],u=t.fastCurieMap,h=e.length-1;for(let t=0;t<h&&e[t]in u;++t)""in(u=u[e[t]])&&l.push(u[""][0]);for(let n=l.length-1;n>=0;--n){let i=l[n];for(let n of i.terms){let a=n+":"+e.substr(i.iri.length);t.mappings.get(n)._prefix&&(!t.mappings.has(a)||null===r&&t.mappings.get(a)["@id"]===e)&&(null===s||0>az(a,s))&&(s=a)}}if(null!==s)return s;for(let[r,n]of t.mappings)if(n&&n._prefix&&e.startsWith(r+":"))throw new nf(`Absolute IRI "${e}" confused with prefix "${r}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:t});if(!n.vocab){if(!("@base"in t))return aD(a,e);if(t["@base"]){let r=aD(aL(a,t["@base"]),e);return aj.test(r)?`./${r}`:r}}return e},aV.compactValue=({activeCtx:t,activeProperty:e,value:r,options:n})=>{if(aN(r)){let n=aC(t,e,"@type"),i=aC(t,e,"@language"),a=aC(t,e,"@direction"),o=aC(t,e,"@container")||[],s="@index"in r&&!o.includes("@index");if(!s&&"@none"!==n&&(r["@type"]===n||"@language"in r&&r["@language"]===i&&"@direction"in r&&r["@direction"]===a||"@language"in r&&r["@language"]===i||"@direction"in r&&r["@direction"]===a))return r["@value"];let l=Object.keys(r).length,u=1===l||2===l&&"@index"in r&&!s,h="@language"in t,d=a_(r["@value"]),c=t.mappings.has(e)&&null===t.mappings.get(e)["@language"];if(u&&"@none"!==n&&(!h||!d||c))return r["@value"];let f={};return s&&(f[aV.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=r["@index"]),"@type"in r?f[aV.compactIri({activeCtx:t,iri:"@type",relativeTo:{vocab:!0}})]=aV.compactIri({activeCtx:t,iri:r["@type"],relativeTo:{vocab:!0}}):"@language"in r&&(f[aV.compactIri({activeCtx:t,iri:"@language",relativeTo:{vocab:!0}})]=r["@language"]),"@direction"in r&&(f[aV.compactIri({activeCtx:t,iri:"@direction",relativeTo:{vocab:!0}})]=r["@direction"]),f[aV.compactIri({activeCtx:t,iri:"@value",relativeTo:{vocab:!0}})]=r["@value"],f}let i=aA(t,e,{vocab:!0},n),a=aC(t,e,"@type"),o=aV.compactIri({activeCtx:t,iri:r["@id"],relativeTo:{vocab:"@vocab"===a},base:n.base});return"@id"===a||"@vocab"===a||"@graph"===i?o:{[aV.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}})]:o}};var a$=ax.compact,aU=ax.compactIri,aH=iw.createNodeMap,aW=iw.createMergedNodeMap,aq=iw.mergeNodeMaps,id=y("8qp2g"),aY=id.logEventHandler,aK=id.logWarningEventHandler,aX=id.safeEventHandler,aJ=id.setDefaultEventHandler,aZ=id.setupEventHandler,aQ=id.strictEventHandler,a0=id.unhandledEventHandler;const a1=function(t){let e={},r=new nO({max:100});function n(e,{documentLoader:r=t.documentLoader,...n}){if(e&&"compactionMap"in e)throw new nf('"compactionMap" not supported.',"jsonld.OptionsError");if(e&&"expansionMap"in e)throw new nf('"expansionMap" not supported.',"jsonld.OptionsError");return Object.assign({},{documentLoader:r},n,e,{eventHandler:aZ({options:e})})}return t.compact=async function(e,i,a){let o;if(arguments.length<2)throw TypeError("Could not compact, too few arguments.");if(null===i)throw new nf("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===e)return null;(a=n(a,{base:ap(e)?e:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new nY("_:b"),contextResolver:new nb({sharedCache:r})})).link&&(a.skipExpansion=!0),a.compactToRelative||delete a.base,o=a.skipExpansion?e:await t.expand(e,a);let s=await t.processContext(av(a),i,a),l=await a$({activeCtx:s,element:o,options:a});a.compactArrays&&!a.graph&&ac(l)?1===l.length?l=l[0]:0===l.length&&(l={}):a.graph&&af(l)&&(l=[l]),af(i)&&"@context"in i&&(i=i["@context"]),ac(i=no.clone(i))||(i=[i]);let u=i;i=[];for(let t=0;t<u.length;++t)(!af(u[t])||Object.keys(u[t]).length>0)&&i.push(u[t]);let h=i.length>0;if(1===i.length&&(i=i[0]),ac(l)){let t=aU({activeCtx:s,iri:"@graph",relativeTo:{vocab:!0}}),e=l;l={},h&&(l["@context"]=i),l[t]=e}else if(af(l)&&h){let t=l;for(let e in l={"@context":i},t)l[e]=t[e]}return l},t.expand=async function(e,i){let a;if(arguments.length<1)throw TypeError("Could not expand, too few arguments.");i=n(i,{keepFreeFloatingNodes:!1,contextResolver:new nb({sharedCache:r})});let o={},s=[];if("expandContext"in i){let t=no.clone(i.expandContext);af(t)&&"@context"in t?o.expandContext=t:o.expandContext={"@context":t},s.push(o.expandContext)}if(ap(e)){let r=await t.get(e,i);a=r.documentUrl,o.input=r.document,r.contextUrl&&(o.remoteContext={"@context":r.contextUrl},s.push(o.remoteContext))}else o.input=no.clone(e);"base"in i||(i.base=a||"");let l=av(i);for(let t of s)l=await am({activeCtx:l,localCtx:t,options:i});let u=await ib({activeCtx:l,element:o.input,options:i});return af(u)&&"@graph"in u&&1===Object.keys(u).length?u=u["@graph"]:null===u&&(u=[]),ac(u)||(u=[u]),u},t.flatten=async function(e,i,a){if(arguments.length<1)return TypeError("Could not flatten, too few arguments.");i="function"==typeof i?null:i||null,a=n(a,{base:ap(e)?e:"",contextResolver:new nb({sharedCache:r})});let o=iO(await t.expand(e,a));return null===i?o:(a.graph=!0,a.skipExpansion=!0,await t.compact(o,i,a))},t.frame=async function(e,i,a){if(arguments.length<2)throw TypeError("Could not frame, too few arguments.");if(a=n(a,{base:ap(e)?e:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new nb({sharedCache:r})}),ap(i)){let e=await t.get(i,a);if(i=e.document,e.contextUrl){let t=i["@context"];t?ac(t)?t.push(e.contextUrl):t=[t,e.contextUrl]:t=e.contextUrl,i["@context"]=t}}let o=i&&i["@context"]||{},s=await t.processContext(av(a),o,a);a.hasOwnProperty("omitGraph")||(a.omitGraph=ab(s,1.1)),a.hasOwnProperty("pruneBlankNodeIdentifiers")||(a.pruneBlankNodeIdentifiers=ab(s,1.1));let l=await t.expand(e,a),u={...a};u.isFrame=!0,u.keepFreeFloatingNodes=!0;let h=await t.expand(i,u),d=Object.keys(i).map(t=>ay(s,t,{vocab:!0}));u.merged=!d.includes("@graph"),u.is11=ab(s,1.1);let c=ah(l,h,u);u.graph=!a.omitGraph,u.skipExpansion=!0,u.link={},u.framing=!0;let f=await t.compact(c,o,u);return u.link={},f=ad(f,u)},t.link=async function(e,r,n){let i={};return r&&(i["@context"]=r),i["@embed"]="@link",t.frame(e,i,n)},t.normalize=t.canonize=async function(e,i){if(arguments.length<1)throw TypeError("Could not canonize, too few arguments.");if("inputFormat"in(i=n(i,{base:ap(e)?e:null,algorithm:"URDNA2015",skipExpansion:!1,safe:!0,contextResolver:new nb({sharedCache:r})}))){if("application/n-quads"!==i.inputFormat&&"application/nquads"!==i.inputFormat)throw new nf("Unknown canonicalization input format.","jsonld.CanonizeError");let t=nK.parse(e);return nn.canonize(t,i)}let a={...i};delete a.format,a.produceGeneralizedRdf=!1;let o=await t.toRDF(e,a);return nn.canonize(o,i)},t.fromRDF=async function(t,r){if(arguments.length<1)throw TypeError("Could not convert from RDF, too few arguments.");let{format:i}=r=n(r,{format:ap(t)?"application/n-quads":void 0}),{rdfParser:a}=r;if(i){if(!(a=a||e[i]))throw new nf("Unknown input format.","jsonld.UnknownFormat",{format:i})}else a=()=>t;return i$(await a(t),r)},t.toRDF=async function(e,i){if(arguments.length<1)throw TypeError("Could not convert to RDF, too few arguments.");let a=i8((i=n(i,{base:ap(e)?e:"",skipExpansion:!1,contextResolver:new nb({sharedCache:r})})).skipExpansion?e:await t.expand(e,i),i);if(i.format){if("application/n-quads"===i.format||"application/nquads"===i.format)return nK.serialize(a);throw new nf("Unknown output format.","jsonld.UnknownFormat",{format:i.format})}return a},t.createNodeMap=async function(e,i){if(arguments.length<1)throw TypeError("Could not create node map, too few arguments.");return i=n(i,{base:ap(e)?e:"",contextResolver:new nb({sharedCache:r})}),aW(await t.expand(e,i),i)},t.merge=async function(e,i,a){if(arguments.length<1)throw TypeError("Could not merge, too few arguments.");if(!ac(e))throw TypeError('Could not merge, "docs" must be an array.');i="function"==typeof i?null:i||null,a=n(a,{contextResolver:new nb({sharedCache:r})});let o=await Promise.all(e.map(e=>{let r={...a};return t.expand(e,r)})),s=!0;"mergeNodes"in a&&(s=a.mergeNodes);let l=a.issuer||new nY("_:b"),u={"@default":{}};for(let t=0;t<o.length;++t){let e=no.relabelBlankNodes(o[t],{issuer:new nY("_:b"+t+"-")}),r=s||0===t?u:{"@default":{}};if(aH(e,r,"@default",l),r!==u)for(let t in r){let e=r[t];if(!(t in u)){u[t]=e;continue}let n=u[t];for(let t in e)t in n||(n[t]=e[t])}}let h=aq(u),d=[],c=Object.keys(h).sort();for(let t=0;t<c.length;++t){let e=h[c[t]];ag(e)||d.push(e)}return null===i?d:(a.graph=!0,a.skipExpansion=!0,await t.compact(d,i,a))},Object.defineProperty(t,"documentLoader",{get:()=>t._documentLoader,set:e=>t._documentLoader=e}),t.documentLoader=async t=>{throw new nf("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:t})},t.get=async function(e,r){let n;n="function"==typeof r.documentLoader?r.documentLoader:t.documentLoader;let i=await n(e);try{if(!i.document)throw new nf("No remote document found at the given URL.","jsonld.NullRemoteDocument");ap(i.document)&&(i.document=JSON.parse(i.document))}catch(t){throw new nf("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:t,remoteDoc:i})}return i},t.processContext=async function(t,e,i){return(i=n(i,{base:"",contextResolver:new nb({sharedCache:r})}),null===e)?av(i):(af(e=no.clone(e))&&"@context"in e||(e={"@context":e}),am({activeCtx:t,localCtx:e,options:i}))},t.getContextValue=y("frGHZ").getContextValue,t.documentLoaders={},t.useDocumentLoader=function(e){if(!(e in t.documentLoaders))throw new nf('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});t.documentLoader=t.documentLoaders[e].apply(t,Array.prototype.slice.call(arguments,1))},t.registerRDFParser=function(t,r){e[t]=r},t.unregisterRDFParser=function(t){delete e[t]},t.registerRDFParser("application/n-quads",nK.parse),t.registerRDFParser("application/nquads",nK.parse),t.url=y("c0VXR"),t.logEventHandler=aY,t.logWarningEventHandler=aK,t.safeEventHandler=aX,t.setDefaultEventHandler=aJ,t.strictEventHandler=aQ,t.unhandledEventHandler=a0,t.util=no,Object.assign(t,no),t.promises=t,t.RequestQueue=y("jUcZG"),t.JsonLdProcessor=y("eds65")(t),ni.setupGlobals(t),ni.setupDocumentLoaders(t),t},a2=function(){return a1(function(){return a2()})};a1(a2);var tm=y("7K0Nk"),a3={},a6=a3&&a3.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),a5=a3&&a3.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||a6(e,t,r)};Object.defineProperty(a3,"__esModule",{value:!0}),a5(y("4l69v"),a3);class a4 extends a3.RdfXmlParser{constructor({factory:t,...e}={}){super({...e,dataFactory:t})}}const a8={parsers:new r8([["application/ld+json",new r2],["application/trig",new r6],["application/n-quads",new r6],["application/n-triples",new r6],["text/n3",new r6],["text/turtle",new r6],["application/rdf+xml",new a4]]),serializers:new r8([["application/ld+json",new nr],["application/n-quads",new r4],["application/n-triples",new r4],["text/n3",new r4],["text/turtle",new r4]])};var a9=class{constructor({factory:t}){this.factory=t,this.parsers=new r8,this.serializers=new r8}import(t){if(t.parsers)for(let[e,r]of t.parsers)this.parsers.set(e,new r.constructor({factory:this.factory}));if(t.serializers)for(let[e,r]of t.serializers)this.serializers.set(e,new r.constructor({factory:this.factory}));return this}},a7=class{init(){this.formats=new a9({factory:this})}clone(t){this.formats.import(t.formats)}};const ot=new tN([e7,rC,rK,class extends a7{init(){super.init(),this.formats.import(a8)}},e0,tG,t9,et,eC,eR,eI,ej],{bind:!0});async function oe(t){let e=await fetch(t);if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);let r=await e.text();return await new Promise((t,e)=>{let n=new X({format:"application/trig"}),i=ot.dataset();n.parse(r,(r,n,a)=>{if(r){e(r);return}if(!n){t({dataset:i,prefixes:a});return}i.add(n)})})}function or(t,e){for(let[r,n]of Object.entries(e))if(t.startsWith(n))return`${r}:${t.slice(n.length)}`;return t}/*!
 * @antv/g
 * @description A core module for rendering engine implements DOM API.
 * @version 6.1.11
 * @date 11/25/2024, 1:46:59 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 *//*!
 * @antv/g-camera-api
 * @description A simple implementation of Camera API.
 * @version 2.0.25
 * @date 11/25/2024, 1:45:07 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var on=y("2eDEB"),oi=y("fu0YK"),oa=y("lR7jo"),oo=y("jLNr1"),os=y("f8wIT"),ol=y("jyI49"),ou=y("kVcyu"),oh=y("3iqbd"),od=y("k1dpP"),oc=y("eIStk"),of=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(oi)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(oo)(this,e,[].concat(n))).landmarks=[],t}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"rotate",value:function(t,e,r){if(this.relElevation=(0,on.getAngle)(e),this.relAzimuth=(0,on.getAngle)(t),this.relRoll=(0,on.getAngle)(r),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===on.CameraType.EXPLORING){var n=od.setAxisAngle(od.create(),[1,0,0],(0,on.deg2rad)((this.rotateWorld?1:-1)*this.relElevation)),i=od.setAxisAngle(od.create(),[0,1,0],(0,on.deg2rad)((this.rotateWorld?1:-1)*this.relAzimuth)),a=od.setAxisAngle(od.create(),[0,0,1],(0,on.deg2rad)(this.relRoll)),o=od.multiply(od.create(),i,n);o=od.multiply(od.create(),o,a);var s=oh.fromQuat(oh.create(),o);oh.translate(this.matrix,this.matrix,[0,0,-this.distance]),oh.multiply(this.matrix,this.matrix,s),oh.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===on.CameraType.ORBITING||this.type===on.CameraType.EXPLORING?this._getPosition():this.type===on.CameraType.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(t,e){var r=(0,on.createVec3)(t,e,0),n=oc.clone(this.position);return oc.add(n,n,oc.scale(oc.create(),this.right,r[0])),oc.add(n,n,oc.scale(oc.create(),this.up,r[1])),this._setPosition(n),this.triggerUpdate(),this}},{key:"dolly",value:function(t){var e=this.forward,r=oc.clone(this.position),n=t*this.dollyingStep;return n=Math.max(Math.min(this.distance+t*this.dollyingStep,this.maxDistance),this.minDistance)-this.distance,r[0]+=n*e[0],r[1]+=n*e[1],r[2]+=n*e[2],this._setPosition(r),this.type===on.CameraType.ORBITING||this.type===on.CameraType.EXPLORING?this._getDistance():this.type===on.CameraType.TRACKING&&oc.add(this.focalPoint,r,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(t){var e,r,n,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=a.position,s=void 0===o?this.position:o,l=a.focalPoint,u=void 0===l?this.focalPoint:l,h=a.roll,d=a.zoom,c=new on.runtime.CameraContribution;c.setType(this.type,void 0),c.setPosition(s[0],null!==(e=s[1])&&void 0!==e?e:this.position[1],null!==(r=s[2])&&void 0!==r?r:this.position[2]),c.setFocalPoint(u[0],null!==(n=u[1])&&void 0!==n?n:this.focalPoint[1],null!==(i=u[2])&&void 0!==i?i:this.focalPoint[2]),c.setRoll(null!=h?h:this.roll),c.setZoom(null!=d?d:this.zoom);var f={name:t,matrix:oh.clone(c.getWorldTransform()),right:oc.clone(c.right),up:oc.clone(c.up),forward:oc.clone(c.forward),position:oc.clone(c.getPosition()),focalPoint:oc.clone(c.getFocalPoint()),distanceVector:oc.clone(c.getDistanceVector()),distance:c.getDistance(),dollyingStep:c.getDollyingStep(),azimuth:c.getAzimuth(),elevation:c.getElevation(),roll:c.getRoll(),relAzimuth:c.relAzimuth,relElevation:c.relElevation,relRoll:c.relRoll,zoom:c.getZoom()};return this.landmarks.push(f),f}},{key:"gotoLandmark",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,ou.default)(t)?this.landmarks.find(function(e){return e.name===t}):t;if(n){var i,a=(0,ol.default)(r)?{duration:r}:r,o=a.easing,s=a.duration,l=void 0===s?100:s,u=a.easingFunction,h=a.onfinish,d=void 0===h?void 0:h,c=a.onframe,f=void 0===c?void 0:c;this.cancelLandmarkAnimation();var p=n.position,g=n.focalPoint,y=n.zoom,v=n.roll,m=(void 0===u?void 0:u)||(0,on.runtime).EasingFunction(void 0===o?"linear":o),b=function(){e.setFocalPoint(g),e.setPosition(p),e.setRoll(v),e.setZoom(y),e.computeMatrix(),e.triggerUpdate(),null==d||d()};if(0===l)return b();var x=function(t){void 0===i&&(i=t);var r=t-i;if(r>=l){b();return}var n=m(r/l),a=oc.create(),o=oc.create(),s=1,u=0;if(oc.lerp(a,e.focalPoint,g,n),oc.lerp(o,e.position,p,n),u=e.roll*(1-n)+v*n,s=e.zoom*(1-n)+y*n,e.setFocalPoint(a),e.setPosition(o),e.setRoll(u),e.setZoom(s),oc.dist(a,g)+oc.dist(o,p)<=.01&&void 0===y&&void 0===v)return b();e.computeMatrix(),e.triggerUpdate(),r<l&&(null==f||f(n),e.landmarkAnimationID=e.canvas.requestAnimationFrame(x))};this.canvas.requestAnimationFrame(x)}}}])}(on.Camera);on.runtime.CameraContribution=of;/*!
 * @antv/g-dom-mutation-observer-api
 * @description A simple implementation of DOM MutationObserver API.
 * @version 2.0.22
 * @date 11/25/2024, 1:45:21 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var oi=y("fu0YK"),oa=y("lR7jo"),on=y("2eDEB"),op=/*#__PURE__*/function(){function t(e,r){/*@__PURE__*/f(oi)(this,t),this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[],this.type=e,this.target=r}return /*@__PURE__*/f(oa)(t,null,[{key:"copy",value:function(e){var r=new t(e.type,e.target);return r.addedNodes=e.addedNodes.slice(),r.removedNodes=e.removedNodes.slice(),r.previousSibling=e.previousSibling,r.nextSibling=e.nextSibling,r.attributeName=e.attributeName,r.attributeNamespace=e.attributeNamespace,r.oldValue=e.oldValue,r}}])}(),og=new WeakMap;function oy(t,e){for(var r=t;r;r=r.parentNode){var n=og.get(r);if(n)for(var i=0;i<n.length;i++){var a=n[i],o=a.options;if(r===t||o.subtree){var s=e(o);s&&a.enqueue(s)}}}}/*@__PURE__*/f(oa)(function t(e,r,n){/*@__PURE__*/f(oi)(this,t),this.transientObservedNodes=[],this.observer=e,this.target=r,this.options=n},[{key:"enqueue",value:function(t){var e,r=this.observer.records,n=r.length;if(r.length>0){var i,a=(i=r[n-1],i===t?i:yP&&(i===yP||i===yI)?yP:null);if(a){r[n-1]=a;return}}else e=this.observer,om.push(e),ov||(ov=!0,void 0!==on.runtime.globalThis?(0,on.runtime).globalThis.setTimeout(ob):ob());r[n]=t}},{key:"addListeners",value:function(){this.addListeners_(this.target)}},{key:"addListeners_",value:function(t){var e=this.options;e.attributes&&t.addEventListener(on.ElementEvent.ATTR_MODIFIED,this,!0),e.childList&&t.addEventListener(on.ElementEvent.INSERTED,this,!0),(e.childList||e.subtree)&&t.addEventListener(on.ElementEvent.REMOVED,this,!0)}},{key:"removeListeners",value:function(){this.removeListeners_(this.target)}},{key:"removeListeners_",value:function(t){var e=this.options;e.attributes&&t.removeEventListener(on.ElementEvent.ATTR_MODIFIED,this,!0),e.childList&&t.removeEventListener(on.ElementEvent.INSERTED,this,!0),(e.childList||e.subtree)&&t.removeEventListener(on.ElementEvent.REMOVED,this,!0)}},{key:"removeTransientObservers",value:function(){var t=this.transientObservedNodes;this.transientObservedNodes=[],t.forEach(function(t){this.removeListeners_(t);for(var e=og.get(t),r=0;r<e.length;r++)if(e[r]===this){e.splice(r,1);break}},this)}},{key:"handleEvent",value:function(t){switch(t.stopImmediatePropagation(),t.type){case on.ElementEvent.ATTR_MODIFIED:var e=t.attrName,r=t.relatedNode.namespaceURI;(i=yI=new op("attributes",a=t.target)).attributeName=e,i.attributeNamespace=r;var n=t.attrChange===on.MutationEvent.ADDITION?null:t.prevValue;oy(a,function(t){if(t.attributes&&(!t.attributeFilter||!t.attributeFilter.length||-1!==t.attributeFilter.indexOf(e)||-1!==t.attributeFilter.indexOf(r)))return t.attributeOldValue?(yP||((yP=op.copy(yI)).oldValue=n),yP):i});break;case on.ElementEvent.REMOVED:case on.ElementEvent.INSERTED:a=t.relatedNode;var i,a,o,s,l=t.target;t.type===on.ElementEvent.INSERTED?(o=[l],s=[]):(o=[],s=[l]);var u=l.previousSibling,h=l.nextSibling;(i=yI=new op("childList",a)).addedNodes=o,i.removedNodes=s,i.previousSibling=u,i.nextSibling=h,oy(a,function(t){if(t.childList)return i})}yI=yP=void 0}}]);var ov=!1,om=[];function ob(){ov=!1;var t=om;om=[],t.sort(function(t,e){return t.uid-e.uid});var e=!1;t.forEach(function(t){var r=t.takeRecords();(function(t){t.nodes.forEach(function(e){var r=og.get(e);r&&r.forEach(function(e){e.observer===t&&e.removeTransientObservers()})})})(t),r.length&&(t.callback(r,t),e=!0)}),e&&ob()}y("2eDEB");/*!
 * @antv/g-web-animations-api
 * @description A simple implementation of Web Animations API.
 * @version 2.1.11
 * @date 11/25/2024, 1:46:54 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var on=y("2eDEB"),oi=y("fu0YK"),oa=y("lR7jo"),oo=y("jLNr1"),os=y("f8wIT"),ox=y("fUHKi"),oE=y("02Ztr"),ow=y("8hhuV"),o_=y("geZBG"),ol=y("jyI49"),oS=/*#__PURE__*/function(t){function e(t,r,n,i){var a;return /*@__PURE__*/f(oi)(this,e),(a=/*@__PURE__*/f(oo)(this,e,[t])).currentTime=n,a.timelineTime=i,a.target=r,a.type="finish",a.bubbles=!1,a.currentTarget=r,a.defaultPrevented=!1,a.eventPhase=a.AT_TARGET,a.timeStamp=Date.now(),a.currentTime=n,a.timelineTime=i,a}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e)}(on.FederatedEvent),ok=0,oN=/*@__PURE__*/f(oa)(function t(e,r){var n;/*@__PURE__*/f(oi)(this,t),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=r,this.id="".concat(ok++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number(null===(n=this.effect)||void 0===n?void 0:n.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()},[{key:"pending",get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var t=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(e,r){t.resolveReadyPromise=function(){e(t)},t.rejectReadyPromise=function(){r(Error())}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var t=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(e,r){t.resolveFinishedPromise=function(){e(t)},t.rejectFinishedPromise=function(){r(Error())}}),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){if(!isNaN(t=Number(t))){if(this.timeline.restart(),!this._paused&&null!==this._startTime){var e;this._startTime=Number(null===(e=this.timeline)||void 0===e?void 0:e.currentTime)-t/this.playbackRate}this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(t){null!==t&&(this.updatePromises(),!isNaN(t=Number(t))&&(this._paused||this._idle||(this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises())))}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var e=this.currentTime;this._playbackRate=t,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==e&&(this.currentTime=e),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&0>=Number(this._currentTime))}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||"running"===this.playState||!this._finishedFlag}},{key:"updatePromises",value:function(){var t=this.oldPlayState,e=this.pending?"pending":this.playState;return this.readyPromise&&e!==t&&("idle"===e?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===t?this.resolveReadyPromise():"pending"===e&&(this.readyPromise=void 0)),this.finishedPromise&&e!==t&&("idle"===e?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===e?this.resolveFinishedPromise():"finished"===t&&(this.finishedPromise=void 0)),this.oldPlayState=e,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var t=this;if(this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var e=new oS(null,this,this.currentTime,null);setTimeout(function(){t.oncancel(e)})}}},{key:"reverse",value:function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),null!==t&&(this.currentTime=t),this.updatePromises()}},{key:"updatePlaybackRate",value:function(t){this.playbackRate=t}},{key:"targetAnimations",value:function(){var t;return(null===(t=this.effect)||void 0===t?void 0:t.target).getAnimations()}},{key:"markTarget",value:function(){var t=this.targetAnimations();-1===t.indexOf(this)&&t.push(this)}},{key:"unmarkTarget",value:function(){var t=this.targetAnimations(),e=t.indexOf(this);-1!==e&&t.splice(e,1)}},{key:"tick",value:function(t,e){this._idle||this._paused||(null===this._startTime?e&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(t))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw Error("Unable to rewind negative playback rate animation with infinite duration")}},{key:"persist",value:function(){throw Error(on.ERROR_MSG_METHOD_NOT_IMPLEMENTED)}},{key:"addEventListener",value:function(t,e,r){throw Error(on.ERROR_MSG_METHOD_NOT_IMPLEMENTED)}},{key:"removeEventListener",value:function(t,e,r){throw Error(on.ERROR_MSG_METHOD_NOT_IMPLEMENTED)}},{key:"dispatchEvent",value:function(t){throw Error(on.ERROR_MSG_METHOD_NOT_IMPLEMENTED)}},{key:"commitStyles",value:function(){throw Error(on.ERROR_MSG_METHOD_NOT_IMPLEMENTED)}},{key:"ensureAlive",value:function(){var t,e;this.playbackRate<0&&0===this.currentTime?this._inEffect=!!(null!==(t=this.effect)&&void 0!==t&&t.update(-1)):this._inEffect=!!(null!==(e=this.effect)&&void 0!==e&&e.update(this.currentTime)),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(t,e){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!e&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(t){var e=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var r=new oS(null,this,this.currentTime,t);setTimeout(function(){e.onfinish&&e.onfinish(r)})}this._finishedFlag=!0}}else{if(this.onframe&&"running"===this.playState){var n=new oS(null,this,this.currentTime,t);this.onframe(n)}this._finishedFlag=!1}}}]),oO="function"==typeof Float32Array,oT=function(t,e){return 1-3*e+3*t},oM=function(t,e){return 3*e-6*t},oA=function(t){return 3*t},oC=function(t,e,r){return((oT(e,r)*t+oM(e,r))*t+oA(e))*t},oR=function(t,e,r){return 3*oT(e,r)*t*t+2*oM(e,r)*t+oA(e)},oI=function(t,e,r,n,i){var a,o,s=0;do(a=oC(o=e+(r-e)/2,n,i)-t)>0?r=o:e=o;while(Math.abs(a)>1e-7&&++s<10)return o},oP=function(t,e,r,n){for(var i=0;i<4;++i){var a=oR(e,r,n);if(0===a)break;var o=oC(e,r,n)-t;e-=o/a}return e},oD=function(t,e,r,n){if(!(t>=0&&t<=1&&r>=0&&r<=1))throw Error("bezier x values must be in [0, 1] range");if(t===e&&r===n)return function(t){return t};for(var i=oO?new Float32Array(11):Array(11),a=0;a<11;++a)i[a]=oC(.1*a,t,r);var o=function(e){for(var n=0,a=1;10!==a&&i[a]<=e;++a)n+=.1;var o=n+(e-i[--a])/(i[a+1]-i[a])*.1,s=oR(o,t,r);return s>=.001?oP(e,o,t,r):0===s?o:oI(e,n,n+.1,t,r)};return function(t){return 0===t||1===t?t:oC(o(t),e,n)}},oL=function(t){return Math.pow(t,2)},oj=function(t){return Math.pow(t,3)},oF=function(t){return Math.pow(t,4)},oB=function(t){return Math.pow(t,5)},oz=function(t){return Math.pow(t,6)},oV=function(t){return 1-Math.cos(t*Math.PI/2)},oG=function(t){return 1-Math.sqrt(1-t*t)},o$=function(t){return t*t*(3*t-2)},oU=function(t){for(var e,r=4;t<((e=Math.pow(2,--r))-1)/11;);return 1/Math.pow(4,3-r)-7.5625*Math.pow((3*e-2)/22-t,2)},oH=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=/*@__PURE__*/f(oE)(e,2),n=r[0],i=r[1],a=(0,ow.default)(Number(void 0===n?1:n),1,10),o=(0,ow.default)(Number(void 0===i?.5:i),.1,2);return 0===t||1===t?t:-a*Math.pow(2,10*(t-1))*Math.sin(2*Math.PI*(t-1-o/(2*Math.PI)*Math.asin(1/a))/o)},oW=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=/*@__PURE__*/f(oE)(e,4),i=n[0],a=void 0===i?1:i,o=n[1],s=void 0===o?100:o,l=n[2],u=void 0===l?10:l,h=n[3],d=void 0===h?0:h;a=(0,ow.default)(a,.1,1e3),s=(0,ow.default)(s,.1,1e3),u=(0,ow.default)(u,.1,1e3),d=(0,ow.default)(d,.1,1e3);var c=Math.sqrt(s/a),p=u/(2*Math.sqrt(s*a)),g=p<1?c*Math.sqrt(1-p*p):0,y=p<1?(p*c+-d)/g:-d+c,v=r?r*t/1e3:t;return(v=p<1?Math.exp(-v*p*c)*(1*Math.cos(g*v)+y*Math.sin(g*v)):(1+y*v)*Math.exp(-v*c),0===t||1===t)?t:1-v},oq=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=/*@__PURE__*/f(oE)(e,2),n=r[0],i=void 0===n?10:n;return("start"===r[1]?Math.ceil:Math.floor)((0,ow.default)(t,0,1)*i)/i},oY=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=/*@__PURE__*/f(oE)(e,4);return oD(r[0],r[1],r[2],r[3])(t)},oK=oD(.42,0,1,1),oX=function(t){return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return 1-t(1-e,r,n)}},oJ=function(t){return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return e<.5?t(2*e,r,n)/2:1-t(-2*e+2,r,n)/2}},oZ=function(t){return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return e<.5?(1-t(1-2*e,r,n))/2:(t(2*e-1,r,n)+1)/2}},oQ={steps:oq,"step-start":function(t){return oq(t,[1,"start"])},"step-end":function(t){return oq(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":oY,ease:function(t){return oY(t,[.25,.1,.25,1])},in:oK,out:oX(oK),"in-out":oJ(oK),"out-in":oZ(oK),"in-quad":oL,"out-quad":oX(oL),"in-out-quad":oJ(oL),"out-in-quad":oZ(oL),"in-cubic":oj,"out-cubic":oX(oj),"in-out-cubic":oJ(oj),"out-in-cubic":oZ(oj),"in-quart":oF,"out-quart":oX(oF),"in-out-quart":oJ(oF),"out-in-quart":oZ(oF),"in-quint":oB,"out-quint":oX(oB),"in-out-quint":oJ(oB),"out-in-quint":oZ(oB),"in-expo":oz,"out-expo":oX(oz),"in-out-expo":oJ(oz),"out-in-expo":oZ(oz),"in-sine":oV,"out-sine":oX(oV),"in-out-sine":oJ(oV),"out-in-sine":oZ(oV),"in-circ":oG,"out-circ":oX(oG),"in-out-circ":oJ(oG),"out-in-circ":oZ(oG),"in-back":o$,"out-back":oX(o$),"in-out-back":oJ(o$),"out-in-back":oZ(o$),"in-bounce":oU,"out-bounce":oX(oU),"in-out-bounce":oJ(oU),"out-in-bounce":oZ(oU),"in-elastic":oH,"out-elastic":oX(oH),"in-out-elastic":oJ(oH),"out-in-elastic":oZ(oH),spring:oW,"spring-in":oW,"spring-out":oX(oW),"spring-in-out":oJ(oW),"spring-out-in":oZ(oW)},o0=function(t){var e;return("-"===(e=(e=t).replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})).charAt(0)?e.substring(1):e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},o1=function(t){return t};function o2(t,e){return function(r){if(r>=1)return 1;var n=1/t;return(r+=e*n)-r%n}}var o3="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",o6=new RegExp("cubic-bezier\\(".concat(o3,",").concat(o3,",").concat(o3,",").concat(o3,"\\)")),o5=/steps\(\s*(\d+)\s*\)/,o4=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function o8(t){var e=o6.exec(t);if(e)return oD.apply(void 0,/*@__PURE__*/f(ox)(e.slice(1).map(Number)));var r=o5.exec(t);if(r)return o2(Number(r[1]),0);var n=o4.exec(t);return n?o2(Number(n[1]),{start:1,middle:.5,end:0}[n[2]]):oQ[o0(t)]||oQ.linear}function o9(t){return"offset"!==t&&"easing"!==t&&"composite"!==t&&"computedOffset"!==t}var o7=function(t,e,r){return function(n){var i=function t(e,r,n){if("number"==typeof e&&"number"==typeof r)return e*(1-n)+r*n;if("boolean"==typeof e&&"boolean"==typeof r||"string"==typeof e&&"string"==typeof r)return n<.5?e:r;if(Array.isArray(e)&&Array.isArray(r)){for(var i=e.length,a=r.length,o=Math.max(i,a),s=[],l=0;l<o;l++)s.push(t(e[l<i?l:i-1],r[l<a?l:a-1],n));return s}throw Error("Mismatched interpolation arguments ".concat(e,":").concat(r))}(t,e,n);return(0,ol.default)(i)?i:r(i)}},st=/*@__PURE__*/f(oa)(function t(){/*@__PURE__*/f(oi)(this,t),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=o1,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null},[{key:"easing",get:function(){return this._easing},set:function(t){this.easingFunction=o8(t),this._easing=t}}]);function se(t,e){if(null===t)return[];Array.isArray(t)||(t=function(t){var e=[];for(var r in t)if(!(r in["easing","offset","composite"])){var n=t[r];Array.isArray(n)||(n=[n]);for(var i=n.length,a=0;a<i;a++){if(!e[a]){var o={};"offset"in t&&(o.offset=Number(t.offset)),"easing"in t&&(o.easing=t.easing),"composite"in t&&(o.composite=t.composite),e[a]=o}void 0!==n[a]&&null!==n[a]&&(e[a][r]=n[a])}}return e.sort(function(t,e){return(t.computedOffset||0)-(e.computedOffset||0)}),e}(t));for(var r=t.map(function(t){var r={};for(var n in null!=e&&e.composite&&(r.composite="auto"),t){var i=t[n];if("offset"===n){if(null!==i){if(!isFinite(i=Number(i)))throw Error("Keyframe offsets must be numbers.");if(i<0||i>1)throw Error("Keyframe offsets must be between 0 and 1.");r.computedOffset=i}}else if("composite"===n&&-1===["replace","add","accumulate","auto"].indexOf(i))throw Error("".concat(i," compositing is not supported"));r[n]=i}return void 0===r.offset&&(r.offset=null),void 0===r.easing&&(r.easing=(null==e?void 0:e.easing)||"linear"),void 0===r.composite&&(r.composite="auto"),r}),n=!0,i=-1/0,a=0;a<r.length;a++){var o=r[a].offset;if((0,o_.default)(o))n=!1;else{if(o<i)throw TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=o}}return r=r.filter(function(t){return Number(t.offset)>=0&&1>=Number(t.offset)}),n||function(){var t,e,n=r.length;r[n-1].computedOffset=Number(null!==(t=r[n-1].offset)&&void 0!==t?t:1),n>1&&(r[0].computedOffset=Number(null!==(e=r[0].offset)&&void 0!==e?e:0));for(var i=0,a=Number(r[0].computedOffset),o=1;o<n;o++){var s=r[o].computedOffset;if(!(0,o_.default)(s)&&!(0,o_.default)(a)){for(var l=1;l<o-i;l++)r[i+l].computedOffset=a+(Number(s)-a)*l/(o-i);i=o,a=Number(s)}}}(),r}var sr="backwards|forwards|both|none".split("|"),sn="reverse|alternate|alternate-reverse".split("|"),si=/*@__PURE__*/f(oa)(function t(e,r,n){var i,a,o,s,l,u,h,d,c,p,g,y,v=this;/*@__PURE__*/f(oi)(this,t),this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=("number"==typeof(i=null!=n?n:{duration:"auto"})&&(i=isNaN(i)?{duration:"auto"}:{duration:i}),l=i,u=new st,"number"!=typeof l||isNaN(l)?void 0!==l&&Object.keys(l).forEach(function(t){void 0===l[t]||null===l[t]||"auto"===l[t]||("number"==typeof u[t]||"duration"===t)&&("number"!=typeof l[t]||isNaN(l[t]))||"fill"===t&&-1===sr.indexOf(l[t])||"direction"===t&&-1===sn.indexOf(l[t])||(u[t]=l[t])}):u.duration=l,u),this.timing.effect=this,this.timing.activeDuration=Math.abs((0===(a=h=this.timing).duration||0===a.iterations?0:("auto"===a.duration?0:Number(a.duration))*(null!==(o=a.iterations)&&void 0!==o?o:1))/(h.playbackRate||1)),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=se(r,this.timing),this.interpolations=(d=this.normalizedKeyframes,c=this.timing,p=this.target,y=function(t,e){var r=[];for(var n in t)for(var i=t[n],a=0;a<i.length-1;a++){var o=a,s=a+1,l=i[o].computedOffset,u=i[s].computedOffset,h=l,d=u;0===a&&(h=-1/0,0===u&&(s=o)),a===i.length-2&&(d=1/0,1===l&&(o=s)),r.push({applyFrom:h,applyTo:d,startOffset:i[o].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[o].easingFunction,property:n,interpolation:function(t,e,r,n){var i=on.propertyMetadataCache[t];if(i&&i.syntax&&i.int){var a=(0,on.runtime).styleValueRegistry.getPropertySyntax(i.syntax);if(a){var o=a.parser,s=o?o(e,n):e,l=o?o(r,n):r,u=a.mixer(s,l,n);if(u){var h=o7.apply(void 0,/*@__PURE__*/f(ox)(u));return function(t){return 0===t?e:1===t?r:h(t)}}}}return o7(!1,!0,function(t){return t?r:e})}(n,i[o].value,i[s].value,e)})}return r.sort(function(t,e){return t.startOffset-e.startOffset}),r}(g=function(t,e){for(var r={},n=0;n<t.length;n++)for(var i in t[n])if(o9(i)){var a={offset:t[n].offset,computedOffset:t[n].computedOffset,easing:t[n].easing,easingFunction:o8(t[n].easing)||e.easingFunction,value:t[n][i]};r[i]=r[i]||[],r[i].push(a)}return r}(d,c),p),function(t,e){if(null!==e)y.filter(function(t){return e>=t.applyFrom&&e<t.applyTo}).forEach(function(r){var n=e-r.startOffset,i=r.endOffset-r.startOffset;t.setAttribute(r.property,r.interpolation(0===i?0:n/i),!1,!1)});else for(var r in g)o9(r)&&t.setAttribute(r,null)});var m=on.runtime.globalThis.Proxy;this.computedTiming=m?new m(this.timing,{get:function(t,e){return"duration"===e?"auto"===t.duration?0:t.duration:"fill"===e?"auto"===t.fill?"none":t.fill:"localTime"===e?v.animation&&v.animation.currentTime||null:"currentIteration"===e?v.animation&&"running"===v.animation.playState?t.currentIteration||0:null:"progress"===e?v.animation&&"running"===v.animation.playState?t.progress||0:null:t[e]},set:function(){return!0}}):this.timing},[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(t){return null!==t&&(this.timeFraction=function(t,e,r){var n,i,a,o,s,l,u,h=function(t,e,r){if(null===e)return 0;var n=r.endTime;return e<Math.min(r.delay,n)?1:e>=Math.min(r.delay+t+r.endDelay,n)?2:3}(t,e,r),d=function(t,e,r,n,i){switch(n){case 1:if("backwards"===e||"both"===e)return 0;return null;case 3:return r-i;case 2:if("forwards"===e||"both"===e)return t;return null;case 0:return null}}(t,r.fill,e,h,r.delay);if(null===d)return null;var c="auto"===r.duration?0:r.duration,f=(n=r.iterations,a=i=r.iterationStart,0===c?1!==h&&(a+=n):a+=d/c,a),p=(o=r.iterationStart,s=r.iterations,0==(l=f===1/0?o%1:f%1)&&2===h&&0!==s&&(0!==d||0===c)&&(l=1),l),g=(u=r.iterations,2===h&&u===1/0?1/0:1===p?Math.floor(f)-1:Math.floor(f)),y=function(t,e,r){var n=t;if("normal"!==t&&"reverse"!==t){var i=e;"alternate-reverse"===t&&(i+=1),n="normal",i!==1/0&&i%2!=0&&(n="reverse")}return"normal"===n?r:1-r}(r.direction,g,p);return r.currentIteration=g,r.progress=y,r.easingFunction(y)}(this.timing.activeDuration,t,this.timing),null!==this.timeFraction)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(t){this.normalizedKeyframes=se(t)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(t){var e=this;Object.keys(t||{}).forEach(function(r){e.timing[r]=t[r]})}}]);function sa(t,e){return Number(t.id)-Number(e.id)}var so=/*@__PURE__*/f(oa)(function t(e){var r=this;/*@__PURE__*/f(oi)(this,t),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(t){r.currentTime=t,r.discardAnimations(),0===r.animations.length?r.timelineTicking=!1:r.requestAnimationFrame(r.webAnimationsNextTick)},this.processRafCallbacks=function(t){var e=r.rafCallbacks;r.rafCallbacks=[],t<Number(r.currentTime)&&(t=Number(r.currentTime)),r.animations.sort(sa),r.animations=r.tick(t,!0,r.animations)[0],e.forEach(function(e){e[1](t)}),r.applyPendingEffects()},this.document=e},[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(t,e,r){var n=new oN(new si(t,e,r),this);return this.animations.push(n),this.restartWebAnimationsNextTick(),n.updatePromises(),n.play(),n.updatePromises(),n}},{key:"applyDirtiedAnimation",value:function(t){var e=this;if(!this.inTick){t.markTarget();var r=t.targetAnimations();r.sort(sa),this.tick(Number(this.currentTime),!1,r.slice())[1].forEach(function(t){var r=e.animations.indexOf(t);-1!==r&&e.animations.splice(r,1)}),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(t){null==t||t.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(t){return t.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(t){return"finished"!==t.playState&&"idle"!==t.playState})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(t){var e=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([e,t]),e}},{key:"requestAnimationFrame",value:function(t){var e=this;return this.rAF(function(r){e.updateAnimationsPromises(),t(r),e.updateAnimationsPromises()})}},{key:"tick",value:function(t,e,r){var n,i,a=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var o=[],s=[],l=[],u=[];return r.forEach(function(r){r.tick(t,e),r._inEffect?(s.push(r.effect),r.markTarget()):(o.push(r.effect),r.unmarkTarget()),r._needsTick&&(a.ticking=!0);var n=r._inEffect||r._needsTick;r._inTimeline=n,n?l.push(r):u.push(r)}),(n=this.pendingEffects).push.apply(n,o),(i=this.pendingEffects).push.apply(i,s),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[l,u]}}]);on.runtime.EasingFunction=o8,on.runtime.AnimationTimeline=so;var on=(y("2eDEB"),y("2eDEB")),o_=y("geZBG"),ss=function(t){return(0,o_.default)(t)?"":t.toString()},sl=function(t){var e=ss(t);return e.charAt(0).toUpperCase()+e.substring(1)},su=function(t){return"object"==typeof t&&null!==t},sh=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)},ou=y("kVcyu"),sd=function(t,e){if(t===e)return!0;if(!t||!e||(0,ou.default)(t)||(0,ou.default)(e))return!1;if(sh(t)||sh(e)){if(t.length!==e.length)return!1;for(var r=!0,n=0;n<t.length&&(r=sd(t[n],e[n]));n++);return r}if(su(t)||su(e)){var i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;for(var r=!0,n=0;n<i.length&&(r=sd(t[i[n]],e[i[n]]));n++);return r}return!1},o_=y("geZBG"),sc=y("6JKSc");const sf={duration:500},sp={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};(yv=yD||(yD={})).NodeAdded="NodeAdded",yv.NodeUpdated="NodeUpdated",yv.NodeRemoved="NodeRemoved",yv.EdgeAdded="EdgeAdded",yv.EdgeUpdated="EdgeUpdated",yv.EdgeRemoved="EdgeRemoved",yv.ComboAdded="ComboAdded",yv.ComboUpdated="ComboUpdated",yv.ComboRemoved="ComboRemoved",(ym=yL||(yL={})).DRAW="draw",ym.COLLAPSE="collapse",ym.EXPAND="expand",ym.TRANSFORM="transform",(yb=yj||(yj={})).CLICK="canvas:click",yb.DBLCLICK="canvas:dblclick",yb.POINTER_OVER="canvas:pointerover",yb.POINTER_LEAVE="canvas:pointerleave",yb.POINTER_ENTER="canvas:pointerenter",yb.POINTER_MOVE="canvas:pointermove",yb.POINTER_OUT="canvas:pointerout",yb.POINTER_DOWN="canvas:pointerdown",yb.POINTER_UP="canvas:pointerup",yb.CONTEXT_MENU="canvas:contextmenu",yb.DRAG_START="canvas:dragstart",yb.DRAG="canvas:drag",yb.DRAG_END="canvas:dragend",yb.DRAG_ENTER="canvas:dragenter",yb.DRAG_OVER="canvas:dragover",yb.DRAG_LEAVE="canvas:dragleave",yb.DROP="canvas:drop",yb.WHEEL="canvas:wheel",(yx=yF||(yF={})).CLICK="combo:click",yx.DBLCLICK="combo:dblclick",yx.POINTER_OVER="combo:pointerover",yx.POINTER_LEAVE="combo:pointerleave",yx.POINTER_ENTER="combo:pointerenter",yx.POINTER_MOVE="combo:pointermove",yx.POINTER_OUT="combo:pointerout",yx.POINTER_DOWN="combo:pointerdown",yx.POINTER_UP="combo:pointerup",yx.CONTEXT_MENU="combo:contextmenu",yx.DRAG_START="combo:dragstart",yx.DRAG="combo:drag",yx.DRAG_END="combo:dragend",yx.DRAG_ENTER="combo:dragenter",yx.DRAG_OVER="combo:dragover",yx.DRAG_LEAVE="combo:dragleave",yx.DROP="combo:drop",(yE=yB||(yB={})).CLICK="click",yE.DBLCLICK="dblclick",yE.POINTER_OVER="pointerover",yE.POINTER_LEAVE="pointerleave",yE.POINTER_ENTER="pointerenter",yE.POINTER_MOVE="pointermove",yE.POINTER_OUT="pointerout",yE.POINTER_DOWN="pointerdown",yE.POINTER_UP="pointerup",yE.CONTEXT_MENU="contextmenu",yE.DRAG_START="dragstart",yE.DRAG="drag",yE.DRAG_END="dragend",yE.DRAG_ENTER="dragenter",yE.DRAG_OVER="dragover",yE.DRAG_LEAVE="dragleave",yE.DROP="drop",yE.KEY_DOWN="keydown",yE.KEY_UP="keyup",yE.WHEEL="wheel",(yw=yz||(yz={})).KEY_DOWN="keydown",yw.KEY_UP="keyup",(y_=yV||(yV={})).CLICK="edge:click",y_.DBLCLICK="edge:dblclick",y_.POINTER_OVER="edge:pointerover",y_.POINTER_LEAVE="edge:pointerleave",y_.POINTER_ENTER="edge:pointerenter",y_.POINTER_MOVE="edge:pointermove",y_.POINTER_OUT="edge:pointerout",y_.POINTER_DOWN="edge:pointerdown",y_.POINTER_UP="edge:pointerup",y_.CONTEXT_MENU="edge:contextmenu",y_.DRAG_ENTER="edge:dragenter",y_.DRAG_OVER="edge:dragover",y_.DRAG_LEAVE="edge:dragleave",y_.DROP="edge:drop",(yS=yG||(yG={})).BEFORE_CANVAS_INIT="beforecanvasinit",yS.AFTER_CANVAS_INIT="aftercanvasinit",yS.BEFORE_SIZE_CHANGE="beforesizechange",yS.AFTER_SIZE_CHANGE="aftersizechange",yS.BEFORE_ELEMENT_CREATE="beforeelementcreate",yS.AFTER_ELEMENT_CREATE="afterelementcreate",yS.BEFORE_ELEMENT_UPDATE="beforeelementupdate",yS.AFTER_ELEMENT_UPDATE="afterelementupdate",yS.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",yS.AFTER_ELEMENT_DESTROY="afterelementdestroy",yS.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",yS.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",yS.BEFORE_DRAW="beforedraw",yS.AFTER_DRAW="afterdraw",yS.BEFORE_RENDER="beforerender",yS.AFTER_RENDER="afterrender",yS.BEFORE_ANIMATE="beforeanimate",yS.AFTER_ANIMATE="afteranimate",yS.BEFORE_LAYOUT="beforelayout",yS.AFTER_LAYOUT="afterlayout",yS.BEFORE_STAGE_LAYOUT="beforestagelayout",yS.AFTER_STAGE_LAYOUT="afterstagelayout",yS.BEFORE_TRANSFORM="beforetransform",yS.AFTER_TRANSFORM="aftertransform",yS.BATCH_START="batchstart",yS.BATCH_END="batchend",yS.BEFORE_DESTROY="beforedestroy",yS.AFTER_DESTROY="afterdestroy",yS.BEFORE_RENDERER_CHANGE="beforerendererchange",yS.AFTER_RENDERER_CHANGE="afterrendererchange",(yk=y$||(y$={})).UNDO="undo",yk.REDO="redo",yk.CANCEL="cancel",yk.ADD="add",yk.CLEAR="clear",yk.CHANGE="change",(yN=yU||(yU={})).CLICK="node:click",yN.DBLCLICK="node:dblclick",yN.POINTER_OVER="node:pointerover",yN.POINTER_LEAVE="node:pointerleave",yN.POINTER_ENTER="node:pointerenter",yN.POINTER_MOVE="node:pointermove",yN.POINTER_OUT="node:pointerout",yN.POINTER_DOWN="node:pointerdown",yN.POINTER_UP="node:pointerup",yN.CONTEXT_MENU="node:contextmenu",yN.DRAG_START="node:dragstart",yN.DRAG="node:drag",yN.DRAG_END="node:dragend",yN.DRAG_ENTER="node:dragenter",yN.DRAG_OVER="node:dragover",yN.DRAG_LEAVE="node:dragleave",yN.DROP="node:drop";const sg="combo",sy="tree";(yO=yH||(yH={})).NODE="node",yO.EDGE="edge",yO.COMBO="combo",yO.THEME="theme",yO.PALETTE="palette",yO.LAYOUT="layout",yO.BEHAVIOR="behavior",yO.PLUGIN="plugin",yO.ANIMATION="animation",yO.TRANSFORM="transform",yO.SHAPE="shape";const sv={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function sm(t,e){var r;let n=null===(r=sv[t])||void 0===r?void 0:r[e];if(n)return n}function sb(t){return`[G6 v5.0.32] ${t}`}const sx={mute:!1,debug:t=>{sx.mute||console.debug(sb(t))},info:t=>{sx.mute||console.info(sb(t))},warn:t=>{sx.mute||console.warn(sb(t))},error:t=>{sx.mute||console.error(sb(t))}};function sE(t){let{theme:e}=t;return e?sm(yH.THEME,e)||(sx.warn(`The theme of ${e} is not registered.`),{}):{}}function sw(t,e){if(Array.isArray(t)&&0===t.length)return null;let r=Array.isArray(t)?t[0]:t,n=Array.isArray(t)?t.slice(1):e||[];return new Proxy(r,{get:(t,e)=>"function"!=typeof t[e]||["onframe","onfinish"].includes(e)?"finished"===e?Promise.all([r.finished,...n.map(t=>t.finished)]):Reflect.get(t,e):(...r)=>{t[e](...r),n.forEach(t=>{var n;return null===(n=t[e])||void 0===n?void 0:n.call(t,...r)})},set:(t,e,r)=>(["onframe","onfinish"].includes(e)||n.forEach(t=>{t[e]=r}),Reflect.set(t,e,r))})}function s_(t){let e=t.reduce((t,e)=>(Object.entries(e).forEach(([e,r])=>{void 0===t[e]?t[e]=[r]:t[e].push(r)}),t),{});Object.entries(e).forEach(([r,n])=>{(n.length!==t.length||n.some(t=>(0,o_.default)(t))||n.every(t=>!["sourceNode","targetNode","childrenNode"].includes(r)&&sd(t,n[0])))&&delete e[r]});let r=Object.entries(e).reduce((t,[e,r])=>(r.forEach((r,n)=>{t[n]?t[n][e]=r:t[n]={[e]:r}}),t),[]);return 0!==t.length&&0===r.length&&r.push({_:0},{_:0}),r}function sS(t){switch(t){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function sk(t,e){let{animation:r}=t;if(!1===r||!1===e)return!1;let n=Object.assign({},sf);return(0,sc.default)(r)&&Object.assign(n,r),(0,sc.default)(e)&&Object.assign(n,e),n}function sN(t,e,r,n){if(Array.isArray(n)){let i=!1,a=[];for(let o=0;o<n.length;o++){let s=n[o];if("translate"===s[0]){if(s[1]===t&&s[2]===e)return null;i=!0,a.push(["translate",t,e])}else if("translate3d"===s[0]){if(s[1]===t&&s[2]===e&&s[3]===r)return null;i=!0,a.push(["translate3d",t,e,r])}else a.push(s)}return i||a.splice(0,0,0===r?["translate",t,e]:["translate3d",t,e,r]),a}let i=n?n.replace(/translate(3d)?\([^)]*\)/g,""):"";return 0===r?`translate(${t}, ${e})${i}`:`translate3d(${t}, ${e}, ${r})${i}`}var sO=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const sT=(t,e,r)=>{let n;if(!r.length)return null;let[i,a]=e,o=e=>{var r;if(!e)return{shape:t,fromStyle:i,toStyle:a};{let n=t.getShape(e);if(!n)return null;let o=`get${sl(e)}Style`,s=(null===(r=null==t?void 0:t[o])||void 0===r?void 0:r.bind(t))||(t=>t);return{shape:n,fromStyle:(null==s?void 0:s(i))||{},toStyle:(null==s?void 0:s(a))||{}}}},s=r.map(t=>{var{fields:e,shape:r,states:i}=t,a=sO(t,["fields","shape","states"]);let s=o(r);if(!s)return null;let{shape:l,fromStyle:u,toStyle:h}=s,d=[{},{}];if(e.forEach(t=>{var e,r;Object.assign(d[0],{[t]:null!==(e=u[t])&&void 0!==e?e:sS(t)}),Object.assign(d[1],{[t]:null!==(r=h[t])&&void 0!==r?r:sS(t)})}),d.some(t=>Object.keys(t).some(t=>["x","y","z"].includes(t)))){let{x:t=0,y:e=0,z:r=0,transform:n=""}=l.attributes||{};d.forEach(i=>{i.transform=sN(i.x||t,i.y||e,i.z||r,n)})}let c=l.animate(s_(d),a);return void 0===r&&(n=c),c}).filter(Boolean),l=n||(null==s?void 0:s[0]);return l?sw(l,s.filter(t=>t!=t)):null},sM=[{fields:["x","y"]}],sA=[{fields:["sourceNode","targetNode"]}],sC=[{fields:["childrenNode","x","y"]}];var sR=y("1uF5a"),sI=y("ky7aH"),sP=Object.prototype.hasOwnProperty,sD=function(t,e){if(!e||!(0,sR.default)(t))return{};for(var r,n={},i=(0,sI.default)(e)?e:function(t){return t[e]},a=0;a<t.length;a++){var o=t[a];r=i(o),sP.call(n,r)?n[r].push(o):n[r]=[o]}return n},sI=y("ky7aH"),sL=function(t,e,r){var n,i,a,o,s=0;r||(r={});var l=function(){s=!1===r.leading?0:Date.now(),n=null,o=t.apply(i,a),n||(i=a=null)},u=function(){var u=Date.now();s||!1!==r.leading||(s=u);var h=e-(u-s);return i=this,a=arguments,h<=0||h>e?(n&&(clearTimeout(n),n=null),s=u,o=t.apply(i,a),n||(i=a=null)):n||!1===r.trailing||(n=setTimeout(l,h)),o};return u.cancel=function(){clearTimeout(n),s=0,n=i=a=null},u},on=y("2eDEB"),sR=y("1uF5a"),sj=function(t){if("object"!=typeof t||null===t)return t;if((0,sR.default)(t)){e=[];for(var e,r=0,n=t.length;r<n;r++)"object"==typeof t[r]&&null!=t[r]?e[r]=sj(t[r]):e[r]=t[r]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=sj(t[i]):e[i]=t[i];return e};function sF(t){return t instanceof Float32Array||!!Array.isArray(t)&&(2===t.length||3===t.length)&&t.every(t=>"number"==typeof t)}function sB(t,e,r){return t>=e&&t<=r}function sz(t=0){if(Array.isArray(t)){let[e=0,r=e,n=e,i=r]=t;return[e,r,n,i]}return[t,t,t,t]}function sV(t){return t.max[0]-t.min[0]}function sG(t){return t.max[1]-t.min[1]}function s$(t){return[sV(t),sG(t)]}function sU(t,e){let r=sF(t)?sH(t):t.getShape("key").getBounds();return e?sW(r,e):r}function sH(t){let[e,r,n=0]=t,i=new on.AABB;return i.setMinMax([e,r,n],[e,r,n]),i}function sW(t,e){let[r,n,i,a]=sz(e),[o,s,l]=t.min,[u,h,d]=t.max,c=new on.AABB;return c.setMinMax([o-a,s-r,l],[u+n,h+i,d]),c}function sq(t){if(0===t.length)return new on.AABB;if(1===t.length)return t[0];let e=new on.AABB;e.setMinMax(t[0].min,t[0].max);for(let r=1;r<t.length;r++){let n=t[r];e.setMinMax([Math.min(e.min[0],n.min[0]),Math.min(e.min[1],n.min[1]),Math.min(e.min[2],n.min[2])],[Math.max(e.max[0],n.max[0]),Math.max(e.max[1],n.max[1]),Math.max(e.max[2],n.max[2])])}return e}function sY(t,e){return sB(t[0],e.min[0],e.max[0])&&sB(t[1],e.min[1],e.max[1])}function sK(t,e,r=!1){let{min:[n,i],max:[a,o]}=e,s=(t[1]===i||t[1]===o)&&(r||sB(t[0],n,a)),l=(t[0]===n||t[0]===a)&&(r||sB(t[1],i,o));return s||l}function sX(t,e){let{center:r}=e;return t[0]===r[0]&&t[1]===r[1]}function sJ(t,e){let[r,n]=t,[i,a]=e.min,[o,s]=e.max,l=r-i,u=o-r,h=n-a,d=s-n,c=Math.min(l,u,h,d);return c===l?"left":c===u?"right":c===h?"top":c===d?"bottom":"left"}function sZ(t,e){let r=sj(t);if(sY(t,e))switch(sJ(t,e)){case"left":r[0]=e.min[0];break;case"right":r[0]=e.max[0];break;case"top":r[1]=e.min[1];break;case"bottom":r[1]=e.max[1]}else{let[n,i]=t,[a,o]=e.min,[s,l]=e.max;r[0]=sB(n,a,s)?n:n<a?a:s,r[1]=sB(i,o,l)?i:i<o?o:l}return r}var sQ=function(t,e){return t===e},s0=function(){function t(t,e){void 0===e&&(e=null),this.value=t,this.next=e}return t.prototype.toString=function(t){return t?t(this.value):"".concat(this.value)},t}(),s1=function(){function t(t){void 0===t&&(t=sQ),this.head=null,this.tail=null,this.compare=t}return t.prototype.prepend=function(t){var e=new s0(t,this.head);return this.head=e,this.tail||(this.tail=e),this},t.prototype.append=function(t){var e=new s0(t);return this.head?this.tail.next=e:this.head=e,this.tail=e,this},t.prototype.delete=function(t){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,t);)e=this.head,this.head=this.head.next;var r=this.head;if(null!==r)for(;r.next;)this.compare(r.next.value,t)?(e=r.next,r.next=r.next.next):r=r.next;return this.compare(this.tail.value,t)&&(this.tail=r),e},t.prototype.find=function(t){var e=t.value,r=void 0===e?void 0:e,n=t.callback,i=void 0===n?void 0:n;if(!this.head)return null;for(var a=this.head;a;){if(i&&i(a.value)||void 0!==r&&this.compare(a.value,r))return a;a=a.next}return null},t.prototype.deleteTail=function(){var t=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,t;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,t},t.prototype.deleteHead=function(){if(!this.head)return null;var t=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),t},t.prototype.fromArray=function(t){var e=this;return t.forEach(function(t){return e.append(t)}),this},t.prototype.toArray=function(){for(var t=[],e=this.head;e;)t.push(e),e=e.next;return t},t.prototype.reverse=function(){for(var t=this.head,e=null,r=null;t;)r=t.next,t.next=e,e=t,t=r;this.tail=this.head,this.head=e},t.prototype.toString=function(t){return void 0===t&&(t=void 0),this.toArray().map(function(e){return e.toString(t)}).toString()},t}();!function(){function t(){this.linkedList=new s1}t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},t.prototype.enqueue=function(t){this.linkedList.append(t)},t.prototype.dequeue=function(){var t=this.linkedList.deleteHead();return t?t.value:null},t.prototype.toString=function(t){return this.linkedList.toString(t)}}();var s2=function(t,e,r){void 0===e&&(e=[]);var n=e.filter(function(e){return e.source===t||e.target===t});return"target"===r?n.filter(function(e){return e.source===t}).map(function(t){return t.target}):"source"===r?n.filter(function(e){return e.target===t}).map(function(t){return t.source}):n.map(function(e){return e.source===t?e.target:e.source})},s3=function(t){var e={},r=t.nodes,n=t.edges;return(void 0===r?[]:r).forEach(function(t){e[t.id]={degree:0,inDegree:0,outDegree:0}}),(void 0===n?[]:n).forEach(function(t){e[t.source].degree++,e[t.source].outDegree++,e[t.target].degree++,e[t.target].inDegree++}),e},s6=y("7WQrb"),s5={}.toString,s4=function(t,e){return s5.call(t)==="[object "+e+"]"},s8=function(t){return s4(t,"Function")},s9=function(t){return Array.isArray?Array.isArray(t):s4(t,"Array")},s7=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e},lt=function(t,e){if(t){if(s9(t))for(var r=0,n=t.length;r<n&&!1!==e(t[r],r);r++);else if(s7(t)){for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break}}},le=Array.prototype;le.splice,le.indexOf,Array.prototype.splice,Object.prototype.hasOwnProperty;var lr=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return lt(t,function(r,n){s8(t)&&"prototype"===n||e.push(r)}),e},ln=function(t){if("object"!=typeof t||null===t)return t;if(s9(t)){e=[];for(var e,r=0,n=t.length;r<n;r++)"object"==typeof t[r]&&null!=t[r]?e[r]=ln(t[r]):e[r]=t[r]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=ln(t[i]):e[i]=t[i];return e};Object.prototype.hasOwnProperty,Object.prototype.hasOwnProperty;var s6=y("7WQrb");!function(t,e){if(!s8(t))throw TypeError("Expected a function");var r=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=e?e.apply(this,n):n[0],o=r.cache;if(o.has(a))return o.get(a);var s=t.apply(this,n);return o.set(a,s),s};r.cache=new Map}(function(t,e){void 0===e&&(e={});var r=e.fontSize,n=e.fontFamily,i=e.fontWeight,a=e.fontStyle,o=e.fontVariant;return yW||(yW=document.createElement("canvas").getContext("2d")),yW.font=[a,o,i,r+"px",n].join(" "),yW.measureText(s4(t,"String")?t:"").width},function(t,e){return void 0===e&&(e={}),(0,s6.__spreadArrays)([t],lr(e)).join("")}),function(){function t(){this.map={}}t.prototype.has=function(t){return void 0!==this.map[t]},t.prototype.get=function(t,e){var r=this.map[t];return void 0===r?e:r},t.prototype.set=function(t,e){this.map[t]=e},t.prototype.clear=function(){this.map={}},t.prototype.delete=function(t){delete this.map[t]},t.prototype.size=function(){return Object.keys(this.map).length}}();var li=function(t,e,r){for(var n,i=1/0,a=0;a<e.length;a++){var o=e[a].id;!r[o]&&t[o]<=i&&(i=t[o],n=e[a])}return n},la=function(t,e,r,n){var i=t.nodes,a=void 0===i?[]:i,o=t.edges,s=void 0===o?[]:o,l=[],u={},h={},d={};a.forEach(function(t,r){var n=t.id;l.push(n),h[n]=1/0,n===e&&(h[n]=0)});for(var c=a.length,f=0;f<c;f++)!function(t){var e=li(h,a,u),i=e.id;if(u[i]=!0,h[i]!==1/0){var o=[];(r?s.filter(function(t){return t.source===i}):s.filter(function(t){return t.source===i||t.target===i})).forEach(function(t){var r=t.target,a=t.source,o=r===i?a:r,s=n&&t[n]?t[n]:1;h[o]>h[e.id]+s?(h[o]=h[e.id]+s,d[o]=[e.id]):h[o]===h[e.id]+s&&d[o].push(e.id)})}}(0);d[e]=[e];var p={};for(var g in h)h[g]!==1/0&&function t(e,r,n,i){if(e===r)return[e];if(i[r])return i[r];for(var a=[],o=0,s=n[r];o<s.length;o++){var l=t(e,s[o],n,i);if(!l)return;for(var u=0;u<l.length;u++){var h=l[u];s9(h)?a.push((0,s6.__spreadArray)((0,s6.__spreadArray)([],h,!0),[r],!1)):a.push([h,r])}}return i[r]=a,i[r]}(e,g,d,p);var y={};for(var g in p)y[g]=p[g][0];return{length:h,path:y,allPath:p}},lo=function(t,e,r,n,i){var a=la(t,e,n,i),o=a.length,s=a.path,l=a.allPath;return{length:o[r],path:s[r],allPath:l[r]}};!function(){function t(t){this.arr=t}t.prototype.getArr=function(){return this.arr||[]},t.prototype.add=function(e){var r,n=e.arr;if(!(null===(r=this.arr)||void 0===r?void 0:r.length))return new t(n);if(!(null==n?void 0:n.length))return new t(this.arr);if(this.arr.length===n.length){var i=[];for(var a in this.arr)i[a]=this.arr[a]+n[a];return new t(i)}},t.prototype.subtract=function(e){var r,n=e.arr;if(!(null===(r=this.arr)||void 0===r?void 0:r.length))return new t(n);if(!(null==n?void 0:n.length))return new t(this.arr);if(this.arr.length===n.length){var i=[];for(var a in this.arr)i[a]=this.arr[a]-n[a];return new t(i)}},t.prototype.avg=function(e){var r=[];if(0!==e)for(var n in this.arr)r[n]=this.arr[n]/e;return new t(r)},t.prototype.negate=function(){var e=[];for(var r in this.arr)e[r]=-this.arr[r];return new t(e)},t.prototype.squareEuclideanDistance=function(t){var e,r=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==r?void 0:r.length))return 0;if(this.arr.length===r.length){var n=0;for(var i in this.arr)n+=Math.pow(this.arr[i]-t.arr[i],2);return n}},t.prototype.euclideanDistance=function(t){var e,r=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==r?void 0:r.length))return 0;if(this.arr.length===r.length){var n=0;for(var i in this.arr)n+=Math.pow(this.arr[i]-t.arr[i],2);return Math.sqrt(n)}console.error("The two vectors are unequal in length.")},t.prototype.normalize=function(){var e=[],r=ln(this.arr);r.sort(function(t,e){return t-e});var n=r[r.length-1],i=r[0];for(var a in this.arr)e[a]=(this.arr[a]-i)/(n-i);return new t(e)},t.prototype.norm2=function(){if(!(null===(t=this.arr)||void 0===t?void 0:t.length))return 0;var t,e=0;for(var r in this.arr)e+=Math.pow(this.arr[r],2);return Math.sqrt(e)},t.prototype.dot=function(t){var e,r=t.arr;if(!(null===(e=this.arr)||void 0===e?void 0:e.length)||!(null==r?void 0:r.length))return 0;if(this.arr.length===r.length){var n=0;for(var i in this.arr)n+=this.arr[i]*t.arr[i];return n}console.error("The two vectors are unequal in length.")},t.prototype.equal=function(t){var e,r=t.arr;if((null===(e=this.arr)||void 0===e?void 0:e.length)!==(null==r?void 0:r.length))return!1;for(var n in this.arr)if(this.arr[n]!==r[n])return!1;return!0}}(),(yq||(yq={})).EuclideanDistance="euclideanDistance",function(){function t(t){this.count=t.length,this.parent={};for(var e=0;e<t.length;e++){var r=t[e];this.parent[r]=r}}t.prototype.find=function(t){for(;this.parent[t]!==t;)t=this.parent[t];return t},t.prototype.union=function(t,e){var r=this.find(t),n=this.find(e);r!==n&&(r<n?(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]):(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]))},t.prototype.connected=function(t,e){return this.find(t)===this.find(e)}}();var ls=function(t,e){return t-e};!function(){function t(t){void 0===t&&(t=ls),this.compareFn=t,this.list=[]}t.prototype.getLeft=function(t){return 2*t+1},t.prototype.getRight=function(t){return 2*t+2},t.prototype.getParent=function(t){return 0===t?null:Math.floor((t-1)/2)},t.prototype.isEmpty=function(){return this.list.length<=0},t.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},t.prototype.delMin=function(){var t=this.top(),e=this.list.pop();return this.list.length>0&&(this.list[0]=e,this.moveDown(0)),t},t.prototype.insert=function(t){if(null!==t){this.list.push(t);var e=this.list.length-1;return this.moveUp(e),!0}return!1},t.prototype.moveUp=function(t){for(var e=this.getParent(t);t&&t>0&&this.compareFn(this.list[e],this.list[t])>0;){var r=this.list[e];this.list[e]=this.list[t],this.list[t]=r,t=e,e=this.getParent(t)}},t.prototype.moveDown=function(t){var e,r=t,n=this.getLeft(t),i=this.getRight(t),a=this.list.length;null!==n&&n<a&&this.compareFn(this.list[r],this.list[n])>0?r=n:null!==i&&i<a&&this.compareFn(this.list[r],this.list[i])>0&&(r=i),t!==r&&(e=[this.list[r],this.list[t]],this.list[t]=e[0],this.list[r]=e[1],this.moveDown(r))}}();var ll=function(t,e,r){"number"!=typeof e&&(e=1e-6),"number"!=typeof r&&(r=.85);for(var n,i=1,a=0,o=1e3,s=t.nodes,l=void 0===s?[]:s,u=t.edges,h=void 0===u?[]:u,d=l.length,c={},f={},p=0;p<d;++p){var g=l[p],y=g.id;c[y]=1/d,f[y]=1/d}for(var v=s3(t);o>0&&i>e;){a=0;for(var p=0;p<d;++p){var g=l[p],y=g.id;if(n=0,0===v[g.id].inDegree)c[y]=0;else{for(var m=s2(y,h,"source"),b=0;b<m.length;++b){var x=m[b],E=v[x].outDegree;E>0&&(n+=f[x]/E)}c[y]=r*n,a+=c[y]}}a=(1-a)/d,i=0;for(var p=0;p<d;++p){var g=l[p],y=g.id;i+=Math.abs((n=c[y]+a)-f[y]),f[y]=n}o-=1}return f},s6=y("7WQrb"),lu=function(t,e,r,n){void 0===t&&(t=-1),void 0===e&&(e=-1),void 0===r&&(r=-1),void 0===n&&(n="-1"),this.id=t,this.from=e,this.to=r,this.label=n},lh=function(){function t(t,e){void 0===t&&(t=-1),void 0===e&&(e="-1"),this.id=t,this.label=e,this.edges=[],this.edgeMap={}}return t.prototype.addEdge=function(t){this.edges.push(t),this.edgeMap[t.id]=t},t}(),ld=function(){function t(t,e,r){void 0===t&&(t=-1),void 0===e&&(e=!0),void 0===r&&(r=!1),this.id=t,this.edgeIdAutoIncrease=e,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=r}return t.prototype.getNodeNum=function(){return this.nodes.length},t.prototype.addNode=function(t,e){if(!this.nodeMap[t]){var r=new lh(t,e);this.nodes.push(r),this.nodeMap[t]=r,this.nodeLabelMap[e]||(this.nodeLabelMap[e]=[]),this.nodeLabelMap[e].push(t)}},t.prototype.addEdge=function(t,e,r,n){if((this.edgeIdAutoIncrease||void 0===t)&&(t=this.counter++),!this.nodeMap[e]||!this.nodeMap[r]||!this.nodeMap[r].edgeMap[t]){var i=new lu(t,e,r,n);if(this.edges.push(i),this.edgeMap[t]=i,this.nodeMap[e].addEdge(i),this.edgeLabelMap[n]||(this.edgeLabelMap[n]=[]),this.edgeLabelMap[n].push(i),!this.directed){var a=new lu(t,r,e,n);this.nodeMap[r].addEdge(a),this.edgeLabelMap[n].push(a)}}},t}(),lc=function(){function t(t,e,r,n,i){this.fromNode=t,this.toNode=e,this.nodeEdgeNodeLabel={nodeLabel1:r||"-1",edgeLabel:n||"-1",nodeLabel2:i||"-1"}}return t.prototype.equalTo=function(t){return this.fromNode===t.formNode&&this.toNode===t.toNode&&this.nodeEdgeNodeLabel===t.nodeEdgeNodeLabel},t.prototype.notEqualTo=function(t){return!this.equalTo(t)},t}(),lf=function(){function t(){this.rmpath=[],this.dfsEdgeList=[]}return t.prototype.equalTo=function(t){var e=this.dfsEdgeList.length;if(e!==t.length)return!1;for(var r=0;r<e;r++)if(this.dfsEdgeList[r]!==t[r])return!1;return!0},t.prototype.notEqualTo=function(t){return!this.equalTo(t)},t.prototype.pushBack=function(t,e,r,n,i){return this.dfsEdgeList.push(new lc(t,e,r,n,i)),this.dfsEdgeList},t.prototype.toGraph=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var r=new ld(t,!0,e);return this.dfsEdgeList.forEach(function(t){var e=t.fromNode,n=t.toNode,i=t.nodeEdgeNodeLabel,a=i.nodeLabel1,o=i.edgeLabel,s=i.nodeLabel2;"-1"!==a&&r.addNode(e,a),"-1"!==s&&r.addNode(n,s),"-1"!==a&&s!==a&&r.addEdge(void 0,e,n,o)}),r},t.prototype.buildRmpath=function(){this.rmpath=[];for(var t=void 0,e=this.dfsEdgeList.length,r=e-1;r>=0;r--){var n=this.dfsEdgeList[r],i=n.fromNode,a=n.toNode;i<a&&(void 0===t||a===t)&&(this.rmpath.push(r),t=i)}return this.rmpath},t.prototype.getNodeNum=function(){var t={};return this.dfsEdgeList.forEach(function(e){t[e.fromNode]||(t[e.fromNode]=!0),t[e.toNode]||(t[e.toNode]=!0)}),Object.keys(t).length},t}(),lp=function(){function t(t){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],t){for(;t;){var e=t.edge;this.edges.push(e),this.nodesUsed[e.from]=1,this.nodesUsed[e.to]=1,this.edgesUsed[e.id]=1,t=t.preNode}this.edges=this.edges.reverse()}}return t.prototype.hasNode=function(t){return 1===this.nodesUsed[t.id]},t.prototype.hasEdge=function(t){return 1===this.edgesUsed[t.id]},t}();function lg(t){if(void 0!==t.id)return t.id;if(void 0!==t.source&&void 0!==t.target)return`${t.source}-${t.target}`;throw Error(sb("The datum does not have available id."))}function ly(t,e){let r={nodes:(t.nodes||[]).map(lg),edges:(t.edges||[]).map(lg),combos:(t.combos||[]).map(lg)};return e?Object.values(r).flat():r}!function(){function t(t){var e=t.graphs,r=t.minSupport,n=t.minNodeNum,i=t.maxNodeNum,a=t.top,o=t.directed,s=t.verbose;this.graphs=e,this.dfsCode=new lf,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=void 0===r?2:r,this.top=void 0===a?10:a,this.directed=void 0!==o&&o,this.counter=0,this.maxNodeNum=void 0===i?4:i,this.minNodeNum=void 0===n?1:n,this.verbose=void 0!==s&&s,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}t.prototype.findForwardRootEdges=function(t,e){var r=this,n=[],i=t.nodeMap;return e.edges.forEach(function(t){(r.directed||e.label<=i[t.to].label)&&n.push(t)}),n},t.prototype.findBackwardEdge=function(t,e,r,n){if(!this.directed&&e===r)return null;for(var i=t.nodeMap,a=i[r.to].edges,o=a.length,s=0;s<o;s++){var l=a[s];if(!n.hasEdge(l)&&l.to===e.from){if(this.directed){if(i[e.from].label<i[r.to].label||i[e.from].label===i[r.to].label&&e.label<=l.label)return l}else if(e.label<l.label||e.label===l.label&&i[e.to].label<=i[r.to].label)return l}}return null},t.prototype.findForwardPureEdges=function(t,e,r,n){for(var i=[],a=e.to,o=t.nodeMap[a].edges,s=o.length,l=0;l<s;l++){var u=o[l],h=t.nodeMap[u.to];r<=h.label&&!n.hasNode(h)&&i.push(u)}return i},t.prototype.findForwardRmpathEdges=function(t,e,r,n){for(var i=[],a=t.nodeMap,o=a[e.to].label,s=a[e.from].edges,l=s.length,u=0;u<l;u++){var h=s[u],d=a[h.to].label;!(e.to===h.to||r>d||n.hasNode(a[h.to]))&&(e.label<h.label||e.label===h.label&&o<=d)&&i.push(h)}return i},t.prototype.getSupport=function(t){var e={};return t.forEach(function(t){e[t.graphId]||(e[t.graphId]=!0)}),Object.keys(e).length},t.prototype.findMinLabel=function(t){var e=void 0;return Object.keys(t).forEach(function(r){var n=t[r],i=n.nodeLabel1,a=n.edgeLabel,o=n.nodeLabel2;if(!e){e={nodeLabel1:i,edgeLabel:a,nodeLabel2:o};return}(i<e.nodeLabel1||i===e.nodeLabel1&&a<e.edgeLabel||i===e.nodeLabel1&&a===e.edgeLabel&&o<e.nodeLabel2)&&(e={nodeLabel1:i,edgeLabel:a,nodeLabel2:o})}),e},t.prototype.isMin=function(){var t=this,e=this.dfsCode;if(this.verbose&&console.log("isMin checking",e),1===e.dfsEdgeList.length)return!0;var r=this.directed,n=e.toGraph(-1,r),i=n.nodeMap,a=new lf,o={};n.nodes.forEach(function(e){t.findForwardRootEdges(n,e).forEach(function(t){var r=i[t.to],a="".concat(e.label,"-").concat(t.label,"-").concat(r.label);o[a]||(o[a]={projected:[],nodeLabel1:e.label,edgeLabel:t.label,nodeLabel2:r.label});var s={graphId:n.id,edge:t,preNode:null};o[a].projected.push(s)})});var s=this.findMinLabel(o);if(s)return a.dfsEdgeList.push(new lc(0,1,s.nodeLabel1,s.edgeLabel,s.nodeLabel2)),function o(s){for(var l=a.buildRmpath(),u=a.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,h=a.dfsEdgeList[l[0]].toNode,d={},c=!1,f=0,p=r?-1:0,g=function(e){if(c)return"break";s.forEach(function(r){var i=new lp(r),o=t.findBackwardEdge(n,i.edges[l[e]],i.edges[l[0]],i);o&&(d[o.label]||(d[o.label]={projected:[],edgeLabel:o.label}),d[o.label].projected.push({graphId:n.id,edge:d,preNode:r}),f=a.dfsEdgeList[l[e]].fromNode,c=!0)})},y=l.length-1;y>p&&"break"!==g(y);y--);if(c){var v=t.findMinLabel(d);a.dfsEdgeList.push(new lc(h,f,"-1",v.edgeLabel,"-1"));var m=a.dfsEdgeList.length-1;return t.dfsCode.dfsEdgeList[m]===a.dfsEdgeList[m]&&o(d[v.edgeLabel].projected)}var b={};c=!1;var x=0;s.forEach(function(e){var r=new lp(e),a=t.findForwardPureEdges(n,r.edges[l[0]],u,r);a.length>0&&(c=!0,x=h,a.forEach(function(t){var r="".concat(t.label,"-").concat(i[t.to].label);b[r]||(b[r]={projected:[],edgeLabel:t.label,nodeLabel2:i[t.to].label}),b[r].projected.push({graphId:n.id,edge:t,preNode:e})}))});for(var E=l.length,y=0;y<E&&"break"!==function(e){if(c)return"break";var r=l[e];s.forEach(function(e){var o=new lp(e),s=t.findForwardRmpathEdges(n,o.edges[r],u,o);s.length>0&&(c=!0,x=a.dfsEdgeList[r].fromNode,s.forEach(function(t){var r="".concat(t.label,"-").concat(i[t.to].label);b[r]||(b[r]={projected:[],edgeLabel:t.label,nodeLabel2:i[t.to].label}),b[r].projected.push({graphId:n.id,edge:t,preNode:e})}))})}(y);y++);if(!c)return!0;var w=t.findMinLabel(b);a.dfsEdgeList.push(new lc(x,h+1,"-1",w.edgeLabel,w.nodeLabel2));var _=a.dfsEdgeList.length-1;return e.dfsEdgeList[_]===a.dfsEdgeList[_]&&o(b["".concat(w.edgeLabel,"-").concat(w.nodeLabel2)].projected)}(o["".concat(s.nodeLabel1,"-").concat(s.edgeLabel,"-").concat(s.nodeLabel2)].projected)},t.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var t=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(ln(t))}},t.prototype.subGraphMining=function(t){var e=this;if(!(this.getSupport(t)<this.minSupport)&&this.isMin()){this.report();var r=this.dfsCode.getNodeNum(),n=this.dfsCode.buildRmpath(),i=this.dfsCode.dfsEdgeList[n[0]].toNode,a=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,o={},s={};t.forEach(function(t){for(var l=e.graphs[t.graphId],u=l.nodeMap,h=new lp(t),d=n.length-1;d>=0;d--){var c=e.findBackwardEdge(l,h.edges[n[d]],h.edges[n[0]],h);if(c){var f="".concat(e.dfsCode.dfsEdgeList[n[d]].fromNode,"-").concat(c.label);s[f]||(s[f]={projected:[],toNodeId:e.dfsCode.dfsEdgeList[n[d]].fromNode,edgeLabel:c.label}),s[f].projected.push({graphId:t.graphId,edge:c,preNode:t})}}if(!(r>=e.maxNodeNum)){e.findForwardPureEdges(l,h.edges[n[0]],a,h).forEach(function(e){var r="".concat(i,"-").concat(e.label,"-").concat(u[e.to].label);o[r]||(o[r]={projected:[],fromNodeId:i,edgeLabel:e.label,nodeLabel2:u[e.to].label}),o[r].projected.push({graphId:t.graphId,edge:e,preNode:t})});for(var p=function(r){e.findForwardRmpathEdges(l,h.edges[n[r]],a,h).forEach(function(i){var a="".concat(e.dfsCode.dfsEdgeList[n[r]].fromNode,"-").concat(i.label,"-").concat(u[i.to].label);o[a]||(o[a]={projected:[],fromNodeId:e.dfsCode.dfsEdgeList[n[r]].fromNode,edgeLabel:i.label,nodeLabel2:u[i.to].label}),o[a].projected.push({graphId:t.graphId,edge:i,preNode:t})})},d=0;d<n.length;d++)p(d)}}),Object.keys(s).forEach(function(t){var r=s[t],n=r.toNodeId,a=r.edgeLabel;e.dfsCode.dfsEdgeList.push(new lc(i,n,"-1",a,"-1")),e.subGraphMining(s[t].projected),e.dfsCode.dfsEdgeList.pop()}),Object.keys(o).forEach(function(t){var r=o[t],n=r.fromNodeId,a=r.edgeLabel,s=r.nodeLabel2;e.dfsCode.dfsEdgeList.push(new lc(n,i+1,"-1",a,s)),e.subGraphMining(o[t].projected),e.dfsCode.dfsEdgeList.pop()})}},t.prototype.generate1EdgeFrequentSubGraphs=function(){var t=this.graphs,e=this.directed,r=this.minSupport,n=this.frequentSize1Subgraphs,i={},a={},o={},s={};return Object.keys(t).forEach(function(r){var n=t[r],l=n.nodeMap;n.nodes.forEach(function(t,n){var u=t.label,h="".concat(r,"-").concat(u);if(!o[h]){var d=i[u]||0;d++,i[u]=d}o[h]={graphKey:r,label:u},t.edges.forEach(function(t){var n=u,i=l[t.to].label;if(!e&&n>i){var o=i;i=n,n=o}var h=t.label,d="".concat(r,"-").concat(n,"-").concat(h,"-").concat(i),c="".concat(n,"-").concat(h,"-").concat(i);if(!a[c]){var f=a[c]||0;f++,a[c]=f}s[d]={graphId:r,nodeLabel1:n,edgeLabel:h,nodeLabel2:i}})})}),Object.keys(i).forEach(function(t){if(!(i[t]<r)){var e={nodes:[],edges:[]};e.nodes.push({id:"0",label:t}),n.push(e)}}),n},t.prototype.run=function(){var t=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var e=this.graphs;this.directed;var r={};Object.keys(e).forEach(function(n){var i=e[n],a=i.nodeMap;i.nodes.forEach(function(e){t.findForwardRootEdges(i,e).forEach(function(t){var i=a[t.to],o="".concat(e.label,"-").concat(t.label,"-").concat(i.label);r[o]||(r[o]={projected:[],nodeLabel1:e.label,edgeLabel:t.label,nodeLabel2:i.label}),r[o].projected.push({graphId:n,edge:t,preNode:null})})})}),Object.keys(r).forEach(function(e){var n=r[e],i=n.projected,a=n.nodeLabel1,o=n.edgeLabel,s=n.nodeLabel2;t.dfsCode.dfsEdgeList.push(new lc(0,1,a,o,s)),t.subGraphMining(i),t.dfsCode.dfsEdgeList.pop()})}}}(),function(){function t(t){void 0===t&&(t=10),this.linkedList=new s1,this.maxStep=t}Object.defineProperty(t.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},t.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},t.prototype.push=function(t){this.linkedList.prepend(t),this.length>this.maxStep&&this.linkedList.deleteTail()},t.prototype.pop=function(){var t=this.linkedList.deleteHead();return t?t.value:null},t.prototype.toArray=function(){return this.linkedList.toArray().map(function(t){return t.value})},t.prototype.clear=function(){for(;!this.isEmpty();)this.pop()}}();const lv=(t,e,r)=>{var n;switch(r.type){case"degree":{let i=new Map;return null===(n=t.nodes)||void 0===n||n.forEach(t=>{let n=e(lg(t),r.direction).length;i.set(lg(t),n)}),i}case"betweenness":return lb(t,r.directed,r.weightPropertyName);case"closeness":return lx(t,r.directed,r.weightPropertyName);case"eigenvector":return lw(t,r.directed);case"pagerank":return lE(t,r.epsilon,r.linkProb);default:return lm(t)}},lm=t=>{var e;let r=new Map;return null===(e=t.nodes)||void 0===e||e.forEach(t=>{r.set(lg(t),0)}),r},lb=(t,e,r)=>{let n=lm(t),{nodes:i=[]}=t;return i.forEach(a=>{i.forEach(i=>{if(a!==i){let{allPath:o}=lo(t,lg(a),lg(i),e,r),s=o.length;o.flat().forEach(t=>{t!==lg(a)&&t!==lg(i)&&n.set(t,n.get(t)+1/s)})}})}),n},lx=(t,e,r)=>{let n=new Map,{nodes:i=[]}=t;return i.forEach(a=>{let o=i.reduce((n,i)=>{if(a!==i){let{length:o}=lo(t,lg(a),lg(i),e,r);n+=o}return n},0);n.set(lg(a),1/o)}),n},lE=(t,e,r)=>{var n;let i=new Map,a=ll(t,e,r);return null===(n=t.nodes)||void 0===n||n.forEach(t=>{i.set(lg(t),a[lg(t)])}),i},lw=(t,e)=>{let{nodes:r=[]}=t,n=lS(l_(t,e),r.length),i=new Map;return r.forEach((t,e)=>{i.set(lg(t),n[e])}),i},l_=(t,e)=>{let{nodes:r=[],edges:n=[]}=t,i=Array(r.length).fill(null).map(()=>Array(r.length).fill(0));return n.forEach(({source:t,target:n})=>{let a=r.findIndex(e=>lg(e)===t),o=r.findIndex(t=>lg(t)===n);e?i[a][o]=1:(i[a][o]=1,i[o][a]=1)}),i},lS=(t,e,r=100,n=1e-6)=>{let i=Array(e).fill(1),a=1/0;for(let o=0;o<r&&a>n;o++){let r=Array(e).fill(0);for(let n=0;n<e;n++)for(let a=0;a<e;a++)r[n]+=t[n][a]*i[a];let n=Math.sqrt(r.reduce((t,e)=>t+e*e,0));for(let t=0;t<e;t++)r[t]/=n;a=Math.sqrt(r.reduce((t,e,r)=>t+(e-i[r])*e,0)),i=r}return i};function lk(t,e,r,n=sd){let i=new Map(t.map(t=>[r(t),t])),a=new Map(e.map(t=>[r(t),t])),o=new Set(i.keys()),s=new Set(a.keys()),l=[],u=[],h=[],d=[];return s.forEach(t=>{o.has(t)?n(i.get(t),a.get(t))?d.push(a.get(t)):u.push(a.get(t)):l.push(a.get(t))}),o.forEach(t=>{s.has(t)||h.push(i.get(t))}),{enter:l,exit:h,keep:d,update:u}}const lN=new WeakMap;function lO(t,e,r=!1,n){if(void 0===e)return;let i=(a,o=e)=>{let s=(t=o)=>a.childNodes.forEach(e=>i(e,t));if(n&&!n(a))return s();if(r||a!==t){lN.has(a)||lN.set(a,a.style.visibility);let t="hidden"===o||"hidden"===(lN.has(a)?lN.get(a):a.style.visibility)?"hidden":"visible";a.style.visibility=t,s(t)}else t.style.visibility=e,lN.delete(t),s(e)};i(t)}class lT{constructor(t){this.extensions=[],this.extensionMap={},this.context=t}setExtensions(t){let e=function(t,e,r){let n={},i=t=>(t in n||(n[t]=0),`${e}-${t}-${n[t]++}`);return r.map(e=>"string"==typeof e?{type:e,key:i(e)}:"function"==typeof e?e.call(t):e.key?e:Object.assign(Object.assign({},e),{key:i(e.type)}))}(this.context.graph,this.category,t),{enter:r,update:n,exit:i,keep:a}=lk(this.extensions,e,t=>t.key);this.createExtensions(r),this.updateExtensions([...n,...a]),this.destroyExtensions(i),this.extensions=e}createExtension(t){let{category:e}=this,{key:r,type:n}=t,i=sm(e,n);if(!i)return sx.warn(`The extension ${n} of ${e} is not registered.`);let a=new i(this.context,t);this.extensionMap[r]=a}createExtensions(t){t.forEach(t=>this.createExtension(t))}updateExtension(t){let{key:e}=t,r=this.extensionMap[e];r&&r.update(t)}updateExtensions(t){t.forEach(t=>this.updateExtension(t))}destroyExtension(t){let e=this.extensionMap[t];e&&(e.destroy(),delete this.extensionMap[t])}destroyExtensions(t){t.forEach(({key:t})=>this.destroyExtension(t))}destroy(){Object.values(this.extensionMap).forEach(t=>t.destroy()),this.context={},this.extensions=[],this.extensionMap={}}}class lM{constructor(t,e){this.events=[],this.destroyed=!1,this.context=t,this.options=e}update(t){this.options=Object.assign(this.options,t)}destroy(){this.context={},this.options={},this.destroyed=!0}}class lA extends lM{}class lC extends lA{constructor(t,e){super(t,Object.assign({},lC.defaultOptions,e)),this.isOverlapping=(t,e)=>e.some(e=>t.intersects(e)),this.occupiedBounds=[],this.detectLabelCollision=t=>{let e=this.context.viewport,r={show:[],hide:[]};return this.occupiedBounds=[],t.forEach(t=>{let n=t.getShape("label").getRenderBounds();e.isInViewport(n,!0)&&!this.isOverlapping(n,this.occupiedBounds)?(r.show.push(t),this.occupiedBounds.push(sW(n,this.options.padding))):r.hide.push(t)}),r},this.hideLabelIfExceedViewport=(t,e)=>{let{exit:r}=lk(t,e,t=>t.id);null==r||r.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(t,e)=>{let{model:r}=this.context,n=r.getData(),i=r.getRelatedEdgesData.bind(r);return t.map(t=>(this.nodeCentralities.has(t.id)||(this.nodeCentralities=lv(n,i,e)),{node:t,centrality:this.nodeCentralities.get(t.id)})).sort((t,e)=>e.centrality-t.centrality).map(t=>t.node)},this.sortLabelElementsInView=t=>{let{sort:e,sortNode:r,sortCombo:n,sortEdge:i}=this.options,{model:a}=this.context;if((0,sI.default)(e))return t.sort((t,r)=>e(a.getElementDataById(t.id),a.getElementDataById(r.id)));let{node:o=[],edge:s=[],combo:l=[]}=sD(t,t=>t.type);return[...(0,sI.default)(n)?l.sort((t,e)=>n(...a.getComboData([t.id,e.id]))):l,...(0,sI.default)(r)?o.sort((t,e)=>r(...a.getNodeData([t.id,e.id]))):this.sortNodesByCentrality(o,r),...(0,sI.default)(i)?s.sort((t,e)=>i(...a.getEdgeData([t.id,e.id]))):s]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=t=>{var e;if((null===(e=t.data)||void 0===e?void 0:e.stage)==="zIndex")return;if(!this.validate(t)){this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear());return}let r=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,r),this.labelElementsInView=r;let n=this.sortLabelElementsInView(this.labelElementsInView),{show:i,hide:a}=this.detectLabelCollision(n);for(let t=i.length-1;t>=0;t--)this.showLabel(i[t]);a.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=t=>{let e=t.getShape("label");e&&lO(e,"hidden"),this.hiddenElements.set(t.id,t)},this.showLabel=t=>{let e=t.getShape("label");e&&lO(e,"visible"),t.toFront(),this.hiddenElements.delete(t.id)},this.onTransform=sL(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=t=>{this.enableToggle&&this.onToggleVisibility(t)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=t=>{this.onToggleVisibility(t),this.enableToggle=!0},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){let{elementMap:t}=this.context.element,e=[];for(let r in t){let n=t[r];n.isVisible()&&n.getShape("label")&&e.push(n)}return e}getLabelElementsInView(){let t=this.context.viewport;return this.getLabelElements().filter(e=>t.isInViewport(e.getShape("key").getRenderBounds()))}bindEvents(){let{graph:t}=this.context;t.on(yG.BEFORE_RENDER,this.onBeforeRender),t.on(yG.AFTER_RENDER,this.onAfterRender),t.on(yG.AFTER_DRAW,this.toggle),t.on(yG.AFTER_LAYOUT,this.toggle),t.on(yG.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){let{graph:t}=this.context;t.off(yG.BEFORE_RENDER,this.onBeforeRender),t.off(yG.AFTER_RENDER,this.onAfterRender),t.off(yG.AFTER_DRAW,this.toggle),t.off(yG.AFTER_LAYOUT,this.toggle),t.off(yG.AFTER_TRANSFORM,this.onTransform)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}lC.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};var on=y("2eDEB"),sR=y("1uF5a"),lR=y("9E5Oj"),lI=function(t){if(!su(t)||!(0,lR.default)(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},lP=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n+=1)!function t(e,r,n,i){for(var a in n=n||0,i=i||5,r)if(function(t,e){if(Object.hasOwn)return Object.hasOwn(t,e);if(null==t)throw TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)}(r,a)){var o=r[a];null!==o&&lI(o)?(lI(e[a])||(e[a]={}),n<i?t(e[a],o,n+1,i):e[a]=r[a]):(0,sR.default)(o)?(e[a]=[],e[a]=e[a].concat(o)):void 0!==o&&(e[a]=o)}}(t,e[n]);return t},sI=y("ky7aH");const lD=[0,0,0];function lL(t,e){return t.map((t,r)=>t+e[r])}function lj(t,e){return t.map((t,r)=>t-e[r])}function lF(t,e){return"number"==typeof e?t.map(t=>t*e):t.map((t,r)=>t*e[r])}function lB(t,e){return"number"==typeof e?t.map(t=>t/e):t.map((t,r)=>t/e[r])}function lz(t,e){return t.map(t=>t*e)}function lV(t,e){return Math.sqrt(t.reduce((t,r,n)=>t+Math.pow(r-e[n]||0,2),0))}function lG(t,e){return t.reduce((t,r,n)=>t+Math.abs(r-e[n]),0)}function l$(t){let e=t.reduce((t,e)=>t+Math.pow(e,2),0);return t.map(t=>t/Math.sqrt(e))}function lU(t,e,r=!1){let n=t[0]*e[1]-t[1]*e[0],i=Math.acos(lF(t,e).reduce((t,e)=>t+e,0)/(lV(t,lD)*lV(e,lD)));return r&&n<0&&(i=2*Math.PI-i),i}function lH(t,e=!0){return e?[-t[1],t[0]]:[t[1],-t[0]]}function lW(t){return[t[0],t[1]]}function lq(t){return 2===t.length?[t[0],t[1],0]:t}function lY(t){let[e,r]=t;return e||r?Math.atan2(r,e):0}function lK(t,e){let[r,n]=t,[i,a]=e;return(function(t,e){let r=lq(t),n=lq(e);return[r[1]*n[2]-r[2]*n[1],r[2]*n[0]-r[0]*n[2],r[0]*n[1]-r[1]*n[0]]})(lj(r,n),lj(i,a)).every(t=>0===t)}function lX(t,e,r=!1){if(lK(t,e))return;let[n,i]=t,[a,o]=e,s=((n[0]-a[0])*(a[1]-o[1])-(n[1]-a[1])*(a[0]-o[0]))/((n[0]-i[0])*(a[1]-o[1])-(n[1]-i[1])*(a[0]-o[0])),l=o[0]-a[0]?(n[0]-a[0]+s*(i[0]-n[0]))/(o[0]-a[0]):(n[1]-a[1]+s*(i[1]-n[1]))/(o[1]-a[1]);if(r||sB(s,0,1)&&sB(l,0,1))return[n[0]+s*(i[0]-n[0]),n[1]+s*(i[1]-n[1])]}function lJ(t){if(Array.isArray(t))return sB(t[0],0,1)&&sB(t[1],0,1)?t:[.5,.5];let e=t.split("-");return[e.includes("left")?0:e.includes("right")?1:.5,e.includes("top")?0:e.includes("bottom")?1:.5]}function lZ(t){let{x:e=0,y:r=0,z:n=0}=t.style||{};return[+e,+r,+n]}function lQ(t){let{x:e,y:r,z:n}=t.style||{};return void 0!==e||void 0!==r||void 0!==n}function l0(t,e="center"){return function(t,e){let[r,n]=e,{min:i,max:a}=t;return[i[0]+r*(a[0]-i[0]),i[1]+n*(a[1]-i[1])]}(t,lJ(e))}function l1(t){var e;return[t.x,t.y,null!==(e=t.z)&&void 0!==e?e:0]}function l2(t){var e;return{x:t[0],y:t[1],z:null!==(e=t[2])&&void 0!==e?e:0}}function l3(t,e=0){return t.map(t=>parseFloat(t.toFixed(e)))}function l6(t,e,r,n=!1){if(sd(t,e))return t;let i=l$(n?lj(t,e):lj(e,t)),a=[i[0]*r,i[1]*r];return lL(lW(t),a)}function l5(t,e){return[2*e[0]-t[0],2*e[1]-t[1]]}function l4(t,e,r,n=!0,i=!1){for(let a=0;a<r.length;a++){let o=r[a],s=r[(a+1)%r.length];n&&(o=lL(e,o),s=lL(e,s));let l=i?l5(t,e):t,u=lX([e,l],[o,s]);if(u)return{point:u,line:[o,s]}}return{point:e,line:void 0}}function l8(t,e,r=!1){let n=e.center,i=lj(r?l5(t,n):t,e.center),a=Math.atan2(i[1],i[0]);if(isNaN(a))return n;let o=sV(e)/2,s=sG(e)/2;return[n[0]+o*Math.cos(a),n[1]+s*Math.sin(a)]}function l9(t,e){let[r,n]=e[0],[i,a]=e[1],[o,s]=t,l=i-r,u=a-n;if(0===l&&0===u)return[r,n];let h=((o-r)*l+(s-n)*u)/(l*l+u*u);return h>1?h=1:h<0&&(h=0),[r+h*l,n+h*u]}function l7(t,e=!0){let r=lB(t.reduce((t,e)=>lL(t,e),[0,0]),t.length);return t.sort(([t,n],[i,a])=>{let o=Math.atan2(n-r[1],t-r[0]),s=Math.atan2(a-r[1],i-r[0]);return e?s-o:o-s})}function ut(t,e){return[t,[t[0],e[1]],e,[e[0],t[1]]]}var ou=y("kVcyu");const ue=t=>t.map(t=>(0,ou.default)(t)?t.toLocaleLowerCase():t);class ur{constructor(t){this.map=new Map,this.recordKey=new Set,this.onKeyDown=t=>{(null==t?void 0:t.key)&&(this.recordKey.add(t.key),this.trigger(t))},this.onKeyUp=t=>{(null==t?void 0:t.key)&&this.recordKey.delete(t.key)},this.onWheel=t=>{this.triggerExtendKey(yB.WHEEL,t)},this.onDrag=t=>{this.triggerExtendKey(yB.DRAG,t)},this.onFocus=()=>{this.recordKey.clear()},this.emitter=t,this.bindEvents()}bind(t,e){0!==t.length&&this.map.set(t,e)}unbind(t,e){this.map.forEach((r,n)=>{sd(n,t)&&(!e||e===r)&&this.map.delete(n)})}unbindAll(){this.map.clear()}match(t){return sd(ue(Array.from(this.recordKey)).sort(),ue(t).sort())}bindEvents(){var t;let{emitter:e}=this;e.on(yB.KEY_DOWN,this.onKeyDown),e.on(yB.KEY_UP,this.onKeyUp),e.on(yB.WHEEL,this.onWheel),e.on(yB.DRAG,this.onDrag),null===(t=globalThis.addEventListener)||void 0===t||t.call(globalThis,"focus",this.onFocus)}trigger(t){this.map.forEach((e,r)=>{this.match(r)&&e(t)})}triggerExtendKey(t,e){this.map.forEach((r,n)=>{n.includes(t)&&sd(Array.from(this.recordKey),n.filter(e=>e!==t))&&r(e)})}destroy(){var t;this.unbindAll(),this.emitter.off(yB.KEY_DOWN,this.onKeyDown),this.emitter.off(yB.KEY_UP,this.onKeyUp),this.emitter.off(yB.WHEEL,this.onWheel),this.emitter.off(yB.DRAG,this.onDrag),null===(t=globalThis.removeEventListener)||void 0===t||t.call(globalThis,"blur",this.onFocus)}}class un extends lA{constructor(t,e){super(t,lP({},un.defaultOptions,e)),this.shortcut=new ur(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;let{canvas:e,graph:r}=this.context,n=Object.assign({},this.options.style);this.options.style.lineWidth&&(n.lineWidth=+this.options.style.lineWidth/r.getZoom()),this.rectShape=new on.Rect({id:"g6-brush-select",style:n}),e.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var e;if(!this.startPoint)return;let{immediately:r,mode:n}=this.options;this.endPoint=ui(t),null===(e=this.rectShape)||void 0===e||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),r&&"default"===n&&this.updateElementsStates(ut(this.startPoint,this.endPoint))}onPointerUp(t){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=ui(t),this.updateElementsStates(ut(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){let{graph:t}=this.context,e=Object.values(t.getData()).reduce((t,e)=>Object.assign({},t,e.reduce((t,e)=>(t[lg(e)]=[],t),{})),{});t.setElementState(e,this.options.animation)}updateElementsStates(t){let{graph:e}=this.context,{enableElements:r,state:n,mode:i,onSelect:a}=this.options,o=this.selector(e,t,r),s={};switch(i){case"union":o.forEach(t=>{s[t]=[...e.getElementState(t),n]});break;case"diff":o.forEach(t=>{let r=e.getElementState(t);s[t]=r.includes(n)?r.filter(t=>t!==n):[...r,n]});break;case"intersect":o.forEach(t=>{let r=e.getElementState(t);s[t]=r.includes(n)?[n]:[]});break;default:o.forEach(t=>{s[t]=[n]})}(0,sI.default)(a)&&(s=a(s)),e.setElementState(s,this.options.animation)}selector(t,e,r){if(!r||0===r.length)return[];let n=[],i=t.getData();if(r.forEach(r=>{i[`${r}s`].forEach(r=>{let i=lg(r);"hidden"!==t.getElementVisibility(i)&&function(t,e,r,n){let i=t[0],a=t[1],o=!1;void 0===r&&(r=0),void 0===n&&(n=e.length);let s=n-r;for(let t=0,n=s-1;t<s;n=t++){let s=e[t+r][0],l=e[t+r][1],u=e[n+r][0],h=e[n+r][1];l>a!=h>a&&i<(u-s)*(a-l)/(h-l)+s&&(o=!o)}return o}(t.getElementPosition(i),e)&&n.push(i)})}),r.includes("edge")){let t=i.edges;null==t||t.forEach(t=>{let{source:e,target:r}=t;n.includes(e)&&n.includes(r)&&n.push(lg(t))})}return n}clearBrush(){var t;null===(t=this.rectShape)||void 0===t||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){let{trigger:t}=this.options,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter(t=>"drag"!==t))}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}bindEvents(){let{graph:t}=this.context;t.on(yB.POINTER_DOWN,this.onPointerDown),t.on(yB.POINTER_MOVE,this.onPointerMove),t.on(yB.POINTER_UP,this.onPointerUp),t.on(yj.CLICK,this.clearStates)}unbindEvents(){let{graph:t}=this.context;t.off(yB.POINTER_DOWN,this.onPointerDown),t.off(yB.POINTER_MOVE,this.onPointerMove),t.off(yB.POINTER_UP,this.onPointerUp),t.off(yj.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=lP(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}un.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const ui=t=>[t.canvas.x,t.canvas.y];var sI=y("ky7aH");const ua=["node","edge","combo"];function uo(t,e,r,n,i=0){"TB"===n&&e(t,i);let a=r(t);if(a)for(let t of a)uo(t,e,r,n,i+1);"BT"===n&&e(t,i)}function us(t,e,r,n,i="both"){if("combo"===e||"node"===e)return ul(t,r,n,i);let a=t.getEdgeData(r);return a?Array.from(new Set([...ul(t,a.source,n-1,i),...ul(t,a.target,n-1,i),r])):[]}function ul(t,e,r,n="both"){let i=new Set,a=new Set,o=new Set;return!function(t,e,r){let n=[[t,0]];for(;n.length;){let[t,i]=n.shift();e(t,i);let a=r(t);if(a)for(let t of a)n.push([t,i+1])}}(e,(e,i)=>{i>r||(o.add(e),t.getRelatedEdgesData(e,n).forEach(t=>{let e=lg(t);!a.has(e)&&i<r&&(o.add(e),a.add(e))}))},e=>t.getRelatedEdgesData(e,n).map(t=>t.source===e?t.target:t.source).filter(t=>!i.has(t)&&(i.add(t),!0))),Array.from(o)}function uu(t){return t.states||[]}var uh=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class ud extends lA{constructor(t,e){super(t,Object.assign({},ud.defaultOptions,e)),this.onClickSelect=t=>uh(this,void 0,void 0,function*(){var e,r;this.validate(t)&&(yield this.updateState(t),null===(r=(e=this.options).onClick)||void 0===r||r.call(e,t))}),this.onClickCanvas=t=>uh(this,void 0,void 0,function*(){var e,r;this.validate(t)&&(yield this.clearState(),null===(r=(e=this.options).onClick)||void 0===r||r.call(e,t))}),this.shortcut=new ur(t.graph),this.bindEvents()}bindEvents(){let{graph:t}=this.context;this.unbindEvents(),ua.forEach(e=>{t.on(`${e}:${yB.CLICK}`,this.onClickSelect)}),t.on(yj.CLICK,this.onClickCanvas)}get isMultipleSelect(){let{multiple:t,trigger:e}=this.options;return t&&this.shortcut.match(e)}getNeighborIds(t){let{target:e,targetType:r}=t,{graph:n}=this.context,{degree:i}=this.options;return us(n,r,e.id,"function"==typeof i?i(t):i).filter(t=>t!==e.id)}updateState(t){return uh(this,void 0,void 0,function*(){let{state:e,unselectedState:r,neighborState:n,animation:i}=this.options;if(!e&&!n&&!r)return;let{target:a}=t,{graph:o}=this.context,s=uu(o.getElementData(a.id)).includes(e)?"unselect":"select",l={},u=this.isMultipleSelect,h=[a.id],d=this.getNeighborIds(t);if(u){if(Object.assign(l,this.getDataStates()),"select"===s){let t=(t,e)=>{t.forEach(t=>{let n=new Set(o.getElementState(t));n.add(e),n.delete(r),l[t]=Array.from(n)})};t(h,e),t(d,n),r&&Object.keys(l).forEach(t=>{let i=l[t];i.includes(e)||i.includes(n)||i.includes(r)||l[t].push(r)})}else{let t=l[a.id];l[a.id]=t.filter(t=>t!==e&&t!==n),t.includes(r)||l[a.id].push(r),d.forEach(t=>{l[t]=l[t].filter(t=>t!==n),l[t].includes(e)||l[t].push(r)})}}else if("select"===s){Object.assign(l,this.getClearStates(!!r));let t=(t,e)=>{t.forEach(t=>{l[t]||(l[t]=o.getElementState(t)),l[t].push(e)})};t(h,e),t(d,n),r&&Object.keys(l).forEach(t=>{h.includes(t)||d.includes(t)||l[t].push(r)})}else Object.assign(l,this.getClearStates());yield o.setElementState(l,i)})}getDataStates(){let{graph:t}=this.context,{nodes:e,edges:r,combos:n}=t.getData(),i={};return[...e,...r,...n].forEach(t=>{i[lg(t)]=uu(t)}),i}getClearStates(t=!1){let{graph:e}=this.context,{state:r,unselectedState:n,neighborState:i}=this.options,a=new Set([r,n,i]),{nodes:o,edges:s,combos:l}=e.getData(),u={};return[...o,...s,...l].forEach(e=>{let r=uu(e),n=r.filter(t=>!a.has(t));t?u[lg(e)]=n:n.length!==r.length&&(u[lg(e)]=n)}),u}clearState(){return uh(this,void 0,void 0,function*(){let{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)})}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;ua.forEach(e=>{t.off(`${e}:${yB.CLICK}`,this.onClickSelect)}),t.off(yj.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}ud.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};var sI=y("ky7aH");function uc(t){var e;return!!(null===(e=t.style)||void 0===e?void 0:e.collapsed)}var ou=y("kVcyu"),uf=function(t,e,r){for(var n=0,i=(0,ou.default)(e)?e.split("."):e;t&&n<i.length;)t=t[i[n++]];return void 0===t||n<i.length?r:t},ou=y("kVcyu"),sc=y("6JKSc"),ou=y("kVcyu"),ol=y("jyI49"),up=function(t,e,r){var n=t,i=(0,ou.default)(e)?e.split("."):e;return i.forEach(function(t,e){e<i.length-1?((0,sc.default)(n[t])||(n[t]=(0,ol.default)(i[e+1])?[]:{}),n=n[t]):n[t]=r}),t},on=y("2eDEB"),sI=y("ky7aH"),ug=function(t){var e=ss(t);return e.charAt(0).toLowerCase()+e.substring(1)};function uy(t,e){if(!t.startsWith(e))return!1;let r=t[e.length];return r>="A"&&r<="Z"}function uv(t,e){let r=Object.entries(t).reduce((t,[r,n])=>("className"===r||"class"===r||uy(r,e)&&Object.assign(t,{[function(t,e,r=!0){if(!e||!uy(t,e))return t;let n=t.slice(e.length);return r?ug(n):n}(r,e)]:n}),t),{});if("opacity"in t){var n;let i=(n="opacity",`${e}${sl(n)}`),a=t.opacity;i in t?Object.assign(r,{opacity:a*t[i]}):Object.assign(r,{opacity:a})}return r}function um(t,e){let r=e.length;return Object.keys(t).reduce((n,i)=>(i.startsWith(e)&&(n[i.slice(r)]=t[i]),n),{})}function ub(t,e){let r="string"==typeof e?[e]:e,n={};return Object.keys(t).forEach(e=>{r.find(t=>e.startsWith(t))||(n[e]=t[e])}),n}function ux(t=0){if("number"==typeof t)return[t,t,t];let[e,r=e,n=e]=t;return[e,r,n]}var uE=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};function uw(t,e){let{datum:r,graph:n}=e;return"function"==typeof t?t.call(n,r):Object.fromEntries(Object.entries(t).map(([t,e])=>"function"==typeof e?[t,e.call(n,r)]:[t,e]))}function u_(t,e){let r=(null==t?void 0:t.style)||{},n=(null==e?void 0:e.style)||{};return Object.assign({},t,e,{style:(null==t?void 0:t.style)?Object.assign({},r,n):n})}const uS=new WeakMap;function uk(t,e,r){uS.has(t)||uS.set(t,{});let n=uS.get(t);return n[e]?!uN(n[e],r)&&(n[e]=r,!0):(n[e]=r,!0)}const uN=(t,e,r=2)=>{if("object"!=typeof t||"object"!=typeof e)return t===e;let n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(let i of n){let n=t[i],a=e[i];if(r>1&&"object"==typeof n&&"object"==typeof a){if(!uN(n,a,r-1))return!1}else if(n!==a)return!1}return!0};function uO(t){if(t)return"string"==typeof t||"function"==typeof t||Array.isArray(t)?{type:"group",field:t=>t.id,color:t,invert:!1}:t}function uT(t){let e="string"==typeof t?sm("palette",t):t;if("function"!=typeof e)return e}function uM(t,e){let r=2*t;return"string"==typeof e?r=t*Number(e.replace("%",""))/100:"number"==typeof e&&(r=e),isNaN(r)&&(r=2*t),r}function uA(t,e,r=1,n=!1){return uM((t.max[0]-t.min[0])*(n?r:1),e)}var on=(y("2eDEB"),y("2eDEB")),o_=y("geZBG"),uC={}.toString,uR=Object.prototype,uI=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||uR)},uP=Object.prototype.hasOwnProperty,uD=function(t){if((0,o_.default)(t))return!0;if(sh(t))return!t.length;var e=uC.call(t).replace(/^\[object /,"").replace(/]$/,"");if("Map"===e||"Set"===e)return!t.size;if(uI(t))return!Object.keys(t).length;for(var r in t)if(uP.call(t,r))return!1;return!0},sI=y("ky7aH");class uL extends on.CustomElement{constructor(t){super(t),this.shapeMap={},this.animateMap={},this.transformPosition(this.attributes),this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(t,e,r,n,i){var a,o,s,l,u,h,d,c;let f=this.shapeMap[t];if(!1===r){f&&(null===(a=null==i?void 0:i.beforeDestroy)||void 0===a||a.call(i,f),n.removeChild(f),delete this.shapeMap[t],null===(o=null==i?void 0:i.afterDestroy)||void 0===o||o.call(i,f));return}let p="string"==typeof e?sm(yH.SHAPE,e):e;if(!p)throw Error(sb(`Shape ${e} not found`));if(!f||f.destroyed||!(f instanceof p)){f&&(null===(s=null==i?void 0:i.beforeDestroy)||void 0===s||s.call(i,f),null==f||f.destroy(),null===(l=null==i?void 0:i.afterDestroy)||void 0===l||l.call(i,f)),null===(u=null==i?void 0:i.beforeCreate)||void 0===u||u.call(i);let e=new p({className:t,style:r});return n.appendChild(e),this.shapeMap[t]=e,null===(h=null==i?void 0:i.afterCreate)||void 0===h||h.call(i,e),e}return null===(d=null==i?void 0:i.beforeUpdate)||void 0===d||d.call(i,f),cy(f,r),null===(c=null==i?void 0:i.afterUpdate)||void 0===c||c.call(i,f),f}transformPosition(t){if("x"in t||"y"in t||"z"in t){let{x:e=0,y:r=0,z:n=0,transform:i}=t,a=sN(+e,+r,+n,i);a&&(this.style.transform=a)}}update(t={}){let e=Object.assign({},this.attributes,t);this.attr(e),this.render(e,this),this.transformPosition(e),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return function(t){let{x:e,y:r,z:n,class:i,className:a,transform:o,transformOrigin:s,zIndex:l,visibility:u}=t;return uE(t,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,e){if(0===t.length)return null;let r=[];if(void 0!==t[0].x||void 0!==t[0].y||void 0!==t[0].z){let{x:e=0,y:r=0,z:n=0}=this.attributes;t.forEach(t=>{let{x:i=e,y:a=r,z:o=n}=t;Object.assign(t,{transform:o?[["translate3d",i,a,o]]:[["translate",i,a]]})})}let n=super.animate(t,e);if(n&&(uj(this,n),r.push(n)),Array.isArray(t)&&t.length>0){let n=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(t=>!n.includes(t))){Object.entries(this.shapeMap).forEach(([n,i])=>{let a=this[`get${sl(n)}Style`];if((0,sI.default)(a)){let n=t.map(t=>a.call(this,Object.assign(Object.assign({},this.attributes),t))),o=i.animate(s_(n),e);o&&(uj(i,o),r.push(o))}});let n=(n,i)=>{if(!uD(n)){let a=this[`get${sl(i)}Style`];if((0,sI.default)(a)){let i=t.map(t=>a.call(this,Object.assign(Object.assign({},this.attributes),t)));Object.entries(i[0]).map(([t])=>{let a=i.map(e=>e[t]),o=n[t];if(o){let t=o.animate(s_(a),e);t&&(uj(o,t),r.push(t))}})}}};this.compositeShapes.forEach(([t,e])=>{n(um(this.shapeMap,e),t)})}}return sw(r)}getShape(t){return this.shapeMap[t]}setVisibility(){let{visibility:t}=this.attributes;lO(this,t,!0)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function uj(t,e){null==e||e.finished.then(()=>{let r=t.activeAnimations.findIndex(t=>t===e);r>-1&&t.activeAnimations.splice(r,1)})}var on=y("2eDEB"),uF=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class uB extends uL{constructor(t){super(u_({style:uB.defaultStyleProps},t))}isTextStyle(t){return uy(t,"label")}isBackgroundStyle(t){return uy(t,"background")}getTextStyle(t){let e=this.getGraphicStyle(t),{padding:r}=e;return ub(uF(e,["padding"]),"background")}getBackgroundStyle(t){if(!1===t.background)return!1;let e=this.getGraphicStyle(t),{wordWrap:r,wordWrapWidth:n,padding:i}=e,a=uv(e,"background"),{min:[o,s],center:[l,u],halfExtents:[h,d]}=this.shapeMap.text.getGeometryBounds(),[c,f,p,g]=sz(i),y=2*h+g+f,{width:v,height:m}=a;v&&m?Object.assign(a,{x:l-Number(v)/2,y:u-Number(m)/2}):Object.assign(a,{x:o-g,y:s-c,width:r?Math.min(y,n+g+f):y,height:2*d+c+p});let{radius:b}=a;if("string"==typeof b&&b.endsWith("%")){let t=Number(b.replace("%",""))/100;a.radius=Math.min(+a.width,+a.height)*t}return a}render(t=this.parsedAttributes,e=this){this.upsert("text",on.Text,this.getTextStyle(t),e),this.upsert("background",on.Rect,this.getBackgroundStyle(t),e)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}uB.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class uz extends uL{constructor(t){super(u_({style:uz.defaultStyleProps},t))}getBadgeStyle(t){return this.getGraphicStyle(t)}render(t=this.parsedAttributes,e=this){this.upsert("label",uB,this.getBadgeStyle(t),e)}getGeometryBounds(){let t=this.getShape("label");return(t.getShape("background")||t.getShape("text")).getGeometryBounds()}}uz.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};var on=y("2eDEB");const uV={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]},uG=t=>{if(t.length<2)return[["M",0,0],["L",0,0]];let e=t[0],r=t[1],n=t[t.length-1],i=t[t.length-2];t.unshift(i,n),t.push(e,r);let a=[["M",n[0],n[1]]];for(let e=1;e<t.length-2;e+=1){let[r,n]=t[e-1],[i,o]=t[e],[s,l]=t[e+1],[u,h]=e!==t.length-2?t[e+2]:[s,l],d=i+(s-r)/6,c=o+(l-n)/6,f=s-(u-i)/6,p=l-(h-o)/6;a.push(["C",d,c,f,p,s,l])}return a};var u$=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class uU extends uL{constructor(t){super(u_({style:uU.defaultStyleProps},t))}getLabelStyle(t){if(!t.label||!t.d||0===t.d.length)return!1;let e=uv(this.getGraphicStyle(t),"label"),{maxWidth:r,offsetX:n,offsetY:i,autoRotate:a,placement:o,closeToPath:s}=e,l=u$(e,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),u=this.shapeMap.key,h=null==u?void 0:u.getRenderBounds();return Object.assign(function(t,e,r,n,i,a,o){var s;let l,u;let[h,d]=l0(t,e),c={textAlign:"left"===e?"right":"right"===e?"left":"center",textBaseline:"top"===e?"bottom":"bottom"===e?"top":"middle",transform:[["translate",h+r,d+n]]};if("center"===e||!i)return c;let f=function(t){let e=[];return("string"==typeof t?function(t){let e=t.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),r=[],n="",i={};for(;e.length>0;){let t=e.shift();t in uV?n=t:e.unshift(t),i={type:n},uV[n].forEach(r=>{t=e.shift(),i[r]=t}),"M"===n?n="L":"m"===n&&(n="l");let[a,...o]=Object.values(i);r.push([a,...o.map(Number)])}return r}(t):t).forEach(t=>{let r=t[0];if("Z"===r){e.push(e[0]);return}if("A"!==r)for(let r=1;r<t.length;r+=2)e.push([t[r],t[r+1],0]);else{let r=t.length;e.push([t[r-2],t[r-1],0])}}),e}(a);if(!f||f.length<=3)return c;let p=f.map((t,e)=>{let r=f[(e+1)%f.length];return sd(t,r)?null:[t,r]}).filter(Boolean),g=(s=[h,d],l=1/0,u=[[0,0],[0,0]],p.forEach(t=>{let e=function(t,e){let r=l9(t,e);return lV(t,r)}(s,t);e<l&&(l=e,u=t)}),u),y=l9([h,d],g);if(y&&g&&(c.transform=[["translate",y[0]+r,y[1]+n]],o)){let t=Math.atan((g[0][1]-g[1][1])/(g[0][0]-g[1][0]));c.transform.push(["rotate",t/Math.PI*180]),c.textAlign="center",("right"===e||"left"===e)&&(t>0?c.textBaseline="right"===e?"bottom":"top":c.textBaseline="right"===e?"top":"bottom")}return c}(h,o,n,i,s,t.d,a),{wordWrapWidth:uA(h,r)},l)}getKeyStyle(t){return this.getGraphicStyle(t)}render(t,e){this.upsert("key",on.Path,this.getKeyStyle(t),e),this.upsert("label",uB,this.getLabelStyle(t),e)}}uU.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};var on=(y("2eDEB"),y("2eDEB"));class uH extends on.Image{constructor(t){super(t),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},uq=this,this.isMutationObserved=!0,this.addEventListener(on.ElementEvent.MOUNTED,this.onMounted),this.addEventListener(on.ElementEvent.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){let{radius:t,clipPath:e,width:r=0,height:n=0}=this.attributes;if(t&&r&&n){let[i,a]=this.getBounds().min,o={x:i,y:a,radius:t,width:r,height:n};if(e)Object.assign(this.parsedStyle.clipPath.style,o);else{let t=new on.Rect({style:o});this.style.clipPath=t}}else e&&(this.style.clipPath=null)}}const uW=new WeakMap;let uq=null;const uY=t=>{if(uq&&(function(t){let e=[],r=t.parentNode;for(;r;)e.push(r),r=r.parentNode;return e})(uq).includes(t)){let e=uW.get(t);e?e.includes(uq)||e.push(uq):uW.set(t,[uq])}},uK=t=>{let e=uW.get(t);e&&e.forEach(t=>t.handleRadius())};class uX extends uL{constructor(t){super(t)}isImage(){let{src:t}=this.attributes;return!!t}getIconStyle(t=this.attributes){let{width:e=0,height:r=0}=t,n=this.getGraphicStyle(t);return this.isImage()?Object.assign({x:-e/2,y:-r/2},n):Object.assign({textBaseline:"middle",textAlign:"center"},n)}render(t=this.attributes,e=this){this.upsert("icon",this.isImage()?uH:on.Text,this.getIconStyle(t),e)}}class uJ extends uL{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(t,e){let r=super.animate(t,e);return r&&(r.onframe=()=>this.onframe(),r.finished.then(()=>this.onframe())),r}}var uZ=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class uQ extends uJ{constructor(t){super(u_({style:uQ.defaultStyleProps},t)),this.type="node"}getSize(t=this.attributes){let{size:e}=t;return ux(e)}getKeyStyle(t){return Object.assign(ub(this.getGraphicStyle(t),["label","halo","icon","badge","port"]))}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;let e=uv(this.getGraphicStyle(t),"label"),{placement:r,maxWidth:n,offsetX:i,offsetY:a}=e,o=uZ(e,["placement","maxWidth","offsetX","offsetY"]),s=this.getShape("key").getLocalBounds();return Object.assign(cg(s,r,i,a),{wordWrapWidth:uA(s,n)},o)}getHaloStyle(t){if(!1===t.halo)return!1;let e=this.getKeyStyle(t),{fill:r}=e,n=uZ(e,["fill"]),i=uv(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign(Object.assign({},n),{stroke:r}),i)}getIconStyle(t){if(!1===t.icon||!t.iconText&&!t.iconSrc)return!1;let e=uv(this.getGraphicStyle(t),"icon");return Object.assign(function(t,e){let r=ux(t),n={};return e.text&&!e.fontSize&&(n={fontSize:.5*Math.min(...r)}),!e.src||e.width&&e.height||(n={width:.5*r[0],height:.5*r[1]}),n}(t.size,e),e)}getBadgesStyle(t){var e;let r=um(this.shapeMap,"badge-"),n={};if(Object.keys(r).forEach(t=>{n[t]=!1}),!1===t.badge||!(null===(e=t.badges)||void 0===e?void 0:e.length))return n;let{badges:i=[],badgePalette:a,opacity:o=1}=t,s=uZ(t,["badges","badgePalette","opacity"]),l=uT(a),u=uv(this.getGraphicStyle(s),"badge");return i.forEach((t,e)=>{n[e]=Object.assign(Object.assign({backgroundFill:l?l[e%(null==l?void 0:l.length)]:void 0,opacity:o},u),this.getBadgeStyle(t))}),n}getBadgeStyle(t){let e=this.getShape("key"),{placement:r="top",offsetX:n,offsetY:i}=t,a=uZ(t,["placement","offsetX","offsetY"]);return Object.assign(Object.assign({},cg(e.getLocalBounds(),r,n,i,!0)),a)}getPortsStyle(t){var e;let r=this.getPorts(),n={};if(Object.keys(r).forEach(t=>{n[t]=!1}),!1===t.port||!(null===(e=t.ports)||void 0===e?void 0:e.length))return n;let i=uv(this.getGraphicStyle(t),"port"),{ports:a=[]}=t;return a.forEach((e,r)=>{let a=e.key||r,o=Object.assign(Object.assign({},i),e);if(cu(o))n[a]=!1;else{let[r,i]=this.getPortXY(t,e);n[a]=Object.assign({transform:[["translate",r,i]]},o)}}),n}getPortXY(t,e){let{placement:r="left"}=e,n=this.getShape("key");return cs(function(t,e){if(!t)return e.getLocalBounds();let r=t.canvas.getLayer(),n=e.cloneNode();lO(n,"hidden"),r.appendChild(n);let i=n.getLocalBounds();return n.destroy(),i}(this.context,n),r)}getPorts(){return um(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t,e=!1){return function(t,e,r=!1){return l4(t,l0(e,"center"),[l0(e,"left-top"),l0(e,"right-top"),l0(e,"right-bottom"),l0(e,"left-bottom")],!1,r).point}(t,this.getShape("key").getBounds(),e)}drawHaloShape(t,e){let r=this.getHaloStyle(t);if(!uk(this,"halo",r))return;let n=this.getShape("key");this.upsert("halo",n.constructor,r,e)}drawIconShape(t,e){let r=this.getIconStyle(t);uk(this,"icon",r)&&(this.upsert("icon",uX,r,e),uY(this))}drawBadgeShapes(t,e){let r=this.getBadgesStyle(t);Object.keys(r).forEach(t=>{let n=r[t];uk(this,`badge-${t}`,n)&&this.upsert(`badge-${t}`,uz,n,e)})}drawPortShapes(t,e){let r=this.getPortsStyle(t);Object.keys(r).forEach(t=>{let n=r[t],i=`port-${t}`;uk(this,i,n)&&this.upsert(i,on.Circle,n,e)})}drawLabelShape(t,e){let r=this.getLabelStyle(t);uk(this,"label",r)&&this.upsert("label",uB,r,e)}_drawKeyShape(t,e){return this.drawKeyShape(t,e)}render(t=this.parsedAttributes,e=this){this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&uK(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}uQ.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};var on=y("2eDEB");class u0 extends uQ{constructor(t){super(u_({style:u0.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",on.Circle,this.getKeyStyle(t),e)}getKeyStyle(t){return Object.assign(Object.assign({},super.getKeyStyle(t)),{r:Math.min(...this.getSize(t))/2})}getIconStyle(t){let e=super.getIconStyle(t),{r:r}=this.getShape("key").attributes,n=2*r*.8;return!!e&&Object.assign({width:n,height:n},e)}getIntersectPoint(t,e=!1){return l8(t,this.getShape("key").getBounds(),e)}}u0.defaultStyleProps={size:32};var on=y("2eDEB");class u1 extends uQ{constructor(t){super(t)}get parsedAttributes(){return this.attributes}drawKeyShape(t,e){return this.upsert("key",on.Polygon,this.getKeyStyle(t),e)}getKeyStyle(t){return Object.assign(Object.assign({},super.getKeyStyle(t)),{points:this.getPoints(t)})}getIntersectPoint(t,e=!1){var r,n;let{points:i}=this.getShape("key").attributes;return l4(t,[+((null===(r=this.attributes)||void 0===r?void 0:r.x)||0),+((null===(n=this.attributes)||void 0===n?void 0:n.y)||0)],i,!0,e).point}}var on=y("2eDEB"),ol=y("jyI49"),ou=y("kVcyu"),u2=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class u3 extends u0{constructor(t){super(u_({style:u3.defaultStyleProps},t))}parseOuterR(){let{size:t}=this.parsedAttributes;return Math.min(...ux(t))/2}parseInnerR(){let{innerR:t}=this.parsedAttributes;return(0,ou.default)(t)?parseInt(t)/100*this.parseOuterR():t}drawDonutShape(t,e){let{donuts:r}=t;if(!(null==r?void 0:r.length))return;let n=r.map(t=>(0,ol.default)(t)?{value:t}:t),i=uv(this.getGraphicStyle(t),"donut"),a=uT(t.donutPalette);if(!a)return;let o=n.reduce((t,e)=>{var r;return t+(null!==(r=e.value)&&void 0!==r?r:0)},0),s=this.parseOuterR(),l=this.parseInnerR(),u=0;n.forEach((t,r)=>{let{value:h=0,color:d=a[r%a.length]}=t,c=u2(t,["value","color"]),f=(0===o?1/n.length:h/o)*360;this.upsert(`round${r}`,on.Path,Object.assign(Object.assign(Object.assign({},i),{d:u8(s,l,u,u+f),fill:d}),c),e),u+=f})}render(t,e=this){super.render(t,e),this.drawDonutShape(t,e)}}u3.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const u6=(t,e,r,n)=>[t+Math.sin(n)*r,e-Math.cos(n)*r],u5=(t,e,r,n)=>n<=0||r<=n?[["M",t-r,e],["A",r,r,0,1,1,t+r,e],["A",r,r,0,1,1,t-r,e],["Z"]]:[["M",t-r,e],["A",r,r,0,1,1,t+r,e],["A",r,r,0,1,1,t-r,e],["Z"],["M",t+n,e],["A",n,n,0,1,0,t-n,e],["A",n,n,0,1,0,t+n,e],["Z"]],u4=(t,e,r,n,i,a)=>{let[o,s]=[i/360*2*Math.PI,a/360*2*Math.PI],l=[u6(t,e,n,o),u6(t,e,r,o),u6(t,e,r,s),u6(t,e,n,s)],u=s-o>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",r,r,0,u,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",n,n,0,u,0,l[0][0],l[0][1]],["Z"]]},u8=(t=0,e=0,r,n)=>{let[i,a]=[0,0];return Math.abs(r-n)%360<1e-6?u5(i,a,t,e):u4(i,a,t,e,r,n)};var on=y("2eDEB");class u9 extends uQ{constructor(t){super(u_({style:u9.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",on.Ellipse,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t),[r,n]=this.getSize(t);return Object.assign(Object.assign({},e),{rx:r/2,ry:n/2})}getIconStyle(t){let e=super.getIconStyle(t),{rx:r,ry:n}=this.getShape("key").attributes,i=2*Math.min(+r,+n)*.8;return!!e&&Object.assign({width:i,height:i},e)}getIntersectPoint(t,e=!1){return l8(t,this.getShape("key").getBounds(),e)}}u9.defaultStyleProps={size:[45,35]};var on=y("2eDEB"),oa=y("lR7jo"),oi=y("fu0YK"),oo=y("jLNr1"),os=y("f8wIT"),on=y("2eDEB"),u7=y("g5Zhu"),oi=y("fu0YK"),oa=y("lR7jo"),oo=y("jLNr1"),os=y("f8wIT"),on=y("2eDEB"),oE=y("02Ztr"),ow=y("8hhuV");function ht(t,e){var r=e.cx,n=e.cy,i=e.r;t.arc(void 0===r?0:r,void 0===n?0:n,i,0,2*Math.PI,!1)}function he(t,e){var r=e.cx,n=void 0===r?0:r,i=e.cy,a=void 0===i?0:i,o=e.rx,s=e.ry;t.ellipse?t.ellipse(n,a,o,s,0,0,2*Math.PI,!1):(t.save(),t.scale(o>s?1:o/s,o>s?s/o:1),t.arc(n,a,o>s?o:s,0,2*Math.PI))}function hr(t,e){var r,n=e.x1,i=e.y1,a=e.x2,o=e.y2,s=e.markerStart,l=e.markerEnd,u=e.markerStartOffset,h=e.markerEndOffset,d=0,c=0,f=0,p=0,g=0;s&&(0,on.isDisplayObject)(s)&&u&&(d=Math.cos(g=Math.atan2(o-i,a-n))*(u||0),c=Math.sin(g)*(u||0)),l&&(0,on.isDisplayObject)(l)&&h&&(f=Math.cos(g=Math.atan2(i-o,n-a))*(h||0),p=Math.sin(g)*(h||0)),t.moveTo(n+d,i+c),t.lineTo(a+f,o+p)}function hn(t,e){var r,n=e.markerStart,i=e.markerEnd,a=e.markerStartOffset,o=e.markerEndOffset,s=e.d,l=s.absolutePath,u=s.segments,h=0,d=0,c=0,p=0,g=0;if(n&&(0,on.isDisplayObject)(n)&&a){var y=n.parentNode.getStartTangent(),v=/*@__PURE__*/f(oE)(y,2),m=v[0],b=v[1];r=m[0]-b[0],h=Math.cos(g=Math.atan2(m[1]-b[1],r))*(a||0),d=Math.sin(g)*(a||0)}if(i&&(0,on.isDisplayObject)(i)&&o){var x=i.parentNode.getEndTangent(),E=/*@__PURE__*/f(oE)(x,2),w=E[0],_=E[1];r=w[0]-_[0],c=Math.cos(g=Math.atan2(w[1]-_[1],r))*(o||0),p=Math.sin(g)*(o||0)}for(var S=0;S<l.length;S++){var k=l[S],N=k[0],O=l[S+1],T=0===S&&(0!==h||0!==d),M=(S===l.length-1||O&&("M"===O[0]||"Z"===O[0]))&&0!==c&&0!==p,A=T?[h,d]:[0,0],C=/*@__PURE__*/f(oE)(A,2),R=C[0],I=C[1],P=M?[c,p]:[0,0],D=/*@__PURE__*/f(oE)(P,2),L=D[0],j=D[1];switch(N){case"M":t.moveTo(k[1]+R,k[2]+I);break;case"L":t.lineTo(k[1]+L,k[2]+j);break;case"Q":t.quadraticCurveTo(k[1],k[2],k[3]+L,k[4]+j);break;case"C":t.bezierCurveTo(k[1],k[2],k[3],k[4],k[5]+L,k[6]+j);break;case"A":var F=u[S].arcParams,B=F.cx,z=F.cy,V=F.rx,G=F.ry,$=F.startAngle,U=F.endAngle,H=F.xRotation,W=F.sweepFlag;if(t.ellipse)t.ellipse(B,z,V,G,H,$,U,!!(1-W));else{var q=V>G?V:G,Y=V>G?1:V/G,K=V>G?G/V:1;t.translate(B,z),t.rotate(H),t.scale(Y,K),t.arc(0,0,q,$,U,!!(1-W)),t.scale(1/Y,1/K),t.rotate(-H),t.translate(-B,-z)}M&&t.lineTo(k[6]+c,k[7]+p);break;case"Z":t.closePath()}}}function hi(t,e){var r,n=e.markerStart,i=e.markerEnd,a=e.markerStartOffset,o=e.markerEndOffset,s=e.points.points,l=s.length,u=s[0][0],h=s[0][1],d=s[l-1][0],c=s[l-1][1],f=0,p=0,g=0,y=0,v=0;n&&(0,on.isDisplayObject)(n)&&a&&(r=s[1][0]-s[0][0],f=Math.cos(v=Math.atan2(s[1][1]-s[0][1],r))*(a||0),p=Math.sin(v)*(a||0)),i&&(0,on.isDisplayObject)(i)&&o&&(r=s[l-1][0]-s[0][0],g=Math.cos(v=Math.atan2(s[l-1][1]-s[0][1],r))*(o||0),y=Math.sin(v)*(o||0)),t.moveTo(u+(f||g),h+(p||y));for(var m=1;m<l-1;m++){var b=s[m];t.lineTo(b[0],b[1])}t.lineTo(d,c)}function ha(t,e){var r,n=e.markerStart,i=e.markerEnd,a=e.markerStartOffset,o=e.markerEndOffset,s=e.points.points,l=s.length,u=s[0][0],h=s[0][1],d=s[l-1][0],c=s[l-1][1],f=0,p=0,g=0,y=0,v=0;n&&(0,on.isDisplayObject)(n)&&a&&(r=s[1][0]-s[0][0],f=Math.cos(v=Math.atan2(s[1][1]-s[0][1],r))*(a||0),p=Math.sin(v)*(a||0)),i&&(0,on.isDisplayObject)(i)&&o&&(r=s[l-2][0]-s[l-1][0],g=Math.cos(v=Math.atan2(s[l-2][1]-s[l-1][1],r))*(o||0),y=Math.sin(v)*(o||0)),t.moveTo(u+f,h+p);for(var m=1;m<l-1;m++){var b=s[m];t.lineTo(b[0],b[1])}t.lineTo(d+g,c+y)}function ho(t,e){var r=e.x,n=void 0===r?0:r,i=e.y,a=void 0===i?0:i,o=e.radius,s=e.width,l=e.height;if(o&&o.some(function(t){return 0!==t})){var u=s>0?1:-1,h=l>0?1:-1,d=u+h===0,c=o.map(function(t){return(0,ow.default)(t,0,Math.min(Math.abs(s)/2,Math.abs(l)/2))}),p=/*@__PURE__*/f(oE)(c,4),g=p[0],y=p[1],v=p[2],m=p[3];t.moveTo(u*g+n,a),t.lineTo(s-u*y+n,a),0!==y&&t.arc(s-u*y+n,h*y+a,y,-h*Math.PI/2,u>0?0:Math.PI,d),t.lineTo(s+n,l-h*v+a),0!==v&&t.arc(s-u*v+n,l-h*v+a,v,u>0?0:Math.PI,h>0?Math.PI/2:1.5*Math.PI,d),t.lineTo(u*m+n,l+a),0!==m&&t.arc(u*m+n,l-h*m+a,m,h>0?Math.PI/2:-Math.PI/2,u>0?Math.PI:0,d),t.lineTo(n,h*g+a),0!==g&&t.arc(u*g+n,h*g+a,g,u>0?Math.PI:0,h>0?1.5*Math.PI:Math.PI/2,d)}else t.rect(n,a,s,l)}var hs=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(oi)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(oo)(this,e,[].concat(n))).name="canvas-path-generator",t}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"init",value:function(){var t,e=(t={},/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(t,on.Shape.CIRCLE,ht),on.Shape.ELLIPSE,he),on.Shape.RECT,ho),on.Shape.LINE,hr),on.Shape.POLYLINE,ha),on.Shape.POLYGON,hi),on.Shape.PATH,hn),on.Shape.TEXT,void 0),on.Shape.GROUP,void 0),on.Shape.IMAGE,void 0),/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(t,on.Shape.HTML,void 0),on.Shape.MESH,void 0),on.Shape.FRAGMENT,void 0));this.context.pathGeneratorFactory=e}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(on.AbstractRendererPlugin),u7=y("g5Zhu"),oi=y("fu0YK"),oa=y("lR7jo"),oo=y("jLNr1"),os=y("f8wIT"),on=y("2eDEB"),hl=y("8QL5z"),hu=y("8HV7i"),hh=y("fOd0O"),oh=y("3iqbd"),oc=y("eIStk"),oE=y("02Ztr"),hd=y("11s8J"),hc=y("2PAX5"),ow=y("8hhuV"),hf=y("cbdLd"),hp=oc.create(),hg=oc.create(),hy=oc.create(),hv=oh.create(),hm=/*#__PURE__*/function(){function t(){var e=this;/*@__PURE__*/f(oi)(this,t),this.isHit=function(t,r,n,i){var a=e.context.pointInPathPickerFactory[t.nodeName];if(a){var o=oh.invert(hv,n),s=oc.transformMat4(hg,oc.set(hy,r[0],r[1],0),o);if(a(t,new on.Point(s[0],s[1]),i,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,r){var n=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),i=e.context.pathGeneratorFactory[t.nodeName];return i&&(n.beginPath(),i(n,t.parsedStyle),n.closePath()),n.isPointInPath(r.x,r.y)}}return /*@__PURE__*/f(oa)(t,[{key:"apply",value:function(e,r){var n,i,a=this,o=e.renderingService,s=e.renderingContext;this.context=e,this.runtime=r;var l=null===(i=s.root)||void 0===i?void 0:i.ownerDocument;o.hooks.pick.tapPromise(t.tag,(n=/*@__PURE__*/f(hh)(/*#__PURE__*//*@__PURE__*/f(hu)().mark(function t(e){return /*@__PURE__*/f(hu)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a.pick(l,e));case 1:case"end":return t.stop()}},t)})),function(t){return n.apply(this,arguments)})),o.hooks.pickSync.tap(t.tag,function(t){return a.pick(l,t)})}},{key:"pick",value:function(t,e){var r,n=e.topmost,i=e.position,a=i.x,o=i.y,s=oc.set(hp,a,o,0),l=t.elementsFromBBox(s[0],s[1],s[0],s[1]),u=[],h=/*@__PURE__*/f(hl)(l);try{for(h.s();!(r=h.n()).done;){var d=r.value,c=d.getWorldTransform();if(this.isHit(d,s,c,!1)){var p=(0,on.findClosestClipPathTarget)(d);if(p){var g=p.parsedStyle.clipPath;if(this.isHit(g,s,g.getWorldTransform(),!0)){if(n)return e.picked=[d],e;u.push(d)}}else{if(n)return e.picked=[d],e;u.push(d)}}}}catch(t){h.e(t)}finally{h.f()}return e.picked=u,e}}])}();function hb(t,e,r){var n=t.parsedStyle,i=n.cx,a=n.cy,o=n.r,s=n.fill,l=n.stroke,u=n.lineWidth,h=n.increasedLineWidthForHitTesting,d=n.pointerEvents,c=((void 0===u?1:u)+(void 0===h?0:h))/2,p=(0,hd.distance)(void 0===i?0:i,void 0===a?0:a,e.x,e.y),g=(0,on.isFillOrStrokeAffected)(void 0===d?"auto":d,s,l),y=/*@__PURE__*/f(oE)(g,2),v=y[0],m=y[1];return v&&m||r?p<=o+c:v?p<=o:!!m&&p>=o-c&&p<=o+c}function hx(t,e,r){var n,i,a,o,s,l,u=t.parsedStyle,h=u.cx,d=void 0===h?0:h,c=u.cy,p=void 0===c?0:c,g=u.rx,y=u.ry,v=u.fill,m=u.stroke,b=u.lineWidth,x=u.increasedLineWidthForHitTesting,E=u.pointerEvents,w=e.x,_=e.y,S=(0,on.isFillOrStrokeAffected)(void 0===E?"auto":E,v,m),k=/*@__PURE__*/f(oE)(S,2),N=k[0],O=k[1],T=((void 0===b?1:b)+(void 0===x?0:x))/2,M=(w-d)*(w-d),A=(_-p)*(_-p);return N&&O||r?1>=M/((n=g+T)*n)+A/((i=y+T)*i):N?1>=M/(g*g)+A/(y*y):!!O&&M/((a=g-T)*a)+A/((o=y-T)*o)>=1&&1>=M/((s=g+T)*s)+A/((l=y+T)*l)}function hE(t,e,r,n,i,a){return i>=t&&i<=t+r&&a>=e&&a<=e+n}function hw(t,e,r,n,i,a,o,s){var l=(Math.atan2(s-e,o-t)+2*Math.PI)%(2*Math.PI),u={x:t+r*Math.cos(l),y:e+r*Math.sin(l)};return(0,hd.distance)(u.x,u.y,o,s)<=a/2}function h_(t,e,r,n,i,a,o){var s=Math.min(t,r),l=Math.max(t,r),u=Math.min(e,n),h=Math.max(e,n),d=i/2;return a>=s-d&&a<=l+d&&o>=u-d&&o<=h+d&&(0,hd.linePointToLine)(t,e,r,n,a,o)<=i/2}function hS(t,e,r,n,i){var a=t.length;if(a<2)return!1;for(var o=0;o<a-1;o++)if(h_(t[o][0],t[o][1],t[o+1][0],t[o+1][1],e,r,n))return!0;if(i){var s=t[0],l=t[a-1];if(h_(s[0],s[1],l[0],l[1],e,r,n))return!0}return!1}function hk(t){return 1e-6>Math.abs(t)?0:t<0?-1:1}function hN(t,e,r){var n=!1,i=t.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o,s=t[a],l=t[(a+1)%i];if(((o=[e,r])[0]-s[0])*(l[1]-s[1])==(l[0]-s[0])*(o[1]-s[1])&&Math.min(s[0],l[0])<=o[0]&&o[0]<=Math.max(s[0],l[0])&&Math.min(s[1],l[1])<=o[1]&&o[1]<=Math.max(s[1],l[1]))return!0;hk(s[1]-r)>0!=hk(l[1]-r)>0&&0>hk(e-(r-s[1])*(s[0]-l[0])/(s[1]-l[1])-s[0])&&(n=!n)}return n}function hO(t,e,r){for(var n=!1,i=0;i<t.length&&!(n=hN(t[i],e,r));i++);return n}function hT(t,e,r){var n=t.parsedStyle,i=n.x1,a=n.y1,o=n.x2,s=n.y2,l=n.lineWidth,u=void 0===l?1:l,h=n.increasedLineWidthForHitTesting,d=n.pointerEvents,c=n.fill,p=n.stroke,g=(0,on.isFillOrStrokeAffected)(void 0===d?"auto":d,c,p);return(!!/*@__PURE__*/f(oE)(g,2)[1]||!!r)&&!!u&&h_(i,a,o,s,u+(void 0===h?0:h),e.x,e.y)}function hM(t,e,r,n,i,a){var o=t.parsedStyle,s=o.lineWidth,l=o.increasedLineWidthForHitTesting,u=o.stroke,h=o.fill,d=o.d,c=o.pointerEvents,p=d.segments,g=d.hasArc,y=d.polylines,v=d.polygons,m=(0,on.isFillOrStrokeAffected)(void 0===c?"auto":c,(null==v?void 0:v.length)&&h,u),b=/*@__PURE__*/f(oE)(m,2),x=b[0],E=b[1],w=(0,on.getOrCalculatePathTotalLength)(t),_=!1;return x||r?_=g?n(t,e):hO(v,e.x,e.y)||hO(y,e.x,e.y):((E||r)&&(_=function(t,e,r,n,i){for(var a=!1,o=e/2,s=0;s<t.length;s++){var l=t[s],u=l.currentPoint,h=l.params,d=l.prePoint,c=l.box;if(!c||hE(c.x-o,c.y-o,c.width+e,c.height+e,r,n))switch(l.command){case"L":case"Z":if(a=h_(d[0],d[1],u[0],u[1],e,r,n))return!0;break;case"Q":if(a=(0,hd.quadPointDistance)(d[0],d[1],h[1],h[2],h[3],h[4],r,n)<=e/2)return!0;break;case"C":if(a=(0,hd.cubicPointDistance)(d[0],d[1],h[1],h[2],h[3],h[4],h[5],h[6],r,n,i)<=e/2)return!0;break;case"A":l.cubicParams||(l.cubicParams=(0,hc.arcToCubic)(d[0],d[1],h[1],h[2],h[3],h[4],h[5],h[6],h[7],void 0));for(var f=l.cubicParams,p=d,g=0;g<f.length;g+=6){var y=(0,hd.cubicPointDistance)(p[0],p[1],f[g],f[g+1],f[g+2],f[g+3],f[g+4],f[g+5],r,n,i);if(p=[f[g+4],f[g+5]],a=y<=e/2)return!0}}}return a}(p,(void 0===s?1:s)+(void 0===l?0:l),e.x,e.y,w)),_)}function hA(t,e,r){var n=t.parsedStyle,i=n.stroke,a=n.fill,o=n.lineWidth,s=n.increasedLineWidthForHitTesting,l=n.points,u=n.pointerEvents,h=(0,on.isFillOrStrokeAffected)(void 0===u?"auto":u,a,i),d=/*@__PURE__*/f(oE)(h,2),c=d[0],p=d[1],g=!1;return(p||r)&&(g=hS(l.points,(void 0===o?1:o)+(void 0===s?0:s),e.x,e.y,!0)),!g&&(c||r)&&(g=hN(l.points,e.x,e.y)),g}function hC(t,e,r){var n=t.parsedStyle,i=n.lineWidth,a=void 0===i?1:i,o=n.increasedLineWidthForHitTesting,s=n.points,l=n.pointerEvents,u=n.fill,h=n.stroke,d=(0,on.isFillOrStrokeAffected)(void 0===l?"auto":l,u,h);return(!!/*@__PURE__*/f(oE)(d,2)[1]||!!r)&&!!a&&hS(s.points,a+(void 0===o?0:o),e.x,e.y,!1)}function hR(t,e,r,n,i){var a,o,s,l=t.parsedStyle,u=l.radius,h=l.fill,d=l.stroke,c=l.lineWidth,p=l.increasedLineWidthForHitTesting,g=l.x,y=void 0===g?0:g,v=l.y,m=void 0===v?0:v,b=l.width,x=l.height,E=l.pointerEvents,w=(0,on.isFillOrStrokeAffected)(void 0===E?"auto":E,h,d),_=/*@__PURE__*/f(oE)(w,2),S=_[0],k=_[1],N=u&&u.some(function(t){return 0!==t}),O=(void 0===c?1:c)+(void 0===p?0:p);if(N){var T,M,A,C,R,I,P,D,L=!1;return(k||r)&&(T=u.map(function(t){return(0,ow.default)(t,0,Math.min(Math.abs(b)/2,Math.abs(x)/2))}),M=e.x,A=e.y,R=(C=/*@__PURE__*/f(oE)(T,4))[0],I=C[1],P=C[2],D=C[3],L=h_(y+R,m,y+b-I,m,O,M,A)||h_(y+b,m+I,y+b,m+x-P,O,M,A)||h_(y+b-P,m+x,y+D,m+x,O,M,A)||h_(y,m+x-D,y,m+R,O,M,A)||hw(y+b-I,m+I,I,1.5*Math.PI,2*Math.PI,O,M,A)||hw(y+b-P,m+x-P,P,0,.5*Math.PI,O,M,A)||hw(y+D,m+x-D,D,.5*Math.PI,Math.PI,O,M,A)||hw(y+R,m+R,R,Math.PI,1.5*Math.PI,O,M,A)),!L&&(S||r)&&(L=n(t,e)),L}var j=O/2;return S&&k||r?hE(y-j,m-j,b+j,x+j,e.x,e.y):S?hE(y,m,b,x,e.x,e.y):!!k&&(a=e.x,o=e.y,hE(y-(s=O/2),m-s,b,O,a,o)||hE(y+b-s,m-s,O,x,a,o)||hE(y+s,m+x-s,b,O,a,o)||hE(y-s,m+s,O,x,a,o))}function hI(t,e,r,n,i,a){var o=t.parsedStyle,s=o.pointerEvents,l=o.x,u=o.y,h=o.width,d=o.height;if("non-transparent-pixel"===(void 0===s?"auto":s)){var c=i.config.offscreenCanvas,p=a.offscreenCanvasCreator.getOrCreateCanvas(c),g=a.offscreenCanvasCreator.getOrCreateContext(c,{willReadFrequently:!0});return p.width=h,p.height=d,i.defaultStyleRendererFactory[(0,on.Shape).IMAGE].render(g,/*@__PURE__*/f(hf)(/*@__PURE__*/f(hf)({},t.parsedStyle),{},{x:0,y:0}),t,void 0,void 0,void 0),g.getImageData(e.x-(void 0===l?0:l),e.y-(void 0===u?0:u),1,1).data.every(function(t){return 0!==t})}return!0}function hP(t,e,r,n){var i=t.getGeometryBounds();return e.x>=i.min[0]&&e.y>=i.min[1]&&e.x<=i.max[0]&&e.y<=i.max[1]}hm.tag="CanvasPicker";var hD=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(oi)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(oo)(this,e,[].concat(n))).name="canvas-picker",t}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"init",value:function(){var t,e=(t={},/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(t,on.Shape.CIRCLE,hb),on.Shape.ELLIPSE,hx),on.Shape.RECT,hR),on.Shape.LINE,hT),on.Shape.POLYLINE,hC),on.Shape.POLYGON,hA),on.Shape.PATH,hM),on.Shape.TEXT,hP),on.Shape.GROUP,null),on.Shape.IMAGE,hI),/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(t,on.Shape.HTML,null),on.Shape.MESH,null));this.context.pointInPathPickerFactory=e,this.addRenderingPlugin(new hm)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(on.AbstractRendererPlugin),u7=y("g5Zhu"),hf=y("cbdLd"),oi=y("fu0YK"),oa=y("lR7jo"),oo=y("jLNr1"),os=y("f8wIT"),on=y("2eDEB"),oE=y("02Ztr"),ox=y("fUHKi"),hL={};(hL=function(t,e){if(!({}).hasOwnProperty.call(t,e))throw TypeError("attempted to use private field on non-instance");return t}).__esModule=!0,hL.default=hL;var hj={},hF=0;(hj=function(t){return"__private_"+hF+++"_"+t}).__esModule=!0,hj.default=hj;var oh=y("3iqbd"),oc=y("eIStk"),o_=y("geZBG"),oi=y("fu0YK"),oa=y("lR7jo"),oo=y("jLNr1"),os=y("f8wIT"),on=y("2eDEB"),hu=y("8HV7i"),hf=y("cbdLd"),oE=y("02Ztr"),hh=y("fOd0O"),ou=y("kVcyu"),oh=y("3iqbd"),hB=/*@__PURE__*/f(oa)(function t(){/*@__PURE__*/f(oi)(this,t),this.cacheStore=new Map},[{key:"onRefAdded",value:function(t){}},{key:"has",value:function(t){return this.cacheStore.has(t)}},{key:"put",value:function(t,e,r){return!this.cacheStore.has(t)&&(this.cacheStore.set(t,{value:e,counter:new Set([r])}),this.onRefAdded(r),!0)}},{key:"get",value:function(t,e){var r=this.cacheStore.get(t);return r?(r.counter.has(e)||(r.counter.add(e),this.onRefAdded(e)),r.value):null}},{key:"update",value:function(t,e,r){var n=this.cacheStore.get(t);return!!n&&(n.value=/*@__PURE__*/f(hf)(/*@__PURE__*/f(hf)({},n.value),e),n.counter.has(r)||(n.counter.add(r),this.onRefAdded(r)),!0)}},{key:"release",value:function(t,e){var r=this.cacheStore.get(t);return!!r&&(r.counter.delete(e),r.counter.size<=0&&this.cacheStore.delete(t),!0)}},{key:"releaseRef",value:function(t){var e=this;Array.from(this.cacheStore.keys()).forEach(function(r){e.release(r,t)})}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}]),hz=[],hV=[],hG=/*#__PURE__*/function(){function t(){/*@__PURE__*/f(oi)(this,t)}return /*@__PURE__*/f(oa)(t,null,[{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.api;t.rafId&&(e.cancelAnimationFrame(t.rafId),t.rafId=null)}},{key:"executeTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.api;hz.length<=0&&hV.length<=0||(hV.forEach(function(t){return t()}),hV=hz.splice(0,t.TASK_NUM_PER_FRAME),t.rafId=e.requestAnimationFrame(function(){t.executeTask(e)}))}},{key:"sliceImage",value:function(e,r,n,i){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:t.api,s=e.naturalWidth||e.width,l=e.naturalHeight||e.height,u=r-a,h=n-a,d=Math.ceil(s/u),c=Math.ceil(l/h),f={tileSize:[r,n],gridSize:[c,d],tiles:Array(c).fill(null).map(function(){return Array(d).fill(null)})},p=function(t){for(var a=function(a){hz.push(function(){var d=a*u,c=t*h,p=[Math.min(r,s-d),Math.min(n,l-c)],g=p[0],y=p[1],v=o.createCanvas();v.width=r,v.height=n,v.getContext("2d").drawImage(e,d,c,g,y,0,0,g,y),f.tiles[t][a]={x:d,y:c,tileX:a,tileY:t,data:v},i()})},c=0;c<d;c++)a(c)},g=0;g<c;g++)p(g);return t.stop(),t.executeTask(),f}}])}();hG.TASK_NUM_PER_FRAME=10;var h$=new hB;h$.onRefAdded=function(t){var e=this;t.addEventListener(on.ElementEvent.DESTROY,function(){e.releaseRef(t)},{once:!0})};var hU=/*@__PURE__*/f(oa)(function t(e,r){/*@__PURE__*/f(oi)(this,t),this.gradientCache={},this.patternCache={},this.context=e,this.runtime=r},[{key:"getImageSync",value:function(t,e,r){var n=(0,ou.default)(t)?t:t.src;if(h$.has(n)){var i=h$.get(n,e);if(i.img.complete)return null==r||r(i),i}return this.getOrCreateImage(t,e).then(function(t){null==r||r(t)}).catch(function(){}),null}},{key:"getOrCreateImage",value:function(t,e){var r=(0,ou.default)(t)?t:t.src;if(!(0,ou.default)(t)&&!h$.has(r)){var n={img:t,size:[t.naturalWidth||t.width,t.naturalHeight||t.height],tileSize:hH(t)};h$.put(r,n,e)}if(h$.has(r)){var i=h$.get(r,e);return i.img.complete?Promise.resolve(i):new Promise(function(t,e){i.img.addEventListener("load",function(){i.size=[i.img.naturalWidth||i.img.width,i.img.naturalHeight||i.img.height],i.tileSize=hH(i.img),t(i)}),i.img.addEventListener("error",function(t){e(t)})})}var a=this.context.config.createImage;return new Promise(function(t,n){var i;if(a?i=a(r):on.isBrowser&&(i=new window.Image),i){var o={img:i,size:[0,0],tileSize:hH(i)};h$.put(r,o,e),i.onload=function(){o.size=[i.naturalWidth||i.width,i.naturalHeight||i.height],o.tileSize=hH(o.img),t(o)},i.onerror=function(t){n(t)},i.crossOrigin="Anonymous",i.src=r}})}},{key:"createDownSampledImage",value:(yT=/*@__PURE__*/f(hh)(/*#__PURE__*//*@__PURE__*/f(hu)().mark(function t(e,r){var n,i,a,o,s,l,u,h,d,c,p,g,y,v;return /*@__PURE__*/f(hu)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getOrCreateImage(e,r);case 2:if(!(void 0!==(n=t.sent).downSamplingRate)){t.next=5;break}return t.abrupt("return",n);case 5:if(s=void 0===(o=(a="boolean"==typeof(i=this.context.config.enableLargeImageOptimization)?{}:i).maxDownSampledImageSize)?2048:o,u=void 0===(l=a.downSamplingRateThreshold)?.5:l,h=this.runtime.globalThis.createImageBitmap,c=(d=/*@__PURE__*/f(oE)(n.size,2))[0],p=d[1],g=n.img,y=Math.min((s+s)/(c+p),Math.max(.01,Math.min(u,.5))),v=/*@__PURE__*/f(hf)(/*@__PURE__*/f(hf)({},n),{},{downSamplingRate:y}),h$.update(n.img.src,v,r),!h){t.next=25;break}return t.prev=14,t.next=17,h(n.img,{resizeWidth:c*y,resizeHeight:p*y});case 17:g=t.sent,t.next=23;break;case 20:t.prev=20,t.t0=t.catch(14),y=1;case 23:t.next=26;break;case 25:y=1;case 26:return v=/*@__PURE__*/f(hf)(/*@__PURE__*/f(hf)({},this.getImageSync(e,r)),{},{downSampled:g,downSamplingRate:y}),h$.update(n.img.src,v,r),t.abrupt("return",v);case 29:case"end":return t.stop()}},t,this,[[14,20]])})),function(t,e){return yT.apply(this,arguments)})},{key:"createImageTiles",value:(yM=/*@__PURE__*/f(hh)(/*#__PURE__*//*@__PURE__*/f(hu)().mark(function t(e,r,n,i){var a,o,s,l,u;return /*@__PURE__*/f(hu)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getOrCreateImage(e,i);case 2:return a=t.sent,s=(o=i.ownerDocument.defaultView).requestAnimationFrame,l=o.cancelAnimationFrame,hG.api={requestAnimationFrame:s,cancelAnimationFrame:l,createCanvas:function(){return(0,on.OffscreenCanvasCreator).createCanvas()}},u=/*@__PURE__*/f(hf)(/*@__PURE__*/f(hf)({},a),hG.sliceImage(a.img,a.tileSize[0],a.tileSize[0],n)),h$.update(a.img.src,u,i),t.abrupt("return",u);case 8:case"end":return t.stop()}},t,this)})),function(t,e,r,n){return yM.apply(this,arguments)})},{key:"releaseImage",value:function(t,e){h$.release((0,ou.default)(t)?t:t.src,e)}},{key:"releaseImageRef",value:function(t){h$.releaseRef(t)}},{key:"getOrCreatePatternSync",value:function(t,e,r,n,i,a,o){var s,l,u=this.generatePatternKey(e);if(u&&this.patternCache[u])return this.patternCache[u];var h=e.image,d=e.repetition,c=e.transform,f=!1;if((0,ou.default)(h)){var p=this.getImageSync(h,t,o);s=null==p?void 0:p.img}else n?(s=n,f=!0):s=h;var g=s&&r.createPattern(s,d);return g&&(l=c?(0,on.parsedTransformToMat4)((0,on.parseTransform)(c),new on.DisplayObject({})):oh.identity(oh.create()),f&&oh.scale(l,l,[1/i,1/i,1]),g.setTransform({a:l[0],b:l[1],c:l[4],d:l[5],e:l[12]+a[0],f:l[13]+a[1]})),u&&g&&(this.patternCache[u]=g),g}},{key:"getOrCreateGradient",value:function(t,e){var r=this.generateGradientKey(t),n=t.type,i=t.steps,a=t.min,o=t.width,s=t.height,l=t.angle,u=t.cx,h=t.cy,d=t.size;if(this.gradientCache[r])return this.gradientCache[r];var c=null;if(n===on.GradientType.LinearGradient){var f=(0,on.computeLinearGradient)(a,o,s,l),p=f.x1,g=f.y1,y=f.x2,v=f.y2;c=e.createLinearGradient(p,g,y,v)}else if(n===on.GradientType.RadialGradient){var m=(0,on.computeRadialGradient)(a,o,s,u,h,d),b=m.x,x=m.y,E=m.r;c=e.createRadialGradient(b,x,0,b,x,E)}return c&&(i.forEach(function(t){var e,r=t.offset,n=t.color;r.unit===on.UnitType.kPercentage&&(null===(e=c)||void 0===e||e.addColorStop(r.value/100,n.toString()))}),this.gradientCache[r]=c),this.gradientCache[r]}},{key:"generateGradientKey",value:function(t){var e=t.type,r=t.min,n=t.width,i=t.height,a=t.steps,o=t.angle,s=t.cx,l=t.cy,u=t.size;return"gradient-".concat(e,"-").concat((null==o?void 0:o.toString())||0,"-").concat((null==s?void 0:s.toString())||0,"-").concat((null==l?void 0:l.toString())||0,"-").concat((null==u?void 0:u.toString())||0,"-").concat(r[0],"-").concat(r[1],"-").concat(n,"-").concat(i,"-").concat(a.map(function(t){var e=t.offset,r=t.color;return"".concat(e).concat(r)}).join("-"))}},{key:"generatePatternKey",value:function(t){var e=t.image,r=t.repetition;return(0,ou.default)(e)?"pattern-".concat(e,"-").concat(r):"rect"===e.nodeName?"pattern-".concat(e.entity,"-").concat(r):void 0}}]);function hH(t){if(!t.complete)return[0,0];var e=t.naturalWidth||t.width,r=t.naturalHeight||t.height,n=256;return[256,512].forEach(function(t){Math.ceil(r/t)*Math.ceil(e/t)<1e3&&(n=t)}),[n,n]}hU.isSupportTile=!!(0,on.OffscreenCanvasCreator).createCanvas();var hW=/*#__PURE__*/function(){function t(){/*@__PURE__*/f(oi)(this,t)}return /*@__PURE__*/f(oa)(t,[{key:"apply",value:function(e){var r=e.renderingService,n=e.renderingContext,i=e.imagePool,a=n.root.ownerDocument.defaultView,o=function(t,e,r){var n=t.parsedStyle,i=n.width,a=n.height;i&&!a?t.setAttribute("height",r/e*i):!i&&a&&t.setAttribute("width",e/r*a)},s=function(t){var e=t.target,n=e.nodeName,a=e.attributes;if(n===on.Shape.IMAGE){var s=a.src,l=a.keepAspectRatio;i.getImageSync(s,e,function(t){var n=t.img,i=n.width,a=n.height;l&&o(e,i,a),e.renderable.dirty=!0,r.dirtify()})}},l=function(t){var e=t.target,n=t.attrName,a=t.prevValue,s=t.newValue;e.nodeName===on.Shape.IMAGE&&"src"===n&&(a!==s&&i.releaseImage(a,e),(0,ou.default)(s)&&i.getOrCreateImage(s,e).then(function(t){var n=t.img,i=n.width,a=n.height;e.attributes.keepAspectRatio&&o(e,i,a),e.renderable.dirty=!0,r.dirtify()}).catch(function(){}))};r.hooks.init.tap(t.tag,function(){a.addEventListener(on.ElementEvent.MOUNTED,s),a.addEventListener(on.ElementEvent.ATTR_MODIFIED,l)}),r.hooks.destroy.tap(t.tag,function(){a.removeEventListener(on.ElementEvent.MOUNTED,s),a.removeEventListener(on.ElementEvent.ATTR_MODIFIED,l)})}}])}();hW.tag="LoadImage";var hq=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(oi)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(oo)(this,e,[].concat(n))).name="image-loader",t}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"init",value:function(t){this.context.imagePool=new hU(this.context,t),this.addRenderingPlugin(new hW)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(on.AbstractRendererPlugin),hY=/*#__PURE__*//*@__PURE__*/f(hj)("renderState"),hK=/*#__PURE__*/function(){function t(e){/*@__PURE__*/f(oi)(this,t),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,hY,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=oh.create(),this.dprMatrix=oh.create(),this.tmpMat4=oh.create(),this.vec3a=oc.create(),this.vec3b=oc.create(),this.vec3c=oc.create(),this.vec3d=oc.create(),this.canvasRendererPluginOptions=e}return /*@__PURE__*/f(oa)(t,[{key:"apply",value:function(e,r){var n=this;this.context=e;var i=this.context,a=i.config,o=i.camera,s=i.renderingService,l=i.renderingContext,u=i.rBushRoot,h=i.pathGeneratorFactory,d=a.renderer.getConfig().enableRenderingOptimization;a.renderer.getConfig().enableDirtyCheck=!1,a.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=u,this.pathGeneratorFactory=h;var c=e.contextService,p=l.root.ownerDocument.defaultView,g=function(t){var e=t.target.rBushNode;e.aabb&&n.removedRBushNodeAABBs.push(e.aabb)},y=function(t){var e=t.target.rBushNode;e.aabb&&n.removedRBushNodeAABBs.push(e.aabb)};s.hooks.init.tap(t.tag,function(){p.addEventListener(on.ElementEvent.UNMOUNTED,g),p.addEventListener(on.ElementEvent.CULLED,y);var t=c.getDPR(),e=a.width,r=a.height,i=c.getContext();n.clearRect(i,0,0,e*t,r*t,a.background)}),s.hooks.destroy.tap(t.tag,function(){p.removeEventListener(on.ElementEvent.UNMOUNTED,g),p.removeEventListener(on.ElementEvent.CULLED,y),n.renderQueue=[],n.removedRBushNodeAABBs=[],/*@__PURE__*/f(hL)(n,hY)[hY]={restoreStack:[],prevObject:null,currentContext:null}}),s.hooks.beginFrame.tap(t.tag,function(){var t,e=c.getContext(),r=c.getDPR(),i=a.width,o=a.height,l=n.canvasRendererPluginOptions,u=l.dirtyObjectNumThreshold,h=l.dirtyObjectRatioThreshold,d=s.getStats(),f=d.total,g=d.rendered;n.clearFullScreen=n.clearFullScreenLastFrame||!(null!==(t=p.context.renderingPlugins[1])&&void 0!==t&&t.isFirstTimeRenderingFinished)||s.disableDirtyRectangleRendering()||g>u&&g/f>h,e&&("function"==typeof e.resetTransform?e.resetTransform():e.setTransform(1,0,0,1,0,0),n.clearFullScreen&&n.clearRect(e,0,0,i*r,o*r,a.background))});var v=function(t,e){for(var i=[t];i.length>0;){var a=i.pop();a.isVisible()&&!a.isCulled()&&(d?n.renderDisplayObjectOptimized(a,e,n.context,/*@__PURE__*/f(hL)(n,hY)[hY],r):n.renderDisplayObject(a,e,n.context,/*@__PURE__*/f(hL)(n,hY)[hY],r));for(var o=a.sortable.sorted||a.childNodes,s=o.length-1;s>=0;s--)i.push(o[s])}};s.hooks.endFrame.tap(t.tag,function(){if(0===l.root.childNodes.length){n.clearFullScreenLastFrame=!0;return}d=a.renderer.getConfig().enableRenderingOptimization,/*@__PURE__*/f(hL)(n,hY)[hY]={restoreStack:[],prevObject:null,currentContext:/*@__PURE__*/f(hL)(n,hY)[hY].currentContext},/*@__PURE__*/f(hL)(n,hY)[hY].currentContext.clear(),n.clearFullScreenLastFrame=!1;var t=c.getContext(),e=c.getDPR();if(oh.fromScaling(n.dprMatrix,[e,e,1]),oh.multiply(n.vpMatrix,n.dprMatrix,o.getOrthoMatrix()),n.clearFullScreen)d?(t.save(),v(l.root,t),t.restore()):v(l.root,t),n.removedRBushNodeAABBs=[];else{var i=n.safeMergeAABB.apply(n,[n.mergeDirtyAABBs(n.renderQueue)].concat(/*@__PURE__*/f(ox)(n.removedRBushNodeAABBs.map(function(t){var e=t.minX,r=t.minY,n=t.maxX,i=t.maxY,a=new on.AABB;return a.setMinMax([e,r,0],[n,i,0]),a}))));if(n.removedRBushNodeAABBs=[],(0,on.AABB).isEmpty(i)){n.renderQueue=[];return}var s=n.convertAABB2Rect(i),u=s.x,h=s.y,g=s.width,y=s.height,m=oc.transformMat4(n.vec3a,[u,h,0],n.vpMatrix),b=oc.transformMat4(n.vec3b,[u+g,h,0],n.vpMatrix),x=oc.transformMat4(n.vec3c,[u,h+y,0],n.vpMatrix),E=oc.transformMat4(n.vec3d,[u+g,h+y,0],n.vpMatrix),w=Math.min(m[0],b[0],E[0],x[0]),_=Math.min(m[1],b[1],E[1],x[1]),S=Math.max(m[0],b[0],E[0],x[0]),k=Math.max(m[1],b[1],E[1],x[1]),N=Math.floor(w),O=Math.floor(_),T=Math.ceil(S-w),M=Math.ceil(k-_);t.save(),n.clearRect(t,N,O,T,M,a.background),t.beginPath(),t.rect(N,O,T,M),t.clip(),t.setTransform(n.vpMatrix[0],n.vpMatrix[1],n.vpMatrix[4],n.vpMatrix[5],n.vpMatrix[12],n.vpMatrix[13]),a.renderer.getConfig().enableDirtyRectangleRenderingDebug&&p.dispatchEvent(new on.CustomEvent(on.CanvasEvent.DIRTY_RECTANGLE,{dirtyRect:{x:N,y:O,width:T,height:M}})),n.searchDirtyObjects(i).sort(function(t,e){return t.sortable.renderOrder-e.sortable.renderOrder}).forEach(function(e){e&&e.isVisible()&&!e.isCulled()&&n.renderDisplayObject(e,t,n.context,/*@__PURE__*/f(hL)(n,hY)[hY],r)}),t.restore(),n.renderQueue.forEach(function(t){n.saveDirtyAABB(t)}),n.renderQueue=[]}/*@__PURE__*/f(hL)(n,hY)[hY].restoreStack.forEach(function(){t.restore()}),/*@__PURE__*/f(hL)(n,hY)[hY].restoreStack=[]}),s.hooks.render.tap(t.tag,function(t){n.clearFullScreen||n.renderQueue.push(t)})}},{key:"clearRect",value:function(t,e,r,n,i,a){t.clearRect(e,r,n,i),a&&(t.fillStyle=a,t.fillRect(e,r,n,i))}},{key:"renderDisplayObjectOptimized",value:function(t,e,r,n,i){var a=t.nodeName,o=!1,s=this.context.styleRendererFactory[a],l=this.pathGeneratorFactory[a],u=t.parsedStyle.clipPath;if(u){n.prevObject&&oh.exactEquals(u.getWorldTransform(),n.prevObject.getWorldTransform())||(this.applyWorldTransform(e,u),n.prevObject=null);var h=this.pathGeneratorFactory[u.nodeName];h&&(e.save(),o=!0,e.beginPath(),h(e,u.parsedStyle),e.closePath(),e.clip())}if(s){n.prevObject&&oh.exactEquals(t.getWorldTransform(),n.prevObject.getWorldTransform())||this.applyWorldTransform(e,t);var d=!n.prevObject;if(!d){var c=n.prevObject.nodeName;d=a===on.Shape.TEXT?c!==on.Shape.TEXT:a===on.Shape.IMAGE?c!==on.Shape.IMAGE:c===on.Shape.TEXT||c===on.Shape.IMAGE}s.applyStyleToContext(e,t,d,n),n.prevObject=t}l&&(e.beginPath(),l(e,t.parsedStyle),a!==on.Shape.LINE&&a!==on.Shape.PATH&&a!==on.Shape.POLYLINE&&e.closePath()),s&&s.drawToContext(e,t,/*@__PURE__*/f(hL)(this,hY)[hY],this,i),o&&e.restore(),t.renderable.dirty=!1}},{key:"renderDisplayObject",value:function(t,e,r,n,i){var a=t.nodeName,o=n.restoreStack[n.restoreStack.length-1];o&&!(t.compareDocumentPosition(o)&on.Node.DOCUMENT_POSITION_CONTAINS)&&(e.restore(),n.restoreStack.pop());var s=this.context.styleRendererFactory[a],l=this.pathGeneratorFactory[a],u=t.parsedStyle.clipPath;if(u){this.applyWorldTransform(e,u);var h=this.pathGeneratorFactory[u.nodeName];h&&(e.save(),n.restoreStack.push(t),e.beginPath(),h(e,u.parsedStyle),e.closePath(),e.clip())}s&&(this.applyWorldTransform(e,t),e.save(),this.applyAttributesToContext(e,t)),l&&(e.beginPath(),l(e,t.parsedStyle),a!==on.Shape.LINE&&a!==on.Shape.PATH&&a!==on.Shape.POLYLINE&&e.closePath()),s&&(s.render(e,t.parsedStyle,t,r,this,i),e.restore()),t.renderable.dirty=!1}},{key:"applyAttributesToContext",value:function(t,e){var r=e.parsedStyle,n=r.stroke,i=r.fill,a=r.opacity,o=r.lineDash,s=r.lineDashOffset;o&&t.setLineDash(o),(0,o_.default)(s)||(t.lineDashOffset=s),(0,o_.default)(a)||(t.globalAlpha*=a),(0,o_.default)(n)||Array.isArray(n)||n.isNone||(t.strokeStyle=e.attributes.stroke),(0,o_.default)(i)||Array.isArray(i)||i.isNone||(t.fillStyle=e.attributes.fill)}},{key:"convertAABB2Rect",value:function(t){var e=t.getMin(),r=t.getMax(),n=Math.floor(e[0]),i=Math.floor(e[1]);return{x:n,y:i,width:Math.ceil(r[0])-n,height:Math.ceil(r[1])-i}}},{key:"mergeDirtyAABBs",value:function(t){var e=new on.AABB;return t.forEach(function(t){var r=t.getRenderBounds();e.add(r);var n=t.renderable.dirtyRenderBounds;n&&e.add(n)}),e}},{key:"searchDirtyObjects",value:function(t){var e=t.getMin(),r=/*@__PURE__*/f(oE)(e,2),n=r[0],i=r[1],a=t.getMax(),o=/*@__PURE__*/f(oE)(a,2),s=o[0],l=o[1];return this.rBush.search({minX:n,minY:i,maxX:s,maxY:l}).map(function(t){return t.displayObject})}},{key:"saveDirtyAABB",value:function(t){var e=t.renderable;e.dirtyRenderBounds||(e.dirtyRenderBounds=new on.AABB);var r=t.getRenderBounds();r&&e.dirtyRenderBounds.update(r.center,r.halfExtents)}},{key:"applyWorldTransform",value:function(t,e,r){r?(oh.copy(this.tmpMat4,e.getLocalTransform()),oh.multiply(this.tmpMat4,r,this.tmpMat4)):oh.copy(this.tmpMat4,e.getWorldTransform()),oh.multiply(this.tmpMat4,this.vpMatrix,this.tmpMat4),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var t=new on.AABB,e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach(function(e){t.add(e)}),t}}])}();function hX(t,e,r,n,i,a,o){if("rect"===t.image.nodeName){var s,l,u=t.image.parsedStyle,h=u.width,d=u.height;l=n.contextService.getDPR();var c=n.config.offscreenCanvas;(s=a.offscreenCanvasCreator.getOrCreateCanvas(c)).width=h*l,s.height=d*l;var f=a.offscreenCanvasCreator.getOrCreateContext(c),p={restoreStack:[],prevObject:null,currentContext:new Map};t.image.forEach(function(t){i.renderDisplayObject(t,f,n,p,a)}),p.restoreStack.forEach(function(){f.restore()})}return o.getOrCreatePatternSync(e,t,r,s,l,e.getGeometryBounds().min,function(){e.renderable.dirty=!0,n.renderingService.dirtify()})}function hJ(t,e,r,n){var i;if(t.type===on.GradientType.LinearGradient||t.type===on.GradientType.RadialGradient){var a=e.getGeometryBounds(),o=a&&2*a.halfExtents[0]||1,s=a&&2*a.halfExtents[1]||1,l=a&&a.min||[0,0];i=n.getOrCreateGradient(/*@__PURE__*/f(hf)(/*@__PURE__*/f(hf)({type:t.type},t.value),{},{min:l,width:o,height:s}),r)}return i}hK.tag="CanvasRenderer";var hZ=["shadowBlur","shadowOffsetX","shadowOffsetY"],hQ=["lineCap","lineJoin","miterLimit"],h0={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},h1={};function h2(t,e,r,n){var i=n.has(e)?n.get(e):h0[e];return i!==r&&("lineDash"===e?t.setLineDash(r):t[e]=r,n.set(e,r)),i}var h3=/*#__PURE__*/function(t){function e(){return /*@__PURE__*/f(oi)(this,e),/*@__PURE__*/f(oo)(this,e,arguments)}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"render",value:function(t,e,r,n,i,a){var o=e.fill,s=e.fillRule,l=e.opacity,u=void 0===l?1:l,h=e.fillOpacity,d=e.stroke,c=e.strokeOpacity,f=e.lineWidth,p=void 0===f?1:f,g=e.lineCap,y=e.lineJoin,v=e.shadowType,m=e.shadowColor,b=e.shadowBlur,x=e.filter,E=e.miterLimit,w=o&&!o.isNone,_=d&&!d.isNone&&p>0,S=(null==o?void 0:o.alpha)===0,k=!!(x&&x.length),N=!(0,o_.default)(m)&&b>0,O=r.nodeName,T="inner"===v,M=_&&N&&(O===on.Shape.PATH||O===on.Shape.LINE||O===on.Shape.POLYLINE||S||T);w&&(t.globalAlpha=u*(void 0===h?1:h),M||h6(r,t,N),h5(t,r,o,s,n,i,a,this.imagePool),M||this.clearShadowAndFilter(t,k,N)),_&&(t.globalAlpha=u*(void 0===c?1:c),t.lineWidth=p,(0,o_.default)(E)||(t.miterLimit=E),(0,o_.default)(g)||(t.lineCap=g),(0,o_.default)(y)||(t.lineJoin=y),M&&(T&&(t.globalCompositeOperation="source-atop"),h6(r,t,!0),T&&(h4(t,r,d,n,i,a,this.imagePool),t.globalCompositeOperation=h0.globalCompositeOperation,this.clearShadowAndFilter(t,k,!0))),h4(t,r,d,n,i,a,this.imagePool))}},{key:"clearShadowAndFilter",value:function(t,e,r){if(r&&(t.shadowColor="transparent",t.shadowBlur=0),e){var n=t.filter;!(0,o_.default)(n)&&n.indexOf("drop-shadow")>-1&&(t.filter=n.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(/*@__PURE__*/f(oa)(function t(e){/*@__PURE__*/f(oi)(this,t),this.imagePool=e},[{key:"applyAttributesToContext",value:function(t,e){}},{key:"render",value:function(t,e,r,n,i,a){}},{key:"applyCommonStyleToContext",value:function(t,e,r,n){var i=r?h1:n.prevObject.parsedStyle,a=e.parsedStyle;(r||a.opacity!==i.opacity)&&h2(t,"globalAlpha",(0,o_.default)(a.opacity)?h0.globalAlpha:a.opacity,n.currentContext),(r||a.blend!==i.blend)&&h2(t,"globalCompositeOperation",(0,o_.default)(a.blend)?h0.globalCompositeOperation:a.blend,n.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(t,e,r,n){var i=r?h1:n.prevObject.parsedStyle,a=e.parsedStyle,o=a.lineWidth,s=void 0===o?h0.lineWidth:o,l=a.fill&&!a.fill.isNone;if(a.stroke&&!a.stroke.isNone&&s>0){(r||e.attributes.stroke!==n.prevObject.attributes.stroke)&&h2(t,"strokeStyle",(0,o_.default)(a.stroke)||Array.isArray(a.stroke)||a.stroke.isNone?h0.strokeStyle:e.attributes.stroke,n.currentContext),(r||a.lineWidth!==i.lineWidth)&&h2(t,"lineWidth",(0,o_.default)(a.lineWidth)?h0.lineWidth:a.lineWidth,n.currentContext),(r||a.lineDash!==i.lineDash)&&h2(t,"lineDash",a.lineDash||h0.lineDash,n.currentContext),(r||a.lineDashOffset!==i.lineDashOffset)&&h2(t,"lineDashOffset",(0,o_.default)(a.lineDashOffset)?h0.lineDashOffset:a.lineDashOffset,n.currentContext);for(var u=0;u<hQ.length;u++){var h=hQ[u];(r||a[h]!==i[h])&&h2(t,h,(0,o_.default)(a[h])?h0[h]:a[h],n.currentContext)}}l&&(r||e.attributes.fill!==n.prevObject.attributes.fill)&&h2(t,"fillStyle",(0,o_.default)(a.fill)||Array.isArray(a.fill)||a.fill.isNone?h0.fillStyle:e.attributes.fill,n.currentContext)}},{key:"applyStyleToContext",value:function(t,e,r,n){var i=e.nodeName;this.applyCommonStyleToContext(t,e,r,n),i===on.Shape.IMAGE||this.applyStrokeFillStyleToContext(t,e,r,n)}},{key:"applyShadowAndFilterStyleToContext",value:function(t,e,r,n){var i=e.parsedStyle;if(r){h2(t,"shadowColor",i.shadowColor.toString(),n.currentContext);for(var a=0;a<hZ.length;a++){var o=hZ[a];h2(t,o,i[o]||h0[o],n.currentContext)}}i.filter&&i.filter.length&&h2(t,"filter",e.attributes.filter,n.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(t,e,r,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(e){h2(t,"shadowColor",h0.shadowColor,n.currentContext);for(var a=0;a<hZ.length;a++){var o=hZ[a];h2(t,o,h0[o],n.currentContext)}}if(r){if(e&&i){var s=t.filter;!(0,o_.default)(s)&&s.indexOf("drop-shadow")>-1&&h2(t,"filter",s.replace(/drop-shadow\([^)]*\)/,"").trim()||h0.filter,n.currentContext)}else h2(t,"filter",h0.filter,n.currentContext)}}},{key:"fillToContext",value:function(t,e,r,n,i){var a=this,o=e.parsedStyle,s=o.fill,l=o.fillRule,u=null;if(Array.isArray(s)&&s.length>0)s.forEach(function(n){var i,o=h2(t,"fillStyle",hJ(n,e,t,a.imagePool),r.currentContext);u=null!==(i=u)&&void 0!==i?i:o,l?t.fill(l):t.fill()});else{if((0,on.isPattern)(s)){var h=hX(s,e,t,e.ownerDocument.defaultView.context,n,i,this.imagePool);h&&(t.fillStyle=h,u=!0)}l?t.fill(l):t.fill()}null!==u&&h2(t,"fillStyle",u,r.currentContext)}},{key:"strokeToContext",value:function(t,e,r,n,i){var a=this,o=e.parsedStyle.stroke,s=null;if(Array.isArray(o)&&o.length>0)o.forEach(function(n){var i,o=h2(t,"strokeStyle",hJ(n,e,t,a.imagePool),r.currentContext);s=null!==(i=s)&&void 0!==i?i:o,t.stroke()});else{if((0,on.isPattern)(o)){var l=hX(o,e,t,e.ownerDocument.defaultView.context,n,i,this.imagePool);if(l){var u,h=h2(t,"strokeStyle",l,r.currentContext);s=null!==(u=s)&&void 0!==u?u:h}}t.stroke()}null!==s&&h2(t,"strokeStyle",s,r.currentContext)}},{key:"drawToContext",value:function(t,e,r,n,i){var a,o=e.nodeName,s=e.parsedStyle,l=s.opacity,u=void 0===l?h0.globalAlpha:l,h=s.fillOpacity,d=void 0===h?h0.fillOpacity:h,c=s.strokeOpacity,f=void 0===c?h0.strokeOpacity:c,p=s.lineWidth,g=void 0===p?h0.lineWidth:p,y=s.fill&&!s.fill.isNone,v=s.stroke&&!s.stroke.isNone&&g>0;if(y||v){var m=!(0,o_.default)(s.shadowColor)&&s.shadowBlur>0,b="inner"===s.shadowType,x=(null===(a=s.fill)||void 0===a?void 0:a.alpha)===0,E=!!(s.filter&&s.filter.length),w=m&&v&&(o===on.Shape.PATH||o===on.Shape.LINE||o===on.Shape.POLYLINE||x||b),_=null;if(y&&(w||this.applyShadowAndFilterStyleToContext(t,e,m,r),_=h2(t,"globalAlpha",u*d,r.currentContext),this.fillToContext(t,e,r,n,i),w||this.clearShadowAndFilterStyleForContext(t,m,E,r)),v){var S=!1,k=h2(t,"globalAlpha",u*f,r.currentContext);if(_=y?_:k,w&&(this.applyShadowAndFilterStyleToContext(t,e,m,r),S=!0,b)){var N=t.globalCompositeOperation;t.globalCompositeOperation="source-atop",this.strokeToContext(t,e,r,n,i),t.globalCompositeOperation=N,this.clearShadowAndFilterStyleForContext(t,m,E,r,!0)}this.strokeToContext(t,e,r,n,i),S&&this.clearShadowAndFilterStyleForContext(t,m,E,r)}null!==_&&h2(t,"globalAlpha",_,r.currentContext)}}}]));function h6(t,e,r){var n=t.parsedStyle,i=n.filter,a=n.shadowColor,o=n.shadowBlur,s=n.shadowOffsetX,l=n.shadowOffsetY;i&&i.length&&(e.filter=t.style.filter),r&&(e.shadowColor=a.toString(),e.shadowBlur=o||0,e.shadowOffsetX=s||0,e.shadowOffsetY=l||0)}function h5(t,e,r,n,i,a,o,s){var l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Array.isArray(r)?r.forEach(function(r){t.fillStyle=hJ(r,e,t,s),l||(n?t.fill(n):t.fill())}):((0,on.isPattern)(r)&&(t.fillStyle=hX(r,e,t,i,a,o,s)),l||(n?t.fill(n):t.fill()))}function h4(t,e,r,n,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Array.isArray(r)?r.forEach(function(r){t.strokeStyle=hJ(r,e,t,o),s||t.stroke()}):((0,on.isPattern)(r)&&(t.strokeStyle=hX(r,e,t,n,i,a,o)),s||t.stroke())}var h8=/*#__PURE__*/function(t){function e(){return /*@__PURE__*/f(oi)(this,e),/*@__PURE__*/f(oo)(this,e,arguments)}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"renderDownSampled",value:function(t,e,r,n){var i=n.src,a=n.imageCache;if(!a.downSampled){this.imagePool.createDownSampledImage(i,r).then(function(t){r.renderable.dirty=!0,r.ownerDocument.defaultView.context.renderingService.dirtify()}).catch(function(){});return}t.drawImage(a.downSampled,Math.floor(n.drawRect[0]),Math.floor(n.drawRect[1]),Math.ceil(n.drawRect[2]),Math.ceil(n.drawRect[3]))}},{key:"renderTile",value:function(t,e,r,n){var i=n.src,a=n.imageCache,o=n.imageRect,s=n.drawRect,l=a.size,u=t.getTransform(),h=u.a,d=u.b,c=u.c,f=u.d,p=u.e,g=u.f;if(t.resetTransform(),!(null!=a&&a.gridSize)){this.imagePool.createImageTiles(i,[],function(){r.renderable.dirty=!0,r.ownerDocument.defaultView.context.renderingService.dirtify()},r).catch(function(){});return}for(var y=[l[0]/o[2],l[1]/o[3]],v=[a.tileSize[0]/y[0],a.tileSize[1]/y[1]],m=[Math.floor((s[0]-o[0])/v[0]),Math.ceil((s[0]+s[2]-o[0])/v[0])],b=m[0],x=m[1],E=[Math.floor((s[1]-o[1])/v[1]),Math.ceil((s[1]+s[3]-o[1])/v[1])],w=E[0],_=E[1],S=w;S<=_;S++)for(var k=b;k<=x;k++){var N=a.tiles[S][k];if(N){var O=[Math.floor(o[0]+N.tileX*v[0]),Math.floor(o[1]+N.tileY*v[1]),Math.ceil(v[0]),Math.ceil(v[1])];t.drawImage(N.data,O[0],O[1],O[2],O[3])}}t.setTransform(h,d,c,f,p,g)}},{key:"render",value:function(t,r,n){var i=r.x,a=void 0===i?0:i,o=r.y,s=void 0===o?0:o,l=r.width,u=r.height,h=r.src,d=r.shadowColor,c=r.shadowBlur,p=this.imagePool.getImageSync(h,n),g=null==p?void 0:p.img,y=l,v=u;if(g){y||(y=g.width),v||(v=g.height),h6(n,t,!(0,o_.default)(d)&&c>0);try{var m,b,x,E,w,_,S,k,N,O,T,M,A,C,R,I,P,D,L,j,F=n.ownerDocument.defaultView.getContextService().getDomElement(),B=F.width,z=F.height,V=t.getTransform(),G=V.a,$=V.b,U=V.c,H=V.d,W=V.e,q=V.f,Y=oh.fromValues(G,U,0,0,$,H,0,0,0,0,1,0,W,q,0,1),K=(m=[a,s,y,v],b=oc.transformMat4(oc.create(),[m[0],m[1],0],Y),x=oc.transformMat4(oc.create(),[m[0]+m[2],m[1],0],Y),E=oc.transformMat4(oc.create(),[m[0],m[1]+m[3],0],Y),w=oc.transformMat4(oc.create(),[m[0]+m[2],m[1]+m[3],0],Y),[Math.min(b[0],x[0],E[0],w[0]),Math.min(b[1],x[1],E[1],w[1]),Math.max(b[0],x[0],E[0],w[0])-Math.min(b[0],x[0],E[0],w[0]),Math.max(b[1],x[1],E[1],w[1])-Math.min(b[1],x[1],E[1],w[1])]),X=(_=[0,0,B,z],k=(S=/*@__PURE__*/f(oE)(_,4))[0],N=S[1],O=S[2],T=S[3],A=(M=/*@__PURE__*/f(oE)(K,4))[0],C=M[1],R=M[2],I=M[3],P=Math.max(k,A),D=Math.max(N,C),L=Math.min(k+O,A+R),j=Math.min(N+T,C+I),L<=P||j<=D?null:[P,D,L-P,j-D]);if(!X)return;if(!n.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){e.renderFull(t,r,n,{image:g,drawRect:[a,s,y,v]});return}if(K[2]/p.size[0]<(p.downSamplingRate||.5)){this.renderDownSampled(t,r,n,{src:h,imageCache:p,drawRect:[a,s,y,v]});return}if(!hU.isSupportTile){e.renderFull(t,r,n,{image:g,drawRect:[a,s,y,v]});return}this.renderTile(t,r,n,{src:h,imageCache:p,imageRect:K,drawRect:X})}catch(t){}}}},{key:"drawToContext",value:function(t,e,r,n,i){this.render(t,e.parsedStyle,e)}}],[{key:"renderFull",value:function(t,e,r,n){t.drawImage(n.image,Math.floor(n.drawRect[0]),Math.floor(n.drawRect[1]),Math.ceil(n.drawRect[2]),Math.ceil(n.drawRect[3]))}}])}(h3),h9=/*#__PURE__*/function(t){function e(){return /*@__PURE__*/f(oi)(this,e),/*@__PURE__*/f(oo)(this,e,arguments)}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"render",value:function(t,e,r,n,i,a){r.getBounds();var o=e.lineWidth,s=void 0===o?1:o,l=e.textAlign,u=void 0===l?"start":l,h=e.textBaseline,d=void 0===h?"alphabetic":h,c=e.lineJoin,f=e.miterLimit,p=void 0===f?10:f,g=e.letterSpacing,y=void 0===g?0:g,v=e.stroke,m=e.fill,b=e.fillRule,x=e.fillOpacity,E=void 0===x?1:x,w=e.strokeOpacity,_=void 0===w?1:w,S=e.opacity,k=void 0===S?1:S,N=e.metrics,O=e.x,T=e.y,M=e.dx,A=e.dy,C=e.shadowColor,R=e.shadowBlur,I=N.font,P=N.lines,D=N.height,L=N.lineHeight,j=N.lineMetrics;t.font=I,t.lineWidth=s,t.textAlign="middle"===u?"center":u;var F=d;"alphabetic"===F&&(F="bottom"),t.lineJoin=void 0===c?"miter":c,(0,o_.default)(p)||(t.miterLimit=p);var B=void 0===T?0:T;"middle"===d?B+=-D/2-L/2:"bottom"===d||"alphabetic"===d||"ideographic"===d?B+=-D:("top"===d||"hanging"===d)&&(B+=-L);var z=(void 0===O?0:O)+(M||0);B+=A||0,1===P.length&&("bottom"===F?(F="middle",B-=.5*D):"top"===F&&(F="middle",B+=.5*D)),t.textBaseline=F,h6(r,t,!(0,o_.default)(C)&&R>0);for(var V=0;V<P.length;V++){var G=s/2+z;B+=L,(0,o_.default)(v)||v.isNone||!s||this.drawLetterSpacing(t,r,P[V],j[V],u,G,B,y,m,b,E,v,_,k,!0,n,i,a),(0,o_.default)(m)||this.drawLetterSpacing(t,r,P[V],j[V],u,G,B,y,m,b,E,v,_,k,!1,n,i,a)}}},{key:"drawLetterSpacing",value:function(t,e,r,n,i,a,o,s,l,u,h,d,c,f,p,g,y,v){if(0===s){p?this.strokeText(t,e,r,a,o,d,c,g,y,v):this.fillText(t,e,r,a,o,l,u,h,f,g,y,v);return}var m=t.textAlign;t.textAlign="left";var b=a;"center"===i||"middle"===i?b=a-n.width/2:("right"===i||"end"===i)&&(b=a-n.width);for(var x=Array.from(r),E=t.measureText(r).width,w=0,_=0;_<x.length;++_){var S=x[_];p?this.strokeText(t,e,S,b,o,d,c,g,y,v):this.fillText(t,e,S,b,o,l,u,h,f,g,y,v),b+=E-(w=t.measureText(r.substring(_+1)).width)+s,E=w}t.textAlign=m}},{key:"fillText",value:function(t,e,r,n,i,a,o,s,l,u,h,d){h5(t,e,a,o,u,h,d,this.imagePool,!0);var c,f=!(0,o_.default)(s)&&1!==s;f&&(c=t.globalAlpha,t.globalAlpha=s*l),t.fillText(r,n,i),f&&(t.globalAlpha=c)}},{key:"strokeText",value:function(t,e,r,n,i,a,o,s,l,u){h4(t,e,a,s,l,u,this.imagePool,!0);var h,d=!(0,o_.default)(o)&&1!==o;d&&(h=t.globalAlpha,t.globalAlpha=o),t.strokeText(r,n,i),d&&(t.globalAlpha=h)}},{key:"drawToContext",value:function(t,e,r,n,i){this.render(t,e.parsedStyle,e,e.ownerDocument.defaultView.context,n,i)}}])}(h3),h7=/*#__PURE__*/function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return /*@__PURE__*/f(oi)(this,e),(t=/*@__PURE__*/f(oo)(this,e)).name="canvas-renderer",t.options=r,t}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"init",value:function(){var t,e=/*@__PURE__*/f(hf)({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),r=this.context.imagePool,n=new h3(r),i=(t={},/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(t,on.Shape.CIRCLE,n),on.Shape.ELLIPSE,n),on.Shape.RECT,n),on.Shape.IMAGE,new h8(r)),on.Shape.TEXT,new h9(r)),on.Shape.LINE,n),on.Shape.POLYLINE,n),on.Shape.POLYGON,n),on.Shape.PATH,n),on.Shape.GROUP,void 0),/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(/*@__PURE__*/f(u7)(t,on.Shape.HTML,void 0),on.Shape.MESH,void 0),on.Shape.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=i,this.context.styleRendererFactory=i,this.addRenderingPlugin(new hK(e))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(on.AbstractRendererPlugin),oi=y("fu0YK"),oa=y("lR7jo"),oo=y("jLNr1"),os=y("f8wIT"),on=y("2eDEB"),dt=/*#__PURE__*/function(){function t(){/*@__PURE__*/f(oi)(this,t)}return /*@__PURE__*/f(oa)(t,[{key:"apply",value:function(e,r){var n=this,i=e.renderingService,a=e.renderingContext,o=e.config;this.context=e;var s=a.root.ownerDocument.defaultView,l=function(t){i.hooks.pointerMove.call(t)},u=function(t){i.hooks.pointerUp.call(t)},h=function(t){i.hooks.pointerDown.call(t)},d=function(t){i.hooks.pointerOver.call(t)},c=function(t){i.hooks.pointerOut.call(t)},f=function(t){i.hooks.pointerCancel.call(t)},p=function(t){i.hooks.pointerWheel.call(t)},g=function(t){i.hooks.click.call(t)},y=function(t){r.globalThis.document.addEventListener("pointermove",l,!0),t.addEventListener("pointerdown",h,!0),t.addEventListener("pointerleave",c,!0),t.addEventListener("pointerover",d,!0),r.globalThis.addEventListener("pointerup",u,!0),r.globalThis.addEventListener("pointercancel",f,!0)},v=function(t){t.addEventListener("touchstart",h,!0),t.addEventListener("touchend",u,!0),t.addEventListener("touchmove",l,!0),t.addEventListener("touchcancel",f,!0)},m=function(t){r.globalThis.document.addEventListener("mousemove",l,!0),t.addEventListener("mousedown",h,!0),t.addEventListener("mouseout",c,!0),t.addEventListener("mouseover",d,!0),r.globalThis.addEventListener("mouseup",u,!0)},b=function(t){r.globalThis.document.removeEventListener("pointermove",l,!0),t.removeEventListener("pointerdown",h,!0),t.removeEventListener("pointerleave",c,!0),t.removeEventListener("pointerover",d,!0),r.globalThis.removeEventListener("pointerup",u,!0),r.globalThis.removeEventListener("pointercancel",f,!0)},x=function(t){t.removeEventListener("touchstart",h,!0),t.removeEventListener("touchend",u,!0),t.removeEventListener("touchmove",l,!0),t.removeEventListener("touchcancel",f,!0)},E=function(t){r.globalThis.document.removeEventListener("mousemove",l,!0),t.removeEventListener("mousedown",h,!0),t.removeEventListener("mouseout",c,!0),t.removeEventListener("mouseover",d,!0),r.globalThis.removeEventListener("mouseup",u,!0)};i.hooks.init.tap(t.tag,function(){var t=n.context.contextService.getDomElement();r.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="none",t.style.msTouchAction="none"):s.supportsPointerEvents&&(t.style.touchAction="none"),s.supportsPointerEvents?y(t):m(t),s.supportsTouchEvents&&v(t),o.useNativeClickEvent&&t.addEventListener("click",g,!0),t.addEventListener("wheel",p,{passive:!0,capture:!0})}),i.hooks.destroy.tap(t.tag,function(){var t=n.context.contextService.getDomElement();r.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="",t.style.msTouchAction=""):s.supportsPointerEvents&&(t.style.touchAction=""),s.supportsPointerEvents?b(t):E(t),s.supportsTouchEvents&&x(t),o.useNativeClickEvent&&t.removeEventListener("click",g,!0),t.removeEventListener("wheel",p,!0)})}}])}();dt.tag="DOMInteraction";var de=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(oi)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(oo)(this,e,[].concat(n))).name="dom-interaction",t}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"init",value:function(){this.addRenderingPlugin(new dt)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(on.AbstractRendererPlugin),oi=y("fu0YK"),oa=y("lR7jo"),oo=y("jLNr1"),os=y("f8wIT"),on=y("2eDEB"),o_=y("geZBG"),ol=y("jyI49"),ou=y("kVcyu"),dr=/*#__PURE__*/function(){function t(){/*@__PURE__*/f(oi)(this,t),this.displayObjectHTMLElementMap=new WeakMap}return /*@__PURE__*/f(oa)(t,[{key:"joinTransformMatrix",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return"matrix(".concat([t[0],t[1],t[4],t[5],t[12]+e[0],t[13]+e[1]].join(","),")")}},{key:"apply",value:function(e,r){var n=this,i=e.camera,a=e.renderingContext,o=e.renderingService;this.context=e;var s=a.root.ownerDocument.defaultView,l=s.context.eventService.nativeHTMLMap,u=function(t,e){e.style.transform=n.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())},h=function(t){var e=t.target;if(e.nodeName===on.Shape.HTML){n.$camera||(n.$camera=n.createCamera(i));var r=n.getOrCreateEl(e);n.$camera.appendChild(r),Object.keys(e.attributes).forEach(function(t){n.updateAttribute(t,e)}),u(e,r),l.set(r,e)}},d=function(t){var e=t.target;if(e.nodeName===on.Shape.HTML&&n.$camera){var r=n.getOrCreateEl(e);r&&(r.remove(),l.delete(r))}},c=function(t){var e=t.target;if(e.nodeName===on.Shape.HTML){var r=t.attrName;n.updateAttribute(r,e)}},f=function(t){var e=t.target;(e.nodeName===on.Shape.FRAGMENT?e.childNodes:[e]).forEach(function(t){if(t.nodeName===on.Shape.HTML){var e=n.getOrCreateEl(t);u(t,e)}})},p=function(){if(n.$camera){var t=n.context.config,e=t.width,r=t.height;n.$camera.parentElement.style.width="".concat(e||0,"px"),n.$camera.parentElement.style.height="".concat(r||0,"px")}};o.hooks.init.tap(t.tag,function(){s.addEventListener(on.CanvasEvent.RESIZE,p),s.addEventListener(on.ElementEvent.MOUNTED,h),s.addEventListener(on.ElementEvent.UNMOUNTED,d),s.addEventListener(on.ElementEvent.ATTR_MODIFIED,c),s.addEventListener(on.ElementEvent.BOUNDS_CHANGED,f)}),o.hooks.endFrame.tap(t.tag,function(){n.$camera&&a.renderReasons.has(on.RenderReason.CAMERA_CHANGED)&&(n.$camera.style.transform=n.joinTransformMatrix(i.getOrthoMatrix()))}),o.hooks.destroy.tap(t.tag,function(){n.$camera&&n.$camera.remove(),s.removeEventListener(on.CanvasEvent.RESIZE,p),s.removeEventListener(on.ElementEvent.MOUNTED,h),s.removeEventListener(on.ElementEvent.UNMOUNTED,d),s.removeEventListener(on.ElementEvent.ATTR_MODIFIED,c),s.removeEventListener(on.ElementEvent.BOUNDS_CHANGED,f)})}},{key:"createCamera",value:function(t){var e=this.context.config,r=e.document,n=e.width,i=e.height,a=this.context.contextService.getDomElement(),o=a.parentNode;if(o){var s="g-canvas-camera",l=o.querySelector("#".concat(s));if(!l){var u=(r||document).createElement("div");u.style.overflow="hidden",u.style.pointerEvents="none",u.style.position="absolute",u.style.left="0px",u.style.top="0px",u.style.width="".concat(n||0,"px"),u.style.height="".concat(i||0,"px");var h=(r||document).createElement("div");l=h,h.id=s,h.style.position="absolute",h.style.left="".concat(a.offsetLeft||0,"px"),h.style.top="".concat(a.offsetTop||0,"px"),h.style.transformOrigin="left top",h.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),h.style.pointerEvents="none",h.style.width="100%",h.style.height="100%",u.appendChild(h),o.appendChild(u)}return l}return null}},{key:"getOrCreateEl",value:function(t){var e=this.context.config.document,r=this.displayObjectHTMLElementMap.get(t);return r||(r=(e||document).createElement("div"),t.parsedStyle.$el=r,this.displayObjectHTMLElementMap.set(t,r),t.id&&(r.id=t.id),t.name&&r.setAttribute("name",t.name),t.className&&(r.className=t.className),r.style.position="absolute",r.style["will-change"]="transform",r.style.transform=this.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())),r}},{key:"updateAttribute",value:function(t,e){var r=this.getOrCreateEl(e);switch(t){case"innerHTML":var n=e.parsedStyle.innerHTML;(0,ou.default)(n)?r.innerHTML=n:(r.innerHTML="",r.appendChild(n));break;case"x":r.style.left="".concat(e.parsedStyle.x,"px");break;case"y":r.style.top="".concat(e.parsedStyle.y,"px");break;case"transformOrigin":var i=e.parsedStyle.transformOrigin;r.style["transform-origin"]="".concat(i[0].buildCSSText(null,null,"")," ").concat(i[1].buildCSSText(null,null,""));break;case"width":var a=e.parsedStyle.width;r.style.width=(0,ol.default)(a)?"".concat(a,"px"):a.toString();break;case"height":var o=e.parsedStyle.height;r.style.height=(0,ol.default)(o)?"".concat(o,"px"):o.toString();break;case"zIndex":var s=e.parsedStyle.zIndex;r.style["z-index"]="".concat(s);break;case"visibility":var l=e.parsedStyle.visibility;r.style.visibility=l;break;case"pointerEvents":var u=e.parsedStyle.pointerEvents;r.style.pointerEvents=void 0===u?"auto":u;break;case"opacity":var h=e.parsedStyle.opacity;r.style.opacity="".concat(h);break;case"fill":var d=e.parsedStyle.fill,c="";(0,on.isCSSRGB)(d)?c=d.isNone?"transparent":e.getAttribute("fill"):Array.isArray(d)?c=e.getAttribute("fill"):(0,on.isPattern)(d),r.style.background=c;break;case"stroke":var f=e.parsedStyle.stroke,p="";(0,on.isCSSRGB)(f)?p=f.isNone?"transparent":e.getAttribute("stroke"):Array.isArray(f)?p=e.getAttribute("stroke"):(0,on.isPattern)(f),r.style["border-color"]=p,r.style["border-style"]="solid";break;case"lineWidth":var g=e.parsedStyle.lineWidth;r.style["border-width"]="".concat(g||0,"px");break;case"lineDash":r.style["border-style"]="dashed";break;case"filter":var y=e.style.filter;r.style.filter=y;break;default:(0,o_.default)(e.style[t])||""===e.style[t]||(r.style[t]=e.style[t])}}}])}();dr.tag="HTMLRendering";var dn=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(oi)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(oo)(this,e,[].concat(n))).name="html-renderer",t}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"init",value:function(){this.addRenderingPlugin(new dr)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(on.AbstractRendererPlugin),hu=y("8HV7i"),hh=y("fOd0O"),ou=y("kVcyu"),di=/*@__PURE__*/f(oa)(function t(e){/*@__PURE__*/f(oi)(this,t),this.renderingContext=e.renderingContext,this.canvasConfig=e.config},[{key:"init",value:function(){var t=this.canvasConfig,e=t.container,r=t.canvas;if(r)this.$canvas=r,e&&r.parentElement!==e&&e.appendChild(r),this.$container=r.parentElement,this.canvasConfig.container=this.$container;else if(e&&(this.$container=(0,ou.default)(e)?document.getElementById(e):e,this.$container)){var n=document.createElement("canvas");this.$container.appendChild(n),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=n}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(t,e){var r=this.canvasConfig.devicePixelRatio||on.isBrowser&&window.devicePixelRatio||1;r=r>=1?Math.ceil(r):1,this.dpr=r,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*e,(0,on.setDOMSize)(this.$canvas,t,e)),this.renderingContext.renderReasons.add(on.RenderReason.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)}},{key:"toDataURL",value:(yA=/*@__PURE__*/f(hh)(/*#__PURE__*//*@__PURE__*/f(hu)().mark(function t(){var e,r,n,i=arguments;return /*@__PURE__*/f(hu)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=(e=i.length>0&&void 0!==i[0]?i[0]:{}).type,n=e.encoderOptions,t.abrupt("return",this.context.canvas.toDataURL(r,n));case 3:case"end":return t.stop()}},t,this)})),function(){return yA.apply(this,arguments)})}]),da=/*#__PURE__*/function(t){function e(){var t;/*@__PURE__*/f(oi)(this,e);for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=/*@__PURE__*/f(oo)(this,e,[].concat(n))).name="canvas-context-register",t}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"init",value:function(){this.context.ContextService=di}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(on.AbstractRendererPlugin),ds=/*#__PURE__*/function(t){function e(t){var r;return /*@__PURE__*/f(oi)(this,e),(r=/*@__PURE__*/f(oo)(this,e,[t])).registerPlugin(new da),r.registerPlugin(new hq),r.registerPlugin(new hs),r.registerPlugin(new h7),r.registerPlugin(new de),r.registerPlugin(new hD),r.registerPlugin(new dn),r}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e)}(on.AbstractRenderer),o_=y("geZBG"),dl=y("aFcWQ"),sR=y("1uF5a"),sc=y("6JKSc"),du=function(t,e){if(t){if((0,sR.default)(t))for(var r=0,n=t.length;r<n&&!1!==e(t[r],r);r++);else if((0,sc.default)(t)){for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break}}},dh=Object.prototype.hasOwnProperty,dd=function(t,e){if(null===t||!lI(t))return{};var r={};return du(e,function(e){dh.call(t,e)&&(r[e]=t[e])}),r},dc=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class df extends uQ{constructor(t){super(Object.assign(Object.assign({},t),{style:Object.assign({},df.defaultStyleProps,t.style)})),this.rootPointerEvent=new on.FederatedPointerEvent(null),this.forwardEvents=t=>{let e=this.context.canvas,r=e.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(t,r).forEach(n=>{let i=this.bootstrapEvent(this.rootPointerEvent,n,r,t);up(e.context.eventService,"mappingTable.pointerupoutside",[]),e.context.eventService.mapEvent(i)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[yB.CLICK,yB.POINTER_DOWN,yB.POINTER_MOVE,yB.POINTER_UP,yB.POINTER_OVER,yB.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}getKeyStyle(t){let e=dd(t,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:r=0,dy:n=0}=e,i=dc(e,["dx","dy"]),[a,o]=this.getSize(t);return Object.assign(Object.assign({x:r,y:n},i),{width:a,height:o})}drawKeyShape(t,e){let r=this.getKeyStyle(t),{x:n,y:i,width:a=0,height:o=0}=r,s=this.upsert("key-container",on.Rect,{x:n,y:i,width:a,height:o,opacity:0},e);return this.upsert("key",on.HTML,r,s)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof ds))return;let t=this.getDomElement();this.events.forEach(e=>{t.addEventListener(e,this.forwardEvents)})}attributeChangedCallback(t,e,r){"zIndex"===t&&e!==r&&(this.getDomElement().style.zIndex=r)}destroy(){let t=this.getDomElement();this.events.forEach(e=>{t.removeEventListener(e,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,e){let r=[];if(e.isTouchEvent(t))for(let e=0;e<t.changedTouches.length;e++){let n=t.changedTouches[e];(0,dl.default)(n.button)&&(n.button=0),(0,dl.default)(n.buttons)&&(n.buttons=1),(0,dl.default)(n.isPrimary)&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,dl.default)(n.width)&&(n.width=n.radiusX||1),(0,dl.default)(n.height)&&(n.height=n.radiusY||1),(0,dl.default)(n.tiltX)&&(n.tiltX=0),(0,dl.default)(n.tiltY)&&(n.tiltY=0),(0,dl.default)(n.pointerType)&&(n.pointerType="touch"),(0,dl.default)(n.pointerId)&&(n.pointerId=n.identifier||0),(0,dl.default)(n.pressure)&&(n.pressure=n.force||.5),(0,dl.default)(n.twist)&&(n.twist=0),(0,dl.default)(n.tangentialPressure)&&(n.tangentialPressure=0),n.isNormalized=!0,n.type=t.type,r.push(n)}else e.isMouseEvent(t)&&((0,dl.default)(t.isPrimary)&&(t.isPrimary=!0),(0,dl.default)(t.width)&&(t.width=1),(0,dl.default)(t.height)&&(t.height=1),(0,dl.default)(t.tiltX)&&(t.tiltX=0),(0,dl.default)(t.tiltY)&&(t.tiltY=0),(0,dl.default)(t.pointerType)&&(t.pointerType="mouse"),(0,dl.default)(t.pointerId)&&(t.pointerId=1),(0,dl.default)(t.pressure)&&(t.pressure=.5),(0,dl.default)(t.twist)&&(t.twist=0),(0,dl.default)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),r.push(t);return r}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}bootstrapEvent(t,e,r,n){t.view=r,t.originalEvent=null,t.nativeEvent=n,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);let{x:i,y:a}=this.getViewportXY(e);t.viewport.x=i,t.viewport.y=a;let[o,s]=this.context.canvas.getCanvasByViewport([i,a]);return t.canvas.x=o,t.canvas.y=s,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=n.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t}getViewportXY(t){let e,r;let{offsetX:n,offsetY:i,clientX:a,clientY:o}=t;if(!this.context.canvas.context.config.supportsCSSTransform||(0,o_.default)(n)||(0,o_.default)(i)){let t=this.eventService.client2Viewport({x:a,y:o});e=t.x,r=t.y}else e=n,r=i;return{x:e,y:r}}onframe(){super.onframe();let{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}}df.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var on=y("2eDEB"),dp=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class dg extends uQ{constructor(t){super(u_({style:dg.defaultStyleProps},t))}getKeyStyle(t){let[e,r]=this.getSize(t),n=super.getKeyStyle(t),{fillOpacity:i,opacity:a=i}=n;return Object.assign(Object.assign({opacity:a},dp(n,["fillOpacity","opacity"])),{width:e,height:r,x:-e/2,y:-r/2})}getHaloStyle(t){if(!1===t.halo)return!1;let e=this.getShape("key").attributes,{fill:r,stroke:n}=e;dp(e,["fill","stroke"]);let i=uv(this.getGraphicStyle(t),"halo"),a=Number(i.lineWidth),[o,s]=lL(this.getSize(t),[a,a]);return Object.assign(Object.assign({},i),{width:o,height:s,fill:"transparent",x:-o/2,y:-s/2})}getIconStyle(t){let e=super.getIconStyle(t),[r,n]=this.getSize(t);return!!e&&Object.assign({width:.8*r,height:.8*n},e)}drawKeyShape(t,e){let r=this.upsert("key",uH,this.getKeyStyle(t),e);return uY(this),r}drawHaloShape(t,e){this.upsert("halo",on.Rect,this.getHaloStyle(t),e)}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&uK(this)}}dg.defaultStyleProps={size:32};var on=y("2eDEB");class dy extends u1{constructor(t){super(u_({style:dy.defaultStyleProps},t))}getPoints(t){let{direction:e}=t,[r,n]=this.getSize(t);return function(t,e,r){let n=e/2,i=t/2,a={up:[[-i,n],[i,n],[0,-n]],left:[[-i,0],[i,n],[i,-n]],right:[[-i,n],[-i,-n],[i,0]],down:[[-i,-n],[i,-n],[0,n]]};return a[r]||a.up}(r,n,e)}getPortXY(t,e){let{direction:r}=t,{placement:n="top"}=e,i=this.getShape("key").getLocalBounds(),[a,o]=this.getSize(t);return cs(i,n,function(t,e,r){let n=e/2,i=t/2,a={};return"down"===r?(a.bottom=a.default=[0,n],a.right=[i,-n],a.left=[-i,-n]):"left"===r?(a.top=[i,-n],a.bottom=[i,n],a.left=a.default=[-i,0]):"right"===r?(a.top=[-i,-n],a.bottom=[-i,n],a.right=a.default=[i,0]):(a.left=[-i,n],a.top=a.default=[0,-n],a.right=[i,n]),a}(a,o,r),!1)}getIconStyle(t){let{icon:e,iconText:r,iconSrc:n,direction:i}=t;if(!1===e||uD(r||n))return!1;let a=uv(this.getGraphicStyle(t),"icon"),o=this.getShape("key").getLocalBounds(),[s,l]=function(t,e){let{center:r}=t,[n,i]=s$(t);return["up"===e||"down"===e?r[0]:"right"===e?r[0]-n/6:r[0]+n/6,"left"===e||"right"===e?r[1]:"down"===e?r[1]-i/6:r[1]+i/6]}(o,i),u=2*function(t,e){let[r,n]=s$(t);return[r,n]="up"===e||"down"===e?[r,n]:[n,r],(Math.pow(n,2)-Math.pow(Math.sqrt(Math.pow(r/2,2)+Math.pow(n,2))-r/2,2))/(2*n)}(o,i)*.8;return Object.assign({x:s,y:l,width:u,height:u},a)}}dy.defaultStyleProps={size:40,direction:"up"};var dv=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class dm extends uQ{constructor(t){super(u_({style:dm.defaultStyleProps},t)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(t){let{collapsed:e,childrenNode:r=[]}=t;return 0===r.length?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){let{padding:e,collapsedSize:r}=t,[n,i,a,o]=sz(e);return lL(ux(r),[o+i,n+a,0])}getCollapsedKeySize(t){return ux(t.collapsedSize)}getExpandedKeySize(t){let e=this.getContentBBox(t);return[sV(e),sG(e),0]}getContentBBox(t){let{childrenNode:e=[],padding:r}=t,n=e.map(t=>this.context.element.getElement(t)).filter(Boolean);if(0===n.length){let e=new on.AABB,{x:r=0,y:n=0,size:i}=t,[a,o]=ux(i);return e.setMinMax([r-a/2,n-o/2,0],[r+a/2,n+o/2,0]),e}let i=sq(n.map(t=>t.getBounds()));return r?sW(i,r):i}drawCollapsedMarkerShape(t,e){let r=this.getCollapsedMarkerStyle(t);uk(this,"collapsedMarker",r)&&(this.upsert("collapsed-marker",uX,r,e),uY(this))}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;let e=uv(this.getGraphicStyle(t),"collapsedMarker"),{type:r}=e,n=dv(e,["type"]),[i,a]=l0(this.getShape("key").getLocalBounds(),"center"),o=Object.assign(Object.assign({},n),{x:i,y:a});return r&&Object.assign(o,{text:this.getCollapsedMarkerText(r,t)}),o}getCollapsedMarkerText(t,e){let{childrenData:r=[]}=e,{model:n}=this.context;return"descendant-count"===t?n.getDescendantsData(this.id).length.toString():"child-count"===t?r.length.toString():"node-count"===t?n.getDescendantsData(this.id).filter(t=>"node"===n.getElementType(lg(t))).length.toString():(0,sI.default)(t)?t(r):""}getComboPosition(t){let{x:e=0,y:r=0,collapsed:n,childrenData:i=[]}=t;if(0===i.length)return[+e,+r,0];if(n){let{model:t}=this.context,n=t.getDescendantsData(this.id).filter(e=>!t.isCombo(lg(e)));return n.length>0&&n.some(lQ)?lB(n.reduce((t,e)=>lL(t,lZ(e)),[0,0,0]),n.length):[+e,+r,0]}return this.getContentBBox(t).center}getComboStyle(t){let[e,r]=this.getComboPosition(t);return{x:e,y:r,transform:[["translate",e,r]]}}updateComboPosition(t){let e=this.getComboStyle(t);Object.assign(this.style,e);let{x:r,y:n}=e;this.context.model.syncComboDatum({id:this.id,style:{x:r,y:n}}),uK(this)}render(t,e=this){super.render(t,e),this.drawCollapsedMarkerShape(t,e)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,e){let r=super.animate(this.attributes.collapsed?t:t.map(t=>{var{x:e,y:r,z:n,transform:i}=t;return dv(t,["x","y","z","transform"])}),e);return r?new Proxy(r,{set:(t,e,r)=>("currentTime"===e&&Promise.resolve().then(()=>this.onframe()),Reflect.set(t,e,r))}):r}}dm.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};var on=(y("2eDEB"),y("2eDEB"),y("2eDEB")),sI=y("ky7aH"),ol=y("jyI49"),db=function(t,e){if(!sh(t))return t;for(var r=[],n=0;n<t.length;n++){var i=t[n];e(i,n)&&r.push(i)}return r};const dx={padding:10};function dE(t,e,r,n,i,a){let{padding:o}=Object.assign(dx,a),s=sU(r,o),l=sU(n,o),u=[t,...i,e],h=null,d=[];for(let t=0,e=u.length;t<e-1;t++){var c,f;let r=t+1,n=u[t],i=u[r],a=(c=n,f=i,c[1]===f[1]||c[0]===f[0]),p=null;if(0===t){if(r===e-1){if(s.intersects(l))p=dM(n,i,s,l);else if(sX(n,s)||sX(i,l))a||(p=function(t,e,r,n){let i=dO(t,e,r),a=lq(i.points[0]);if(sY(a,n)){let o=lq((i=dO(e,t,n)).points[0]);if(sY(o,r)){let s=l6(t,a,dk(r,dS(t,a))/2),l=l6(e,o,dk(n,dS(e,o))/2),u=[(s[0]+l[0])/2,(s[1]+l[1])/2],h=dO(t,u,r),d=dT(u,e,n,h.direction);i.points=[h.points[0],d.points[0]],i.direction=d.direction}}return i}(n,i,s,l));else{let t=sZ(n,s),e=sZ(i,l);(p=dN(t,e,dS(t,e))).points.unshift(t),p.points.push(e)}}else sY(i,s)?p=dM(n,i,s,sU(i,o),h):a||(p=dO(n,i,s))}else r===e-1?sY(n,l)?p=dM(n,i,sU(n,o),l,h):a||(p=dT(n,i,l,h)):a||(p=dN(n,i,h));p?(d.push(...p.points),h=p.direction):h=dS(n,i),r<e-1&&d.push(i)}return d.map(lW)}const dw={N:"S",S:"N",W:"E",E:"W"},d_={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function dS(t,e){let[r,n]=t,[i,a]=e;return r===i?n>a?"N":"S":n===a?r>i?"W":"E":null}function dk(t,e){return"N"===e||"S"===e?sG(t):sV(t)}function dN(t,e,r){let n=[t[0],e[1]],i=[e[0],t[1]],a=dS(t,n),o=dS(t,i),s=r?dw[r]:null,l=a===r||a!==s&&o!==r?n:i;return{points:[l],direction:dS(l,e)}}function dO(t,e,r){if(sX(t,r)){let n=dA(t,e,r);return{points:[n],direction:dS(n,e)}}{let n=sZ(t,r),i=["left","right"].includes(sJ(t,r))?[e[0],n[1]]:[n[0],e[1]];return{points:[i],direction:dS(i,e)}}}function dT(t,e,r,n){let i=sX(e,r)?e:sZ(e,r),a=[[i[0],t[1]],[t[0],i[1]]],o=a.filter(t=>!sY(t,r)&&!sK(t,r,!0)),s=o.filter(e=>dS(e,t)!==n);if(s.length>0){let r=s.find(e=>dS(t,e)===n)||s[0];return{points:[r],direction:dS(r,e)}}{var l;let i=l6(e,(void 0===(l=o)&&(l=[]),db(a,function(t){var e;return!(sh(e=l)&&e.indexOf(t)>-1)}))[0],dk(r,n)/2);return{points:[dA(i,t,r),i],direction:dS(i,e)}}}function dM(t,e,r,n,i){let a;let o=sq([r,n]),s=lV(e,o.center)>lV(t,o.center),[l,u]=s?[e,t]:[t,e],h=sG(o)+sV(o);if(i){let t=[l[0]+h*Math.cos(d_[i]),l[1]+h*Math.sin(d_[i])];a=l6(sZ(t,o),t,.01)}else a=l6(sZ(l,o),l,-.01);let d=dA(a,u,o),c=[l3(a,2),l3(d,2)];if(sd(l3(a),l3(d))){let t=lU(lj(a,l),[1,0,0])+Math.PI/2,e=dA(a,d=l3(l6(sZ(d=[u[0]+h*Math.cos(t),u[1]+h*Math.sin(t),0],o),u,-.01),2),o);c=[a,e,d]}return{points:s?c.reverse():c,direction:s?dS(a,e):dS(d,e)}}function dA(t,e,r){let n=[t[0],e[1]];return sY(n,r)&&(n=[e[0],t[1]]),n}function dC(t,e,r,n,i){let a="number"==typeof e?e:.5;"start"===e&&(a=0),"end"===e&&(a=.99);let o=l1(t.getPoint(a)),s=l1(t.getPoint(a+.01)),l="start"===e?"left":"end"===e?"right":"center";if(o[1]===s[1]||!r){let[e,r]=dR(t,a,n,i);return{transform:[["translate",e,r]],textAlign:l}}let u=Math.atan2(s[1]-o[1],s[0]-o[0]);s[0]<o[0]&&(l="center"===l?l:"left"===l?"right":"left",n*=-1,u+=Math.PI);let[h,d]=dR(t,a,n,i,u);return{textAlign:l,transform:[["translate",h,d],["rotate",u/Math.PI*180]]}}function dR(t,e,r,n,i){let[a,o]=l1(t.getPoint(e)),s=r,l=n;return i&&(s=r*Math.cos(i)-n*Math.sin(i),l=r*Math.sin(i)+n*Math.cos(i)),[a+s,o+l]}function dI(t,e,r,n){if(sd(t,e))return t;let i=lj(e,t),a=[t[0]+r*i[0],t[1]+r*i[1]],o=l$(lH(i,!1));return a[0]+=n*o[0],a[1]+=n*o[1],a}function dP(t,e,r){return[["M",t[0],t[1]],["C",r[0][0],r[0][1],r[1][0],r[1][1],e[0],e[1]]]}function dD(t,e=0,r=!1){let n=t[0],i=t[t.length-1],a=t.slice(1,t.length-1),o=[["M",n[0],n[1]]];return a.forEach((t,r)=>{let s=a[r-1]||n,l=a[r+1]||i;if(!lK([s,t],[t,l])&&e){let[r,n]=function(t,e,r,n){let i=lG(t,e),a=lG(r,e),o=Math.min(n,Math.min(i,a)/2);return[[e[0]-o/i*(e[0]-t[0]),e[1]-o/i*(e[1]-t[1])],[e[0]-o/a*(e[0]-r[0]),e[1]-o/a*(e[1]-r[1])]]}(s,t,l,e);o.push(["L",r[0],r[1]],["Q",t[0],t[1],n[0],n[1]],["L",n[0],n[1]])}else o.push(["L",t[0],t[1]])}),o.push(["L",i[0],i[1]]),r&&o.push(["Z"]),o}const dL=t=>{let e=Math.PI/2,r=sG(t)/2,n=sV(t)/2,i=Math.atan2(r,n)/2,a=Math.atan2(n,r)/2;return{top:[-e-a,-e+a],"top-right":[-e+a,-i],"right-top":[-e+a,-i],right:[-i,i],"bottom-right":[i,e-a],"right-bottom":[i,e-a],bottom:[e-a,e+a],"bottom-left":[e+a,Math.PI-i],"left-bottom":[e+a,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-e-a],"left-top":[Math.PI+i,-e-a]}};function dj(t,e,r,n,i){let a=sU(t),o=t.getCenter(),s=n&&ch(n),l=i&&ch(i);if(!s||!l){let n=dL(a),i=n[e][0],u=n[e][1],[h,d]=s$(a),c=Math.max(h,d),f=lL(o,[c*Math.cos(i),c*Math.sin(i),0]),p=lL(o,[c*Math.cos(u),c*Math.sin(u),0]);s=cp(t,f),l=cp(t,p),r||([s,l]=[l,s])}return[s,l]}function dF(t,e){let r=new Set,n=new Set,i=new Set;return t.forEach(a=>{e(a).forEach(e=>{r.add(e),t.includes(e.source)&&t.includes(e.target)?n.add(e):i.add(e)})}),{edges:Array.from(r),internal:Array.from(n),external:Array.from(i)}}function dB(t,e){let r=[],n=t;for(;n;){r.push(n);let t=e(lg(n));if(t)n=t;else break}if(r.some(t=>{var e;return null===(e=t.style)||void 0===e?void 0:e.collapsed})){let t=r.reverse().findIndex(uc);return r[t]||r.at(-1)}return t}var dz={};n(dz,"circle",()=>dV),n(dz,"triangle",()=>dG),n(dz,"diamond",()=>d$),n(dz,"vee",()=>dU),n(dz,"rect",()=>dH),n(dz,"triangleRect",()=>dW),n(dz,"simple",()=>dq);const dV=(t,e)=>{let r=Math.max(t,e)/2;return[["M",-t/2,0],["A",r,r,0,1,0,2*r-t/2,0],["A",r,r,0,1,0,-t/2,0],["Z"]]},dG=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",t/2,e/2],["Z"]],d$=(t,e)=>[["M",-t/2,0],["L",0,-e/2],["L",t/2,0],["L",0,e/2],["Z"]],dU=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",4*t/5-t/2,0],["L",t/2,e/2],["Z"]],dH=(t,e)=>[["M",-t/2,-e/2],["L",t/2,-e/2],["L",t/2,e/2],["L",-t/2,e/2],["Z"]],dW=(t,e)=>{let r=t/2,n=t/7,i=t-n;return[["M",-r,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-r,-e/2],["L",i+n-r,-e/2],["L",i+n-r,e/2],["L",i-r,e/2],["Z"]]},dq=(t,e)=>[["M",t/2,-e/2],["L",-t/2,0],["L",t/2,0],["L",-t/2,0],["L",t/2,e/2]];var dY=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class dK extends uJ{constructor(t){super(u_({style:dK.defaultStyleProps},t)),this.type="edge"}get sourceNode(){let{sourceNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}get targetNode(){let{targetNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}getKeyStyle(t){let e=this.getGraphicStyle(t),{loop:r}=e,n=dY(e,["loop"]),{sourceNode:i,targetNode:a}=this;return Object.assign({d:r&&i&&a&&i===a?this.getLoopPath(t):this.getKeyPath(t)},ub(n,["halo","label","startArrow","endArrow"]))}getLoopPath(t){let{sourcePort:e,targetPort:r}=t,n=this.sourceNode,i=sU(n),a=Math.max(sV(i),sG(i)),{placement:o,clockwise:s,dist:l=a}=uv(this.getGraphicStyle(t),"loop");return function(t,e,r,n,i,a){let o=t.getPorts()[i||a],s=t.getPorts()[a||i],[l,u]=dj(t,e,r,o,s),h=function(t,e,r,n){let i=t.getCenter();if(sd(e,r)){let t=lj(e,i),a=[n*Math.sign(t[0])||n/2,n*Math.sign(t[1])||-n/2,0];return[lL(e,a),lL(r,lF(a,[1,-1,1]))]}return[l6(i,e,lV(i,e)+n),l6(i,r,lV(i,r)+n)]}(t,l,u,n);return o&&(l=cf(o,h[0])),s&&(u=cf(s,h[h.length-1])),dP(l,u,h)}(n,o,s,l,e,r)}getEndpoints(t,e=!0,r=[]){let{sourcePort:n,targetPort:i}=t,{sourceNode:a,targetNode:o}=this,[s,l]=[cd(a,o,n,i),cd(o,a,i,n)];if(!e)return[s?ch(s):a.getCenter(),l?ch(l):o.getCenter()];let u="function"==typeof r?r():r;return[cc(s||a,u[0]||l||o),cc(l||o,u[u.length-1]||s||a)]}getHaloStyle(t){if(!1===t.halo)return!1;let e=this.getKeyStyle(t),r=uv(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign({},e),r)}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;let e=uv(this.getGraphicStyle(t),"label"),{placement:r,offsetX:n,offsetY:i,autoRotate:a,maxWidth:o}=e,s=dY(e,["placement","offsetX","offsetY","autoRotate","maxWidth"]),l=dC(this.shapeMap.key,r,a,n,i),u=this.shapeMap.key.getLocalBounds();return Object.assign({wordWrapWidth:function(t,e,r=1){return uM(lV(t[0],t[1])*r,e)}([u.min,u.max],o)},l,s)}getBadgeStyle(t){if(!1===t.badge||!t.badgeText)return!1;let e=uv(t,"badge"),{offsetX:r,offsetY:n,placement:i}=e;return Object.assign(dY(e,["offsetX","offsetY","placement"]),function(t,e,r,n,i){var a,o;let s=(null===(a=t.badge)||void 0===a?void 0:a.getGeometryBounds().halfExtents[0])*2||0,l=(null===(o=t.label)||void 0===o?void 0:o.getGeometryBounds().halfExtents[0])*2||0;return dC(t.key,r,!0,(l?(l/2+s/2)*("suffix"===e?1:-1):0)+n,i)}(this.shapeMap,i,t.labelPlacement,r,n))}drawArrow(t,e){var r;let n="start"===e,i=t["start"===e?"startArrow":"endArrow"],a=this.shapeMap.key;if(i){let r=this.getArrowStyle(t,n);if(!uk(this,`arrow-${e}`,r))return;let[i,o,s]=n?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],l=a.parsedStyle[i];if(l)l.attr(r);else{let t=new(r.src?on.Image:on.Path)({style:r});a.style[i]=t}a.style[o]=t[s]||r.width/2+ +r.lineWidth}else{let t=n?"markerStart":"markerEnd";null===(r=a.style[t])||void 0===r||r.destroy(),a.style[t]=null}}getArrowStyle(t,e){var r;let n=this.getShape("key").attributes,i=uv(this.getGraphicStyle(t),e?"startArrow":"endArrow"),{size:a,type:o}=i,s=dY(i,["size","type"]),[l,u]=ux((r=n.lineWidth,a||(r<4?10:4===r?12:2.5*r))),h=((0,sI.default)(o)?o:dz[o]||dz.triangle)(l,u);return Object.assign(dd(n,["stroke","strokeOpacity","fillOpacity"]),{width:l,height:u},Object.assign({},h&&{d:h,fill:"simple"===o?"":n.stroke}),s)}drawLabelShape(t,e){let r=this.getLabelStyle(t);uk(this,"label",r)&&this.upsert("label",uB,r,e)}drawHaloShape(t,e){let r=this.getHaloStyle(t);uk(this,"halo",r)&&this.upsert("halo",on.Path,r,e)}drawBadgeShape(t,e){let r=this.getBadgeStyle(t);uk(this,"badge",r)&&this.upsert("badge",uz,r,e)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,e){let r=this.getKeyStyle(t);if(uk(this,"key",r))return this.upsert("key",on.Path,r,e)}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,e){let r=super.animate(t,e);return r?new Proxy(r,{set:(t,e,r)=>("currentTime"===e&&Promise.resolve().then(()=>this.onframe()),Reflect.set(t,e,r))}):r}}dK.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class dX extends dK{constructor(t){super(u_({style:dX.defaultStyleProps},t))}getKeyPath(t){let[e,r]=this.getEndpoints(t),{controlPoints:n,curvePosition:i,curveOffset:a}=t,o=this.getControlPoints(e,r,(0,ol.default)(i)?[i,1-i]:i,(0,ol.default)(a)?[a,-a]:a,n);return dP(e,r,o)}getControlPoints(t,e,r,n,i){return(null==i?void 0:i.length)===2?i:[dI(t,e,r[0],n[0]),dI(t,e,r[1],n[1])]}}dX.defaultStyleProps={curvePosition:.5,curveOffset:20};class dJ extends dX{constructor(t){super(u_({style:dJ.defaultStyleProps},t))}getControlPoints(t,e,r,n){let i=e[0]-t[0];return[[t[0]+i*r[0]+n[0],t[1]],[e[0]-i*r[1]+n[1],e[1]]]}}dJ.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class dZ extends dX{constructor(t){super(u_({style:dZ.defaultStyleProps},t))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(t){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(t);let e=lZ(this.ref);return[this.sourceNode.getIntersectPoint(e,!0),this.targetNode.getIntersectPoint(e)]}toRadialCoordinate(t){let e=lZ(this.ref);return[lV(t,e),lY(lj(t,e))]}getControlPoints(t,e,r,n){let[i,a]=this.toRadialCoordinate(t),[o]=this.toRadialCoordinate(e),s=o-i;return[[t[0]+(s*r[0]+n[0])*Math.cos(a),t[1]+(s*r[0]+n[0])*Math.sin(a)],[e[0]-(s*r[1]-n[0])*Math.cos(a),e[1]-(s*r[1]-n[0])*Math.sin(a)]]}}dZ.defaultStyleProps={curvePosition:.5,curveOffset:20};class dQ extends dX{constructor(t){super(u_({style:dQ.defaultStyleProps},t))}getControlPoints(t,e,r,n){let i=e[1]-t[1];return[[t[0],t[1]+i*r[0]+n[0]],[e[0],e[1]-i*r[1]+n[1]]]}}dQ.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class d0 extends dK{constructor(t){super(u_({style:d0.defaultStyleProps},t))}getKeyPath(t){let[e,r]=this.getEndpoints(t);return[["M",e[0],e[1]],["L",r[0],r[1]]]}}d0.defaultStyleProps={};var ol=y("jyI49");const d1={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:lG},d2=t=>`${Math.round(t[0])}|||${Math.round(t[1])}`;function d3(t,e){let r=t=>Math.round(t/e);return(0,ol.default)(t)?r(t):t.map(r)}function d6(t,e){let r=e[0]-t[0],n=e[1]-t[1];return r||n?Math.atan2(n,r):0}function d5(t,e,r,n){let i=d6(t,e);return function(t,e){let r=Math.abs(t-e);return r>Math.PI?2*Math.PI-r:r}(d6(r[d2(t)]||n,t),i)}const d4=(t,e)=>{let{offset:r,gridSize:n}=e,i={};return t.forEach(t=>{if(!t||t.destroyed||!t.isVisible())return;let e=sW(t.getRenderBounds(),r);for(let t=d3(e.min[0],n);t<=d3(e.max[0],n);t+=1)for(let r=d3(e.min[1],n);r<=d3(e.max[1],n);r+=1)i[`${t}|||${r}`]=!0}),i};function d8(t,e,r){return Math.min(...e.map(e=>r(t,e)))}const d9=(t,e,r,n)=>{if(!e)return[t];let{directionMap:i,offset:a}=n,o=sW(e.getRenderBounds(),a),s=Object.keys(i).reduce((e,n)=>{if(r.includes(n)){let r=i[n],[a,s]=s$(o),l=[t[0]+r.stepX*a,t[1]+r.stepY*s],u=function(t){let{min:[e,r],max:[n,i]}=t,a=[e,i],o=[n,i],s=[n,r],l=[e,r];return[[a,o],[o,s],[s,l],[l,a]]}(o);for(let r=0;r<u.length;r++){let n=lX([t,l],u[r]);n&&sK(n,o)&&e.push(n)}}return e},[]);return sY(t,o)||s.push(t),s.map(t=>d3(t,n.gridSize))},d7=(t,e,r,n,i,a,o)=>{let s=[],l=[a[0]===n[0]?n[0]:t[0]*o,a[1]===n[1]?n[1]:t[1]*o];s.unshift(l);let u=t,h=e[d2(u)];for(;h;){let t=h,n=u;d5(t,n,e,r)&&(l=[t[0]===n[0]?l[0]:t[0]*o,t[1]===n[1]?l[1]:t[1]*o],s.unshift(l)),h=e[d2(t)],u=t}let d=function(t,e,r){let n=t[0],i=r(t[0],e);for(let a=0;a<t.length;a++){let o=t[a],s=r(o,e);s<i&&(n=o,i=s)}return n}(i.map(t=>[t[0]*o,t[1]*o]),l,lG);return s.unshift(d),s};class ct{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(t,e){let r=0,n=e-1;for(;n-r>1;){let e=Math.floor((r+n)/2);if(this.arr[e].value>t.value)n=e;else if(this.arr[e].value<t.value)r=e;else{this.arr.splice(e,0,t),this.map[t.id]=!0;return}}this.arr.splice(n,0,t),this.map[t.id]=!0}add(t){delete this.map[t.id];let e=this.arr.length;if(!e||this.arr[e-1].value<t.value){this.arr.push(t),this.map[t.id]=!0;return}this._innerAdd(t,e)}remove(t){this.map[t]&&delete this.map[t]}_clearAndGetMinId(){let t;for(let e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}_findFirstId(){for(;this.arr.length;){let t=this.arr.shift();if(this.map[t.id])return t.id}}minId(t){return t?this._clearAndGetMinId():this._findFirstId()}}class ce extends dK{constructor(t){super(u_({style:ce.defaultStyleProps},t))}getControlPoints(t){let{router:e}=t,{sourceNode:r,targetNode:n}=this,[i,a]=this.getEndpoints(t,!1),o=[];return e?"shortest-path"===e.type?(o=function(t,e,r,n){let i;let a=lW(t.getCenter()),o=lW(e.getCenter()),s=Object.assign(d1,n),{gridSize:l}=s,u=d4(s.enableObstacleAvoidance?r:[t,e],s),h=d3(a,l),d=d3(o,l),c=d9(a,t,s.startDirections,s),f=d9(o,e,s.endDirections,s);c.forEach(t=>delete u[d2(t)]),f.forEach(t=>delete u[d2(t)]);let p={},g={},y={},v={},m={},b=new ct;for(let t=0;t<c.length;t++){let e=c[t],r=d2(e);p[r]=e,v[r]=0,m[r]=d8(e,f,s.distFunc),b.add({id:r,value:m[r]})}let x=f.map(t=>d2(t)),E=s.maximumLoops,w=1/0;for(let[t,e]of Object.entries(p))m[t]<=w&&(w=m[t],i=e);for(;Object.keys(p).length>0&&E>0;){let t=b.minId(!1);if(t)i=p[t];else break;let e=d2(i);if(x.includes(e))return d7(i,y,h,o,c,d,l);for(let t of(delete p[e],b.remove(e),g[e]=!0,Object.values(s.directionMap))){let r=lL(i,[t.stepX,t.stepY]),n=d2(r);if(g[n])continue;let a=d5(i,r,y,h);if(a>s.maxAllowedDirectionChange||u[n])continue;p[n]||(p[n]=r);let o=s.penalties[a],d=s.distFunc(i,r)+(isNaN(o)?l:o),c=v[e]+d,x=v[n];x&&c>=x||(y[n]=i,v[n]=c,m[n]=c+d8(r,f,s.distFunc),b.add({id:n,value:m[n]}))}E-=1}return[]}(r,n,this.context.element.getNodes(),e)).length||(o=dE(i,a,r,n,t.controlPoints,{padding:e.offset})):"orth"===e.type&&(o=dE(i,a,r,n,t.controlPoints,e)):o=t.controlPoints,o}getPoints(t){let e=this.getControlPoints(t),[r,n]=this.getEndpoints(t,!0,e);return[r,...e,n]}getKeyPath(t){return dD(this.getPoints(t),t.radius)}getLoopPath(t){let{sourcePort:e,targetPort:r,radius:n}=t,i=this.sourceNode,a=sU(i),o=Math.max(sV(a),sG(a))/4,{placement:s,clockwise:l,dist:u=o}=uv(this.getGraphicStyle(t),"loop");return function(t,e,r,n,i,a,o){let s=cl(t),l=s[a||o],u=s[o||a],[h,d]=dj(t,r,n,l,u),c=function(t,e,r,n){let i=[],a=sU(t);if(sd(e,r))switch(sJ(e,a)){case"left":i.push([e[0]-n,e[1]]),i.push([e[0]-n,e[1]+n]),i.push([e[0],e[1]+n]);break;case"right":i.push([e[0]+n,e[1]]),i.push([e[0]+n,e[1]+n]),i.push([e[0],e[1]+n]);break;case"top":i.push([e[0],e[1]-n]),i.push([e[0]+n,e[1]-n]),i.push([e[0]+n,e[1]]);break;case"bottom":i.push([e[0],e[1]+n]),i.push([e[0]+n,e[1]+n]),i.push([e[0]+n,e[1]])}else{let t=sJ(e,a),o=sJ(r,a);if(t===o){let a,o;switch(t){case"left":a=Math.min(e[0],r[0])-n,i.push([a,e[1]]),i.push([a,r[1]]);break;case"right":a=Math.max(e[0],r[0])+n,i.push([a,e[1]]),i.push([a,r[1]]);break;case"top":o=Math.min(e[1],r[1])-n,i.push([e[0],o]),i.push([r[0],o]);break;case"bottom":o=Math.max(e[1],r[1])+n,i.push([e[0],o]),i.push([r[0],o])}}else{let s=(t,e)=>({left:[e[0]-n,e[1]],right:[e[0]+n,e[1]],top:[e[0],e[1]-n],bottom:[e[0],e[1]+n]})[t],l=s(t,e),u=s(o,r),h=dA(l,u,a);i.push(l,h,u)}}return i}(t,h,d,i);return l&&(h=cf(l,c[0])),u&&(d=cf(u,c[c.length-1])),dD([h,...c,d],e)}(i,n,s,l,u,e,r)}}ce.defaultStyleProps={radius:0,controlPoints:[],router:!1};class cr extends dK{constructor(t){super(u_({style:cr.defaultStyleProps},t))}getKeyPath(t){let{curvePosition:e,curveOffset:r}=t,[n,i]=this.getEndpoints(t),a=t.controlPoint||dI(n,i,e,r);return[["M",n[0],n[1]],["Q",a[0],a[1],i[0],i[1]]]}}function cn(t){return t instanceof uQ&&"node"===t.type}function ci(t){return t instanceof dK}function ca(t){return t instanceof dm}cr.defaultStyleProps={curvePosition:.5,curveOffset:30};const co={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function cs(t,e,r=co,n=!0){let i=[.5,.5],a=(0,ou.default)(e)?uf(r,e.toLocaleLowerCase(),i):e;if(!n&&(0,ou.default)(e))return a;let[o,s]=a||i;return[t.min[0]+sV(t)*o,t.min[1]+sG(t)*s]}function cl(t){if(!t)return{};let e=t.getPorts();return(t.attributes.ports||[]).forEach((r,n)=>{var i;let{key:a,placement:o}=r;cu(r)&&(e[i=a||n]||(e[i]=l0(t.getShape("key").getBounds(),o)))}),e}function cu(t){let{r:e}=t;return!e||0===Number(e)}function ch(t){return sF(t)?t:t.getPosition()}function cd(t,e,r,n){let i,a;let o=cl(t);if(r)return o[r];let s=Object.values(o);if(0===s.length)return;let l=s.map(t=>ch(t)),u=function(t,e){let r=cl(t);if(e)return[ch(r[e])];let n=Object.values(r);return n.length>0?n.map(t=>ch(t)):[t.getCenter()]}(e,n),[h]=(i=1/0,a=[l[0],u[0]],l.forEach(t=>{u.forEach(e=>{let r=lV(t,e);r<i&&(i=r,a=[t,e])})}),a);return s.find(t=>ch(t)===h)}function cc(t,e){return ca(t)||cn(t)?cp(t,e):cf(t,e)}function cf(t,e){return t&&e?sF(t)?t:t.attributes.linkToCenter?t.getPosition():l8(sF(e)?e:cn(e)?e.getCenter():e.getPosition(),t.getBounds()):[0,0,0]}function cp(t,e){if(!t||!e)return[0,0,0];let r=sF(e)?e:cn(e)?e.getCenter():e.getPosition();return t.getIntersectPoint(r)||t.getCenter()}function cg(t,e="bottom",r=0,n=0,i=!1){let a=e.split("-"),[o,s]=l0(t,e),l=a.includes("left")?"right":a.includes("right")?"left":"center",u=a.includes("top")?"bottom":a.includes("bottom")?"top":"middle";return i&&(u="top"===u?"bottom":"bottom"===u?"top":u),{transform:[["translate",o+r,s+n]],textBaseline:u,textAlign:l}}function cy(t,e){"update"in t?t.update(e):t.attr(e)}function cv(t){return uf(t,"__to_be_destroyed__",!1)}class cm extends lA{constructor(t,e){super(t,Object.assign({},cm.defaultOptions,e)),this.onCollapseExpand=t=>{var e,r,n,i;return e=this,r=void 0,n=void 0,i=function*(){if(!this.validate(t))return;let{target:e}=t;if(!(cn(e)||ci(e)||ca(e)))return;let r=e.id,{model:n,graph:i}=this.context,a=n.getElementDataById(r);if(!a)return!1;let{onCollapse:o,onExpand:s,animation:l}=this.options;uc(a)?(yield i.expandElement(r,l),null==s||s(r)):(yield i.collapseElement(r,l),null==o||o(r))},new(n||(n=Promise))(function(t,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n(function(t){t(r)})).then(o,s)}l((i=i.apply(e,r||[])).next())})},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.on(`node:${e}`,this.onCollapseExpand),t.on(`combo:${e}`,this.onCollapseExpand)}unbindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.off(`node:${e}`,this.onCollapseExpand),t.off(`combo:${e}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}cm.defaultOptions={enable:!0,animation:!0,trigger:yB.DBLCLICK};var sI=y("ky7aH"),cb={},cx=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};const cE="g6-create-edge-assist-node-id";class cw extends lA{constructor(t,e){super(t,Object.assign({},cw.defaultOptions,e)),this.drop=t=>cx(this,void 0,void 0,function*(){let{targetType:e}=t;["combo","node"].includes(e)&&this.source?yield this.handleCreateEdge(t):yield this.cancelEdge()}),this.handleCreateEdge=t=>cx(this,void 0,void 0,function*(){var e,r,n;if(!this.validate(t))return;let{graph:i,canvas:a,batch:o,element:s}=this.context,{style:l}=this.options;if(this.source){this.createEdge(t),yield this.cancelEdge();return}o.startBatch(),a.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0];let u=i.getElementData(this.source);i.addNodeData([{id:cE,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:null===(e=u.style)||void 0===e?void 0:e.x,y:null===(r=u.style)||void 0===r?void 0:r.y}}]),i.addEdgeData([{id:"g6-create-edge-assist-edge-id",source:this.source,target:cE,style:Object.assign({pointerEvents:"none"},l)}]),yield null===(n=s.draw({animation:!1}))||void 0===n?void 0:n.finished}),this.updateAssistEdge=t=>cx(this,void 0,void 0,function*(){var e;if(!this.source)return;let{model:r,element:n}=this.context;r.translateNodeTo(cE,[t.canvas.x,t.canvas.y]),yield null===(e=n.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished}),this.createEdge=t=>{var e,r,n;let{graph:i}=this.context,{style:a,onFinish:o,onCreate:s}=this.options;if(void 0===(null===(e=t.target)||void 0===e?void 0:e.id)||void 0===this.source)return;let l=null===(r=this.getSelectedNodeIDs([t.target.id]))||void 0===r?void 0:r[0],u=s({id:`${this.source}-${l}-${(cb[n=n||"g"]?cb[n]+=1:cb[n]=1,n+cb[n])}`,source:this.source,target:l,style:a});i.addEdgeData([u]),o(u)},this.cancelEdge=()=>cx(this,void 0,void 0,function*(){var t;if(!this.source)return;let{graph:e,element:r,batch:n}=this.context;e.removeNodeData([cE]),this.source=void 0,yield null===(t=r.draw({animation:!1}))||void 0===t?void 0:t.finished,n.endBatch()}),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;this.unbindEvents(),"click"===e?(t.on(yU.CLICK,this.handleCreateEdge),t.on(yF.CLICK,this.handleCreateEdge),t.on(yj.CLICK,this.cancelEdge),t.on(yV.CLICK,this.cancelEdge)):(t.on(yU.DRAG_START,this.handleCreateEdge),t.on(yF.DRAG_START,this.handleCreateEdge),t.on(yB.POINTER_UP,this.drop)),t.on(yB.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(t)))}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;t.off(yU.CLICK,this.handleCreateEdge),t.off(yF.CLICK,this.handleCreateEdge),t.off(yj.CLICK,this.cancelEdge),t.off(yV.CLICK,this.cancelEdge),t.off(yU.DRAG_START,this.handleCreateEdge),t.off(yF.DRAG_START,this.handleCreateEdge),t.off(yB.POINTER_UP,this.drop),t.off(yB.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}cw.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:t=>t,onFinish:()=>{}};var c_=function(t,e,r){var n;return function(){var i=this,a=arguments,o=r&&!n;clearTimeout(n),n=setTimeout(function(){n=null,r||t.apply(i,a)},e),o&&t.apply(i,a)}},sc=y("6JKSc"),cS=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class ck extends lA{constructor(t,e){super(t,Object.assign({},ck.defaultOptions,e)),this.isDragging=!1,this.onDragStart=t=>{this.validate(t)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=t=>{if(!this.isDragging)return;let{x:e,y:r}=t.movement;(e|r)!=0&&this.translate([e,r],!1)},this.onDragEnd=()=>{var t,e;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},this.invokeOnFinish=c_(()=>{var t,e;null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},300),this.shortcut=new ur(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{trigger:t}=this.options;if((0,sc.default)(t)){let{up:e=[],down:r=[],left:n=[],right:i=[]}=t;this.shortcut.bind(e,t=>this.onTranslate([0,1],t)),this.shortcut.bind(r,t=>this.onTranslate([0,-1],t)),this.shortcut.bind(n,t=>this.onTranslate([1,0],t)),this.shortcut.bind(i,t=>this.onTranslate([-1,0],t))}else{let{graph:t}=this.context;t.on(yB.DRAG_START,this.onDragStart),t.on(yB.DRAG,this.onDrag),t.on(yB.DRAG_END,this.onDragEnd)}}onTranslate(t,e){return cS(this,void 0,void 0,function*(){if(!this.validate(e))return;let{sensitivity:r}=this.options;yield this.translate(lF(t,-1*r),this.options.animation),this.invokeOnFinish()})}translate(t,e){return cS(this,void 0,void 0,function*(){t=this.clampByDirection(t),t=this.clampByRange(t),yield this.context.graph.translateBy(t,e)})}clampByDirection([t,e]){let{direction:r}=this.options;return"x"===r?e=0:"y"===r&&(t=0),[t,e]}clampByRange([t,e]){let{viewport:r,canvas:n}=this.context,[i,a]=n.getSize(),[o,s,l,u]=sz(this.options.range),h=sW(sH(r.getCanvasCenter()),[a*o,i*s,a*l,i*u]),d=lj(r.getViewportCenter(),[t,e,0]);if(!sY(d,h)){let{min:[r,n],max:[i,a]}=h;(d[0]<r&&t>0||d[0]>i&&t<0)&&(t=0),(d[1]<n&&e>0||d[1]>a&&e<0)&&(e=0)}return[t,e]}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return"function"==typeof e?e(t):!!e}unbindEvents(){this.shortcut.unbindAll();let{graph:t}=this.context;t.off(yB.DRAG_START,this.onDragStart),t.off(yB.DRAG,this.onDrag),t.off(yB.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}ck.defaultOptions={enable:t=>!("targetType"in t)||"canvas"===t.targetType,sensitivity:10,direction:"both",range:1/0};var on=y("2eDEB"),sI=y("ky7aH"),cN=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class cO extends lA{constructor(t,e){super(t,Object.assign({},cO.defaultOptions,e)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=t=>cN(this,void 0,void 0,function*(){var e;if("link"!==this.options.dropEffect)return;let{model:r,element:n}=this.context,i=t.target.id;this.target.forEach(t=>{let e=r.getParentData(t,sg);e&&lg(e)===i&&r.refreshComboData(i),r.setParent(t,i,sg)}),yield null===(e=null==n?void 0:n.draw({animation:!0}))||void 0===e?void 0:e.finished}),this.setCursor=t=>{if(this.isDragging)return;let{type:e}=t,{canvas:r}=this.context,{cursor:n}=this.options;e===yB.POINTER_ENTER?r.setCursor((null==n?void 0:n.grab)||"grab"):r.setCursor((null==n?void 0:n.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){let{graph:t,canvas:e}=this.context,r=e.getLayer().getContextService().$canvas;r&&(r.addEventListener("blur",this.onDragEnd),r.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(e=>{t.on(`${e}:${yB.DRAG_START}`,this.onDragStart),t.on(`${e}:${yB.DRAG}`,this.onDrag),t.on(`${e}:${yB.DRAG_END}`,this.onDragEnd),t.on(`${e}:${yB.POINTER_ENTER}`,this.setCursor),t.on(`${e}:${yB.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(t.on(yF.DROP,this.onDrop),t.on(yj.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(t)))}getDelta(t){let e=this.context.graph.getZoom();return lB([t.dx,t.dy],e)}onDragStart(t){var e;if(this.enable=this.validate(t),!this.enable)return;let{batch:r,canvas:n}=this.context;n.setCursor((null===(e=this.options.cursor)||void 0===e?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,r.startBatch(),this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;let e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}onDragEnd(){var t,e,r;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";let{x:t=0,y:e=0}=this.shadow.attributes,[r,n]=lj([+t,+e],this.shadowOrigin);this.moveElement(this.target,[r,n])}this.showEdges(),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t,this.target);let{batch:n,canvas:i}=this.context;n.endBatch(),i.setCursor((null===(r=this.options.cursor)||void 0===r?void 0:r.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}moveElement(t,e){return cN(this,void 0,void 0,function*(){let{graph:r,model:n}=this.context,{dropEffect:i}=this.options;"move"===i&&t.forEach(t=>n.refreshComboData(t)),r.translateElementBy(Object.fromEntries(t.map(t=>[t,e])),!1)})}moveShadow(t){if(!this.shadow)return;let{x:e=0,y:r=0}=this.shadow.attributes,[n,i]=t;this.shadow.attr({x:+e+n,y:+r+i})}createShadow(t){let e=uv(this.options,"shadow"),r=sq(t.map(t=>this.context.element.getElement(t).getBounds())),[n,i]=r.min;this.shadowOrigin=[n,i];let[a,o]=s$(r),s={width:a,height:o,x:n,y:i};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},e),s),{visibility:"visible"})):(this.shadow=new on.Rect({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},e),s),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||0===this.hiddenEdges.length||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){let{hideEdge:t,shadow:e}=this.options;if("none"===t||e)return;let{graph:r}=this.context;"all"===t?this.hiddenEdges=r.getEdgeData().map(lg):this.hiddenEdges=Array.from(new Set(this.target.map(e=>r.getRelatedEdgesData(e,t).map(lg)).flat())),r.hideElement(this.hiddenEdges)}unbindEvents(){let{graph:t,canvas:e}=this.context,r=e.getLayer().getContextService().$canvas;r&&(r.removeEventListener("blur",this.onDragEnd),r.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(e=>{t.off(`${e}:${yB.DRAG_START}`,this.onDragStart),t.off(`${e}:${yB.DRAG}`,this.onDrag),t.off(`${e}:${yB.DRAG_END}`,this.onDragEnd),t.off(`${e}:${yB.POINTER_ENTER}`,this.setCursor),t.off(`${e}:${yB.POINTER_LEAVE}`,this.setCursor)}),t.off(`combo:${yB.DROP}`,this.onDrop),t.off(`canvas:${yB.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),null===(t=this.shadow)||void 0===t||t.destroy(),super.destroy()}}cO.defaultOptions={animation:!0,enable:t=>["node","combo"].includes(t.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var cT=function(){function t(){this._events={}}return t.prototype.on=function(t,e,r){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!r}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=this._events[t]||[],a=this._events["*"]||[],o=function(n){for(var i=n.length,a=0;a<i;a++)if(n[a]){var o=n[a],s=o.callback;o.once&&(n.splice(a,1),0===n.length&&delete e._events[t],i--,a--),s.apply(e,r)}};o(i),o(a)},t.prototype.off=function(t,e){if(t){if(e){for(var r=this._events[t]||[],n=r.length,i=0;i<n;i++)r[i].callback===e&&(r.splice(i,1),n--,i--);0===r.length&&delete this._events[t]}else delete this._events[t]}else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function cM(t,e,r,n){for(;t.length;){let i=t.shift();if(r(i))return!0;e.add(i.id),n(i.id).forEach(r=>{e.has(r.id)||(e.add(r.id),t.push(r))})}return!1}function cA(t,e,r,n){if(r(t))return!0;for(let i of(e.add(t.id),n(t.id)))if(!e.has(i.id)&&cA(i,e,r,n))return!0;return!1}const cC=()=>!0;class cR{graph;nodeFilter;edgeFilter;cacheEnabled;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;allNodesMap=new Map;allEdgesMap=new Map;constructor(t){this.graph=t.graph;let e=t.nodeFilter||cC,r=t.edgeFilter||cC;this.nodeFilter=e,this.edgeFilter=t=>{let{source:n,target:i}=this.graph.getEdgeDetail(t.id);return!!(e(n)&&e(i))&&r(t,n,i)},"auto"===t.cache?(this.cacheEnabled=!0,this.startAutoCache()):"manual"===t.cache?this.cacheEnabled=!0:this.cacheEnabled=!1}clearCache=()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()};refreshCache=()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map(t=>t.id))};updateCache=t=>{let e=new Set;t.forEach(t=>{let r=this.bothEdgesMap.get(t);if(r&&r.forEach(t=>e.add(t.id)),this.hasNode(t)){let r=this.graph.getRelatedEdges(t,"in").filter(this.edgeFilter),n=this.graph.getRelatedEdges(t,"out").filter(this.edgeFilter),i=Array.from(new Set([...r,...n]));i.forEach(t=>e.add(t.id)),this.inEdgesMap.set(t,r),this.outEdgesMap.set(t,n),this.bothEdgesMap.set(t,i),this.allNodesMap.set(t,this.graph.getNode(t))}else this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.bothEdgesMap.delete(t),this.allNodesMap.delete(t)}),e.forEach(t=>{this.hasEdge(t)?this.allEdgesMap.set(t,this.graph.getEdge(t)):this.allEdgesMap.delete(t)})};startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}handleGraphChanged=t=>{let e=new Set;t.changes.forEach(r=>{switch(r.type){case"NodeAdded":case"NodeRemoved":e.add(r.value.id);break;case"NodeDataUpdated":e.add(r.id);break;case"EdgeAdded":case"EdgeRemoved":e.add(r.value.source),e.add(r.value.target);break;case"EdgeUpdated":("source"===r.propertyName||"target"===r.propertyName)&&(e.add(r.oldValue),e.add(r.newValue));break;case"EdgeDataUpdated":if(t.graph.hasEdge(r.id)){let n=t.graph.getEdge(r.id);e.add(n.source),e.add(n.target)}}}),this.updateCache(e)};checkNodeExistence(t){this.getNode(t)}hasNode(t){if(!this.graph.hasNode(t))return!1;let e=this.graph.getNode(t);return this.nodeFilter(e)}areNeighbors(t,e){return this.checkNodeExistence(t),this.getNeighbors(e).some(e=>e.id===t)}getNode(t){let e=this.graph.getNode(t);if(!this.nodeFilter(e))throw Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){return(this.checkNodeExistence(t),this.cacheEnabled)?"in"===e?this.inEdgesMap.get(t):"out"===e?this.outEdgesMap.get(t):this.bothEdgesMap.get(t):this.graph.getRelatedEdges(t,e).filter(this.edgeFilter)}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){return Array.from(new Set(this.getRelatedEdges(t,"out").map(t=>this.getNode(t.target))))}getPredecessors(t){return Array.from(new Set(this.getRelatedEdges(t,"in").map(t=>this.getNode(t.source))))}getNeighbors(t){return Array.from(new Set([...this.getPredecessors(t),...this.getSuccessors(t)]))}hasEdge(t){if(!this.graph.hasEdge(t))return!1;let e=this.graph.getEdge(t);return this.edgeFilter(e)}getEdge(t){let e=this.graph.getEdge(t);if(!this.edgeFilter(e))throw Error("Edge not found for id: "+t);return e}getEdgeDetail(t){let e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}hasTreeStructure(t){return this.graph.hasTreeStructure(t)}getRoots(t){return this.graph.getRoots(t).filter(this.nodeFilter)}getChildren(t,e){return this.checkNodeExistence(t),this.graph.getChildren(t,e).filter(this.nodeFilter)}getParent(t,e){this.checkNodeExistence(t);let r=this.graph.getParent(t,e);return r&&this.nodeFilter(r)?r:null}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(t,e,r="out"){let n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];cM([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){let n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];cA(this.getNode(t),new Set,e,n)}}class cI extends cT{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){if(super(),!t)return;t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged)}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){let t=this.changes;this.changes=[];let e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach(t=>{switch(t.type){case"NodeRemoved":{let r=!1;e=e.filter(e=>{if("NodeAdded"===e.type){let n=e.value.id===t.value.id;return n&&(r=!0),!n}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id}),r||e.push(t);break}case"EdgeRemoved":{let r=!1;e=e.filter(e=>{if("EdgeAdded"===e.type){let n=e.value.id===t.value.id;return n&&(r=!0),!n}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id}),r||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{let r=e.findIndex(e=>e.type===t.type&&e.id===t.id&&(void 0===t.propertyName||e.propertyName===t.propertyName)),n=e[r];n?void 0!==t.propertyName?n.newValue=t.newValue:(e.splice(r,1),e.push(t)):e.push(t);break}case"TreeStructureDetached":(e=e.filter(e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey)).push(t);break;case"TreeStructureChanged":{let r=e.find(e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId);r?r.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}}),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some(e=>e.id===t)}getNode(t){let e=this.nodeMap.get(t);if(!e)throw Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){return(this.checkNodeExistence(t),"in"===e)?Array.from(this.inEdgesMap.get(t)):"out"===e?Array.from(this.outEdgesMap.get(t)):Array.from(this.bothEdgesMap.get(t))}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){return Array.from(new Set(this.getRelatedEdges(t,"out").map(t=>this.getNode(t.target))))}getPredecessors(t){return Array.from(new Set(this.getRelatedEdges(t,"in").map(t=>this.getNode(t.source))))}getNeighbors(t){return Array.from(new Set([...this.getPredecessors(t),...this.getSuccessors(t)]))}doAddNode(t){if(this.hasNode(t.id))throw Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach(e=>{e.childrenMap.set(t.id,new Set)}),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch(()=>{for(let e of t)this.doAddNode(e)})}addNode(t){this.addNodes([t])}doRemoveNode(t){let e=this.getNode(t),r=this.bothEdgesMap.get(t);r?.forEach(t=>this.doRemoveEdge(t.id)),this.nodeMap.delete(t),this.treeIndices.forEach(r=>{r.childrenMap.get(t)?.forEach(t=>{r.parentMap.delete(t.id)});let n=r.parentMap.get(t);n&&r.childrenMap.get(n.id)?.delete(e),r.parentMap.delete(t),r.childrenMap.delete(t)}),this.bothEdgesMap.delete(t),this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch(()=>{t.forEach(t=>this.doRemoveNode(t))})}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,r){let n=this.getNode(t);this.batch(()=>{let i=n.data[e];n.data[e]=r,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:i,newValue:r})})}mergeNodeData(t,e){this.batch(()=>{Object.entries(e).forEach(([e,r])=>{this.updateNodeDataProperty(t,e,r)})})}updateNodeData(...t){let e;let r=t[0],n=this.getNode(r);if("string"==typeof t[1]){this.updateNodeDataProperty(r,t[1],t[2]);return}"function"==typeof t[1]?e=(0,t[1])(n.data):"object"==typeof t[1]&&(e=t[1]),this.batch(()=>{let t=n.data,i=e;n.data=e,this.changes.push({type:"NodeDataUpdated",id:r,oldValue:t,newValue:i})})}checkEdgeExistence(t){if(!this.hasEdge(t))throw Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){let e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);let e=this.inEdgesMap.get(t.target),r=this.outEdgesMap.get(t.source),n=this.bothEdgesMap.get(t.source),i=this.bothEdgesMap.get(t.target);e.add(t),r.add(t),n.add(t),i.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch(()=>{for(let e of t)this.doAddEdge(e)})}addEdge(t){this.addEdges([t])}doRemoveEdge(t){let e=this.getEdge(t),r=this.outEdgesMap.get(e.source),n=this.inEdgesMap.get(e.target),i=this.bothEdgesMap.get(e.source),a=this.bothEdgesMap.get(e.target);r.delete(e),n.delete(e),i.delete(e),a.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch(()=>{t.forEach(t=>this.doRemoveEdge(t))})}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){let r=this.getEdge(t);this.checkNodeExistence(e);let n=r.source;this.outEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.outEdgesMap.get(e).add(r),this.bothEdgesMap.get(e).add(r),r.source=e,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:n,newValue:e})})}updateEdgeTarget(t,e){let r=this.getEdge(t);this.checkNodeExistence(e);let n=r.target;this.inEdgesMap.get(n).delete(r),this.bothEdgesMap.get(n).delete(r),this.inEdgesMap.get(e).add(r),this.bothEdgesMap.get(e).add(r),r.target=e,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:n,newValue:e})})}updateEdgeDataProperty(t,e,r){let n=this.getEdge(t);this.batch(()=>{let i=n.data[e];n.data[e]=r,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:i,newValue:r})})}updateEdgeData(...t){let e;let r=t[0],n=this.getEdge(r);if("string"==typeof t[1]){this.updateEdgeDataProperty(r,t[1],t[2]);return}"function"==typeof t[1]?e=(0,t[1])(n.data):"object"==typeof t[1]&&(e=t[1]),this.batch(()=>{let t=n.data,i=e;n.data=e,this.changes.push({type:"EdgeDataUpdated",id:r,oldValue:t,newValue:i})})}mergeEdgeData(t,e){this.batch(()=>{Object.entries(e).forEach(([e,r])=>{this.updateEdgeDataProperty(t,e,r)})})}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})}))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})})}addTree(t,e){this.batch(()=>{this.attachTreeStructure(e);let r=[],n=Array.isArray(t)?t:[t];for(;n.length;){let t=n.shift();r.push(t),t.children&&n.push(...t.children)}this.addNodes(r),r.forEach(t=>{t.children?.forEach(r=>{this.setParent(r.id,t.id,e)})})})}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter(e=>!this.getParent(e.id,t))}getChildren(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),Array.from(this.treeIndices.get(e).childrenMap.get(t)||[])}getParent(t,e){return this.checkNodeExistence(t),this.checkTreeExistence(e),this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){let r;let n=[],i=this.getNode(t);for(;r=this.getParent(i.id,e);)n.push(r),i=r;return n}setParent(t,e,r){this.checkTreeExistence(r);let n=this.treeIndices.get(r),i=this.getNode(t),a=n.parentMap.get(t);if(a?.id===e)return;if(void 0===e){a&&n.childrenMap.get(a.id)?.delete(i),n.parentMap.delete(t);return}let o=this.getNode(e);n.parentMap.set(t,o),a&&n.childrenMap.get(a.id)?.delete(i);let s=n.childrenMap.get(o.id);s||(s=new Set,n.childrenMap.set(o.id,s)),s.add(i),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:r,nodeId:t,oldParentId:a?.id,newParentId:o.id})})}dfsTree(t,e,r){return cA(this.getNode(t),new Set,e,t=>this.getChildren(t,r))}bfsTree(t,e,r){return cM([this.getNode(t)],new Set,e,t=>this.getChildren(t,r))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,r="out"){let n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return cM([this.getNode(t)],new Set,e,n)}dfs(t,e,r="out"){let n={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[r];return cA(this.getNode(t),new Set,e,n)}clone(){let t=new cI({nodes:this.getAllNodes().map(t=>({...t,data:{...t.data}})),edges:this.getAllEdges().map(t=>({...t,data:{...t.data}}))});return this.treeIndices.forEach(({parentMap:e,childrenMap:r},n)=>{let i=new Map;e.forEach((e,r)=>{i.set(r,t.getNode(e.id))});let a=new Map;r.forEach((e,r)=>{a.set(r,new Set(Array.from(e).map(e=>t.getNode(e.id))))}),t.treeIndices.set(n,{parentMap:i,childrenMap:a})}),t}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(t){return new cR({graph:this,...t})}}var ol=y("jyI49");class cP{constructor(t,e){this.context=t,this.options=e||{}}}var cD=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};function cL(t){let{nodes:e,edges:r}=t,n={nodes:[],edges:[],combos:[]};return e.forEach(t=>{let e=t.data._isCombo?n.combos:n.nodes,{x:r,y:i,z:a=0}=t.data;null==e||e.push({id:t.id,style:{x:r,y:i,z:a}})}),r.forEach(t=>{let{id:e,source:r,target:i,data:{points:a=[],controlPoints:o=a.slice(1,a.length-1)}}=t;n.edges.push({id:e,source:r,target:i,style:Object.assign({},(null==o?void 0:o.length)?{controlPoints:o.map(l1)}:{})})}),n}function cj(t,e,...r){if(e in t)return t[e](...r);if("instance"in t){let n=t.instance;if(e in n)return n[e](...r)}return null}function cF(t,e){if(e in t)return t[e];if("instance"in t){let r=t.instance;if(e in r)return r[e]}return null}var sI=y("ky7aH"),ol=y("jyI49"),cB=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class cz extends lA{constructor(t,e){super(t,Object.assign({},cz.defaultOptions,e)),this.isZoomEvent=t=>!!(t.data&&"scale"in t.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=t=>cB(this,void 0,void 0,function*(){if(!this.validate(t))return;let{graph:e}=this.context,{state:r,nodeFilter:n,edgeFilter:i,comboFilter:a}=this.options,o=(r?e.getElementDataByState("node",r):e.getNodeData()).filter(n),s=(r?e.getElementDataByState("edge",r):e.getEdgeData()).filter(i),l=(r?e.getElementDataByState("combo",r):e.getComboData()).filter(a),u=this.isZoomEvent(t)?this.zoom=Math.max(.01,Math.min(t.data.scale,10)):this.zoom,h=[...o,...l];h.length>0&&h.forEach(t=>this.fixNodeLike(t,u)),this.updateRelatedEdges(),s.length>0&&s.forEach(t=>this.fixEdge(t,u))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(t,e,r)=>{var n;let i=this.cachedStyles.get(t)||[],a=(null===(n=i.find(t=>t.shape===e))||void 0===n?void 0:n.style)||{};return r in a||(a[r]=e.attributes[r],this.cachedStyles.set(t,[...i.filter(t=>t.shape!==e),{shape:e,style:a}])),a[r]},this.scaleEntireElement=(t,e,r)=>{e.setLocalScale(1/r);let n=this.cachedStyles.get(t)||[];n.push({shape:e}),this.cachedStyles.set(t,n)},this.scaleSpecificShapes=(t,e,r)=>{let n=function(t){let e=[],r=t=>{(null==t?void 0:t.children.length)&&t.children.forEach(t=>{e.push(t),r(t)})};return r(t),e}(t);(Array.isArray(r)?r:[r]).forEach(r=>{let{shape:i,fields:a}=r,o="function"==typeof i?i(n):t.getShape(i);if(o){if(!a){this.scaleEntireElement(t.id,o,e);return}a.forEach(r=>{let n=this.getOriginalFieldValue(t.id,o,r);(0,ol.default)(n)&&(o.style[r]=n/e)})}})},this.skipIfExceedViewport=t=>{let{viewport:e}=this.context;return!(null==e?void 0:e.isInViewport(t.getRenderBounds(),!1,30))},this.fixNodeLike=(t,e)=>{let r=lg(t),{element:n,model:i}=this.context,a=n.getElement(r);if(!a||this.skipIfExceedViewport(a))return;i.getRelatedEdgesData(r).forEach(t=>this.relatedEdgeToUpdate.add(lg(t)));let o=this.options[a.type];if(!o){this.scaleEntireElement(r,a,e);return}this.scaleSpecificShapes(a,e,o)},this.fixEdge=(t,e)=>{let r=lg(t),n=this.context.element.getElement(r);if(!n||this.skipIfExceedViewport(n))return;let i=this.options.edge;if(!i){n.style.transformOrigin="center",this.scaleEntireElement(r,n,e);return}this.scaleSpecificShapes(n,e,i)},this.updateRelatedEdges=()=>{let{element:t}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(e=>{let r=t.getElement(e);null==r||r.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=t=>cB(this,void 0,void 0,function*(){var e;null!==(e=t.data)&&void 0!==e&&e.firstRender||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(t=>{t.forEach(({shape:t,style:e})=>{if(uD(e))t.setLocalScale(1);else{if(this.options.state)return;Object.entries(e).forEach(([e,r])=>t.style[e]=r)}})});let{graph:t,element:e}=this.context,r=Object.keys(Object.fromEntries(this.cachedStyles)).filter(e=>e&&"node"===t.getElementType(e));if(r.length>0){let n=new Set;r.forEach(e=>{t.getRelatedEdgesData(e).forEach(t=>n.add(lg(t)))}),n.forEach(t=>{let r=null==e?void 0:e.getElement(t);null==r||r.update({})})}}}bindEvents(){let{graph:t}=this.context;t.on(yG.AFTER_DRAW,this.resetTransform),t.on(yG.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){let{graph:t}=this.context;t.off(yG.AFTER_DRAW,this.resetTransform),t.off(yG.AFTER_TRANSFORM,this.fixElementSize)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}cz.defaultOptions={enable:t=>t.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};var sI=y("ky7aH");class cV extends lA{constructor(t,e){super(t,Object.assign({},cV.defaultOptions,e)),this.focus=t=>{var e,r,n,i;return e=this,r=void 0,n=void 0,i=function*(){if(!this.validate(t))return;let{graph:e}=this.context;yield e.focusElement(t.target.id,this.options.animation)},new(n||(n=Promise))(function(t,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n(function(t){t(r)})).then(o,s)}l((i=i.apply(e,r||[])).next())})},this.bindEvents()}bindEvents(){let{graph:t}=this.context;this.unbindEvents(),ua.forEach(e=>{t.on(`${e}:${yB.CLICK}`,this.focus)})}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;ua.forEach(e=>{t.off(`${e}:${yB.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}}cV.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};var sI=y("ky7aH");class cG extends lA{constructor(t,e){super(t,Object.assign({},cG.defaultOptions,e)),this.isFrozen=!1,this.toggleFrozen=t=>{this.isFrozen="dragstart"===t.type},this.hoverElement=t=>{if(!this.validate(t))return;let e=t.type===yB.POINTER_ENTER;this.updateElementsState(t,e);let{onHover:r,onHoverEnd:n}=this.options;e?null==r||r(t):null==n||n(t)},this.updateElementsState=(t,e)=>{if(!this.options.state&&!this.options.inactiveState)return;let{graph:r}=this.context,{state:n,animation:i,inactiveState:a}=this.options,o=this.getActiveIds(t),s={};if(n&&Object.assign(s,this.getElementsState(o,n,e)),a){let t=ly(r.getData(),!0).filter(t=>!o.includes(t));Object.assign(s,this.getElementsState(t,a,e))}r.setElementState(s,i)},this.getElementsState=(t,e,r)=>{let{graph:n}=this.context,i={};return t.forEach(t=>{let a=n.getElementState(t);r?i[t]=a.includes(e)?a:[...a,e]:i[t]=a.filter(t=>t!==e)}),i},this.bindEvents()}bindEvents(){let{graph:t}=this.context;this.unbindEvents(),ua.forEach(e=>{t.on(`${e}:${yB.POINTER_ENTER}`,this.hoverElement),t.on(`${e}:${yB.POINTER_LEAVE}`,this.hoverElement)});let e=this.context.canvas.document;e.addEventListener(`${yB.DRAG_START}`,this.toggleFrozen),e.addEventListener(`${yB.DRAG_END}`,this.toggleFrozen)}getActiveIds(t){let{graph:e}=this.context,{degree:r,direction:n}=this.options,i=t.target.id;return r?us(e,t.targetType,i,"function"==typeof r?r(t):r,n):[i]}validate(t){if(this.destroyed||this.isFrozen||cv(t.target)||this.context.graph.isCollapsingExpanding)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}unbindEvents(){let{graph:t}=this.context;ua.forEach(e=>{t.off(`${e}:${yB.POINTER_ENTER}`,this.hoverElement),t.off(`${e}:${yB.POINTER_LEAVE}`,this.hoverElement)});let e=this.context.canvas.document;e.removeEventListener(`${yB.DRAG_START}`,this.toggleFrozen),e.removeEventListener(`${yB.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}cG.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};var on=y("2eDEB"),sI=y("ky7aH");class c$ extends lA{constructor(t,e){super(t,Object.assign({},c$.defaultOptions,e)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(t,e,r)=>{t.filter(Boolean).forEach(t=>{"hidden"!==e||t.isVisible()?"visible"===e&&this.hiddenShapes.includes(t)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(t),1):lO(t,e,!1,r):this.hiddenShapes.push(t)})},this.filterShapes=(t,e)=>{if((0,sI.default)(e))return r=>!e(t,r);let r=null==e?void 0:e[t];return t=>!t.className||!(null==r?void 0:r.includes(t.className))},this.hideShapes=t=>{if(!this.validate(t)||!this.isVisible)return;let{element:e}=this.context,{shapes:r={}}=this.options;this.setElementsVisibility(e.getNodes(),"hidden",this.filterShapes("node",r)),this.setElementsVisibility(e.getEdges(),"hidden",this.filterShapes("edge",r)),this.setElementsVisibility(e.getCombos(),"hidden",this.filterShapes("combo",r)),this.isVisible=!1},this.showShapes=c_(t=>{if(!this.validate(t)||this.isVisible)return;let{element:e}=this.context;this.setElementsVisibility(e.getNodes(),"visible"),this.setElementsVisibility(e.getEdges(),"visible"),this.setElementsVisibility(e.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){let{graph:t}=this.context;t.on(yG.BEFORE_TRANSFORM,this.hideShapes),t.on(yG.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){let{graph:t}=this.context;t.off(yG.BEFORE_TRANSFORM,this.hideShapes),t.off(yG.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}c$.defaultOptions={enable:!0,debounce:200,shapes:t=>"node"===t};var sI=y("ky7aH"),sc=y("6JKSc"),cU=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class cH extends lA{constructor(t,e){super(t,Object.assign({},cH.defaultOptions,e)),this.onWheel=t=>cU(this,void 0,void 0,function*(){this.options.preventDefault&&t.preventDefault();let e=t.deltaX,r=t.deltaY;yield this.scroll([-e,-r],t)}),this.shortcut=new ur(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var t,e;let{trigger:r}=this.options;if(this.shortcut.unbindAll(),(0,sc.default)(r)){null===(t=this.graphDom)||void 0===t||t.removeEventListener(yB.WHEEL,this.onWheel);let{up:e=[],down:n=[],left:i=[],right:a=[]}=r;this.shortcut.bind(e,t=>this.scroll([0,-10],t)),this.shortcut.bind(n,t=>this.scroll([0,10],t)),this.shortcut.bind(i,t=>this.scroll([-10,0],t)),this.shortcut.bind(a,t=>this.scroll([10,0],t))}else null===(e=this.graphDom)||void 0===e||e.addEventListener(yB.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(t){let{sensitivity:e}=this.options;return t=lF(t,e),t=this.clampByDirection(t),t=this.clampByRange(t)}clampByDirection([t,e]){let{direction:r}=this.options;return"x"===r?e=0:"y"===r&&(t=0),[t,e]}clampByRange([t,e]){let{viewport:r,canvas:n}=this.context,[i,a]=n.getSize(),[o,s,l,u]=sz(this.options.range),h=sW(sH(r.getCanvasCenter()),[a*o,i*s,a*l,i*u]),d=lj(r.getViewportCenter(),[t,e,0]);if(!sY(d,h)){let{min:[r,n],max:[i,a]}=h;(d[0]<r&&t>0||d[0]>i&&t<0)&&(t=0),(d[1]<n&&e>0||d[1]>a&&e<0)&&(e=0)}return[t,e]}scroll(t,e){return cU(this,void 0,void 0,function*(){if(!this.validate(e))return;let{onFinish:r}=this.options,n=this.context.graph,i=this.formatDisplacement(t);yield n.translateBy(i,!1),null==r||r()})}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.graphDom)||void 0===t||t.removeEventListener(yB.WHEEL,this.onWheel),super.destroy()}}cH.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var ow=y("8hhuV"),sI=y("ky7aH"),cW=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class cq extends lA{constructor(t,e){super(t,Object.assign({},cq.defaultOptions,e)),this.zoom=(t,e,r)=>cW(this,void 0,void 0,function*(){let n;if(!this.validate(e))return;let{graph:i}=this.context;"viewport"in e&&(n=l1(e.viewport));let{sensitivity:a,onFinish:o}=this.options,s=1+(0,ow.default)(t,-50,50)*a/100,l=i.getZoom();yield i.zoomTo(l*s,r,n),null==o||o()}),this.onReset=()=>cW(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=t=>{this.options.preventDefault&&t.preventDefault()},this.shortcut=new ur(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var t;let{trigger:e}=this.options;if(this.shortcut.unbindAll(),Array.isArray(e)&&(null===(t=this.context.canvas.getContainer())||void 0===t||t.addEventListener(yB.WHEEL,this.preventDefault),this.shortcut.bind([...e,yB.WHEEL],t=>{let{deltaX:e,deltaY:r}=t;this.zoom(-(null!=r?r:e),t,!1)})),"object"==typeof e){let{zoomIn:t=[],zoomOut:r=[],reset:n=[]}=e;this.shortcut.bind(t,t=>this.zoom(10,t,this.options.animation)),this.shortcut.bind(r,t=>this.zoom(-10,t,this.options.animation)),this.shortcut.bind(n,this.onReset)}}validate(t){if(this.destroyed)return!1;let{enable:e}=this.options;return(0,sI.default)(e)?e(t):!!e}destroy(){var t;this.shortcut.destroy(),null===(t=this.context.canvas.getContainer())||void 0===t||t.removeEventListener(yB.WHEEL,this.preventDefault),super.destroy()}}cq.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var cY={};"undefined"!=typeof self&&self,cY=function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=5)}([function(t,e){t.exports={assign:Object.assign,getHeight:function(t,e,r,n){return void 0===n&&(n="height"),"center"===r?(t[n]+e[n])/2:t.height}}},function(t,e,r){var n=r(3),i=/*#__PURE__*/function(){function t(t,e){void 0===e&&(e={}),this.options=e,this.rootNode=n(t,e)}return t.prototype.execute=function(){throw Error("please override this method")},t}();t.exports=i},function(t,e,r){var n=r(4),i=["LR","RL","TB","BT","H","V"],a=["LR","RL","H"],o=i[0];t.exports=function(t,e,r){var s=e.direction||o;if(e.isHorizontal=a.indexOf(s)>-1,s&&-1===i.indexOf(s))throw TypeError("Invalid direction: "+s);if(s===i[0])r(t,e);else if(s===i[1])r(t,e),t.right2left();else if(s===i[2])r(t,e);else if(s===i[3])r(t,e),t.bottom2top();else if(s===i[4]||s===i[5]){var l=n(t,e),u=l.left,h=l.right;r(u,e),r(h,e),e.isHorizontal?u.right2left():u.bottom2top(),h.translate(u.x-h.x,u.y-h.y),t.x=u.x,t.y=h.y;var d=t.getBoundingBox();e.isHorizontal?d.top<0&&t.translate(0,-d.top):d.left<0&&t.translate(-d.left,0)}var c=e.fixedRoot;return void 0===c&&(c=!0),c&&t.translate(-(t.x+t.width/2+t.hgap),-(t.y+t.height/2+t.vgap)),function(t,e){if(e.radial){var r=e.isHorizontal?["x","y"]:["y","x"],n=r[0],i=r[1],a={x:1/0,y:1/0},o={x:-1/0,y:-1/0},s=0;t.DFTraverse(function(t){s++;var e=t.x,r=t.y;a.x=Math.min(a.x,e),a.y=Math.min(a.y,r),o.x=Math.max(o.x,e),o.y=Math.max(o.y,r)});var l=o[i]-a[i];if(0!==l){var u=2*Math.PI/s;t.DFTraverse(function(e){var r=(e[i]-a[i])/l*(2*Math.PI-u)+u,o=e[n]-t[n];e.x=Math.cos(r)*o,e.y=Math.sin(r)*o})}}}(t,e),t}},function(t,e,r){var n=r(0),i={getId:function(t){return t.id||t.name},getPreH:function(t){return t.preH||0},getPreV:function(t){return t.preV||0},getHGap:function(t){return t.hgap||18},getVGap:function(t){return t.vgap||18},getChildren:function(t){return t.children},getHeight:function(t){return t.height||36},getWidth:function(t){var e=t.label||" ";return t.width||18*e.split("").length}};function a(t,e){if(this.vgap=this.hgap=0,t instanceof a)return t;this.data=t;var r=e.getHGap(t),n=e.getVGap(t);return this.preH=e.getPreH(t),this.preV=e.getPreV(t),this.width=e.getWidth(t),this.height=e.getHeight(t),this.width+=this.preH,this.height+=this.preV,this.id=e.getId(t),this.x=this.y=0,this.depth=0,this.children||(this.children=[]),this.addGap(r,n),this}n.assign(a.prototype,{isRoot:function(){return 0===this.depth},isLeaf:function(){return 0===this.children.length},addGap:function(t,e){this.hgap+=t,this.vgap+=e,this.width+=2*t,this.height+=2*e},eachNode:function(t){for(var e,r=[this];e=r.shift();)t(e),r=e.children.concat(r)},DFTraverse:function(t){this.eachNode(t)},BFTraverse:function(t){for(var e,r=[this];e=r.shift();)t(e),r=r.concat(e.children)},getBoundingBox:function(){var t={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(e){t.left=Math.min(t.left,e.x),t.top=Math.min(t.top,e.y),t.width=Math.max(t.width,e.x+e.width),t.height=Math.max(t.height,e.y+e.height)}),t},translate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.eachNode(function(r){r.x+=t,r.y+=e,r.x+=r.preH,r.y+=r.preV})},right2left:function(){var t=this.getBoundingBox();this.eachNode(function(e){e.x=e.x-(e.x-t.left)*2-e.width}),this.translate(t.width,0)},bottom2top:function(){var t=this.getBoundingBox();this.eachNode(function(e){e.y=e.y-(e.y-t.top)*2-e.height}),this.translate(0,t.height)}}),t.exports=function(t,e,r){void 0===e&&(e={});var o,s=new a(t,e=n.assign({},i,e)),l=[s];if(!r&&!t.collapsed){for(;o=l.shift();)if(!o.data.collapsed){var u=e.getChildren(o.data),h=u?u.length:0;if(o.children=Array(h),u&&h)for(var d=0;d<h;d++){var c=new a(u[d],e);o.children[d]=c,l.push(c),c.parent=o,c.depth=o.depth+1}}}return s}},function(t,e,r){var n=r(3);t.exports=function(t,e){for(var r=n(t.data,e,!0),i=n(t.data,e,!0),a=t.children.length,o=Math.round(a/2),s=e.getSide||function(t,e){return e<o?"right":"left"},l=0;l<a;l++){var u=t.children[l];"right"===s(u,l)?i.children.push(u):r.children.push(u)}return r.eachNode(function(t){t.isRoot()||(t.side="left")}),i.eachNode(function(t){t.isRoot()||(t.side="right")}),{left:r,right:i}}},function(t,e,r){var n={compactBox:r(6),dendrogram:r(8),indented:r(10),mindmap:r(12)};t.exports=n},function(t,e,r){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var i=r(1),a=r(7),o=r(2),s=r(0),l=/*#__PURE__*/function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){return o(this.rootNode,this.options,a)},e}(i),u={};t.exports=function(t,e){return new l(t,e=s.assign({},u,e)).execute()}},function(t,e){function r(t,e,r,n){void 0===n&&(n=[]),this.w=t||0,this.h=e||0,this.y=r||0,this.x=0,this.c=n||[],this.cs=n.length,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.tl=null,this.tr=null,this.el=null,this.er=null,this.msel=0,this.mser=0}r.fromNode=function(t,e){if(!t)return null;var n=[];return(t.children.forEach(function(t){n.push(r.fromNode(t,e))}),e)?new r(t.height,t.width,t.x,n):new r(t.width,t.height,t.y,n)},t.exports=function(t,e){void 0===e&&(e={});var n,i=e.isHorizontal;function a(t){0===t.cs?(t.el=t,t.er=t,t.msel=t.mser=0):(t.el=t.c[0].el,t.msel=t.c[0].msel,t.er=t.c[t.cs-1].er,t.mser=t.c[t.cs-1].mser)}function o(t){return t.y+t.h}function s(t,e,r){for(;null!==r&&t>=r.low;)r=r.nxt;return{low:t,index:e,nxt:r}}!function t(e,r,n){void 0===n&&(n=0),r?(e.x=n,n+=e.width):(e.y=n,n+=e.height),e.children.forEach(function(e){t(e,r,n)})}(t,i);var l=r.fromNode(t,i);return function t(e){if(0===e.cs){a(e);return}t(e.c[0]);for(var r=s(o(e.c[0].el),0,null),n=1;n<e.cs;++n){t(e.c[n]);var i=o(e.c[n].er);(function(t,e,r){for(var n=t.c[e-1],i=n.mod,a=t.c[e],s=a.mod;null!==n&&null!==a;){o(n)>r.low&&(r=r.nxt);var l,u,h,d=i+n.prelim+n.w-(s+a.prelim);d>0&&(s+=d,l=r.index,t.c[e].mod+=d,t.c[e].msel+=d,t.c[e].mser+=d,function(t,e,r,n){if(r!==e-1){var i=e-r;t.c[r+1].shift+=n/i,t.c[e].shift-=n/i,t.c[e].change-=n-n/i}}(t,e,l,d));var c=o(n),f=o(a);c<=f&&null!==(n=0===(u=n).cs?u.tr:u.c[u.cs-1])&&(i+=n.mod),c>=f&&null!==(a=0===(h=a).cs?h.tl:h.c[0])&&(s+=a.mod)}!n&&a?function(t,e,r,n){var i=t.c[0].el;i.tl=r;var a=n-r.mod-t.c[0].msel;i.mod+=a,i.prelim-=a,t.c[0].el=t.c[e].el,t.c[0].msel=t.c[e].msel}(t,e,a,s):n&&!a&&function(t,e,r,n){var i=t.c[e].er;i.tr=r;var a=n-r.mod-t.c[e].mser;i.mod+=a,i.prelim-=a,t.c[e].er=t.c[e-1].er,t.c[e].mser=t.c[e-1].mser}(t,e,n,i)})(e,n,r),r=s(i,n,r)}e.prelim=(e.c[0].prelim+e.c[0].mod+e.c[e.cs-1].mod+e.c[e.cs-1].prelim+e.c[e.cs-1].w)/2-e.w/2,a(e)}(l),function t(e,r){r+=e.mod,e.x=e.prelim+r,function(t){for(var e=0,r=0,n=0;n<t.cs;n++)e+=t.c[n].shift,r+=e+t.c[n].change,t.c[n].mod+=r}(e);for(var n=0;n<e.cs;n++)t(e.c[n],r)}(l,0),function t(e,r,n){n?r.y=e.x:r.x=e.x,e.c.forEach(function(e,i){t(e,r.children[i],n)})}(l,t,i),n=function t(e,r){var n=r?e.y:e.x;return e.children.forEach(function(e){n=Math.min(t(e,r),n)}),n}(t,i),function t(e,r,n){n?e.y+=r:e.x+=r,e.children.forEach(function(e){t(e,r,n)})}(t,-n,i),t}},function(t,e,r){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var i=r(1),a=r(9),o=r(2),s=r(0),l=/*#__PURE__*/function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){return this.rootNode.width=0,o(this.rootNode,this.options,a)},e}(i),u={};t.exports=function(t,e){return new l(t,e=s.assign({},u,e)).execute()}},function(t,e,r){var n=r(0);function i(t,e){void 0===t&&(t=0),void 0===e&&(e=[]),this.x=this.y=0,this.leftChild=this.rightChild=null,this.height=0,this.children=e}var a={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};t.exports=function(t,e){void 0===e&&(e={}),e=n.assign({},a,e);var r,o=0,s=function t(e){if(!e)return null;e.width=0,e.depth&&e.depth>o&&(o=e.depth);var r=e.children,n=r.length,a=new i(e.height,[]);return r.forEach(function(e,r){var i=t(e);a.children.push(i),0===r&&(a.leftChild=i),r===n-1&&(a.rightChild=i)}),a.originNode=e,a.isLeaf=e.isLeaf(),a}(t);return function t(e){if(e.isLeaf||0===e.children.length)e.drawingDepth=o;else{var r=e.children.map(function(e){return t(e)}),n=Math.min.apply(null,r);e.drawingDepth=n-1}return e.drawingDepth}(s),function t(n){n.x=n.drawingDepth*e.rankSep,n.isLeaf?(n.y=0,r&&(n.y=r.y+r.height+e.nodeSep,n.originNode.parent!==r.originNode.parent&&(n.y+=e.subTreeSep)),r=n):(n.children.forEach(function(e){t(e)}),n.y=(n.leftChild.y+n.rightChild.y)/2)}(s),function t(e,r,n){n?(r.x=e.x,r.y=e.y):(r.x=e.y,r.y=e.x),e.children.forEach(function(e,i){t(e,r.children[i],n)})}(s,t,e.isHorizontal),t}},function(t,e,r){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var i=r(1),a=r(11),o=r(4),s=r(0),l=["LR","RL","H"],u=l[0],h=/*#__PURE__*/function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){var t=this.options,e=this.rootNode;t.isHorizontal=!0;var r=t.indent,n=void 0===r?20:r,i=t.dropCap,s=void 0===i||i,h=t.direction,d=void 0===h?u:h,c=t.align;if(d&&-1===l.indexOf(d))throw TypeError("Invalid direction: "+d);if(d===l[0])a(e,n,s,c);else if(d===l[1])a(e,n,s,c),e.right2left();else if(d===l[2]){var f=o(e,t),p=f.left,g=f.right;a(p,n,s,c),p.right2left(),a(g,n,s,c);var y=p.getBoundingBox();g.translate(y.width,0),e.x=g.x-e.width/2}return e},e}(i),d={};t.exports=function(t,e){return new h(t,e=s.assign({},d,e)).execute()}},function(t,e,r){var n=r(0);t.exports=function(t,e,r,i){var a=null;t.eachNode(function(t){(function(t,e,r,i,a){var o=("function"==typeof r?r(t):r)*t.depth;if(!i)try{if(t.id===t.parent.children[0].id){t.x+=o,t.y=e?e.y:0;return}}catch(t){}if(t.x+=o,e){if(t.y=e.y+n.getHeight(e,t,a),e.parent&&t.parent.id!==e.parent.id){var s=e.parent,l=s.y+n.getHeight(s,t,a);t.y=l>t.y?l:t.y}}else t.y=0})(t,a,e,r,i),a=t})}},function(t,e,r){function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var i=r(1),a=r(13),o=r(2),s=r(0),l=/*#__PURE__*/function(t){function e(){return t.apply(this,arguments)||this}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t),e.prototype.execute=function(){return o(this.rootNode,this.options,a)},e}(i),u={};t.exports=function(t,e){return new l(t,e=s.assign({},u,e)).execute()}},function(t,e,r){var n=r(0),i={getSubTreeSep:function(){return 0}};t.exports=function(t,e){void 0===e&&(e={}),e=n.assign({},i,e),t.parent={x:0,width:0,height:0,y:0},t.BFTraverse(function(t){t.x=t.parent.x+t.parent.width}),t.parent=null,function t(e,r){var n=0;return e.children.length?e.children.forEach(function(e){n+=t(e,r)}):n=e.height,e._subTreeSep=r.getSubTreeSep(e.data),e.totalHeight=Math.max(e.height,n)+2*e._subTreeSep,e.totalHeight}(t,e),t.startY=0,t.y=t.totalHeight/2-t.height/2,t.eachNode(function(t){var e=t.children,r=e.length;if(r){var n=e[0];if(n.startY=t.startY+t._subTreeSep,1===r)n.y=t.y+t.height/2-n.height/2;else{n.y=n.startY+n.totalHeight/2-n.height/2;for(var i=1;i<r;i++){var a=e[i];a.startY=e[i-1].startY+e[i-1].totalHeight,a.y=a.startY+a.totalHeight/2-a.height/2}}}}),function t(e){var r=e.children,n=r.length;if(n){r.forEach(function(e){t(e)});var i=r[0],a=r[n-1],o=a.y-i.y+a.height,s=0;if(r.forEach(function(t){s+=t.totalHeight}),o>e.height)e.y=i.y+o/2-e.height/2;else if(1!==r.length||e.height>s){var l=e.y+(e.height-o)/2-i.y;r.forEach(function(t){t.translate(0,l)})}else e.y=(i.y+i.height/2+a.y+a.height/2)/2-e.height/2}}(t)}}]);var s6=y("7WQrb"),ol=y("jyI49"),o_=y("geZBG");const cK=(t,e)=>{if("next"!==t&&"prev"!==t)return e},cX=t=>{t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev};class cJ{constructor(){let t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){let t=this.shortcut,e=t.prev;if(e&&e!==t)return cX(e),e}enqueue(t){let e=this.shortcut;t.prev&&t.next&&cX(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e}toString(){let t=[],e=this.shortcut,r=e.prev;for(;r!==e;)t.push(JSON.stringify(r,cK)),r=null==r?void 0:r.prev;return`[${t.join(", ")}]`}}class cZ extends cJ{}const cQ=()=>1,c0=(t,e)=>{var r;if(t.getAllNodes().length<=1)return[];let n=c3(t,e||cQ);return null===(r=c1(n.graph,n.buckets,n.zeroIdx).map(e=>t.getRelatedEdges(e.v,"out").filter(({target:t})=>t===e.w)))||void 0===r?void 0:r.flat()},c1=(t,e,r)=>{let n,i=[],a=e[e.length-1],o=e[0];for(;t.getAllNodes().length;){for(;n=o.dequeue();)c2(t,e,r,n);for(;n=a.dequeue();)c2(t,e,r,n);if(t.getAllNodes().length){for(let a=e.length-2;a>0;--a)if(n=e[a].dequeue()){i=i.concat(c2(t,e,r,n,!0));break}}}return i},c2=(t,e,r,n,i)=>{var a,o;let s=[];return t.hasNode(n.v)&&(null===(a=t.getRelatedEdges(n.v,"in"))||void 0===a||a.forEach(n=>{let a=n.data.weight,o=t.getNode(n.source);i&&s.push({v:n.source,w:n.target,in:0,out:0}),void 0===o.data.out&&(o.data.out=0),o.data.out-=a,c6(e,r,Object.assign({v:o.id},o.data))}),null===(o=t.getRelatedEdges(n.v,"out"))||void 0===o||o.forEach(n=>{let i=n.data.weight,a=n.target,o=t.getNode(a);void 0===o.data.in&&(o.data.in=0),o.data.in-=i,c6(e,r,Object.assign({v:o.id},o.data))}),t.removeNode(n.v)),i?s:void 0},c3=(t,e)=>{let r=new cI,n=0,i=0;t.getAllNodes().forEach(t=>{r.addNode({id:t.id,data:{v:t.id,in:0,out:0}})}),t.getAllEdges().forEach(t=>{let a=r.getRelatedEdges(t.source,"out").find(e=>e.target===t.target),o=(null==e?void 0:e(t))||1;a?r.updateEdgeData(null==a?void 0:a.id,Object.assign(Object.assign({},a.data),{weight:a.data.weight+o})):r.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:o}}),i=Math.max(i,r.getNode(t.source).data.out+=o),n=Math.max(n,r.getNode(t.target).data.in+=o)});let a=[],o=i+n+3;for(let t=0;t<o;t++)a.push(new cZ);let s=n+1;return r.getAllNodes().forEach(t=>{c6(a,s,Object.assign({v:t.id},r.getNode(t.id).data))}),{buckets:a,zeroIdx:s,graph:r}},c6=(t,e,r)=>{r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},c5=(t,e)=>{let r="greedy"===e?c0(t,t=>t.data.weight||1):c4(t);null==r||r.forEach(e=>{let r=e.data;t.removeEdge(e.id),r.forwardName=e.data.name,r.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign({},r)})})},c4=t=>{let e=[],r={},n={},i=a=>{n[a]||(n[a]=!0,r[a]=!0,t.getRelatedEdges(a,"out").forEach(t=>{r[t.target]?e.push(t):i(t.target)}),delete r[a])};return t.getAllNodes().forEach(t=>i(t.id)),e},c8=t=>{t.getAllEdges().forEach(e=>{let r=e.data;if(r.reversed){t.removeEdge(e.id);let n=r.forwardName;delete r.reversed,delete r.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign(Object.assign({},r),{forwardName:n})})}})};var ol=y("jyI49");const c9=(t,e)=>Number(t)-Number(e),c7=(t,e,r,n)=>{let i;do i=`${n}${Math.random()}`;while(t.hasNode(i))return r.dummy=e,t.addNode({id:i,data:r}),i},ft=t=>{let e=new cI;return t.getAllNodes().forEach(t=>{e.addNode(Object.assign({},t))}),t.getAllEdges().forEach(t=>{let r=e.getRelatedEdges(t.source,"out").find(e=>e.target===t.target);r?e.updateEdgeData(null==r?void 0:r.id,Object.assign(Object.assign({},r.data),{weight:r.data.weight+t.data.weight||0,minlen:Math.max(r.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})}),e},fe=t=>{let e=new cI;return t.getAllNodes().forEach(r=>{t.getChildren(r.id).length||e.addNode(Object.assign({},r))}),t.getAllEdges().forEach(t=>{e.addEdge(t)}),e},fr=(t,e)=>null==t?void 0:t.reduce((t,r,n)=>(t[r]=e[n],t),{}),fn=(t,e)=>{let r,n;let i=Number(t.x),a=Number(t.y),o=Number(e.x)-i,s=Number(e.y)-a,l=Number(t.width)/2,u=Number(t.height)/2;return o||s?(Math.abs(s)*l>Math.abs(o)*u?(s<0&&(u=-u),r=u*o/s,n=u):(o<0&&(l=-l),r=l,n=l*s/o),{x:i+r,y:a+n}):{x:0,y:0}},fi=t=>{let e=[],r=fl(t)+1;for(let t=0;t<r;t++)e.push([]);t.getAllNodes().forEach(t=>{let r=t.data.rank;void 0!==r&&e[r]&&e[r].push(t.id)});for(let n=0;n<r;n++)e[n]=e[n].sort((e,r)=>c9(t.getNode(e).data.order,t.getNode(r).data.order));return e},fa=t=>{let e=Math.min(...t.getAllNodes().filter(t=>void 0!==t.data.rank).map(t=>t.data.rank));t.getAllNodes().forEach(t=>{t.data.hasOwnProperty("rank")&&e!==1/0&&(t.data.rank-=e)})},fo=(t,e=0)=>{let r=t.getAllNodes(),n=Math.min(...r.filter(t=>void 0!==t.data.rank).map(t=>t.data.rank)),i=[];r.forEach(t=>{let e=(t.data.rank||0)-n;i[e]||(i[e]=[]),i[e].push(t.id)});let a=0;for(let r=0;r<i.length;r++){let n=i[r];void 0===n?r%e!=0&&(a-=1):a&&(null==n||n.forEach(e=>{let r=t.getNode(e);r&&(r.data.rank=r.data.rank||0,r.data.rank+=a)}))}},fs=(t,e,r,n)=>{let i={width:0,height:0};return(0,ol.default)(r)&&(0,ol.default)(n)&&(i.rank=r,i.order=n),c7(t,"border",i,e)},fl=t=>{let e;return t.getAllNodes().forEach(t=>{let r=t.data.rank;void 0!==r&&(void 0===e||r>e)&&(e=r)}),e||(e=0),e},fu=(t,e)=>{let r={lhs:[],rhs:[]};return null==t||t.forEach(t=>{e(t)?r.lhs.push(t):r.rhs.push(t)}),r},fh=(t,e)=>t.reduce((t,r)=>e(t)>e(r)?r:t),fd=(t,e,r,n,i,a)=>{!n.includes(e.id)&&(n.push(e.id),r||a.push(e.id),i(e.id).forEach(e=>fd(t,e,r,n,i,a)),r&&a.push(e.id))},fc=(t,e,r,n)=>{let i=Array.isArray(e)?e:[e],a=e=>n?t.getSuccessors(e):t.getNeighbors(e),o=[],s=[];return i.forEach(e=>{if(t.hasNode(e.id))fd(t,e,"post"===r,s,a,o);else throw Error(`Graph does not have node: ${e}`)}),o},ff=t=>{let e=r=>{let n=t.getChildren(r),i=t.getNode(r);if((null==n?void 0:n.length)&&n.forEach(t=>e(t.id)),i.data.hasOwnProperty("minRank")){i.data.borderLeft=[],i.data.borderRight=[];for(let e=i.data.minRank,n=i.data.maxRank+1;e<n;e+=1)fp(t,"borderLeft","_bl",r,i,e),fp(t,"borderRight","_br",r,i,e)}};t.getRoots().forEach(t=>e(t.id))},fp=(t,e,r,n,i,a)=>{let o=i.data[e][a-1],s=c7(t,"border",{rank:a,borderType:e,width:0,height:0},r);i.data[e][a]=s,t.setParent(s,n),o&&t.addEdge({id:`e${Math.random()}`,source:o,target:s,data:{weight:1}})},fg=(t,e)=>{let r=e.toLowerCase();("lr"===r||"rl"===r)&&fv(t)},fy=(t,e)=>{let r=e.toLowerCase();("bt"===r||"rl"===r)&&fb(t),("lr"===r||"rl"===r)&&(fE(t),fv(t))},fv=t=>{t.getAllNodes().forEach(t=>{fm(t)}),t.getAllEdges().forEach(t=>{fm(t)})},fm=t=>{let e=t.data.width;t.data.width=t.data.height,t.data.height=e},fb=t=>{t.getAllNodes().forEach(t=>{fx(t.data)}),t.getAllEdges().forEach(t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach(t=>fx(t)),t.data.hasOwnProperty("y")&&fx(t.data)})},fx=t=>{(null==t?void 0:t.y)&&(t.y=-t.y)},fE=t=>{t.getAllNodes().forEach(t=>{fw(t.data)}),t.getAllEdges().forEach(t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach(t=>fw(t)),t.data.hasOwnProperty("x")&&fw(t.data)})},fw=t=>{let e=t.x;t.x=t.y,t.y=e},f_=t=>{let e=c7(t,"root",{},"_root"),r=fk(t),n=Math.max(...Object.values(r));Math.abs(n)===1/0&&(n=1);let i=n-1,a=2*i+1;t.getAllEdges().forEach(t=>{t.data.minlen*=a});let o=fN(t)+1;return t.getRoots().forEach(n=>{fS(t,e,a,o,i,r,n.id)}),{nestingRoot:e,nodeRankFactor:a}},fS=(t,e,r,n,i,a,o)=>{let s=t.getChildren(o);if(!(null==s?void 0:s.length)){o!==e&&t.addEdge({id:`e${Math.random()}`,source:e,target:o,data:{weight:0,minlen:r}});return}let l=fs(t,"_bt"),u=fs(t,"_bb"),h=t.getNode(o);t.setParent(l,o),h.data.borderTop=l,t.setParent(u,o),h.data.borderBottom=u,null==s||s.forEach(s=>{fS(t,e,r,n,i,a,s.id);let h=s.data.borderTop?s.data.borderTop:s.id,d=s.data.borderBottom?s.data.borderBottom:s.id,c=s.data.borderTop?n:2*n,f=h!==d?1:i-a[o]+1;t.addEdge({id:`e${Math.random()}`,source:l,target:h,data:{minlen:f,weight:c,nestingEdge:!0}}),t.addEdge({id:`e${Math.random()}`,source:d,target:u,data:{minlen:f,weight:c,nestingEdge:!0}})}),t.getParent(o)||t.addEdge({id:`e${Math.random()}`,source:e,target:l,data:{weight:0,minlen:i+a[o]}})},fk=t=>{let e={},r=(n,i)=>{let a=t.getChildren(n);null==a||a.forEach(t=>r(t.id,i+1)),e[n]=i};return t.getRoots().forEach(t=>r(t.id,1)),e},fN=t=>{let e=0;return t.getAllEdges().forEach(t=>{e+=t.data.weight}),e},fO=(t,e)=>{e&&t.removeNode(e),t.getAllEdges().forEach(e=>{e.data.nestingEdge&&t.removeEdge(e.id)})},fT="edge-label",fM=(t,e)=>{t.getAllEdges().forEach(r=>fA(t,r,e))},fA=(t,e,r)=>{let n,i,a,o=e.source,s=t.getNode(o).data.rank,l=e.target,u=t.getNode(l).data.rank,h=e.data.labelRank;if(u!==s+1){for(t.removeEdge(e.id),a=0,++s;s<u;++a,++s)e.data.points=[],n=c7(t,"edge",i={originalEdge:e,width:0,height:0,rank:s},"_d"),s===h&&(i.width=e.data.width,i.height=e.data.height,i.dummy=fT,i.labelpos=e.data.labelpos),t.addEdge({id:`e${Math.random()}`,source:o,target:n,data:{weight:e.data.weight}}),0===a&&r.push(n),o=n;t.addEdge({id:`e${Math.random()}`,source:o,target:l,data:{weight:e.data.weight}})}},fC=(t,e)=>{e.forEach(e=>{let r,n=t.getNode(e),{data:i}=n,a=i.originalEdge;a&&t.addEdge(a);let o=e;for(;n.data.dummy;)r=t.getSuccessors(o)[0],t.removeNode(o),a.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===fT&&(a.data.x=n.data.x,a.data.y=n.data.y,a.data.width=n.data.width,a.data.height=n.data.height),o=r.id,n=t.getNode(o)})},fR=(t,e,r)=>{let n;let i={};null==r||r.forEach(r=>{let a,o,s=t.getParent(r);for(;s;){if((a=t.getParent(s.id))?(o=i[a.id],i[a.id]=s.id):(o=n,n=s.id),o&&o!==s.id){e.hasNode(o)||e.addNode({id:o,data:{}}),e.hasNode(s.id)||e.addNode({id:s.id,data:{}}),e.hasEdge(`e${o}-${s.id}`)||e.addEdge({id:`e${o}-${s.id}`,source:o,target:s.id,data:{}});return}s=a}})},fI=(t,e,r)=>{let n=fP(t),i=new cI({tree:[{id:n,children:[],data:{}}]});return t.getAllNodes().forEach(a=>{let o=t.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(Object.assign({},a)),(null==o?void 0:o.id)&&!i.hasNode(null==o?void 0:o.id)&&i.addNode(Object.assign({},o)),i.setParent(a.id,(null==o?void 0:o.id)||n),t.getRelatedEdges(a.id,r).forEach(e=>{let r=e.source===a.id?e.target:e.source;i.hasNode(r)||i.addNode(Object.assign({},t.getNode(r)));let n=i.getRelatedEdges(r,"out").find(({target:t})=>t===a.id),o=void 0!==n?n.data.weight:0;n?i.updateEdgeData(n.id,Object.assign(Object.assign({},n.data),{weight:e.data.weight+o})):i.addEdge({id:e.id,source:r,target:a.id,data:{weight:e.data.weight+o}})}),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,Object.assign(Object.assign({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))}),i},fP=t=>{let e;for(;t.hasNode(e=`_root${Math.random()}`););return e},fD=(t,e,r)=>{let n=fr(r,r.map((t,e)=>e)),i=e.map(e=>{let r=t.getRelatedEdges(e,"out").map(t=>({pos:n[t.target]||0,weight:t.data.weight}));return null==r?void 0:r.sort((t,e)=>t.pos-e.pos)}).flat().filter(t=>void 0!==t),a=1;for(;a<r.length;)a<<=1;let o=2*a-1;a-=1;let s=Array(o).fill(0,0,o),l=0;return null==i||i.forEach(t=>{if(t){let e=t.pos+a;s[e]+=t.weight;let r=0;for(;e>0;)e%2&&(r+=s[e+1]),e=e-1>>1,s[e]+=t.weight;l+=t.weight*r}}),l},fL=(t,e)=>{let r=0;for(let n=1;n<(null==e?void 0:e.length);n+=1)r+=fD(t,e[n-1],e[n]);return r},fj=t=>{let e={},r=t.getAllNodes(),n=Math.max(...r.map(t=>{var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0})),i=[];for(let t=0;t<n+1;t++)i.push([]);let a=r.sort((e,r)=>t.getNode(e.id).data.rank-t.getNode(r.id).data.rank),o=a.filter(e=>void 0!==t.getNode(e.id).data.fixorder).sort((e,r)=>t.getNode(e.id).data.fixorder-t.getNode(r.id).data.fixorder);return null==o||o.forEach(r=>{isNaN(t.getNode(r.id).data.rank)||i[t.getNode(r.id).data.rank].push(r.id),e[r.id]=!0}),null==a||a.forEach(r=>t.dfsTree(r.id,t=>{if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||i[t.data.rank].push(t.id)})),i},fF=(t,e)=>e.map(e=>{let r=t.getRelatedEdges(e,"in");if(!(null==r?void 0:r.length))return{v:e};let n={sum:0,weight:0};return null==r||r.forEach(e=>{let r=t.getNode(e.source);n.sum+=e.data.weight*r.data.order,n.weight+=e.data.weight}),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}),fB=t=>{var e,r;let n=[],i=t=>e=>{!e.merged&&(void 0===e.barycenter||void 0===t.barycenter||e.barycenter>=t.barycenter)&&fz(t,e)},a=e=>r=>{r.in.push(e),0==--r.indegree&&t.push(r)};for(;null==t?void 0:t.length;){let o=t.pop();n.push(o),null===(e=o.in.reverse())||void 0===e||e.forEach(t=>i(o)(t)),null===(r=o.out)||void 0===r||r.forEach(t=>a(o)(t))}let o=n.filter(t=>!t.merged),s=["vs","i","barycenter","weight"];return o.map(t=>{let e={};return null==s||s.forEach(r=>{void 0!==t[r]&&(e[r]=t[r])}),e})},fz=(t,e)=>{var r;let n=0,i=0;t.weight&&(n+=t.barycenter*t.weight,i+=t.weight),e.weight&&(n+=e.barycenter*e.weight,i+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/i,t.weight=i,t.i=Math.min(e.i,t.i),e.merged=!0};var fV=(t,e)=>{var r,n,i;let a={};return null==t||t.forEach((t,e)=>{a[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};let r=a[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)}),null===(r=e.getAllEdges())||void 0===r||r.forEach(t=>{let e=a[t.source],r=a[t.target];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(a[t.target]))}),fB(null===(i=(n=Object.values(a)).filter)||void 0===i?void 0:i.call(n,t=>!t.indegree))};const fG=(t,e,r,n)=>{let i=fu(t,t=>{let e=t.hasOwnProperty("fixorder")&&!isNaN(t.fixorder);return n?!e&&t.hasOwnProperty("barycenter"):e||t.hasOwnProperty("barycenter")}),a=i.lhs,o=i.rhs.sort((t,e)=>-t.i- -e.i),s=[],l=0,u=0,h=0;null==a||a.sort(fU(!!e,!!r)),h=f$(s,o,h),null==a||a.forEach(t=>{var e;h+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),l+=t.barycenter*t.weight,u+=t.weight,h=f$(s,o,h)});let d={vs:s.flat()};return u&&(d.barycenter=l/u,d.weight=u),d},f$=(t,e,r)=>{let n,i=r;for(;e.length&&(n=e[e.length-1]).i<=i;)e.pop(),null==t||t.push(n.vs),i++;return i},fU=(t,e)=>(r,n)=>{if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return -1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return -1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i},fH=(t,e,r,n,i,a)=>{var o,s,l,u;let h=t.getChildren(e).map(t=>t.id),d=t.getNode(e),c=d?d.data.borderLeft:void 0,f=d?d.data.borderRight:void 0,p={};c&&(h=null==h?void 0:h.filter(t=>t!==c&&t!==f));let g=fF(t,h||[]);null==g||g.forEach(e=>{var i;if(null===(i=t.getChildren(e.v))||void 0===i?void 0:i.length){let i=fH(t,e.v,r,n,a);p[e.v]=i,i.hasOwnProperty("barycenter")&&fq(e,i)}});let y=fV(g,r);fW(y,p),null===(o=y.filter(t=>t.vs.length>0))||void 0===o||o.forEach(e=>{let r=t.getNode(e.vs[0]);r&&(e.fixorder=r.data.fixorder,e.order=r.data.order)});let v=fG(y,n,i,a);if(c&&(v.vs=[c,v.vs,f].flat(),null===(s=t.getPredecessors(c))||void 0===s?void 0:s.length)){let e=t.getNode((null===(l=t.getPredecessors(c))||void 0===l?void 0:l[0].id)||""),r=t.getNode((null===(u=t.getPredecessors(f))||void 0===u?void 0:u[0].id)||"");v.hasOwnProperty("barycenter")||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+e.data.order+r.data.order)/(v.weight+2),v.weight+=2}return v},fW=(t,e)=>{null==t||t.forEach(t=>{var r;let n=null===(r=t.vs)||void 0===r?void 0:r.map(t=>e[t]?e[t].vs:t);t.vs=n.flat()})},fq=(t,e)=>{void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},fY=(t,e)=>{let r;let n=fl(t),i=[],a=[];for(let t=1;t<n+1;t++)i.push(t);for(let t=n-1;t>-1;t--)a.push(t);let o=fK(t,i,"in"),s=fK(t,a,"out"),l=fj(t);fJ(t,l);let u=Number.POSITIVE_INFINITY;for(let n=0,i=0;i<4;++n,++i){fX(n%2?o:s,n%4>=2,!1,e),l=fi(t);let a=fL(t,l);a<u&&(i=0,r=sj(l),u=a)}l=fj(t),fJ(t,l);for(let n=0,i=0;i<4;++n,++i){fX(n%2?o:s,n%4>=2,!0,e),l=fi(t);let a=fL(t,l);a<u&&(i=0,r=sj(l),u=a)}fJ(t,r)},fK=(t,e,r)=>e.map(e=>fI(t,e,r)),fX=(t,e,r,n)=>{let i=new cI;null==t||t.forEach(t=>{var a;let o=t.getRoots()[0].id,s=fH(t,o,i,e,r,n);for(let e=0;e<(null===(a=s.vs)||void 0===a?void 0:a.length);e++){let r=t.getNode(s.vs[e]);r&&(r.data.order=e)}fR(t,i,s.vs)})},fJ=(t,e)=>{null==e||e.forEach(e=>{null==e||e.forEach((e,r)=>{t.getNode(e).data.order=r})})},fZ=(t,e)=>{let r=Math.max(...t.getAllNodes().filter(e=>{var r;return!(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length)}).map(t=>t.data.rank)),n=[];for(let t=0;t<r+1;t++)n[t]=[];null==e||e.forEach(e=>{let r=t.getNode(e);!r||r.data.dummy||isNaN(r.data.rank)||(r.data.fixorder=n[r.data.rank].length,n[r.data.rank].push(e))})},fQ=t=>{let e={},r=0,n=i=>{let a=r;t.getChildren(i).forEach(t=>n(t.id)),e[i]={low:a,lim:r++}};return t.getRoots().forEach(t=>n(t.id)),e},f0=(t,e,r,n)=>{var i,a;let o,s;let l=[],u=[],h=Math.min(e[r].low,e[n].low),d=Math.max(e[r].lim,e[n].lim);o=r;do l.push(o=null===(i=t.getParent(o))||void 0===i?void 0:i.id);while(o&&(e[o].low>h||d>e[o].lim))for(s=o,o=n;o&&o!==s;)u.push(o),o=null===(a=t.getParent(o))||void 0===a?void 0:a.id;return{lca:s,path:l.concat(u.reverse())}},f1=(t,e)=>{let r=fQ(t);e.forEach(e=>{var n,i;let a=e,o=t.getNode(a),s=o.data.originalEdge;if(!s)return;let l=f0(t,r,s.source,s.target),u=l.path,h=l.lca,d=0,c=u[0],f=!0;for(;a!==s.target;){if(o=t.getNode(a),f){for(;c!==h&&(null===(n=t.getNode(c))||void 0===n?void 0:n.data.maxRank)<o.data.rank;)c=u[++d];c===h&&(f=!1)}if(!f){for(;d<u.length-1&&(null===(i=t.getNode(u[d+1]))||void 0===i?void 0:i.data.minRank)<=o.data.rank;)d++;c=u[d]}t.hasNode(c)&&t.setParent(a,c),a=t.getSuccessors(a)[0].id}})},f2=(t,e)=>{let r={};return(null==e?void 0:e.length)&&e.reduce((e,n)=>{let i=0,a=0,o=e.length,s=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((e,l)=>{var u;let h=f6(t,e),d=h?t.getNode(h.id).data.order:o;(h||e===s)&&(null===(u=n.slice(a,l+1))||void 0===u||u.forEach(e=>{var n;null===(n=t.getPredecessors(e))||void 0===n||n.forEach(n=>{var a;let o=t.getNode(n.id),s=o.data.order;(s<i||d<s)&&!(o.data.dummy&&(null===(a=t.getNode(e))||void 0===a?void 0:a.data.dummy))&&f5(r,n.id,e)})}),a=l+1,i=d)}),n}),r},f3=(t,e)=>{let r={};function n(e,n){let i=JSON.stringify(e.slice(1));n.get(i)||(!function(e,n,i,a,o){var s,l;let u;for(let h=n;h<i;h++)u=e[h],(null===(s=t.getNode(u))||void 0===s?void 0:s.data.dummy)&&(null===(l=t.getPredecessors(u))||void 0===l||l.forEach(e=>{let n=t.getNode(e.id);n.data.dummy&&(n.data.order<a||n.data.order>o)&&f5(r,e.id,u)}))}(...e),n.set(i,!0))}return(null==e?void 0:e.length)&&e.reduce((e,r)=>{let i,a=-1,o=0,s=new Map;return null==r||r.forEach((l,u)=>{var h;if((null===(h=t.getNode(l))||void 0===h?void 0:h.data.dummy)==="border"){let e=t.getPredecessors(l)||[];e.length&&(i=t.getNode(e[0].id).data.order,n([r,o,u,a,i],s),o=u,a=i)}n([r,o,r.length,i,e.length],s)}),r}),r},f6=(t,e)=>{var r,n;if(null===(r=t.getNode(e))||void 0===r?void 0:r.data.dummy)return null===(n=t.getPredecessors(e))||void 0===n?void 0:n.find(e=>t.getNode(e.id).data.dummy)},f5=(t,e,r)=>{let n=e,i=r;if(n>i){let t=n;n=i,i=t}let a=t[n];a||(t[n]=a={}),a[i]=!0},f4=(t,e,r)=>{let n=e,i=r;return n>i&&(n=i,i=e),!!t[n]},f8=(t,e,r,n)=>{let i={},a={},o={};return null==e||e.forEach(t=>{null==t||t.forEach((t,e)=>{i[t]=t,a[t]=t,o[t]=e})}),null==e||e.forEach(t=>{let e=-1;null==t||t.forEach(t=>{let s=n(t).map(t=>t.id);if(s.length){let n=((s=s.sort((t,e)=>o[t]-o[e])).length-1)/2;for(let l=Math.floor(n),u=Math.ceil(n);l<=u;++l){let n=s[l];a[t]===t&&e<o[n]&&!f4(r,t,n)&&(a[n]=t,a[t]=i[t]=i[n],e=o[n])}}})}),{root:i,align:a}},f9=(t,e,r,n,i,a,o)=>{var s;let l={},u=f7(t,e,r,i,a,o),h=o?"borderLeft":"borderRight",d=(t,e)=>{let r=u.getAllNodes(),n=r.pop(),i={};for(;n;)i[n.id]?t(n.id):(i[n.id]=!0,r.push(n),r=r.concat(e(n.id))),n=r.pop()};return d(t=>{l[t]=(u.getRelatedEdges(t,"in")||[]).reduce((t,e)=>Math.max(t,(l[e.source]||0)+e.data.weight),0)},u.getPredecessors.bind(u)),d(e=>{let r=(u.getRelatedEdges(e,"out")||[]).reduce((t,e)=>Math.min(t,(l[e.target]||0)-e.data.weight),Number.POSITIVE_INFINITY),n=t.getNode(e);r!==Number.POSITIVE_INFINITY&&n.data.borderType!==h&&(l[e]=Math.max(l[e],r))},u.getSuccessors.bind(u)),null===(s=Object.values(n))||void 0===s||s.forEach(t=>{l[t]=l[r[t]]}),l},f7=(t,e,r,n,i,a)=>{let o=new cI,s=pr(n,i,a);return null==e||e.forEach(e=>{let n;null==e||e.forEach(e=>{let i=r[e];if(o.hasNode(i)||o.addNode({id:i,data:{}}),n){let a=r[n],l=o.getRelatedEdges(a,"out").find(t=>t.target===i);l?o.updateEdgeData(l.id,Object.assign(Object.assign({},l.data),{weight:Math.max(s(t,e,n),l.data.weight||0)})):o.addEdge({id:`e${Math.random()}`,source:a,target:i,data:{weight:Math.max(s(t,e,n),0)}})}n=e})}),o},pt=(t,e)=>fh(Object.values(e),e=>{var r;let n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach(r=>{let a=e[r],o=pn(t,r)/2;n=Math.max(a+o,n),i=Math.min(a-o,i)}),n-i}),pe=(t,e)=>{let r={};return Object.keys(t.ul).forEach(n=>{if(e)r[n]=t[e.toLowerCase()][n];else{let e=Object.values(t).map(t=>t[n]);r[n]=(e[0]+e[1])/2}}),r},pr=(t,e,r)=>(n,i,a)=>{let o;let s=n.getNode(i),l=n.getNode(a),u=0;if(o=0+s.data.width/2,s.data.hasOwnProperty("labelpos"))switch((s.data.labelpos||"").toLowerCase()){case"l":u=-s.data.width/2;break;case"r":u=s.data.width/2}if(u&&(o+=r?u:-u),u=0,o+=(s.data.dummy?e:t)/2,o+=(l.data.dummy?e:t)/2,o+=l.data.width/2,l.data.labelpos)switch((l.data.labelpos||"").toLowerCase()){case"l":u=l.data.width/2;break;case"r":u=-l.data.width/2}return u&&(o+=r?u:-u),u=0,o},pn=(t,e)=>t.getNode(e).data.width||0,pi=(t,e)=>{let{ranksep:r=0}=e||{},n=fi(t),i=0;null==n||n.forEach(e=>{let n=Math.max(...e.map(e=>t.getNode(e).data.height),0);null==e||e.forEach(e=>{t.getNode(e).data.y=i+n/2}),i+=n+r})},pa=(t,e)=>{let{align:r,nodesep:n=0,edgesep:i=0}=e||{},a=fi(t),o=Object.assign(f2(t,a),f3(t,a)),s={},l=[];["u","d"].forEach(e=>{l="u"===e?a:Object.values(a).reverse(),["l","r"].forEach(r=>{"r"===r&&(l=l.map(t=>Object.values(t).reverse()));let a=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),u=f8(t,l,o,a),h=f9(t,l,u.root,u.align,n,i,"r"===r);"r"===r&&Object.keys(h).forEach(t=>h[t]=-h[t]),s[e+r]=h})});let u=pt(t,s);return u&&function(t,e){let r=Object.values(e),n=Math.min(...r),i=Math.max(...r);["u","d"].forEach(r=>{["l","r"].forEach(a=>{let o;let s=r+a,l=t[s];if(l===e)return;let u=Object.values(l);(o="l"===a?n-Math.min(...u):i-Math.max(...u))&&(t[s]={},Object.keys(l).forEach(e=>{t[s][e]=l[e]+o}))})})}(s,u),pe(s,r)},po=(t,e)=>{var r;let n=fe(t);pi(n,e);let i=pa(n,e);null===(r=Object.keys(i))||void 0===r||r.forEach(t=>{n.getNode(t).data.x=i[t]})},ps=t=>{let e={},r=n=>{var i;let a;let o=t.getNode(n);return o?e[n]?o.data.rank:(e[n]=!0,null===(i=t.getRelatedEdges(n,"out"))||void 0===i||i.forEach(t=>{let e=r(t.target)-t.data.minlen;e&&(void 0===a||e<a)&&(a=e)}),a||(a=0),o.data.rank=a,a):0};t.getAllNodes().filter(e=>0===t.getRelatedEdges(e.id,"in").length).forEach(t=>r(t.id))},pl=t=>{let e;let r={},n=i=>{var a;let o;let s=t.getNode(i);return s?r[i]?s.data.rank:(r[i]=!0,null===(a=t.getRelatedEdges(i,"out"))||void 0===a||a.forEach(t=>{let e=n(t.target)-t.data.minlen;e&&(void 0===o||e<o)&&(o=e)}),o||(o=0),(void 0===e||o<e)&&(e=o),s.data.rank=o,o):0};t.getAllNodes().filter(e=>0===t.getRelatedEdges(e.id,"in").length).forEach(t=>{t&&n(t.id)}),void 0===e&&(e=0);let i={},a=(e,r)=>{var n;let o=t.getNode(e),s=isNaN(o.data.layer)?r:o.data.layer;(void 0===o.data.rank||o.data.rank<s)&&(o.data.rank=s),i[e]||(i[e]=!0,null===(n=t.getRelatedEdges(e,"out"))||void 0===n||n.forEach(t=>{a(t.target,s+t.data.minlen)}))};t.getAllNodes().forEach(t=>{let r=t.data;r&&(isNaN(r.layer)?r.rank-=e:a(t.id,r.layer))})},pu=(t,e)=>t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen,ph=t=>{let e,r;let n=new cI({tree:[]}),i=t.getAllNodes()[0],a=t.getAllNodes().length;for(n.addNode(i);pd(n,t)<a;)e=pp(n,t),r=n.hasNode(e.source)?pu(t,e):-pu(t,e),pg(n,t,r);return n},pd=(t,e)=>{let r=n=>{e.getRelatedEdges(n,"both").forEach(i=>{let a=i.source,o=n===a?i.target:a;t.hasNode(o)||pu(e,i)||(t.addNode({id:o,data:{}}),t.addEdge({id:i.id,source:n,target:o,data:{}}),r(o))})};return t.getAllNodes().forEach(t=>r(t.id)),t.getAllNodes().length},pc=t=>{let e,r;let n=new cI({tree:[]}),i=t.getAllNodes()[0],a=t.getAllNodes().length;for(n.addNode(i);pf(n,t)<a;)e=pp(n,t),r=n.hasNode(e.source)?pu(t,e):-pu(t,e),pg(n,t,r);return n},pf=(t,e)=>{let r=n=>{var i;null===(i=e.getRelatedEdges(n,"both"))||void 0===i||i.forEach(i=>{let a=i.source,o=n===a?i.target:a;t.hasNode(o)||void 0===e.getNode(o).data.layer&&pu(e,i)||(t.addNode({id:o,data:{}}),t.addEdge({id:i.id,source:n,target:o,data:{}}),r(o))})};return t.getAllNodes().forEach(t=>r(t.id)),t.getAllNodes().length},pp=(t,e)=>fh(e.getAllEdges(),r=>t.hasNode(r.source)!==t.hasNode(r.target)?pu(e,r):1/0),pg=(t,e,r)=>{t.getAllNodes().forEach(t=>{let n=e.getNode(t.id);n.data.rank||(n.data.rank=0),n.data.rank+=r})},py=t=>{let e,r;let n=ft(t);ps(n);let i=ph(n);for(px(i),pv(i,n);e=pw(i);)r=p_(i,n,e),pS(i,n,e,r)},pv=(t,e)=>{let r=fc(t,t.getAllNodes(),"post",!1);(r=r.slice(0,(null==r?void 0:r.length)-1)).forEach(r=>{pm(t,e,r)})},pm=(t,e,r)=>{let n=t.getNode(r).data.parent;t.getRelatedEdges(r,"both").find(t=>t.target===n||t.source===n).data.cutvalue=pb(t,e,r)},pb=(t,e,r)=>{let n=t.getNode(r).data.parent,i=!0,a=e.getRelatedEdges(r,"out").find(t=>t.target===n),o=0;return a||(i=!1,a=e.getRelatedEdges(n,"out").find(t=>t.target===r)),o=a.data.weight,e.getRelatedEdges(r,"both").forEach(e=>{let a=e.source===r,s=a?e.target:e.source;if(s!==n){let n=a===i,l=e.data.weight;if(o+=n?l:-l,pN(t,r,s)){let e=t.getRelatedEdges(r,"both").find(t=>t.source===s||t.target===s).data.cutvalue;o+=n?-e:e}}}),o},px=(t,e=t.getAllNodes()[0].id)=>{pE(t,{},1,e)},pE=(t,e,r,n,i)=>{var a;let o=r,s=t.getNode(n);return e[n]=!0,null===(a=t.getNeighbors(n))||void 0===a||a.forEach(r=>{e[r.id]||(o=pE(t,e,o,r.id,n))}),s.data.low=r,s.data.lim=o++,i?s.data.parent=i:delete s.data.parent,o},pw=t=>t.getAllEdges().find(t=>t.data.cutvalue<0),p_=(t,e,r)=>{let n=r.source,i=r.target;e.getRelatedEdges(n,"out").find(t=>t.target===i)||(n=r.target,i=r.source);let a=t.getNode(n),o=t.getNode(i),s=a,l=!1;return a.data.lim>o.data.lim&&(s=o,l=!0),fh(e.getAllEdges().filter(e=>l===pO(t.getNode(e.source),s)&&l!==pO(t.getNode(e.target),s)),t=>pu(e,t))},pS=(t,e,r,n)=>{let i=t.getRelatedEdges(r.source,"both").find(t=>t.source===r.target||t.target===r.target);i&&t.removeEdge(i.id),t.addEdge({id:`e${Math.random()}`,source:n.source,target:n.target,data:{}}),px(t),pv(t,e),pk(t,e)},pk=(t,e)=>{let r=t.getAllNodes().find(t=>!t.data.parent),n=fc(t,r,"pre",!1);(n=n.slice(1)).forEach(r=>{let n=t.getNode(r).data.parent,i=e.getRelatedEdges(r,"out").find(t=>t.target===n),a=!1;!i&&e.hasNode(n)&&(i=e.getRelatedEdges(n,"out").find(t=>t.target===r),a=!0),e.getNode(r).data.rank=(e.hasNode(n)&&e.getNode(n).data.rank||0)+(a?null==i?void 0:i.data.minlen:-(null==i?void 0:i.data.minlen))})},pN=(t,e,r)=>t.getRelatedEdges(e,"both").find(t=>t.source===r||t.target===r),pO=(t,e)=>e.data.low<=t.data.lim&&t.data.lim<=e.data.lim,pT=(t,e)=>{switch(e){case"network-simplex":pC(t);break;case"tight-tree":default:pA(t);break;case"longest-path":pM(t)}},pM=ps,pA=t=>{pl(t),pc(t)},pC=t=>{py(t)},pR=(t,e)=>{let r;let{edgeLabelSpace:n,keepNodeOrder:i,prevGraph:a,rankdir:o,ranksep:s}=e;!i&&a&&pP(t,a);let l=pV(t);n&&(e.ranksep=pG(l,{rankdir:o,ranksep:s}));try{r=pI(l,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message){console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",t);return}throw t}return pD(t,l),r},pI=(t,e)=>{let{acyclicer:r,ranker:n,rankdir:i="tb",nodeOrder:a,keepNodeOrder:o,align:s,nodesep:l=50,edgesep:u=20,ranksep:h=50}=e;pJ(t),c5(t,r);let{nestingRoot:d,nodeRankFactor:c}=f_(t);pT(fe(t),n),p$(t),fo(t,c),fO(t,d),fa(t),pU(t),pH(t);let f=[];fM(t,f),f1(t,f),ff(t),o&&fZ(t,a),fY(t,o),pZ(t),fg(t,i),po(t,{align:s,nodesep:l,edgesep:u,ranksep:h}),pQ(t),pX(t),fC(t,f),pY(t),fy(t,i);let{width:p,height:g}=pW(t);return pq(t),pK(t),c8(t),{width:p,height:g}},pP=(t,e)=>{t.getAllNodes().forEach(r=>{let n=t.getNode(r.id);if(e.hasNode(r.id)){let t=e.getNode(r.id);n.data.fixorder=t.data._order,delete t.data._order}else delete n.data.fixorder})},pD=(t,e)=>{t.getAllNodes().forEach(r=>{var n;let i=t.getNode(r.id);if(i){let t=e.getNode(r.id);i.data.x=t.data.x,i.data.y=t.data.y,i.data._order=t.data.order,i.data._rank=t.data.rank,(null===(n=e.getChildren(r.id))||void 0===n?void 0:n.length)&&(i.data.width=t.data.width,i.data.height=t.data.height)}}),t.getAllEdges().forEach(r=>{let n=t.getEdge(r.id),i=e.getEdge(r.id);n.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty("x")&&(n.data.x=i.data.x,n.data.y=i.data.y)})},pL=["width","height","layer","fixorder"],pj={width:0,height:0},pF=["minlen","weight","width","height","labeloffset"],pB={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},pz=["labelpos"],pV=t=>{let e=new cI({tree:[]});return t.getAllNodes().forEach(r=>{let n=p1(t.getNode(r.id).data),i=p0(Object.assign(Object.assign({},pj),n),pL);e.hasNode(r.id)||e.addNode({id:r.id,data:Object.assign({},i)});let a=t.hasTreeStructure("combo")?t.getParent(r.id,"combo"):t.getParent(r.id);(0,o_.default)(a)||(e.hasNode(a.id)||e.addNode(Object.assign({},a)),e.setParent(r.id,a.id))}),t.getAllEdges().forEach(r=>{let n=p1(t.getEdge(r.id).data),i={};null==pz||pz.forEach(t=>{void 0!==n[t]&&(i[t]=n[t])}),e.addEdge({id:r.id,source:r.source,target:r.target,data:Object.assign({},pB,p0(n,pF),i)})}),e},pG=(t,e)=>{let{ranksep:r=0,rankdir:n}=e;return t.getAllNodes().forEach(t=>{isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)}),t.getAllEdges().forEach(t=>{var e;t.data.minlen*=2,(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())!=="c"&&("TB"===n||"BT"===n?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)}),r/2},p$=t=>{t.getAllEdges().forEach(e=>{if(e.data.width&&e.data.height){let r=t.getNode(e.source),n=t.getNode(e.target);c7(t,"edge-proxy",{e:e,rank:(n.data.rank-r.data.rank)/2+r.data.rank},"_ep")}})},pU=t=>{let e=0;return t.getAllNodes().forEach(r=>{var n,i;r.data.borderTop&&(r.data.minRank=null===(n=t.getNode(r.data.borderTop))||void 0===n?void 0:n.data.rank,r.data.maxRank=null===(i=t.getNode(r.data.borderBottom))||void 0===i?void 0:i.data.rank,e=Math.max(e,r.data.maxRank||-1/0))}),e},pH=t=>{t.getAllNodes().forEach(e=>{"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))})},pW=(t,e)=>{let r,n;let i=0,a=0,{marginx:o=0,marginy:s=0}=e||{},l=t=>{if(!t.data)return;let e=t.data.x,o=t.data.y,s=t.data.width,l=t.data.height;isNaN(e)||isNaN(s)||(void 0===r&&(r=e-s/2),r=Math.min(r,e-s/2),i=Math.max(i,e+s/2)),isNaN(o)||isNaN(l)||(void 0===n&&(n=o-l/2),n=Math.min(n,o-l/2),a=Math.max(a,o+l/2))};return t.getAllNodes().forEach(t=>{l(t)}),t.getAllEdges().forEach(t=>{(null==t?void 0:t.data.hasOwnProperty("x"))&&l(t)}),r-=o,n-=s,t.getAllNodes().forEach(t=>{t.data.x-=r,t.data.y-=n}),t.getAllEdges().forEach(t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach(t=>{t.x-=r,t.y-=n}),t.data.hasOwnProperty("x")&&(t.data.x-=r),t.data.hasOwnProperty("y")&&(t.data.y-=n)}),{width:i-r+o,height:a-n+s}},pq=t=>{t.getAllEdges().forEach(e=>{let r,n;let i=t.getNode(e.source),a=t.getNode(e.target);e.data.points?(r=e.data.points[0],n=e.data.points[e.data.points.length-1]):(e.data.points=[],r={x:a.data.x,y:a.data.y},n={x:i.data.x,y:i.data.y}),e.data.points.unshift(fn(i.data,r)),e.data.points.push(fn(a.data,n))})},pY=t=>{t.getAllEdges().forEach(t=>{if(t.data.hasOwnProperty("x"))switch(("l"===t.data.labelpos||"r"===t.data.labelpos)&&(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}})},pK=t=>{t.getAllEdges().forEach(t=>{var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())})},pX=t=>{t.getAllNodes().forEach(e=>{var r,n,i;if(null===(r=t.getChildren(e.id))||void 0===r?void 0:r.length){let r=t.getNode(e.id),a=t.getNode(r.data.borderTop),o=t.getNode(r.data.borderBottom),s=t.getNode(r.data.borderLeft[(null===(n=r.data.borderLeft)||void 0===n?void 0:n.length)-1]),l=t.getNode(r.data.borderRight[(null===(i=r.data.borderRight)||void 0===i?void 0:i.length)-1]);r.data.width=Math.abs((null==l?void 0:l.data.x)-(null==s?void 0:s.data.x))||10,r.data.height=Math.abs((null==o?void 0:o.data.y)-(null==a?void 0:a.data.y))||10,r.data.x=((null==s?void 0:s.data.x)||0)+r.data.width/2,r.data.y=((null==a?void 0:a.data.y)||0)+r.data.height/2}}),t.getAllNodes().forEach(e=>{"border"===e.data.dummy&&t.removeNode(e.id)})},pJ=t=>{t.getAllEdges().forEach(e=>{if(e.source===e.target){let r=t.getNode(e.source);r.data.selfEdges||(r.data.selfEdges=[]),r.data.selfEdges.push(e),t.removeEdge(e.id)}})},pZ=t=>{let e=fi(t);null==e||e.forEach(e=>{let r=0;null==e||e.forEach((e,n)=>{var i;let a=t.getNode(e);a.data.order=n+r,null===(i=a.data.selfEdges)||void 0===i||i.forEach(e=>{c7(t,"selfedge",{width:e.data.width,height:e.data.height,rank:a.data.rank,order:n+ ++r,e:e},"_se")}),delete a.data.selfEdges})})},pQ=t=>{t.getAllNodes().forEach(e=>{let r=t.getNode(e.id);if("selfedge"===r.data.dummy){let n=t.getNode(r.data.e.source),i=n.data.x+n.data.width/2,a=n.data.y,o=r.data.x-i,s=n.data.height/2;t.hasEdge(r.data.e.id)?t.updateEdgeData(r.data.e.id,r.data.e.data):t.addEdge({id:r.data.e.id,source:r.data.e.source,target:r.data.e.target,data:r.data.e.data}),t.removeNode(e.id),r.data.e.data.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{y:a,x:i+o},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],r.data.e.data.x=r.data.x,r.data.e.data.y=r.data.y}})},p0=(t,e)=>{let r={};return null==e||e.forEach(e=>{void 0!==t[e]&&(r[e]=+t[e])}),r},p1=(t={})=>{let e={};return Object.keys(t).forEach(r=>{e[r.toLowerCase()]=t[r]}),e};var ol=y("jyI49");const p2=t=>{if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){let e=[];return t.forEach(t=>{e.push(t)}),e.map(t=>p2(t))}if("object"==typeof t){let e={};return Object.keys(t).forEach(r=>{e[r]=p2(t[r])}),e}return t},p3=(t,e)=>{let r=p2(t);return r.data=r.data||{},e&&((0,ol.default)(r.data.x)||(r.data.x=Math.random()*e[0]),(0,ol.default)(r.data.y)||(r.data.y=Math.random()*e[1])),r};var sI=y("ky7aH"),ol=y("jyI49"),sc=y("6JKSc"),ol=y("jyI49");function p6(t){if(!t)return[0,0,0];if((0,ol.default)(t))return[t,t,t];if(0===t.length)return[0,0,0];let[e,r=e,n=e]=t;return[e,r,n]}function p5(t,e){return(0,sI.default)(e)?e:(0,ol.default)(e)?()=>e:()=>t}function p4(t,e,r=!0){return e||0===e?(0,sI.default)(e)?e:(0,ol.default)(e)?()=>e:Array.isArray(e)?()=>r?Math.max(...e)||t:e:(0,sc.default)(e)&&e.width&&e.height?()=>r?Math.max(e.width,e.height)||t:[e.width,e.height]:()=>t:e=>{let{size:n}=e.data||{};return n?Array.isArray(n)?r?Math.max(...n)||t:n:(0,sc.default)(n)&&n.width&&n.height?r?Math.max(n.width,n.height)||t:[n.width,n.height]:n:t}}const p8=(t,e,r=10)=>{let n;let i="function"==typeof e?e:()=>e||0;return n=t?Array.isArray(t)?e=>t:(0,sI.default)(t)?t:e=>t:t=>{var e,n,i;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return null===(n=t.data)||void 0===n?void 0:n.bboxSize;if(null===(i=t.data)||void 0===i?void 0:i.size){let e=t.data.size;return Array.isArray(e)?e:(0,sc.default)(e)?[e.width,e.height]:e}return r},t=>{let e=n(t),r=i(t);return Math.max(...p6(e))+r}},p9={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null},p7=(t,e,r,n,i,a,o)=>{let s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&r){let{x:t,y:l}=e.data,{x:u,y:h}=r.data;if(i&&(t=e.data.y,l=e.data.x,u=r.data.y,h=r.data.x),h!==l&&t!==u){let d=n.indexOf(l),c=n[d+1];if(c){let t=s[0],e=i?{x:(l+c)/2,y:(null==t?void 0:t.y)||u}:{x:(null==t?void 0:t.x)||u,y:(l+c)/2};(!t||a(t,e))&&s.unshift(e)}let f=n.indexOf(h),p=Math.abs(f-d);if(1===p)(s=o(s,e.data,r.data)).length||s.push(i?{x:(l+h)/2,y:t}:{x:t,y:(l+h)/2});else if(p>1){let e=n[f-1];if(e){let r=s[s.length-1],n=i?{x:(h+e)/2,y:(null==r?void 0:r.y)||u}:{x:(null==r?void 0:r.x)||t,y:(h+e)/2};(!r||a(r,n))&&s.push(n)}}}}return s};var s6=y("7WQrb");const gt=(t,e,r)=>{let n=t.getAllNodes(),i=t.getAllEdges();return(null==n?void 0:n.length)?1===n.length?(e&&t.mergeNodeData(n[0].id,{x:r[0],y:r[1]}),{nodes:[Object.assign(Object.assign({},n[0]),{data:Object.assign(Object.assign({},n[0].data),{x:r[0],y:r[1]})})],edges:i}):void 0:{nodes:[],edges:i}},ge={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},gr=(t,e,r=!1)=>{let n=[p3(e[0])],i={},a=e.length;i[e[0].id]=!0;let o=0;return e.forEach((s,l)=>{if(0!==l){if((l===a-1||t.getDegree(s.id,"both")!==t.getDegree(e[l+1].id,"both")||t.areNeighbors(n[o].id,s.id))&&!i[s.id])n.push(p3(s)),i[s.id]=!0,o++;else{let l=r?t.getSuccessors(n[o].id):t.getNeighbors(n[o].id),u=!1;for(let e=0;e<l.length;e++){let r=l[e];if(t.getDegree(r.id)===t.getDegree(s.id)&&!i[r.id]){n.push(p3(r)),i[r.id]=!0,u=!0;break}}let h=0;for(;!u&&(i[e[h].id]||(n.push(p3(e[h])),i[e[h].id]=!0,u=!0),++h!==a););}}}),n},gn=(t,e,r)=>{let n=t,i=e,a=r;return n||"undefined"==typeof window||(n=window.innerWidth),i||"undefined"==typeof window||(i=window.innerHeight),a||(a=[n/2,i/2]),[n,i,a]};var s6=y("7WQrb"),sI=y("ky7aH"),ol=y("jyI49"),sc=y("6JKSc"),s6=y("7WQrb"),sI=y("ky7aH"),ol=y("jyI49"),sc=y("6JKSc"),ou=y("kVcyu");const gi=Array.isArray,ga={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class go{constructor(t={}){this.options=t,this.id="concentric",this.options=Object.assign(Object.assign({},ga),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericConcentricLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericConcentricLayout(!0,t,e)})}genericConcentricLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let n;let{center:i,width:a,height:o,sortBy:s,maxLevelDiff:l,sweep:u,clockwise:h,equidistant:d,preventOverlap:c,startAngle:f=1.5*Math.PI,nodeSize:p,nodeSpacing:g}=Object.assign(Object.assign({},this.options),r),y=e.getAllNodes(),v=e.getAllEdges(),m=a||"undefined"==typeof window?a:window.innerWidth,b=o||"undefined"==typeof window?o:window.innerHeight,x=i||[m/2,b/2];if(!(null==y?void 0:y.length)||1===y.length)return gt(e,t,x);let E=[],w=0;gi(p)?n=Math.max(p[0],p[1]):(0,sI.default)(p)?(n=-1/0,y.forEach(t=>{let e=Math.max(...p6(p(t)));e>n&&(n=e)})):n=p,gi(g)?w=Math.max(g[0],g[1]):(0,ol.default)(g)&&(w=g),y.forEach(t=>{let e=p3(t);E.push(e);let r=n,{data:i}=e;gi(i.size)?r=Math.max(i.size[0],i.size[1]):(0,ol.default)(i.size)?r=i.size:(0,sc.default)(i.size)&&(r=Math.max(i.size.width,i.size.height)),n=Math.max(n,r),(0,sI.default)(g)&&(w=Math.max(g(t),w))});let _={};E.forEach((t,e)=>{_[t.id]=e});let S=s;(0,ou.default)(S)&&void 0!==E[0].data[S]||(S="degree"),"degree"===S?E.sort((t,r)=>e.getDegree(r.id,"both")-e.getDegree(t.id,"both")):E.sort((t,e)=>e.data[S]-t.data[S]);let k=E[0],N=(l||("degree"===S?e.getDegree(k.id,"both"):k.data[S]))/4,O=[{nodes:[]}],T=O[0];E.forEach(t=>{if(T.nodes.length>0){let r="degree"===S?Math.abs(e.getDegree(T.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(T.nodes[0].data[S]-t.data[S]);N&&r>=N&&(T={nodes:[]},O.push(T))}T.nodes.push(t)});let M=n+w;if(!c){let t=O.length>0&&O[0].nodes.length>1,e=(Math.min(m,b)/2-M)/(O.length+(t?1:0));M=Math.min(M,e)}let A=0;if(O.forEach(t=>{let e=void 0===u?2*Math.PI-2*Math.PI/t.nodes.length:u;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&c){let e=Math.cos(t.dTheta)-1,r=Math.sin(t.dTheta)-0;A=Math.max(Math.sqrt(M*M/(e*e+r*r)),A)}t.r=A,A+=M}),d){let t=0,e=0;for(let r=0;r<O.length;r++){let n=(O[r].r||0)-e;t=Math.max(t,n)}e=0,O.forEach((r,n)=>{0===n&&(e=r.r||0),r.r=e,e+=t})}return O.forEach(t=>{let e=t.dTheta||0,r=t.r||0;t.nodes.forEach((t,n)=>{let i=f+(h?1:-1)*e*n;t.data.x=x[0]+r*Math.cos(i),t.data.y=x[1]+r*Math.sin(i)})}),t&&E.forEach(t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})),{nodes:E,edges:v}})}}var s6=y("7WQrb"),ol=y("jyI49");function gs(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var i,a,o,s,l,u,h,d,c,f=t._root,p={data:n},g=t._x0,y=t._y0,v=t._x1,m=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((u=e>=(a=(g+v)/2))?g=a:v=a,(h=r>=(o=(y+m)/2))?y=o:m=o,i=f,!(f=f[d=h<<1|u]))return i[d]=p,t;if(s=+t._x.call(null,f.data),l=+t._y.call(null,f.data),e===s&&r===l)return p.next=f,i?i[d]=p:t._root=p,t;do i=i?i[d]=[,,,,]:t._root=[,,,,],(u=e>=(a=(g+v)/2))?g=a:v=a,(h=r>=(o=(y+m)/2))?y=o:m=o;while((d=h<<1|u)==(c=(l>=o)<<1|s>=a))return i[c]=f,i[d]=p,t}function gl(t,e,r,n,i){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=i}function gu(t){return t[0]}function gh(t){return t[1]}function gd(t,e,r){var n=new gc(null==e?gu:e,null==r?gh:r,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function gc(t,e,r,n,i,a){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=i,this._y1=a,this._root=void 0}function gf(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var gp=gd.prototype=gc.prototype;function gg(t,e,r,n,i){if(isNaN(e)||isNaN(r)||isNaN(n))return t;var a,o,s,l,u,h,d,c,f,p,g,y,v=t._root,m={data:i},b=t._x0,x=t._y0,E=t._z0,w=t._x1,_=t._y1,S=t._z1;if(!v)return t._root=m,t;for(;v.length;)if((c=e>=(o=(b+w)/2))?b=o:w=o,(f=r>=(s=(x+_)/2))?x=s:_=s,(p=n>=(l=(E+S)/2))?E=l:S=l,a=v,!(v=v[g=p<<2|f<<1|c]))return a[g]=m,t;if(u=+t._x.call(null,v.data),h=+t._y.call(null,v.data),d=+t._z.call(null,v.data),e===u&&r===h&&n===d)return m.next=v,a?a[g]=m:t._root=m,t;do a=a?a[g]=Array(8):t._root=Array(8),(c=e>=(o=(b+w)/2))?b=o:w=o,(f=r>=(s=(x+_)/2))?x=s:_=s,(p=n>=(l=(E+S)/2))?E=l:S=l;while((g=p<<2|f<<1|c)==(y=(d>=l)<<2|(h>=s)<<1|u>=o))return a[y]=v,a[g]=m,t}function gy(t,e,r,n,i,a,o){this.node=t,this.x0=e,this.y0=r,this.z0=n,this.x1=i,this.y1=a,this.z1=o}function gv(t){return t[0]}function gm(t){return t[1]}function gb(t){return t[2]}function gx(t,e,r,n){var i=new gE(null==e?gv:e,null==r?gm:r,null==n?gb:n,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function gE(t,e,r,n,i,a,o,s,l){this._x=t,this._y=e,this._z=r,this._x0=n,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=l,this._root=void 0}function gw(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}gp.copy=function(){var t,e,r=new gc(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=gf(n),r;for(t=[{source:n,target:r._root=[,,,,]}];n=t.pop();)for(var i=0;i<4;++i)(e=n.source[i])&&(e.length?t.push({source:e,target:n.target[i]=[,,,,]}):n.target[i]=gf(e));return r},gp.add=function(t){let e=+this._x.call(null,t),r=+this._y.call(null,t);return gs(this.cover(e,r),e,r,t)},gp.addAll=function(t){var e,r,n,i,a=t.length,o=Array(a),s=Array(a),l=1/0,u=1/0,h=-1/0,d=-1/0;for(r=0;r<a;++r)!(isNaN(n=+this._x.call(null,e=t[r]))||isNaN(i=+this._y.call(null,e)))&&(o[r]=n,s[r]=i,n<l&&(l=n),n>h&&(h=n),i<u&&(u=i),i>d&&(d=i));if(l>h||u>d)return this;for(this.cover(l,u).cover(h,d),r=0;r<a;++r)gs(this,o[r],s[r],t[r]);return this},gp.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,i=this._x1,a=this._y1;if(isNaN(r))i=(r=Math.floor(t))+1,a=(n=Math.floor(e))+1;else{for(var o,s,l=i-r||1,u=this._root;r>t||t>=i||n>e||e>=a;)switch(s=(e<n)<<1|t<r,(o=[,,,,])[s]=u,u=o,l*=2,s){case 0:i=r+l,a=n+l;break;case 1:r=i-l,a=n+l;break;case 2:i=r+l,n=a-l;break;case 3:r=i-l,n=a-l}this._root&&this._root.length&&(this._root=u)}return this._x0=r,this._y0=n,this._x1=i,this._y1=a,this},gp.data=function(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t},gp.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},gp.find=function(t,e,r){var n,i,a,o,s,l,u,h=this._x0,d=this._y0,c=this._x1,f=this._y1,p=[],g=this._root;for(g&&p.push(new gl(g,h,d,c,f)),null==r?r=1/0:(h=t-r,d=e-r,c=t+r,f=e+r,r*=r);l=p.pop();)if((g=l.node)&&!((i=l.x0)>c)&&!((a=l.y0)>f)&&!((o=l.x1)<h)&&!((s=l.y1)<d)){if(g.length){var y=(i+o)/2,v=(a+s)/2;p.push(new gl(g[3],y,v,o,s),new gl(g[2],i,v,y,s),new gl(g[1],y,a,o,v),new gl(g[0],i,a,y,v)),(u=(e>=v)<<1|t>=y)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var m=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),x=m*m+b*b;if(x<r){var E=Math.sqrt(r=x);h=t-E,d=e-E,c=t+E,f=e+E,n=g.data}}}return n},gp.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,r,n,i,a,o,s,l,u,h,d,c,f=this._root,p=this._x0,g=this._y0,y=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((u=a>=(s=(p+y)/2))?p=s:y=s,(h=o>=(l=(g+v)/2))?g=l:v=l,e=f,!(f=f[d=h<<1|u]))return this;if(!f.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(r=e,c=d)}for(;f.data!==t;)if(n=f,!(f=f.next))return this;return((i=f.next)&&delete f.next,n)?i?n.next=i:delete n.next:e?(i?e[d]=i:delete e[d],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(r?r[c]=f:this._root=f)):this._root=i,this},gp.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},gp.root=function(){return this._root},gp.size=function(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t},gp.visit=function(t){var e,r,n,i,a,o,s=[],l=this._root;for(l&&s.push(new gl(l,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(l=e.node,n=e.x0,i=e.y0,a=e.x1,o=e.y1)&&l.length){var u=(n+a)/2,h=(i+o)/2;(r=l[3])&&s.push(new gl(r,u,h,a,o)),(r=l[2])&&s.push(new gl(r,n,h,u,o)),(r=l[1])&&s.push(new gl(r,u,i,a,h)),(r=l[0])&&s.push(new gl(r,n,i,u,h))}return this},gp.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new gl(this._root,this._x0,this._y0,this._x1,this._y1));e=r.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,l=e.x1,u=e.y1,h=(o+l)/2,d=(s+u)/2;(a=i[0])&&r.push(new gl(a,o,s,h,d)),(a=i[1])&&r.push(new gl(a,h,s,l,d)),(a=i[2])&&r.push(new gl(a,o,d,h,u)),(a=i[3])&&r.push(new gl(a,h,d,l,u))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},gp.x=function(t){return arguments.length?(this._x=t,this):this._x},gp.y=function(t){return arguments.length?(this._y=t,this):this._y};var g_=gx.prototype=gE.prototype;function gS(t){let e=0,r=0,n=0,i=0,a=0,o=t.length;if(o){for(let s=0;s<o;s++){let o=t[s];o&&o.weight&&(e+=o.weight,r+=o.x*o.weight,n+=o.y*o.weight,i+=o.z*o.weight,a+=o.size*o.weight)}t.x=r/e,t.y=n/e,t.z=i/e,t.size=a/e,t.weight=e}else t.x=t.data.x,t.y=t.data.y,t.z=t.data.z,t.size=t.data.size,t.weight=t.data.weight}g_.copy=function(){var t,e,r=new gE(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root;if(!n)return r;if(!n.length)return r._root=gw(n),r;for(t=[{source:n,target:r._root=Array(8)}];n=t.pop();)for(var i=0;i<8;++i)(e=n.source[i])&&(e.length?t.push({source:e,target:n.target[i]=Array(8)}):n.target[i]=gw(e));return r},g_.add=function(t){let e=+this._x.call(null,t),r=+this._y.call(null,t),n=+this._z.call(null,t);return gg(this.cover(e,r,n),e,r,n,t)},g_.addAll=function(t){Array.isArray(t)||(t=Array.from(t));let e=t.length,r=new Float64Array(e),n=new Float64Array(e),i=new Float64Array(e),a=1/0,o=1/0,s=1/0,l=-1/0,u=-1/0,h=-1/0;for(let d=0,c,f,p,g;d<e;++d)!(isNaN(f=+this._x.call(null,c=t[d]))||isNaN(p=+this._y.call(null,c))||isNaN(g=+this._z.call(null,c)))&&(r[d]=f,n[d]=p,i[d]=g,f<a&&(a=f),f>l&&(l=f),p<o&&(o=p),p>u&&(u=p),g<s&&(s=g),g>h&&(h=g));if(a>l||o>u||s>h)return this;this.cover(a,o,s).cover(l,u,h);for(let a=0;a<e;++a)gg(this,r[a],n[a],i[a],t[a]);return this},g_.cover=function(t,e,r){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,i=this._y0,a=this._z0,o=this._x1,s=this._y1,l=this._z1;if(isNaN(n))o=(n=Math.floor(t))+1,s=(i=Math.floor(e))+1,l=(a=Math.floor(r))+1;else{for(var u,h,d=o-n||1,c=this._root;n>t||t>=o||i>e||e>=s||a>r||r>=l;)switch(h=(r<a)<<2|(e<i)<<1|t<n,(u=Array(8))[h]=c,c=u,d*=2,h){case 0:o=n+d,s=i+d,l=a+d;break;case 1:n=o-d,s=i+d,l=a+d;break;case 2:o=n+d,i=s-d,l=a+d;break;case 3:n=o-d,i=s-d,l=a+d;break;case 4:o=n+d,s=i+d,a=l-d;break;case 5:n=o-d,s=i+d,a=l-d;break;case 6:o=n+d,i=s-d,a=l-d;break;case 7:n=o-d,i=s-d,a=l-d}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=l,this},g_.data=function(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t},g_.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},g_.find=function(t,e,r,n){var i,a,o,s,l,u,h,d,c,f=this._x0,p=this._y0,g=this._z0,y=this._x1,v=this._y1,m=this._z1,b=[],x=this._root;for(x&&b.push(new gy(x,f,p,g,y,v,m)),null==n?n=1/0:(f=t-n,p=e-n,g=r-n,y=t+n,v=e+n,m=r+n,n*=n);d=b.pop();)if((x=d.node)&&!((a=d.x0)>y)&&!((o=d.y0)>v)&&!((s=d.z0)>m)&&!((l=d.x1)<f)&&!((u=d.y1)<p)&&!((h=d.z1)<g)){if(x.length){var E=(a+l)/2,w=(o+u)/2,_=(s+h)/2;b.push(new gy(x[7],E,w,_,l,u,h),new gy(x[6],a,w,_,E,u,h),new gy(x[5],E,o,_,l,w,h),new gy(x[4],a,o,_,E,w,h),new gy(x[3],E,w,s,l,u,_),new gy(x[2],a,w,s,E,u,_),new gy(x[1],E,o,s,l,w,_),new gy(x[0],a,o,s,E,w,_)),(c=(r>=_)<<2|(e>=w)<<1|t>=E)&&(d=b[b.length-1],b[b.length-1]=b[b.length-1-c],b[b.length-1-c]=d)}else{var S=t-+this._x.call(null,x.data),k=e-+this._y.call(null,x.data),N=r-+this._z.call(null,x.data),O=S*S+k*k+N*N;if(O<n){var T=Math.sqrt(n=O);f=t-T,p=e-T,g=r-T,y=t+T,v=e+T,m=r+T,i=x.data}}}return i},g_.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,r,n,i,a,o,s,l,u,h,d,c,f,p,g,y=this._root,v=this._x0,m=this._y0,b=this._z0,x=this._x1,E=this._y1,w=this._z1;if(!y)return this;if(y.length)for(;;){if((d=a>=(l=(v+x)/2))?v=l:x=l,(c=o>=(u=(m+E)/2))?m=u:E=u,(f=s>=(h=(b+w)/2))?b=h:w=h,e=y,!(y=y[p=f<<2|c<<1|d]))return this;if(!y.length)break;(e[p+1&7]||e[p+2&7]||e[p+3&7]||e[p+4&7]||e[p+5&7]||e[p+6&7]||e[p+7&7])&&(r=e,g=p)}for(;y.data!==t;)if(n=y,!(y=y.next))return this;return((i=y.next)&&delete y.next,n)?i?n.next=i:delete n.next:e?(i?e[p]=i:delete e[p],(y=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&y===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!y.length&&(r?r[g]=y:this._root=y)):this._root=i,this},g_.removeAll=function(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this},g_.root=function(){return this._root},g_.size=function(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t},g_.visit=function(t){var e,r,n,i,a,o,s,l,u=[],h=this._root;for(h&&u.push(new gy(h,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=u.pop();)if(!t(h=e.node,n=e.x0,i=e.y0,a=e.z0,o=e.x1,s=e.y1,l=e.z1)&&h.length){var d=(n+o)/2,c=(i+s)/2,f=(a+l)/2;(r=h[7])&&u.push(new gy(r,d,c,f,o,s,l)),(r=h[6])&&u.push(new gy(r,n,c,f,d,s,l)),(r=h[5])&&u.push(new gy(r,d,i,f,o,c,l)),(r=h[4])&&u.push(new gy(r,n,i,f,d,c,l)),(r=h[3])&&u.push(new gy(r,d,c,a,o,s,f)),(r=h[2])&&u.push(new gy(r,n,c,a,d,s,f)),(r=h[1])&&u.push(new gy(r,d,i,a,o,c,f)),(r=h[0])&&u.push(new gy(r,n,i,a,d,c,f))}return this},g_.visitAfter=function(t){var e,r=[],n=[];for(this._root&&r.push(new gy(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=r.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,l=e.z0,u=e.x1,h=e.y1,d=e.z1,c=(o+u)/2,f=(s+h)/2,p=(l+d)/2;(a=i[0])&&r.push(new gy(a,o,s,l,c,f,p)),(a=i[1])&&r.push(new gy(a,c,s,l,u,f,p)),(a=i[2])&&r.push(new gy(a,o,f,l,c,h,p)),(a=i[3])&&r.push(new gy(a,c,f,l,u,h,p)),(a=i[4])&&r.push(new gy(a,o,s,p,c,f,d)),(a=i[5])&&r.push(new gy(a,c,s,p,u,f,d)),(a=i[6])&&r.push(new gy(a,o,f,p,c,h,d)),(a=i[7])&&r.push(new gy(a,c,f,p,u,h,d))}n.push(e)}for(;e=n.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},g_.x=function(t){return arguments.length?(this._x=t,this):this._x},g_.y=function(t){return arguments.length?(this._y=t,this):this._y},g_.z=function(t){return arguments.length?(this._z=t,this):this._z};const gk=(t,e,r,n,i,a,o)=>{var s;if((null===(s=t.data)||void 0===s?void 0:s.id)===a.id)return;let l=[r,n,i][o-1],u=a.x-t.x||.1,h=a.y-t.y||.1,d=a.z-t.z||.1,c=[u,h,d],f=l-e,p=0;for(let t=0;t<o;t++)p+=c[t]*c[t];let g=Math.sqrt(p)*p;if(f*f*.81<p){let e=t.weight/g;return a.vx+=u*e,a.vy+=h*e,a.vz+=d*e,!0}if(t.length)return!1;if(t.data!==a){let e=t.data.weight/g;a.vx+=u*e,a.vy+=h*e,a.vz+=d*e}},gN={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class gO{constructor(t={}){this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},gN),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericForceLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericForceLayout(!0,t,e)})}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let e=0;(this.judgingDistance>this.lastOptions.minMovement||e<1)&&e<t;e++)this.runOneStep(this.lastCalcGraph,this.lastGraph,e,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);let e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach(t=>this.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===this.options.dimensions?t.data.z:void 0})),e}genericForceLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.options),r),i=e.getAllNodes(),a=e.getAllEdges(),o=this.formatOptions(n,e),{dimensions:s,width:l,height:u,nodeSize:h,getMass:d,nodeStrength:c,edgeStrength:f,linkDistance:p}=o,g=i.map((t,e)=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{x:(0,ol.default)(t.data.x)?t.data.x:Math.random()*l,y:(0,ol.default)(t.data.y)?t.data.y:Math.random()*u,z:(0,ol.default)(t.data.z)?t.data.z:Math.random()*Math.sqrt(l*u),size:h(t)||30,mass:d(t),nodeStrength:c(t)})})),y=a.map(t=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{edgeStrength:f(t),linkDistance:p(t,e.getNode(t.source),e.getNode(t.target))})}));if(!(null==i?void 0:i.length))return this.lastResult={nodes:[],edges:a},{nodes:[],edges:a};let v={};i.forEach((t,e)=>{v[t.id]={x:0,y:0,z:0}});let m=new cI({nodes:g,edges:y});this.formatCentripetal(o,m);let{maxIteration:b,minMovement:x,onTick:E}=o;if(this.lastLayoutNodes=g,this.lastLayoutEdges=y,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=m,this.lastOptions=o,this.lastVelMap=v,"undefined"==typeof window)return;let w=0;return new Promise(r=>{this.timeInterval=window.setInterval(()=>{i&&this.running||r({nodes:gR(e,g),edges:a}),this.runOneStep(m,e,w,v,o),this.updatePosition(e,m,v,o),t&&g.forEach(t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===s?t.data.z:void 0})),null==E||E({nodes:gR(e,g),edges:a}),(++w>=b||this.judgingDistance<x)&&(window.clearInterval(this.timeInterval),r({nodes:gR(e,g),edges:a}))},0),this.running=!0})})}formatOptions(t,e){let r=Object.assign({},t),{width:n,height:i,getMass:a}=t;r.width=n||"undefined"==typeof window?n:window.innerWidth,r.height=i||"undefined"==typeof window?i:window.innerHeight,t.center||(r.center=[r.width/2,r.height/2]),a||(r.getMass=t=>{let r=1;(0,ol.default)(null==t?void 0:t.data.mass)&&(r=null==t?void 0:t.data.mass);let n=e.getDegree(t.id,"both");return!n||n<5?r:5*n*r}),r.nodeSize=p8(t.nodeSize,t.nodeSpacing);let o=t.linkDistance?p5(1,t.linkDistance):t=>1+r.nodeSize(e.getNode(t.source))+r.nodeSize(e.getNode(t.target));return r.linkDistance=o,r.nodeStrength=p5(1,t.nodeStrength),r.edgeStrength=p5(1,t.edgeStrength),r}formatCentripetal(t,e){let r,n;let{dimensions:i,centripetalOptions:a,center:o,clusterNodeStrength:s,leafCluster:l,clustering:u,nodeClusterBy:h}=t,d=e.getAllNodes(),c=a||{leaf:2,single:2,others:1,center:t=>({x:o[0],y:o[1],z:3===i?o[2]:void 0})};if("function"!=typeof s&&(t.clusterNodeStrength=t=>s),l&&h&&(r=gT(e,h),n=Array.from(new Set(null==d?void 0:d.map(t=>t.data[h])))||[],t.centripetalOptions=Object.assign(c,{single:100,leaf:e=>{let{siblingLeaves:i,sameTypeLeaves:a}=r[e.id]||{};return(null==a?void 0:a.length)===(null==i?void 0:i.length)||(null==n?void 0:n.length)===1?1:t.clusterNodeStrength(e)},others:1,center:t=>{let n;let i=e.getDegree(t.id,"both");if(!i)return{x:100,y:100,z:0};if(1===i){let{sameTypeLeaves:e=[]}=r[t.id]||{};1===e.length?n=void 0:e.length>1&&(n=gC(e))}else n=void 0;return{x:null==n?void 0:n.x,y:null==n?void 0:n.y,z:null==n?void 0:n.z}}})),u&&h){r||(r=gT(e,h)),n||(n=Array.from(new Set(d.map(t=>t.data[h]))));let i={};(n=n.filter(t=>void 0!==t)).forEach(t=>{let r=d.filter(e=>e.data[h]===t).map(t=>e.getNode(t.id));i[t]=gC(r)}),t.centripetalOptions=Object.assign(c,{single:e=>t.clusterNodeStrength(e),leaf:e=>t.clusterNodeStrength(e),others:e=>t.clusterNodeStrength(e),center:t=>{let e=i[t.data[h]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y,z:null==e?void 0:e.z}}})}let{leaf:f,single:p,others:g}=t.centripetalOptions||{};f&&"function"!=typeof f&&(t.centripetalOptions.leaf=()=>f),p&&"function"!=typeof p&&(t.centripetalOptions.single=()=>p),g&&"function"!=typeof g&&(t.centripetalOptions.others=()=>g)}runOneStep(t,e,r,n,i){let a={},o=t.getAllNodes(),s=t.getAllEdges();if(!(null==o?void 0:o.length))return;let{monitor:l}=i;this.calRepulsive(t,a,i),s&&this.calAttractive(t,a,i),this.calGravity(t,e,a,i),this.updateVelocity(t,a,n,i),l&&l({energy:this.calTotalEnergy(a,o),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:r})}calTotalEnergy(t,e){if(!(null==e?void 0:e.length))return 0;let r=0;return e.forEach((e,n)=>{let i=t[e.id].x,a=t[e.id].y,o=3===this.options.dimensions?t[e.id].z:0,{mass:s=1}=e.data;r+=s*(i*i+a*a+o*o)*.5}),r}calRepulsive(t,e,r){let{dimensions:n,factor:i,coulombDisScale:a}=r;!function(t,e,r,n,i=2){let a=e/r,o=t.getAllNodes(),s=o.map((t,e)=>{let{nodeStrength:r,x:n,y:i,z:o,size:s}=t.data;return{x:n,y:i,z:o,size:s,index:e,id:t.id,vx:0,vy:0,vz:0,weight:a*r}}),l=(2===i?gd(s,t=>t.x,t=>t.y):gx(s,t=>t.x,t=>t.y,t=>t.z)).visitAfter(gS),u=new Map;s.forEach(t=>{u.set(t.id,t),function(t,e,r){e.visit((e,n,i,a,o)=>gk(e,n,i,a,o,t,r))}(t,l,i)}),s.map((t,e)=>{let{id:r,data:i}=o[e],{mass:a=1}=i;n[r]={x:t.vx/a,y:t.vy/a,z:t.vz/a}})}(t,i,a*a,e,n)}calAttractive(t,e,r){let{dimensions:n,nodeSize:i}=r;t.getAllEdges().forEach((r,a)=>{let{source:o,target:s}=r,l=t.getNode(o),u=t.getNode(s);if(!l||!u)return;let h=u.data.x-l.data.x,d=u.data.y-l.data.y,c=3===n?u.data.z-l.data.z:0;h||d||(h=.01*Math.random(),d=.01*Math.random(),3!==n||c||(c=.01*Math.random()));let f=Math.sqrt(h*h+d*d+c*c);if(f<i(l)+i(u))return;let p=h/f,g=d/f,y=c/f,{linkDistance:v=200,edgeStrength:m=200}=r.data||{},b=(v-f)*m,x=l.data.mass||1,E=u.data.mass||1,w=1/x,_=1/E,S=p*b,k=g*b,N=y*b;e[o].x-=S*w,e[o].y-=k*w,e[o].z-=N*w,e[s].x+=S*_,e[s].y+=k*_,e[s].z+=N*_})}calGravity(t,e,r,n){let{getCenter:i}=n,a=t.getAllNodes(),o=e.getAllNodes(),s=e.getAllEdges(),{width:l,height:u,center:h,gravity:d,centripetalOptions:c}=n;a&&a.forEach(n=>{let{id:a,data:f}=n,{mass:p,x:g,y:y,z:v}=f,m=e.getNode(a),b=0,x=0,E=0,w=d,_=t.getDegree(a,"in"),S=t.getDegree(a,"out"),k=t.getDegree(a,"both"),N=null==i?void 0:i(m,k);if(N){let[t,e,r]=N;b=g-t,x=y-e,w=r}else b=g-h[0],x=y-h[1],E=v-h[2];if(w&&(r[a].x-=w*b/p,r[a].y-=w*x/p,r[a].z-=w*E/p),c){let{leaf:t,single:e,others:n,center:i}=c,{x:h,y:d,z:f,centerStrength:b}=(null==i?void 0:i(m,o,s,l,u))||{x:0,y:0,z:0,centerStrength:0};if(!(0,ol.default)(h)||!(0,ol.default)(d))return;let x=(g-h)/p,E=(y-d)/p,w=(v-f)/p;if(b&&(r[a].x-=b*x,r[a].y-=b*E,r[a].z-=b*w),0===k){let t=e(m);if(!t)return;r[a].x-=t*x,r[a].y-=t*E,r[a].z-=t*w;return}if(0===_||0===S){let e=t(m,o,s);if(!e)return;r[a].x-=e*x,r[a].y-=e*E,r[a].z-=e*w;return}let N=n(m);if(!N)return;r[a].x-=N*x,r[a].y-=N*E,r[a].z-=N*w}})}updateVelocity(t,e,r,n){let{damping:i,maxSpeed:a,interval:o,dimensions:s}=n,l=t.getAllNodes();(null==l?void 0:l.length)&&l.forEach(t=>{let{id:n}=t,l=(r[n].x+e[n].x*o)*i||.01,u=(r[n].y+e[n].y*o)*i||.01,h=3===s?(r[n].z+e[n].z*o)*i||.01:0,d=Math.sqrt(l*l+u*u+h*h);if(d>a){let t=a/d;l*=t,u*=t,h*=t}r[n]={x:l,y:u,z:h}})}updatePosition(t,e,r,n){let{distanceThresholdMode:i,interval:a,dimensions:o}=n,s=e.getAllNodes();if(!(null==s?void 0:s.length)){this.judgingDistance=0;return}let l=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach(n=>{let{id:s}=n,u=t.getNode(s);if((0,ol.default)(u.data.fx)&&(0,ol.default)(u.data.fy)){e.mergeNodeData(s,{x:u.data.fx,y:u.data.fy,z:3===o?u.data.fz:void 0});return}let h=r[s].x*a,d=r[s].y*a,c=3===o?r[s].z*a:0;e.mergeNodeData(s,{x:n.data.x+h,y:n.data.y+d,z:n.data.z+c});let f=Math.sqrt(h*h+d*d+c*c);switch(i){case"max":this.judgingDistance<f&&(this.judgingDistance=f);break;case"min":this.judgingDistance>f&&(this.judgingDistance=f);break;default:l+=f}}),i&&"mean"!==i||(this.judgingDistance=l/s.length)}}const gT=(t,e)=>{let r=t.getAllNodes();if(!(null==r?void 0:r.length))return{};let n={};return r.forEach((r,i)=>{1===t.getDegree(r.id,"both")&&(n[r.id]=gM(t,"leaf",r,e))}),n},gM=(t,e,r,n)=>{let i=t.getDegree(r.id,"in"),a=t.getDegree(r.id,"out"),o=r,s=[];0===i?(o=t.getSuccessors(r.id)[0],s=t.getNeighbors(o.id)):0===a&&(o=t.getPredecessors(r.id)[0],s=t.getNeighbors(o.id)),s=s.filter(e=>0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out"));let l=gA(t,e,n,r,s);return{coreNode:o,siblingLeaves:s,sameTypeLeaves:l}},gA=(t,e,r,n,i)=>{let a=n.data[r]||"",o=(null==i?void 0:i.filter(t=>t.data[r]===a))||[];return"leaf"===e&&(o=o.filter(e=>0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out"))),o},gC=t=>{let e={x:0,y:0};t.forEach(t=>{let{x:r,y:n}=t.data;e.x+=r||0,e.y+=n||0});let r=t.length||1;return{x:e.x/r,y:e.y/r}},gR=(t,e)=>e.map(e=>{let{id:r,data:n}=e,i=t.getNode(r);return Object.assign(Object.assign({},i),{data:Object.assign(Object.assign({},i.data),{x:n.x,y:n.y,z:n.z})})});var s6=y("7WQrb");const gI=Object.prototype.toString;function gP(t){let e=gI.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function gD(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(gP(t)){if(0===t.length)throw TypeError("input must not be empty")}else throw TypeError("input must be an array");if(void 0!==r.output){if(!gP(r.output))throw TypeError("output option must be an array if specified");e=r.output}else e=Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!gP(t))throw TypeError("input must be an array");if(0===t.length)throw TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,a=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>t.length||!Number.isInteger(a))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[n],s=n+1;s<a;s++)t[s]<o&&(o=t[s]);return o}(t),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!gP(t))throw TypeError("input must be an array");if(0===t.length)throw TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,a=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>t.length||!Number.isInteger(a))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[n],s=n+1;s<a;s++)t[s]>o&&(o=t[s]);return o}(t);if(n===i)throw RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=r.min,o=void 0===a?r.autoMinMax?n:0:a,s=r.max,l=void 0===s?r.autoMinMax?i:1:s;if(o>=l)throw RangeError("min option must be smaller than max option");for(var u=(l-o)/(i-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*u+o;return e}const gL=" ".repeat(2),gj=" ".repeat(4);function gF(t,e={}){let{maxRows:r=15,maxColumns:n=10,maxNumSize:i=8,padMinus:a="auto"}=e;return`${t.constructor.name} {
${gL}[
${gj}${function(t,e,r,n,i){let{rows:a,columns:o}=t,s=Math.min(a,e),l=Math.min(o,r),u=[];if("auto"===i){i=!1;t:for(let e=0;e<s;e++)for(let r=0;r<l;r++)if(0>t.get(e,r)){i=!0;break t}}for(let e=0;e<s;e++){let r=[];for(let a=0;a<l;a++){var h,d;r.push((h=t.get(e,a),d=i,(h>=0&&d?` ${gB(h,n-1)}`:gB(h,n)).padEnd(n)))}u.push(`${r.join(" ")}`)}return l!==o&&(u[u.length-1]+=` ... ${o-r} more columns`),s!==a&&u.push(`... ${a-e} more rows`),u.join(`
${gj}`)}(t,r,n,i,a)}
${gL}]
${gL}rows: ${t.rows}
${gL}columns: ${t.columns}
}`}function gB(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function gz(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw RangeError("Row index out of range")}function gV(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw RangeError("Column index out of range")}function gG(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw RangeError("vector size must be the same as the number of columns");return e}function g$(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw RangeError("vector size must be the same as the number of rows");return e}function gU(t,e,r,n,i){if(5!=arguments.length)throw RangeError("expected 4 arguments");if(gW("startRow",e),gW("endRow",r),gW("startColumn",n),gW("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw RangeError("Submatrix indices are out of range")}function gH(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function gW(t,e){if("number"!=typeof e)throw TypeError(`${t} must be a number`)}function gq(t){if(t.isEmpty())throw Error("Empty matrix has no elements to index")}class gY{static from1DArray(t,e,r){if(t*e!==r.length)throw RangeError("data length does not match given dimensions");let n=new gX(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)n.set(i,t,r[i*e+t]);return n}static rowVector(t){let e=new gX(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new gX(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new gX(t,e)}static ones(t,e){return new gX(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw TypeError("options must be an object");let{random:n=Math.random}=r,i=new gX(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,n());return i}static randInt(t,e,r={}){if("object"!=typeof r)throw TypeError("options must be an object");let{min:n=0,max:i=1e3,random:a=Math.random}=r;if(!Number.isInteger(n))throw TypeError("min must be an integer");if(!Number.isInteger(i))throw TypeError("max must be an integer");if(n>=i)throw RangeError("min must be smaller than max");let o=i-n,s=new gX(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(a()*o);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<n;t++)i.set(t,t,r);return i}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let i=Math.min(n,e,r),a=this.zeros(e,r);for(let e=0;e<i;e++)a.set(e,e,t[e]);return a}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new gX(r,n);for(let a=0;a<r;a++)for(let r=0;r<n;r++)i.set(a,r,Math.min(t.get(a,r),e.get(a,r)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new this(r,n);for(let a=0;a<r;a++)for(let r=0;r<n;r++)i.set(a,r,Math.max(t.get(a,r),e.get(a,r)));return i}static checkMatrix(t){return gY.isMatrix(t)?t:new gX(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let i=e;i<t.rows;i++)t.get(i,r)>t.get(n,r)&&(n=i);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let i=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/i);for(let n=e+1;n<t.rows;n++){let i=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let a=r+1;a<t.columns;a++)t.set(n,a,t.get(n,a)-t.get(e,a)*i)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let i=0,a=!1;for(;i<r&&!1===a;)1===t.get(n,i)?a=!0:i++;for(let r=0;r<n;r++){let a=t.get(r,i);for(let o=i;o<e;o++){let e=t.get(r,o)-a*t.get(n,o);t.set(r,o,e)}}n--}return t}set(){throw Error("set method is unimplemented")}get(){throw Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw TypeError("columns must be a positive integer");let n=new gX(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){gz(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return gX.rowVector(this.getRow(t))}setRow(t,e){gz(this,t),e=gG(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){gz(this,t),gz(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){gV(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return gX.columnVector(this.getColumn(t))}setColumn(t,e){gV(this,t),e=g$(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){gV(this,t),gV(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=gG(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=gG(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=gG(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=gG(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=g$(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=g$(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=g$(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=g$(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){gz(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){gV(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{let t=Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{let t=Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw Error(`invalid option: ${t}`)}}maxIndex(){gq(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{let t=Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{let t=Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw Error(`invalid option: ${t}`)}}minIndex(){gq(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(gz(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){gz(this,t),gq(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(gz(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){gz(this,t),gq(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(gV(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){gV(this,t),gq(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(gV(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){gV(this,t),gq(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){gY.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=gX.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,i=new gX(e,n),a=new Float64Array(r);for(let o=0;o<n;o++){for(let e=0;e<r;e++)a[e]=t.get(e,o);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*a[n];i.set(t,o,e)}}return i}mpow(t){if(!this.isSquare())throw RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw RangeError("Exponent must be a non-negative integer");let e=gX.eye(this.rows),r=this;for(let n=t;n>1;n/=2)(1&n)!=0&&(e=e.mmul(r)),r=r.mmul(r);return e}strassen2x2(t){t=gX.checkMatrix(t);let e=new gX(2,2),r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),a=t.get(0,1),o=this.get(1,0),s=t.get(1,0),l=this.get(1,1),u=t.get(1,1),h=(r+l)*(n+u),d=(o+l)*n,c=r*(a-u),f=l*(s-n),p=(r+i)*u;return e.set(0,0,h+f-p+(i-l)*(s+u)),e.set(0,1,c+p),e.set(1,0,d+f),e.set(1,1,h-d+c+(o-r)*(n+a)),e}strassen3x3(t){t=gX.checkMatrix(t);let e=new gX(3,3),r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),a=this.get(1,0),o=this.get(1,1),s=this.get(1,2),l=this.get(2,0),u=this.get(2,1),h=this.get(2,2),d=t.get(0,0),c=t.get(0,1),f=t.get(0,2),p=t.get(1,0),g=t.get(1,1),y=t.get(1,2),v=t.get(2,0),m=t.get(2,1),b=t.get(2,2),x=(r-a)*(-c+g),E=(-r+a+o)*(d-c+g),w=(a+o)*(-d+c),_=r*d,S=(-r+l+u)*(d-f+y),k=(-r+l)*(f-y),N=(l+u)*(-d+f),O=(-i+u+h)*(g+v-m),T=(i-h)*(g-m),M=i*v,A=(u+h)*(-v+m),C=(-i+o+s)*(y+v-b),R=(i-s)*(y-b),I=(o+s)*(-v+b);return e.set(0,0,_+M+n*p),e.set(0,1,(r+n+i-a-o-u-h)*g+E+w+_+O+M+A),e.set(0,2,_+S+N+(r+n+i-o-s-l-u)*y+M+C+I),e.set(1,0,x+o*(-d+c+p-g-y-v+b)+E+_+M+C+R),e.set(1,1,x+E+w+_+s*m),e.set(1,2,M+C+R+I+a*f),e.set(2,0,_+S+k+u*(-d+f+p-g-y-v+m)+O+T+M),e.set(2,1,O+T+M+A+l*c),e.set(2,2,_+S+k+N+h*b),e}mmulStrassen(t){t=gX.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,i=t.rows,a=t.columns;function o(t,e,r){let n=t.rows,i=t.columns;return n===e&&i===r?t:gY.zeros(e,r).setSubMatrix(t,0,0)}n!==i&&console.warn(`Multiplying ${r} x ${n} and ${i} x ${a} matrix: dimensions do not match.`);let s=Math.max(r,i),l=Math.max(n,a);return function t(e,r,n,i){if(n<=512||i<=512)return e.mmul(r);n%2==1&&i%2==1?(e=o(e,n+1,i+1),r=o(r,n+1,i+1)):n%2==1?(e=o(e,n+1,i),r=o(r,n+1,i)):i%2==1&&(e=o(e,n,i+1),r=o(r,n,i+1));let a=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),l=e.subMatrix(0,a-1,0,s-1),u=r.subMatrix(0,a-1,0,s-1),h=e.subMatrix(0,a-1,s,e.columns-1),d=r.subMatrix(0,a-1,s,r.columns-1),c=e.subMatrix(a,e.rows-1,0,s-1),f=r.subMatrix(a,r.rows-1,0,s-1),p=e.subMatrix(a,e.rows-1,s,e.columns-1),g=r.subMatrix(a,r.rows-1,s,r.columns-1),y=t(gY.add(l,p),gY.add(u,g),a,s),v=t(gY.add(c,p),u,a,s),m=t(l,gY.sub(d,g),a,s),b=t(p,gY.sub(f,u),a,s),x=t(gY.add(l,h),g,a,s),E=t(gY.sub(c,l),gY.add(u,d),a,s),w=t(gY.sub(h,p),gY.add(f,g),a,s),_=gY.add(y,b);_.sub(x),_.add(w);let S=gY.add(m,x),k=gY.add(v,b),N=gY.sub(y,v);N.add(m),N.add(E);let O=gY.zeros(2*_.rows,2*_.columns);return(O=(O=(O=(O=O.setSubMatrix(_,0,0)).setSubMatrix(S,_.rows,0)).setSubMatrix(k,0,_.columns)).setSubMatrix(N,_.rows,_.columns)).subMatrix(0,n-1,0,i-1)}(e=o(e,s,l),t=o(t,s,l),s,l)}scaleRows(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw TypeError("min must be a number");if(!Number.isFinite(r))throw TypeError("max must be a number");if(e>=r)throw RangeError("min must be smaller than max");let n=new gX(this.rows,this.columns);for(let t=0;t<this.rows;t++){let i=this.getRow(t);i.length>0&&gD(i,{min:e,max:r,output:i}),n.setRow(t,i)}return n}scaleColumns(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw TypeError("min must be a number");if(!Number.isFinite(r))throw TypeError("max must be a number");if(e>=r)throw RangeError("min must be smaller than max");let n=new gX(this.rows,this.columns);for(let t=0;t<this.columns;t++){let i=this.getColumn(t);i.length&&gD(i,{min:e,max:r,output:i}),n.setColumn(t,i)}return n}flipRows(){let t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){let t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=gX.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,i=t.columns,a=new gX(e*n,r*i);for(let o=0;o<e;o++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<i;s++)a.set(n*o+r,i*e+s,this.get(o,e)*t.get(r,s));return a}kroneckerSum(t){if(t=gX.checkMatrix(t),!this.isSquare()||!t.isSquare())throw Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(gX.eye(r,r)),i=gX.eye(e,e).kroneckerProduct(t);return n.add(i)}transpose(){let t=new gX(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=gK){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=gK){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){gU(this,t,e,r,n);let i=new gX(e-t+1,n-r+1);for(let a=t;a<=e;a++)for(let e=r;e<=n;e++)i.set(a-t,e-r,this.get(a,e));return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw RangeError("Argument out of range");let n=new gX(t.length,r-e+1);for(let i=0;i<t.length;i++)for(let a=e;a<=r;a++){if(t[i]<0||t[i]>=this.rows)throw RangeError(`Row index out of range: ${t[i]}`);n.set(i,a-e,this.get(t[i],a))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw RangeError("Argument out of range");let n=new gX(r-e+1,t.length);for(let i=0;i<t.length;i++)for(let a=e;a<=r;a++){if(t[i]<0||t[i]>=this.columns)throw RangeError(`Column index out of range: ${t[i]}`);n.set(a-e,i,this.get(a,t[i]))}return n}setSubMatrix(t,e,r){if((t=gX.checkMatrix(t)).isEmpty())return this;let n=e+t.rows-1,i=r+t.columns-1;gU(this,e,n,r,i);for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)this.set(e+n,r+i,t.get(n,i));return this}selection(t,e){!function(t,e){if(!gP(e))throw TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw RangeError("row indices are out of range")}(this,t),function(t,e){if(!gP(e))throw TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw RangeError("column indices are out of range")}(this,e);let r=new gX(t.length,e.length);for(let n=0;n<t.length;n++){let i=t[n];for(let t=0;t<e.length;t++){let a=e[t];r.set(n,t,this.get(i,a))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new gX(this.rows,this.columns))}static copy(t,e){for(let[r,n,i]of t.entries())e.set(r,n,i);return e}sum(t){switch(t){case"row":return function(t){let e=gH(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=gH(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=gH(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=gH(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw Error(`invalid option: ${t}`)}}mean(t){let e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw TypeError("unbiased must be a boolean");switch(t){case"row":if(!gP(n))throw TypeError("mean must be an array");return function(t,e,r){let n=t.rows,i=t.columns,a=[];for(let o=0;o<n;o++){let n=0,s=0,l=0;for(let e=0;e<i;e++)n+=l=t.get(o,e)-r[o],s+=l*l;e?a.push((s-n*n/i)/(i-1)):a.push((s-n*n/i)/i)}return a}(this,r,n);case"column":if(!gP(n))throw TypeError("mean must be an array");return function(t,e,r){let n=t.rows,i=t.columns,a=[];for(let o=0;o<i;o++){let i=0,s=0,l=0;for(let e=0;e<n;e++)i+=l=t.get(e,o)-r[o],s+=l*l;e?a.push((s-i*i/n)/(n-1)):a.push((s-i*i/n)/n)}return a}(this,r,n);case void 0:if("number"!=typeof n)throw TypeError("mean must be a number");return function(t,e,r){let n=t.rows,i=t.columns,a=n*i,o=0,s=0,l=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++)o+=l=t.get(e,n)-r,s+=l*l;return e?(s-o*o/a)/(a-1):(s-o*o/a)/a}(this,r,n);default:throw Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);let r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let{center:r=this.mean(t)}=e;switch(t){case"row":if(!gP(r))throw TypeError("center must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!gP(r))throw TypeError("center must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw TypeError("center must be a number");return!function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){let e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=t.get(r,e)**2/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!gP(r))throw TypeError("scale must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){let e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=t.get(e,r)**2/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!gP(r))throw TypeError("scale must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){let e=t.size-1,r=0;for(let n=0;n<t.columns;n++)for(let i=0;i<t.rows;i++)r+=t.get(i,n)**2/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw TypeError("scale must be a number");return!function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw Error(`invalid option: ${t}`)}}toString(t){return gF(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function gK(t,e){return t-e}gY.prototype.klass="Matrix","undefined"!=typeof Symbol&&(gY.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return gF(this)}),gY.random=gY.rand,gY.randomInt=gY.randInt,gY.diagonal=gY.diag,gY.prototype.diagonal=gY.prototype.diag,gY.identity=gY.eye,gY.prototype.negate=gY.prototype.neg,gY.prototype.tensorProduct=gY.prototype.kroneckerProduct;class gX extends gY{data;#t(t,e){if(this.data=[],Number.isInteger(e)&&e>=0)for(let r=0;r<t;r++)this.data.push(new Float64Array(e));else throw TypeError("nColumns must be a positive integer");this.rows=t,this.columns=e}constructor(t,e){if(super(),gX.isMatrix(t))this.#t(t.rows,t.columns),gX.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else if(gP(t)){let r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw RangeError("Inconsistent array dimensions");if(!r[n].every(t=>"number"==typeof t))throw TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}this.rows=t,this.columns=e}else throw TypeError("First argument must be a positive number or an array")}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return gz(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),gz(this,t,!0),e=Float64Array.from(gG(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){gV(this,t);for(let e=0;e<this.rows;e++){let r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),gV(this,t,!0),e=g$(this,e);for(let r=0;r<this.rows;r++){let n=new Float64Array(this.columns+1),i=0;for(;i<t;i++)n[i]=this.data[r][i];for(n[i++]=e[r];i<this.columns+1;i++)n[i]=this.data[r][i-1];this.data[r]=n}return this.columns+=1,this}}gY.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},gY.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},gY.prototype.addM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},gY.add=function(t,e){return new gX(t).add(e)},gY.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},gY.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},gY.prototype.subM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},gY.sub=function(t,e){return new gX(t).sub(e)},gY.prototype.subtract=gY.prototype.sub,gY.prototype.subtractS=gY.prototype.subS,gY.prototype.subtractM=gY.prototype.subM,gY.subtract=gY.sub,gY.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},gY.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},gY.prototype.mulM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},gY.mul=function(t,e){return new gX(t).mul(e)},gY.prototype.multiply=gY.prototype.mul,gY.prototype.multiplyS=gY.prototype.mulS,gY.prototype.multiplyM=gY.prototype.mulM,gY.multiply=gY.mul,gY.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},gY.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},gY.prototype.divM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},gY.div=function(t,e){return new gX(t).div(e)},gY.prototype.divide=gY.prototype.div,gY.prototype.divideS=gY.prototype.divS,gY.prototype.divideM=gY.prototype.divM,gY.divide=gY.div,gY.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},gY.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},gY.prototype.modM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},gY.mod=function(t,e){return new gX(t).mod(e)},gY.prototype.modulus=gY.prototype.mod,gY.prototype.modulusS=gY.prototype.modS,gY.prototype.modulusM=gY.prototype.modM,gY.modulus=gY.mod,gY.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},gY.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},gY.prototype.andM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},gY.and=function(t,e){return new gX(t).and(e)},gY.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},gY.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},gY.prototype.orM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},gY.or=function(t,e){return new gX(t).or(e)},gY.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},gY.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},gY.prototype.xorM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},gY.xor=function(t,e){return new gX(t).xor(e)},gY.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},gY.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},gY.prototype.leftShiftM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},gY.leftShift=function(t,e){return new gX(t).leftShift(e)},gY.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},gY.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},gY.prototype.signPropagatingRightShiftM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},gY.signPropagatingRightShift=function(t,e){return new gX(t).signPropagatingRightShift(e)},gY.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},gY.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},gY.prototype.rightShiftM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},gY.rightShift=function(t,e){return new gX(t).rightShift(e)},gY.prototype.zeroFillRightShift=gY.prototype.rightShift,gY.prototype.zeroFillRightShiftS=gY.prototype.rightShiftS,gY.prototype.zeroFillRightShiftM=gY.prototype.rightShiftM,gY.zeroFillRightShift=gY.rightShift,gY.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},gY.not=function(t){return new gX(t).not()},gY.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},gY.abs=function(t){return new gX(t).abs()},gY.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},gY.acos=function(t){return new gX(t).acos()},gY.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},gY.acosh=function(t){return new gX(t).acosh()},gY.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},gY.asin=function(t){return new gX(t).asin()},gY.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},gY.asinh=function(t){return new gX(t).asinh()},gY.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},gY.atan=function(t){return new gX(t).atan()},gY.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},gY.atanh=function(t){return new gX(t).atanh()},gY.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},gY.cbrt=function(t){return new gX(t).cbrt()},gY.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},gY.ceil=function(t){return new gX(t).ceil()},gY.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},gY.clz32=function(t){return new gX(t).clz32()},gY.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},gY.cos=function(t){return new gX(t).cos()},gY.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},gY.cosh=function(t){return new gX(t).cosh()},gY.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},gY.exp=function(t){return new gX(t).exp()},gY.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},gY.expm1=function(t){return new gX(t).expm1()},gY.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},gY.floor=function(t){return new gX(t).floor()},gY.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},gY.fround=function(t){return new gX(t).fround()},gY.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},gY.log=function(t){return new gX(t).log()},gY.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},gY.log1p=function(t){return new gX(t).log1p()},gY.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},gY.log10=function(t){return new gX(t).log10()},gY.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},gY.log2=function(t){return new gX(t).log2()},gY.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},gY.round=function(t){return new gX(t).round()},gY.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},gY.sign=function(t){return new gX(t).sign()},gY.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},gY.sin=function(t){return new gX(t).sin()},gY.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},gY.sinh=function(t){return new gX(t).sinh()},gY.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},gY.sqrt=function(t){return new gX(t).sqrt()},gY.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},gY.tan=function(t){return new gX(t).tan()},gY.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},gY.tanh=function(t){return new gX(t).tanh()},gY.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},gY.trunc=function(t){return new gX(t).trunc()},gY.pow=function(t,e){return new gX(t).pow(e)},gY.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},gY.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t);return this},gY.prototype.powM=function(t){if(t=gX.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t.get(e,r));return this};class gJ extends gY{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function gZ(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class gQ{constructor(t,e={}){let r;if((t=gJ.checkMatrix(t)).isEmpty())throw Error("Matrix must be non-empty");let n=t.rows,i=t.columns,{computeLeftSingularVectors:a=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=e,l=!!a,u=!!o,h=!1;if(n<i){if(s){n=(r=t.transpose()).rows,i=r.columns,h=!0;let e=l;l=u,u=e}else r=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose")}else r=t.clone();let d=Math.min(n,i),c=Math.min(n+1,i),f=new Float64Array(c),p=new gX(n,d),g=new gX(i,i),y=new Float64Array(i),v=new Float64Array(n),m=new Float64Array(c);for(let t=0;t<c;t++)m[t]=t;let b=Math.min(n-1,i),x=Math.max(0,Math.min(i-2,n)),E=Math.max(b,x);for(let t=0;t<E;t++){if(t<b){f[t]=0;for(let e=t;e<n;e++)f[t]=gZ(f[t],r.get(e,t));if(0!==f[t]){0>r.get(t,t)&&(f[t]=-f[t]);for(let e=t;e<n;e++)r.set(e,t,r.get(e,t)/f[t]);r.set(t,t,r.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<i;e++){if(t<b&&0!==f[t]){let i=0;for(let a=t;a<n;a++)i+=r.get(a,t)*r.get(a,e);i=-i/r.get(t,t);for(let a=t;a<n;a++)r.set(a,e,r.get(a,e)+i*r.get(a,t))}y[e]=r.get(t,e)}if(l&&t<b)for(let e=t;e<n;e++)p.set(e,t,r.get(e,t));if(t<x){y[t]=0;for(let e=t+1;e<i;e++)y[t]=gZ(y[t],y[e]);if(0!==y[t]){y[t+1]<0&&(y[t]=0-y[t]);for(let e=t+1;e<i;e++)y[e]/=y[t];y[t+1]+=1}if(y[t]=-y[t],t+1<n&&0!==y[t]){for(let e=t+1;e<n;e++)v[e]=0;for(let e=t+1;e<n;e++)for(let n=t+1;n<i;n++)v[e]+=y[n]*r.get(e,n);for(let e=t+1;e<i;e++){let i=-y[e]/y[t+1];for(let a=t+1;a<n;a++)r.set(a,e,r.get(a,e)+i*v[a])}}if(u)for(let e=t+1;e<i;e++)g.set(e,t,y[e])}}let w=Math.min(i,n+1);if(b<i&&(f[b]=r.get(b,b)),n<w&&(f[w-1]=0),x+1<w&&(y[x]=r.get(x,w-1)),y[w-1]=0,l){for(let t=b;t<d;t++){for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}for(let t=b-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<d;e++){let r=0;for(let i=t;i<n;i++)r+=p.get(i,t)*p.get(i,e);r=-r/p.get(t,t);for(let i=t;i<n;i++)p.set(i,e,p.get(i,e)+r*p.get(i,t))}for(let e=t;e<n;e++)p.set(e,t,-p.get(e,t));p.set(t,t,1+p.get(t,t));for(let e=0;e<t-1;e++)p.set(e,t,0)}else{for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}}if(u)for(let t=i-1;t>=0;t--){if(t<x&&0!==y[t])for(let e=t+1;e<i;e++){let r=0;for(let n=t+1;n<i;n++)r+=g.get(n,t)*g.get(n,e);r=-r/g.get(t+1,t);for(let n=t+1;n<i;n++)g.set(n,e,g.get(n,e)+r*g.get(n,t))}for(let e=0;e<i;e++)g.set(e,t,0);g.set(t,t,1)}let _=w-1,S=Number.EPSILON;for(;w>0;){let t,e;for(t=w-2;t>=-1&&-1!==t;t--){let e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(y[t])<=e||Number.isNaN(y[t])){y[t]=0;break}}if(t===w-2)e=4;else{let r;for(r=w-1;r>=t&&r!==t;r--){let e=(r!==w?Math.abs(y[r]):0)+(r!==t+1?Math.abs(y[r-1]):0);if(Math.abs(f[r])<=S*e){f[r]=0;break}}r===t?e=3:r===w-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=y[w-2];y[w-2]=0;for(let r=w-2;r>=t;r--){let n=gZ(f[r],e),a=f[r]/n,o=e/n;if(f[r]=n,r!==t&&(e=-o*y[r-1],y[r-1]=a*y[r-1]),u)for(let t=0;t<i;t++)n=a*g.get(t,r)+o*g.get(t,w-1),g.set(t,w-1,-o*g.get(t,r)+a*g.get(t,w-1)),g.set(t,r,n)}break}case 2:{let e=y[t-1];y[t-1]=0;for(let r=t;r<w;r++){let i=gZ(f[r],e),a=f[r]/i,o=e/i;if(f[r]=i,e=-o*y[r],y[r]=a*y[r],l)for(let e=0;e<n;e++)i=a*p.get(e,r)+o*p.get(e,t-1),p.set(e,t-1,-o*p.get(e,r)+a*p.get(e,t-1)),p.set(e,r,i)}break}case 3:{let e=Math.max(Math.abs(f[w-1]),Math.abs(f[w-2]),Math.abs(y[w-2]),Math.abs(f[t]),Math.abs(y[t])),r=f[w-1]/e,a=f[w-2]/e,o=y[w-2]/e,s=f[t]/e,h=y[t]/e,d=((a+r)*(a-r)+o*o)/2,c=r*o*(r*o),v=0;(0!==d||0!==c)&&(v=d<0?0-Math.sqrt(d*d+c):Math.sqrt(d*d+c),v=c/(d+v));let m=(s+r)*(s-r)+v,b=s*h;for(let e=t;e<w-1;e++){let r=gZ(m,b);0===r&&(r=Number.MIN_VALUE);let a=m/r,o=b/r;if(e!==t&&(y[e-1]=r),m=a*f[e]+o*y[e],y[e]=a*y[e]-o*f[e],b=o*f[e+1],f[e+1]=a*f[e+1],u)for(let t=0;t<i;t++)r=a*g.get(t,e)+o*g.get(t,e+1),g.set(t,e+1,-o*g.get(t,e)+a*g.get(t,e+1)),g.set(t,e,r);if(0===(r=gZ(m,b))&&(r=Number.MIN_VALUE),a=m/r,o=b/r,f[e]=r,m=a*y[e]+o*f[e+1],f[e+1]=-o*y[e]+a*f[e+1],b=o*y[e+1],y[e+1]=a*y[e+1],l&&e<n-1)for(let t=0;t<n;t++)r=a*p.get(t,e)+o*p.get(t,e+1),p.set(t,e+1,-o*p.get(t,e)+a*p.get(t,e+1)),p.set(t,e,r)}y[w-2]=m;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,u))for(let e=0;e<=_;e++)g.set(e,t,-g.get(e,t));for(;t<_&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,u&&t<i-1)for(let r=0;r<i;r++)e=g.get(r,t+1),g.set(r,t+1,g.get(r,t)),g.set(r,t,e);if(l&&t<n-1)for(let r=0;r<n;r++)e=p.get(r,t+1),p.set(r,t+1,p.get(r,t)),p.set(r,t,e);t++}w--}}if(h){let t=g;g=p,p=t}this.m=n,this.n=i,this.s=f,this.U=p,this.V=g}solve(t){let e=this.threshold,r=this.s.length,n=gX.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=e?n.set(t,t,0):n.set(t,t,1/this.s[t]);let i=this.U,a=this.rightSingularVectors,o=a.mmul(n),s=a.rows,l=i.rows,u=gX.zeros(s,l);for(let t=0;t<s;t++)for(let e=0;e<l;e++){let n=0;for(let a=0;a<r;a++)n+=o.get(t,a)*i.get(e,a);u.set(t,e,n)}return u.mmul(t)}solveForDiagonal(t){return this.solve(gX.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,i=new gX(r,this.s.length);for(let a=0;a<r;a++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&i.set(a,r,t.get(a,r)/this.s[r]);let a=this.U,o=a.rows,s=a.columns,l=new gX(r,o);for(let t=0;t<r;t++)for(let e=0;e<o;e++){let r=0;for(let n=0;n<s;n++)r+=i.get(t,n)*a.get(e,n);l.set(t,e,r)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return gX.diag(this.s)}}var ol=y("jyI49");const g0=t=>{let e=[],r=t.length;for(let n=0;n<r;n+=1){e[n]=[];for(let i=0;i<r;i+=1)n===i?e[n][i]=0:0!==t[n][i]&&t[n][i]?e[n][i]=t[n][i]:e[n][i]=1/0}for(let t=0;t<r;t+=1)for(let n=0;n<r;n+=1)for(let i=0;i<r;i+=1)e[n][i]>e[n][t]+e[t][i]&&(e[n][i]=e[n][t]+e[t][i]);return e},g1=(t,e)=>{let{nodes:r,edges:n}=t,i=[],a={};if(!r)throw Error("invalid nodes data!");return r&&r.forEach((t,e)=>{a[t.id]=e,i.push([])}),null==n||n.forEach(t=>{let{source:r,target:n}=t,o=a[r],s=a[n];void 0===o||void 0===s||(i[o][s]=1,e||(i[s][o]=1))}),i},g2=(t,e)=>{let r=[];return t.forEach(t=>{let n=[];t.forEach(t=>{n.push(t*e)}),r.push(n)}),r},g3=t=>{let e=1/0,r=1/0,n=-1/0,i=-1/0;return t.forEach(t=>{let a=t.data.size;gi(a)?1===a.length&&(a=[a[0],a[0]]):(0,ol.default)(a)?a=[a,a]:(void 0===a||isNaN(a))&&(a=[30,30]);let o=[a[0]/2,a[1]/2],s=t.data.x-o[0],l=t.data.x+o[0],u=t.data.y-o[1],h=t.data.y+o[1];e>s&&(e=s),r>u&&(r=u),n<l&&(n=l),i<h&&(i=h)}),{minX:e,minY:r,maxX:n,maxY:i}},g6=(t,e)=>Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),g5=(t,e,r,n="TB",i,a={})=>{if(!(null==e?void 0:e.length))return;let{stopBranchFn:o,stopAllFn:s}=a;for(let l=0;l<e.length;l++){let u=e[l];if(t.hasNode(u.id)&&(null==o||!o(u))){if(null==s?void 0:s(u))return;"TB"===n&&r(u),g5(t,t.getChildren(u.id,i),r,n,i,a),"TB"!==n&&r(u)}}},g4={center:[0,0],linkDistance:50};class g8{constructor(t={}){this.options=t,this.id="mds",this.options=Object.assign(Object.assign({},g4),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericMDSLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericMDSLayout(!0,t,e)})}genericMDSLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let{center:n=[0,0],linkDistance:i=50}=Object.assign(Object.assign({},this.options),r),a=e.getAllNodes(),o=e.getAllEdges();if(!(null==a?void 0:a.length)||1===a.length)return gt(e,t,n);let s=g0(g1({nodes:a,edges:o},!1));g9(s);let l=g7(g2(s,i)),u=[];return l.forEach((t,e)=>{let r=p3(a[e]);r.data.x=t[0]+n[0],r.data.y=t[1]+n[1],u.push(r)}),t&&u.forEach(t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})),{nodes:u,edges:o}})}}const g9=t=>{let e=-999999;t.forEach(t=>{t.forEach(t=>{t!==1/0&&e<t&&(e=t)})}),t.forEach((r,n)=>{r.forEach((r,i)=>{r===1/0&&(t[n][i]=e)})})},g7=t=>{let e=gX.mul(gX.pow(t,2),-.5),r=e.mean("row"),n=e.mean("column"),i=e.mean();e.add(i).subRowVector(r).subColumnVector(n);let a=new gQ(e),o=gX.sqrt(a.diagonalMatrix).diagonal();return a.leftSingularVectors.toJSON().map(t=>gX.mul([t],[o]).toJSON()[0].splice(0,2))};function yt(t){return!!t.tick&&!!t.stop}const ye={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},yr={center:[0,0],comboPadding:10,treeKey:"combo"};function yn(t,e,r,n){var i;return(0,s6.__awaiter)(this,void 0,void 0,function*(){return yt(t)?(t.execute(e,r),t.stop(),t.tick(null!==(i=r.iterations)&&void 0!==i?i:300)):n?yield t.assign(e,r):yield t.execute(e,r)})}var s6=y("7WQrb");function yi(t,e){var r,n=1;function i(){var i,a,o=r.length,s=0,l=0;for(i=0;i<o;++i)s+=(a=r[i]).x,l+=a.y;for(s=(s/o-t)*n,l=(l/o-e)*n,i=0;i<o;++i)a=r[i],a.x-=s,a.y-=l}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){r=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(n=+t,i):n},i}function ya(t){return function(){return t}}function yo(t){return(t()-.5)*1e-6}function ys(t){return t.x+t.vx}function yl(t){return t.y+t.vy}function yu(t){var e,r,n,i=1,a=1;function o(){for(var t,o,l,u,h,d,c,f=e.length,p=0;p<a;++p)for(t=0,o=gd(e,ys,yl).visitAfter(s);t<f;++t)c=(d=r[(l=e[t]).index])*d,u=l.x+l.vx,h=l.y+l.vy,o.visit(g);function g(t,e,r,a,o){var s=t.data,f=t.r,p=d+f;if(s){if(s.index>l.index){var g=u-s.x-s.vx,y=h-s.y-s.vy,v=g*g+y*y;v<p*p&&(0===g&&(v+=(g=yo(n))*g),0===y&&(v+=(y=yo(n))*y),v=(p-(v=Math.sqrt(v)))/v*i,l.vx+=(g*=v)*(p=(f*=f)/(c+f)),l.vy+=(y*=v)*p,s.vx-=g*(p=1-p),s.vy-=y*p)}return}return e>u+p||a<u-p||r>h+p||o<h-p}}function s(t){if(t.data)return t.r=r[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var n,i,a=e.length;for(n=0,r=Array(a);n<a;++n)r[(i=e[n]).index]=+t(i,n,e)}}return"function"!=typeof t&&(t=ya(null==t?1:+t)),o.initialize=function(t,r){e=t,n=r,l()},o.iterations=function(t){return arguments.length?(a=+t,o):a},o.strength=function(t){return arguments.length?(i=+t,o):i},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:ya(+e),l(),o):t},o}function yh(t){return t.index}function yd(t,e){var r=t.get(e);if(!r)throw Error("node not found: "+e);return r}function yc(t){var e,r,n,i,a,o,s=yh,l=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=ya(30),h=1;function d(n){for(var i=0,s=t.length;i<h;++i)for(var l,u,d,c,f,p,g,y=0;y<s;++y)u=(l=t[y]).source,p=((p=Math.sqrt((c=(d=l.target).x+d.vx-u.x-u.vx||yo(o))*c+(f=d.y+d.vy-u.y-u.vy||yo(o))*f))-r[y])/p*n*e[y],c*=p,f*=p,d.vx-=c*(g=a[y]),d.vy-=f*g,u.vx+=c*(g=1-g),u.vy+=f*g}function c(){if(n){var o,l,u=n.length,h=t.length,d=new Map(n.map((t,e)=>[s(t,e,n),t]));for(o=0,i=Array(u);o<h;++o)(l=t[o]).index=o,"object"!=typeof l.source&&(l.source=yd(d,l.source)),"object"!=typeof l.target&&(l.target=yd(d,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(o=0,a=Array(h);o<h;++o)l=t[o],a[o]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);e=Array(h),f(),r=Array(h),p()}}function f(){if(n)for(var r=0,i=t.length;r<i;++r)e[r]=+l(t[r],r,t)}function p(){if(n)for(var e=0,i=t.length;e<i;++e)r[e]=+u(t[e],e,t)}return null==t&&(t=[]),d.initialize=function(t,e){n=t,o=e,c()},d.links=function(e){return arguments.length?(t=e,c(),d):t},d.id=function(t){return arguments.length?(s=t,d):s},d.iterations=function(t){return arguments.length?(h=+t,d):h},d.strength=function(t){return arguments.length?(l="function"==typeof t?t:ya(+t),f(),d):l},d.distance=function(t){return arguments.length?(u="function"==typeof t?t:ya(+t),p(),d):u},d}var yf={value:()=>{}};function yp(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw Error("illegal type: "+t);n[t]=[]}return new yg(n)}function yg(t){this._=t}function yy(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=yf,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}yg.prototype=yp.prototype={constructor:yg,on:function(t,e){var r,n=this._,i=(t+"").trim().split(/^|\s+/).map(function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw Error("unknown type: "+t);return{type:t,name:e}}),a=-1,o=i.length;if(arguments.length<2){for(;++a<o;)if((r=(t=i[a]).type)&&(r=function(t,e){for(var r,n=0,i=t.length;n<i;++n)if((r=t[n]).name===e)return r.value}(n[r],t.name)))return r;return}if(null!=e&&"function"!=typeof e)throw Error("invalid callback: "+e);for(;++a<o;)if(r=(t=i[a]).type)n[r]=yy(n[r],t.name,e);else if(null==e)for(r in n)n[r]=yy(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new yg(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,i=Array(r),a=0;a<r;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw Error("unknown type: "+t);for(n=this._[t],a=0,r=n.length;a<r;++a)n[a].value.apply(e,i)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw Error("unknown type: "+t);for(var n=this._[t],i=0,a=n.length;i<a;++i)n[i].value.apply(e,r)}};var yv,ym,yb,yx,yE,yw,y_,yS,yk,yN,yO,yT,yM,yA,yC,yR,yI,yP,yD,yL,yj,yF,yB,yz,yV,yG,y$,yU,yH,yW,yq,yY,yK,yX=0,yJ=0,yZ=0,yQ=0,y0=0,y1=0,y2="object"==typeof performance&&performance.now?performance:Date,y3="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function y6(){return y0||(y3(y5),y0=y2.now()+y1)}function y5(){y0=0}function y4(){this._call=this._time=this._next=null}function y8(t,e,r){var n=new y4;return n.restart(t,e,r),n}function y9(){y0=(yQ=y2.now())+y1,yX=yJ=0;try{!function(){y6(),++yX;for(var t,e=yY;e;)(t=y0-e._time)>=0&&e._call.call(void 0,t),e=e._next;--yX}()}finally{yX=0,function(){for(var t,e,r=yY,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:yY=e);yK=t,vt(n)}(),y0=0}}function y7(){var t=y2.now(),e=t-yQ;e>1e3&&(y1-=e,yQ=t)}function vt(t){!yX&&(yJ&&(yJ=clearTimeout(yJ)),t-y0>24?(t<1/0&&(yJ=setTimeout(y9,t-y2.now()-y1)),yZ&&(yZ=clearInterval(yZ))):(yZ||(yQ=y2.now(),yZ=setInterval(y7,1e3)),yX=1,y3(y9)))}function ve(t){return t.x}function vr(t){return t.y}y4.prototype=y8.prototype={constructor:y4,restart:function(t,e,r){if("function"!=typeof t)throw TypeError("callback is not a function");r=(null==r?y6():+r)+(null==e?0:+e),this._next||yK===this||(yK?yK._next=this:yY=this,yK=this),this._call=t,this._time=r,vt()},stop:function(){this._call&&(this._call=null,this._time=1/0,vt())}};var vn=Math.PI*(3-Math.sqrt(5));function vi(){var t,e,r,n,i,a=ya(-30),o=1,s=1/0,l=.81;function u(r){var i,a=t.length,o=gd(t,ve,vr).visitAfter(d);for(n=r,i=0;i<a;++i)e=t[i],o.visit(c)}function h(){if(t){var e,r,n=t.length;for(e=0,i=Array(n);e<n;++e)i[(r=t[e]).index]=+a(r,e,t)}}function d(t){var e,r,n,a,o,s=0,l=0;if(t.length){for(n=a=o=0;o<4;++o)(e=t[o])&&(r=Math.abs(e.value))&&(s+=e.value,l+=r,n+=r*e.x,a+=r*e.y);t.x=n/l,t.y=a/l}else{(e=t).x=e.data.x,e.y=e.data.y;do s+=i[e.data.index];while(e=e.next)}t.value=s}function c(t,a,u,h){if(!t.value)return!0;var d=t.x-e.x,c=t.y-e.y,f=h-a,p=d*d+c*c;if(f*f/l<p)return p<s&&(0===d&&(p+=(d=yo(r))*d),0===c&&(p+=(c=yo(r))*c),p<o&&(p=Math.sqrt(o*p)),e.vx+=d*t.value*n/p,e.vy+=c*t.value*n/p),!0;if(!t.length&&!(p>=s)){(t.data!==e||t.next)&&(0===d&&(p+=(d=yo(r))*d),0===c&&(p+=(c=yo(r))*c),p<o&&(p=Math.sqrt(o*p)));do t.data!==e&&(f=i[t.data.index]*n/p,e.vx+=d*f,e.vy+=c*f);while(t=t.next)}}return u.initialize=function(e,n){t=e,r=n,h()},u.strength=function(t){return arguments.length?(a="function"==typeof t?t:ya(+t),h(),u):a},u.distanceMin=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.distanceMax=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u.theta=function(t){return arguments.length?(l=t*t,u):Math.sqrt(l)},u}function va(t,e,r){var n,i,a,o=ya(.1);function s(t){for(var o=0,s=n.length;o<s;++o){var l=n[o],u=l.x-e||1e-6,h=l.y-r||1e-6,d=Math.sqrt(u*u+h*h),c=(a[o]-d)*i[o]*t/d;l.vx+=u*c,l.vy+=h*c}}function l(){if(n){var e,r=n.length;for(e=0,i=Array(r),a=Array(r);e<r;++e)a[e]=+t(n[e],e,n),i[e]=isNaN(a[e])?0:+o(n[e],e,n)}}return"function"!=typeof t&&(t=ya(+t)),null==e&&(e=0),null==r&&(r=0),s.initialize=function(t){n=t,l()},s.strength=function(t){return arguments.length?(o="function"==typeof t?t:ya(+t),l(),s):o},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:ya(+e),l(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(r=+t,s):r},s}function vo(t){var e,r,n,i=ya(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)i=e[a],i.vx+=(n[a]-i.x)*r[a]*t}function o(){if(e){var a,o=e.length;for(a=0,r=Array(o),n=Array(o);a<o;++a)r[a]=isNaN(n[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=ya(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:ya(+t),o(),a):i},a.x=function(e){return arguments.length?(t="function"==typeof e?e:ya(+e),o(),a):t},a}function vs(t){var e,r,n,i=ya(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)i=e[a],i.vy+=(n[a]-i.y)*r[a]*t}function o(){if(e){var a,o=e.length;for(a=0,r=Array(o),n=Array(o);a<o;++a)r[a]=isNaN(n[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=ya(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:ya(+t),o(),a):i},a.y=function(e){return arguments.length?(t="function"==typeof e?e:ya(+e),o(),a):t},a}const vl=(t,e)=>e.reduce((e,[r,n])=>e[r]&&void 0!==n?e[r].call(t,n):e,t);var s6=y("7WQrb"),sI=y("ky7aH"),ol=y("jyI49"),vu={};vu={graphlib:y("6mwJ2"),layout:y("VZEn7"),debug:y("8XBdx"),util:{time:y("1kMKg").time,notime:y("1kMKg").notime},version:y("9Grre")};class vh{constructor(t){this.id="dagre",this.options={},Object.assign(this.options,vh.defaultOptions,t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,t,Object.assign(Object.assign({},this.options),e))})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,t,Object.assign(Object.assign({},this.options),e))})}genericDagreLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let{nodeSize:n}=r,i=new vu.graphlib.Graph;i.setGraph(r),i.setDefaultEdgeLabel(()=>({})),[...e.getAllNodes(),...e.getAllEdges()].some(({id:t})=>(0,ol.default)(t))&&console.error("Dagre layout only support string id, it will convert number to string."),e.getAllNodes().forEach(t=>{let{id:e}=t,r=Object.assign({},t.data);if(void 0!==n){let[e,i]=p6((0,sI.default)(n)?n(t):n);Object.assign(r,{width:e,height:i})}i.setNode(e.toString(),r)}),e.getAllEdges().forEach(({id:t,source:e,target:r})=>{i.setEdge(e.toString(),r.toString(),{id:t})}),/*@__PURE__*/f(vu).layout(i);let a={nodes:[],edges:[]};return i.nodes().forEach(r=>{let n=i.node(r);a.nodes.push({id:r,data:n}),t&&e.mergeNodeData(r,n)}),i.edges().forEach(r=>{let n=i.edge(r),{id:o}=n,s=(0,s6.__rest)(n,["id"]),{v:l,w:u}=r;a.edges.push({id:o,source:l,target:u,data:s}),t&&e.mergeEdgeData(o,s)}),a})}}vh.defaultOptions={};var s6=y("7WQrb"),ol=y("jyI49");class vd{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){return Math.hypot(this.rx-t.rx,this.ry-t.ry)}setPos(t,e){this.rx=t,this.ry=e}resetForce(){this.fx=0,this.fy=0}addForce(t){let e=t.rx-this.rx,r=t.ry-this.ry,n=Math.hypot(e,r);n=n<1e-4?1e-4:n;let i=this.g*(this.degree+1)*(t.degree+1)/n;this.fx+=i*e/n,this.fy+=i*r/n}in(t){return t.contains(this.rx,this.ry)}add(t){let e=this.mass+t.mass,r=(this.rx*this.mass+t.rx*t.mass)/e;return new vd({rx:r,ry:(this.ry*this.mass+t.ry*t.mass)/e,mass:e,degree:this.degree+t.degree})}}class vc{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,e){let r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r}NW(){let t=this.xmid-this.length/4;return new vc({xmid:t,ymid:this.ymid+this.length/4,length:this.length/2})}NE(){let t=this.xmid+this.length/4;return new vc({xmid:t,ymid:this.ymid+this.length/4,length:this.length/2})}SW(){let t=this.xmid-this.length/4;return new vc({xmid:t,ymid:this.ymid-this.length/4,length:this.length/2})}SE(){let t=this.xmid+this.length/4;return new vc({xmid:t,ymid:this.ymid-this.length/4,length:this.length/2})}}class vf{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}insert(t){if(null==this.body){this.body=t;return}this._isExternal()?(this.quad&&(this.NW=new vf(this.quad.NW()),this.NE=new vf(this.quad.NE()),this.SW=new vf(this.quad.SW()),this.SE=new vf(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t))}_putBody(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE}updateForce(t){null!=this.body&&t!==this.body&&(this._isExternal()?t.addForce(this.body):(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t)))}}const vp={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1};var s6=y("7WQrb"),ol=y("jyI49");const vg={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"};var s6=y("7WQrb"),ol=y("jyI49"),ou=y("kVcyu");const vy={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},vv=(t,e)=>{let r;let n=t.rows||5,i=t.cols||5;return null==e?r=Math.min(n,i):Math.min(n,i)===t.rows?t.rows=e:t.cols=e,r},vm=(t,e)=>{let r;let n=t.rows||5,i=t.cols||5;return null==e?r=Math.max(n,i):Math.max(n,i)===t.rows?t.rows=e:t.cols=e,r},vb=(t,e)=>t[`c-${e.row}-${e.col}`]||!1,vx=(t,e)=>t[`c-${e.row}-${e.col}`]=!0,vE=(t,e)=>{let r=t.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},vw=(t,e,r,n,i,a,o,s)=>{let l,u;let h=i[t.id];if(h)l=h.col*r+r/2+e[0],u=h.row*n+n/2+e[1];else{for(;vb(s,o);)vE(a,o);l=o.col*r+r/2+e[0],u=o.row*n+n/2+e[1],vx(s,o),vE(a,o)}t.data.x=l,t.data.y=u};var s6=y("7WQrb"),ou=y("kVcyu");const v_=(t,e,r)=>{try{let r=gX.mul(gX.pow(e,2),-.5),n=r.mean("row"),i=r.mean("column"),a=r.mean();r.add(a).subRowVector(n).subColumnVector(i);let o=new gQ(r),s=gX.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map(e=>gX.mul([e],[s]).toJSON()[0].splice(0,t))}catch(n){let t=[];for(let n=0;n<e.length;n++){let e=Math.random()*r,n=Math.random()*r;t.push([e,n])}return t}},vS={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},vk=(t,e)=>{let{positions:r,iterations:n,width:i,k:a,speed:o=100,strictRadial:s,focusIdx:l,radii:u=[],nodeSizeFunc:h}=Object.assign(Object.assign({},vS),e),d=t.getAllNodes(),c=[],f=i/10;for(let t=0;t<n;t++)r.forEach((t,e)=>{c[e]={x:0,y:0}}),vN(d,r,c,a,u,h),vO(r,c,o,s,l,f,i,u);return r},vN=(t,e,r,n,i,a)=>{e.forEach((o,s)=>{r[s]={x:0,y:0},e.forEach((e,l)=>{if(s===l||i[s]!==i[l])return;let u=o.x-e.x,h=o.y-e.y,d=Math.sqrt(u*u+h*h);if(0===d){d=1;let t=s>l?1:-1;u=.01*t,h=.01*t}if(d<a(t[s])/2+a(t[l])/2){let t=n*n/d;r[s].x+=u/d*t,r[s].y+=h/d*t}})})},vO=(t,e,r,n,i,a,o,s)=>{let l=a||o/10;return n&&e.forEach((e,r)=>{let n=t[r].x-t[i].x,a=t[r].y-t[i].y,o=Math.sqrt(n*n+a*a),s=a/o,l=-n/o,u=Math.sqrt(e.x*e.x+e.y*e.y),h=Math.acos((s*e.x+l*e.y)/u);h>Math.PI/2&&(h-=Math.PI/2,s*=-1,l*=-1);let d=Math.cos(h)*u;e.x=s*d,e.y=l*d}),t.forEach((a,o)=>{if(o===i)return;let u=Math.sqrt(e[o].x*e[o].x+e[o].y*e[o].y);if(u>0&&o!==i){let h=Math.min(r/800*l,u);if(a.x+=e[o].x/u*h,a.y+=e[o].y/u*h,n){let e=a.x-t[i].x,r=a.y-t[i].y,n=Math.sqrt(e*e+r*r);e=e/n*s[o],r=r/n*s[o],a.x=t[i].x+e,a.y=t[i].y+r}}}),t},vT={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},vM=(t,e,r,n,i,a,o)=>{if(!t)return[];let s=[];if(e){let l={};e.forEach((e,u)=>{let h=[];e.forEach((e,s)=>{var d,c;if(u===s)h.push(0);else if(n[u]===n[s]){if("data"===a)h.push(Math.abs(u-s)*o*e/(n[u]/i));else if(a){let r,f;if(l[t[u].id])r=l[t[u].id];else{let e=("id"===a?t[u].id:null===(d=t[u].data)||void 0===d?void 0:d[a])||0;r=(0,ou.default)(e)?e.charCodeAt(0):e,l[t[u].id]=r}if(l[t[s].id])f=l[t[s].id];else{let e=("id"===a?t[s].id:null===(c=t[s].data)||void 0===c?void 0:c[a])||0;f=(0,ou.default)(e)?e.charCodeAt(0):e,l[t[s].id]=f}h.push(Math.abs(r-f)*o*e/(n[u]/i))}else h.push(e*r/(n[u]/i))}else h.push((r+i)/2*e)}),s.push(h)})}return s},vA=t=>{let e=t.length,r=t[0].length,n=[];for(let i=0;i<e;i++){let e=[];for(let n=0;n<r;n++)0!==t[i][n]?e.push(1/(t[i][n]*t[i][n])):e.push(0);n.push(e)}return n},vC=(t,e)=>{let r=-1;return t.forEach((t,n)=>{t.id===e&&(r=n)}),Math.max(r,0)},vR=(t,e,r)=>{let n=t.length;for(let i=0;i<n;i++)if(t[e][i]===1/0){t[e][i]=r,t[i][e]=r;for(let a=0;a<n;a++)t[i][a]!==1/0&&t[e][a]===1/0&&(t[e][a]=r+t[i][a],t[a][e]=r+t[i][a])}for(let r=0;r<n;r++)if(r!==e){for(let i=0;i<n;i++)if(t[r][i]===1/0){let n=Math.abs(t[e][r]-t[e][i]);n=0===n?1:n,t[r][i]=n}}},vI=(t,e)=>{let r=0;for(let n=0;n<t[e].length;n++)t[e][n]!==1/0&&(r=t[e][n]>r?t[e][n]:r);return r};var s6=y("7WQrb");const vP={center:[0,0],width:300,height:300};var vD=new Map;function vL(t,e,r){return void 0===r&&(r=128),function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=e?e.apply(this,n):n[0];vD.has(t)||vD.set(t,function(t){var e,r,n,i=t||1;function a(t,a){++e>i&&(n=r,o(1),++e),r[t]=a}function o(t){e=0,r=Object.create(null),t||(n=Object.create(null))}return o(),{clear:o,has:function(t){return void 0!==r[t]||void 0!==n[t]},get:function(t){var e=r[t];return void 0!==e?e:void 0!==(e=n[t])?(a(t,e),e):void 0},set:function(t,e){void 0!==r[t]?r[t]=e:a(t,e)}}}(r));var o=vD.get(t);if(o.has(a))return o.get(a);var s=t.apply(this,n);return o.set(a,s),s}}var sR=y("1uF5a"),vj=function(t,e,r){if(!(0,sR.default)(t)&&!lI(t))return t;var n=r;return du(t,function(t,r){n=e(n,t,r)}),n},vF=function(t,e){return vj(t,function(t,r,n){return e.includes(n)||(t[n]=r),t},{})};class vB extends lM{}function vz(t,e=!0,r){let n=document.createElement("div");return n.setAttribute("class",`g6-${t}`),Object.assign(n.style,{position:"absolute",display:"block"}),e&&Object.assign(n.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),r&&Object.assign(n.style,r),n}function vV(t,e="div",r={},n="",i=document.body){let a=document.getElementById(t);a&&a.remove();let o=document.createElement(e);return o.innerHTML=n,o.id=t,Object.assign(o.style,r),i.appendChild(o),o}class vG extends vB{constructor(t,e){super(t,Object.assign({},vG.defaultOptions,e)),this.$element=vz("background"),this.context.canvas.getContainer().prepend(this.$element),this.update(e)}update(t){var e,r,n,i;let a=Object.create(null,{update:{get:()=>super.update}});return e=this,r=void 0,n=void 0,i=function*(){a.update.call(this,t),Object.assign(this.$element.style,vF(this.options,["key","type"]))},new(n||(n=Promise))(function(t,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n(function(t){t(r)})).then(o,s)}l((i=i.apply(e,r||[])).next())})}destroy(){super.destroy(),this.$element.remove()}}vG.defaultOptions={transition:"background 0.5s",backgroundSize:"cover"};var sI=y("ky7aH");function v$(t,e,r,n,i,a){let o=r-t,s=n-e,l=i-t,u=a-e,h=l*o+u*s,d=0;d=h<=0?0:(h=(l=o-l)*o+(u=s-u)*s)<=0?0:h*h/(o*o+s*s);let c=l*l+u*u-d;return c<0?0:c}function vU(t,e,r,n){return(t-r)*(t-r)+(e-n)*(e-n)}function vH(t){let e=Math.min(t.x1,t.x2),r=Math.max(t.x1,t.x2),n=Math.min(t.y1,t.y2),i=Math.max(t.y1,t.y2);return{x:e,y:n,x2:r,y2:i,width:r-e,height:i-n}}class vW{constructor(t,e,r,n){this.x1=t,this.y1=e,this.x2=r,this.y2=n}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}draw(t){t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(t){return new vW(t.x1,t.y1,t.x2,t.y2)}cuts(t,e){return this.y1!==this.y2&&(!(e<this.y1)||!(e<=this.y2))&&(!(e>this.y1)||!(e>=this.y2))&&(!(t>this.x1)||!(t>=this.x2))&&(t<this.x1&&t<=this.x2||t<=this.x1+(e-this.y1)*(this.x2-this.x1)/(this.y2-this.y1))}distSquare(t,e){return v$(this.x1,this.y1,this.x2,this.y2,t,e)}ptClose(t,e,r){if(this.x1<this.x2){if(t<this.x1-r||t>this.x2+r)return!1}else if(t<this.x2-r||t>this.x1+r)return!1;if(this.y1<this.y2){if(e<this.y1-r||e>this.y2+r)return!1}else if(e<this.y2-r||e>this.y1+r)return!1;return!0}}(i=s||(s={}))[i.POINT=1]="POINT",i[i.PARALLEL=2]="PARALLEL",i[i.COINCIDENT=3]="COINCIDENT",i[i.NONE=4]="NONE";class vq{constructor(t,e=0,r=0){this.state=t,this.x=e,this.y=r}}function vY(t,e){let r=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),n=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),i=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(i){let e=r/i,a=n/i;return 0<=e&&e<=1&&0<=a&&a<=1?new vq(s.POINT,t.x1+e*(t.x2-t.x1),t.y1+e*(t.y2-t.y1)):new vq(s.NONE)}return new vq(0===r||0===n?s.COINCIDENT:s.PARALLEL)}function vK(t,e){let r=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),n=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),i=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(i){let t=r/i,e=n/i;if(0<=t&&t<=1&&0<=e&&e<=1)return t}return Number.POSITIVE_INFINITY}function vX(t,e,r){let n=new Set;return t.width<=0?(n.add(l.LEFT),n.add(l.RIGHT)):e<t.x?n.add(l.LEFT):e>t.x+t.width&&n.add(l.RIGHT),t.height<=0?(n.add(l.TOP),n.add(l.BOTTOM)):r<t.y?n.add(l.TOP):r>t.y+t.height&&n.add(l.BOTTOM),n}function vJ(t,e){let r=e.x1,n=e.y1,i=e.x2,a=e.y2,o=Array.from(vX(t,i,a));if(0===o.length)return!0;let s=vX(t,r,n);for(;0!==s.size;){for(let t of o)if(s.has(t))return!1;if(s.has(l.RIGHT)||s.has(l.LEFT)){let e=t.x;s.has(l.RIGHT)&&(e+=t.width),n+=(e-r)*(a-n)/(i-r),r=e}else{let e=t.y;s.has(l.BOTTOM)&&(e+=t.height),r+=(e-n)*(i-r)/(a-n),n=e}s=vX(t,r,n)}return!0}(a=l||(l={}))[a.LEFT=0]="LEFT",a[a.TOP=1]="TOP",a[a.RIGHT=2]="RIGHT",a[a.BOTTOM=3]="BOTTOM";class vZ{constructor(t,e,r,n){this.x=t,this.y=e,this.width=r,this.height=n}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(t){return new vZ(t.x,t.y,t.width,t.height)}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}clone(){return new vZ(this.x,this.y,this.width,this.height)}add(t){let e=Math.min(this.x,t.x),r=Math.min(this.y,t.y),n=Math.max(this.x2,t.x+t.width),i=Math.max(this.y2,t.y+t.height);this.x=e,this.y=r,this.width=n-e,this.height=i-r}addPoint(t){let e=Math.min(this.x,t.x),r=Math.min(this.y,t.y),n=Math.max(this.x2,t.x),i=Math.max(this.y2,t.y);this.x=e,this.y=r,this.width=n-e,this.height=i-r}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(t){t.rect(this.x,this.y,this.width,this.height)}containsPt(t,e){return t>=this.x&&t<=this.x2&&e>=this.y&&e<=this.y2}get area(){return this.width*this.height}intersects(t){return!(this.area<=0)&&!(t.width<=0)&&!(t.height<=0)&&t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x2&&t.y<this.y2}distSquare(t,e){if(this.containsPt(t,e))return 0;let r=vX(this,t,e);return r.has(l.TOP)?r.has(l.LEFT)?vU(t,e,this.x,this.y):r.has(l.RIGHT)?vU(t,e,this.x2,this.y):(this.y-e)*(this.y-e):r.has(l.BOTTOM)?r.has(l.LEFT)?vU(t,e,this.x,this.y2):r.has(l.RIGHT)?vU(t,e,this.x2,this.y2):(e-this.y2)*(e-this.y2):r.has(l.LEFT)?(this.x-t)*(this.x-t):r.has(l.RIGHT)?(t-this.x2)*(t-this.x2):0}}class vQ{constructor(t,e,r){this.cx=t,this.cy=e,this.radius=r}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return 2*this.radius}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return 2*this.radius}static from(t){return new vQ(t.cx,t.cy,t.radius)}containsPt(t,e){return vU(this.cx,this.cy,t,e)<this.radius*this.radius}distSquare(t,e){let r=vU(this.cx,this.cy,t,e);if(r<this.radius*this.radius)return 0;let n=Math.sqrt(r)-this.radius;return n*n}draw(t){t.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,2*Math.PI)}}class v0{constructor(t,e=0,r=0,n=0,i=0,a=10,o=10,s=new Float32Array(Math.max(0,a*o)).fill(0)){this.pixelGroup=t,this.i=e,this.j=r,this.pixelX=n,this.pixelY=i,this.width=a,this.height=o,this.area=s}createSub(t,e){return new v0(this.pixelGroup,t.x,t.y,e.x,e.y,t.width,t.height)}static fromPixelRegion(t,e){return new v0(e,0,0,t.x,t.y,Math.ceil(t.width/e),Math.ceil(t.height/e))}copy(t,e){return new v0(this.pixelGroup,this.scaleX(e.x),this.scaleY(e.y),e.x,e.y,t.width,t.height,t.area)}boundX(t){return t<this.i?this.i:t>=this.width?this.width-1:t}boundY(t){return t<this.j?this.j:t>=this.height?this.height-1:t}scaleX(t){return this.boundX(Math.floor((t-this.pixelX)/this.pixelGroup))}scaleY(t){return this.boundY(Math.floor((t-this.pixelY)/this.pixelGroup))}scale(t){let e=this.scaleX(t.x),r=this.scaleY(t.y);return new vZ(e,r,this.boundX(Math.ceil((t.x+t.width-this.pixelX)/this.pixelGroup))-e,this.boundY(Math.ceil((t.y+t.height-this.pixelY)/this.pixelGroup))-r)}invertScaleX(t){return Math.round(t*this.pixelGroup+this.pixelX)}invertScaleY(t){return Math.round(t*this.pixelGroup+this.pixelY)}addPadding(t,e){let r=Math.ceil(e/this.pixelGroup),n=this.boundX(t.x-r),i=this.boundY(t.y-r);return new vZ(n,i,this.boundX(t.x2+r)-n,this.boundY(t.y2+r)-i)}get(t,e){return t<0||e<0||t>=this.width||e>=this.height?Number.NaN:this.area[t+e*this.width]}inc(t,e,r){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]+=r)}set(t,e,r){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]=r)}incArea(t,e){if(t.width<=0||t.height<=0||0===e)return;let r=this.width,n=t.width,i=Math.max(0,t.i),a=Math.max(0,t.j),o=Math.min(t.i+t.width,r),s=Math.min(t.j+t.height,this.height);if(!(s<=0)&&!(o<=0)&&!(i>=r)&&!(s>=this.height))for(let l=a;l<s;l++){let a=(l-t.j)*n,s=l*r;for(let r=i;r<o;r++){let n=t.area[r-t.i+a];0!==n&&(this.area[r+s]+=e*n)}}}fill(t){this.area.fill(t)}fillArea(t,e){let r=t.x+t.y*this.width;for(let n=0;n<t.height;n++){let i=r+n*this.width;this.area.fill(e,i,i+t.width)}}fillHorizontalLine(t,e,r,n){let i=t+e*this.width;this.area.fill(n,i,i+r)}fillVerticalLine(t,e,r,n){let i=t+e*this.width;for(let t=0;t<r;t++)this.area[i+t*this.width]=n}clear(){this.area.fill(0)}toString(){let t="";for(let e=0;e<this.height;e++){let r=e*this.width;for(let e=0;e<this.width;e++)t+=this.area[r+e].toFixed(1).padStart(6),t+=" ";t+="\n"}return t}draw(t,e=!0){if(this.width<=0||this.height<=0)return;t.save(),e&&t.translate(this.pixelX,this.pixelY);let r=this.area.reduce((t,e)=>Math.min(t,e),Number.POSITIVE_INFINITY),n=this.area.reduce((t,e)=>Math.max(t,e),Number.NEGATIVE_INFINITY),i=t=>(t-r)/(n-r);t.scale(this.pixelGroup,this.pixelGroup);for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++){let n=this.area[e+r*this.width];t.fillStyle=`rgba(0, 0, 0, ${i(n)})`,t.fillRect(e,r,1,1)}t.restore()}drawThreshold(t,e,r=!0){if(!(this.width<=0)&&!(this.height<=0)){t.save(),r&&t.translate(this.pixelX,this.pixelY),t.scale(this.pixelGroup,this.pixelGroup);for(let r=0;r<this.width;r++)for(let n=0;n<this.height;n++){let i=this.area[r+n*this.width];t.fillStyle=i>e?"black":"white",t.fillRect(r,n,1,1)}t.restore()}}}function v1(t,e){let r=t=>({x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e});return Array.isArray(t)?t.map(r):r(t)}function v2(t,e,r){return v3(Object.assign(vH(t),{distSquare:(e,r)=>v$(t.x1,t.y1,t.x2,t.y2,e,r)}),e,r)}function v3(t,e,r){let n=v1(t,r),i=e.scale(n),a=e.createSub(i,n);return function(t,e,r,n){let i=r*r;for(let a=0;a<t.height;a++)for(let o=0;o<t.width;o++){let s=n(e.invertScaleX(t.i+o),e.invertScaleY(t.j+a));if(0===s){t.set(o,a,i);continue}if(s<i){let e=r-Math.sqrt(s);t.set(o,a,e*e)}}}(a,e,r,(e,r)=>t.distSquare(e,r)),a}function v6(t,e){return{x:t,y:e}}function v5(t,e){return e.some(e=>e.containsPt(t.x,t.y))}function v4(t,e){return e.some(e=>{var r,n,i,a;return r=e.x1,n=e.y1,1e-6>vU(r,n,t.x,t.y)||(i=e.x2,a=e.y2,1e-6>vU(i,a,t.x,t.y))})}function v8(t,e){let r=Number.POSITIVE_INFINITY,n=null;for(let i of t){if(!vJ(i,e))continue;let t=function(t,e){let r=Number.POSITIVE_INFINITY,n=0;function i(t,i,a,o){let s=vK(e,new vW(t,i,a,o));(s=Math.abs(s-.5))>=0&&s<=1&&(n++,s<r&&(r=s))}return(i(t.x,t.y,t.x2,t.y),i(t.x,t.y,t.x,t.y2),n>1)?r:(i(t.x,t.y2,t.x2,t.y2),n>1)?r:(i(t.x2,t.y,t.x2,t.y2),0===n)?-1:r}(i,e);t>=0&&t<r&&(n=i,r=t)}return n}function v9(t,e,r,n){let i=r.top,a=r.left,o=r.bottom,l=r.right;if(n){if(a.state===s.POINT){if(i.state===s.POINT)return v6(t.x-e,t.y-e);if(o.state===s.POINT)return v6(t.x-e,t.y2+e);let r=t.width*t.height;return t.width*((a.y-t.y+(l.y-t.y))*.5)<.5*r?a.y>l.y?v6(t.x-e,t.y-e):v6(t.x2+e,t.y-e):a.y<l.y?v6(t.x-e,t.y2+e):v6(t.x2+e,t.y2+e)}if(l.state===s.POINT){if(i.state===s.POINT)return v6(t.x2+e,t.y-e);if(o.state===s.POINT)return v6(t.x2+e,t.y2+e)}let r=t.height*t.width;return t.height*((i.x-t.x+(l.x-t.x))*.5)<.5*r?i.x>o.x?v6(t.x-e,t.y-e):v6(t.x-e,t.y2+e):i.x<o.x?v6(t.x2+e,t.y-e):v6(t.x2+e,t.y2+e)}if(a.state===s.POINT){if(i.state===s.POINT)return v6(t.x2+e,t.y2+e);if(o.state===s.POINT)return v6(t.x2+e,t.y-e);let r=t.height*t.width;return t.width*((a.y-t.y+(l.y-t.y))*.5)<.5*r?a.y>l.y?v6(t.x2+e,t.y2+e):v6(t.x-e,t.y2+e):a.y<l.y?v6(t.x2+e,t.y-e):v6(t.x-e,t.y-e)}if(l.state===s.POINT){if(i.state===s.POINT)return v6(t.x-e,t.y2+e);if(o.state===s.POINT)return v6(t.x-e,t.y-e)}let u=t.height*t.width;return t.height*((i.x-t.x+(l.x-t.x))*.5)<.5*u?i.x>o.x?v6(t.x2+e,t.y2+e):v6(t.x2+e,t.y-e):i.x<o.x?v6(t.x-e,t.y2+e):v6(t.x-e,t.y-e)}class v7{constructor(t=[],e=!0){this.points=t,this.closed=e}get(t){let e=this.points.length;return t<0?this.closed?this.get(t+e):this.points[0]:t>=e?this.closed?this.get(t-e):this.points[e-1]:this.points[t]}get length(){return this.points.length}toString(t=1/0){let e=this.points;if(0===e.length)return"";let r="function"==typeof t?t:function(t){if(!Number.isFinite(t))return t=>t;if(0===t)return Math.round;let e=Math.pow(10,t);return t=>Math.round(t*e)/e}(t),n="M";for(let t of e)n+=`${r(t.x)},${r(t.y)} L`;return n=n.slice(0,-1),this.closed&&(n+=" Z"),n}draw(t){let e=this.points;if(0!==e.length){for(let r of(t.beginPath(),t.moveTo(e[0].x,e[0].y),e))t.lineTo(r.x,r.y);this.closed&&t.closePath()}}sample(t){return(function(t=8){return e=>{let r=t,n=e.length;if(r>1)for(n=Math.floor(e.length/r);n<3&&r>1;)r-=1,n=Math.floor(e.length/r);let i=[];for(let t=0,a=0;a<n;a++,t+=r)i.push(e.get(t));return new v7(i)}})(t)(this)}simplify(t){return(function(t=0){return e=>{if(t<0||e.length<3)return e;let r=[],n=0,i=t*t;for(;n<e.length;){let t=n+1;for(;function(t,e,r,n){if(!(t.closed?r<t.length:r<t.length-1))return!1;let i=t.get(e),a=t.get(r+1);for(let o=e+1;o<=r;o++){let e=t.get(o);if(v$(i.x,i.y,a.x,a.y,e.x,e.y)>n)return!1}return!0}(e,n,t,i);)t++;r.push(e.get(n)),n=t}return new v7(r)}})(t)(this)}bSplines(t){return(function(t=6){function e(t,e,r){let n=0,i=0;for(let a=-2;a<=1;a++){let o=t.get(e+a),s=function(t,e){switch(t){case -2:return(((-e+3)*e-3)*e+1)/6;case -1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw Error("unknown error")}}(a,r);n+=s*o.x,i+=s*o.y}return{x:n,y:i}}return r=>{if(r.length<3)return r;let n=[],i=r.closed,a=r.length+3-1+(i?0:2);n.push(e(r,2-(i?0:2),0));for(let o=2-(i?0:2);o<a;o++)for(let i=1;i<=t;i++)n.push(e(r,o,i/t));return new v7(n)}})(t)(this)}apply(t){return t(this)}containsElements(t){let e=function(t){if(0===t.length)return null;let e=t[0],r=new vZ(e.x,e.y,0,0);for(let e of t)r.addPoint(e);return r}(this.points);return!!e&&t.every(t=>e.containsPt(t.cx,t.cy)&&this.withinArea(t.cx,t.cy))}withinArea(t,e){if(0===this.length)return!1;let r=0,n=this.points[0],i=new vW(n.x,n.y,n.x,n.y);for(let n=1;n<this.points.length;n++){let a=this.points[n];i.x1=i.x2,i.y1=i.y2,i.x2=a.x,i.y2=a.y,i.cuts(t,e)&&r++}return i.x1=i.x2,i.y1=i.y2,i.x2=n.x,i.y2=n.y,i.cuts(t,e)&&r++,r%2==1}}class mt{constructor(t=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=t}add(t){this.set.add(`${t.x}x${t.y}`),this.arr[this.count++]=t}contains(t){return this.set.has(`${t.x}x${t.y}`)}isFirst(t){if(0===this.count)return!1;let e=this.arr[0];return null!=e&&e.x===t.x&&e.y===t.y}path(){return new v7(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(t){return this.arr[t]}get length(){return this.count}}const me={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function mr(t){return null!=t&&"number"==typeof t.radius}function mn(t,e){return mr(t)===mr(e)&&(mr(t)?t.cx===e.cx&&t.cy===e.cy&&t.radius===e.radius:t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height)}(o=u||(u={}))[o.MEMBERS=0]="MEMBERS",o[o.NON_MEMBERS=1]="NON_MEMBERS",o[o.EDGES=2]="EDGES";class mi{constructor(t={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new vZ(0,0,0,0),this.potentialArea=new v0(1,0,0,0,0,0,0),this.o=Object.assign({},me,t)}pushMember(...t){if(0!==t.length)for(let e of(this.dirty.add(u.MEMBERS),t))this.members.push({raw:e,obj:mr(e)?vQ.from(e):vZ.from(e),area:null})}removeMember(t){let e=this.members.findIndex(e=>mn(e.raw,t));return!(e<0)&&(this.members.splice(e,1),this.dirty.add(u.MEMBERS),!0)}removeNonMember(t){let e=this.nonMembers.findIndex(e=>mn(e.raw,t));return!(e<0)&&(this.nonMembers.splice(e,1),this.dirty.add(u.NON_MEMBERS),!0)}removeEdge(t){let e=this.edges.findIndex(e=>e.obj.equals(t));return!(e<0)&&(this.edges.splice(e,1),this.dirty.add(u.NON_MEMBERS),!0)}pushNonMember(...t){if(0!==t.length)for(let e of(this.dirty.add(u.NON_MEMBERS),t))this.nonMembers.push({raw:e,obj:mr(e)?vQ.from(e):vZ.from(e),area:null})}pushEdge(...t){if(0!==t.length)for(let e of(this.dirty.add(u.EDGES),t))this.edges.push({raw:e,obj:vW.from(e),area:null})}update(){let t=this.dirty.has(u.MEMBERS),e=this.dirty.has(u.NON_MEMBERS),r=this.dirty.has(u.EDGES);this.dirty.clear();let n=this.members.map(t=>t.obj);if(this.o.virtualEdges&&(t||e)){let t=function(t,e,r,n){if(0===t.length)return[];let i=function(t){if(t.length<2)return t;let e=0,r=0;return t.forEach(t=>{e+=t.cx,r+=t.cy}),e/=t.length,r/=t.length,t.map(t=>{let n=e-t.cx,i=r-t.cy;return[t,n*n+i*i]}).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}(t);return i.map((t,a)=>(function(t,e,r,n,i){let a;let o=v6(e.cx,e.cy),l=(a=Number.POSITIVE_INFINITY,r.reduce((e,r)=>{var n;let i=vU(o.x,o.y,r.cx,r.cy);if(i>a)return e;let s=(n=new vW(o.x,o.y,r.cx,r.cy),t.reduce((t,e)=>vJ(e,n)&&function(t,e){function r(t,r,n,i){let a=vK(e,new vW(t,r,n,i));return(a=Math.abs(a-.5))>=0&&a<=1?1:0}let n=r(t.x,t.y,t.x2,t.y);return!!((n+=r(t.x,t.y,t.x,t.y2))>1||(n+=r(t.x,t.y2,t.x2,t.y2))>1)||(n+=r(t.x2,t.y,t.x2,t.y2))>0}(e,n)?t+1:t,0));return i*(s+1)*(s+1)<a&&(e=r,a=i*(s+1)*(s+1)),e},null));return null==l?[]:function(t,e){let r=[];for(;t.length>0;){let n=t.pop();if(0===t.length){r.push(n);break}let i=t.pop(),a=new vW(n.x1,n.y1,i.x2,i.y2);v8(e,a)?(r.push(n),t.push(i)):t.push(a)}return r}(function(t,e,r,n){let i=[],a=[];a.push(t);let o=!0;for(let t=0;t<r&&o;t++)for(o=!1;!o&&a.length>0;){let t=a.pop(),r=v8(e,t),l=r?function(t,e){let r=0,n=vY(t,new vW(e.x,e.y,e.x2,e.y));r+=n.state===s.POINT?1:0;let i=vY(t,new vW(e.x,e.y,e.x,e.y2));r+=i.state===s.POINT?1:0;let a=vY(t,new vW(e.x,e.y2,e.x2,e.y2));r+=a.state===s.POINT?1:0;let o=vY(t,new vW(e.x2,e.y,e.x2,e.y2));return r+=o.state===s.POINT?1:0,{top:n,left:i,bottom:a,right:o,count:r}}(t,r):null;if(!r||!l||2!==l.count){o||i.push(t);continue}let u=n,h=v9(r,u,l,!0),d=v4(h,a)||v4(h,i),c=v5(h,e);for(;!d&&c&&u>=1;)u/=1.5,d=v4(h=v9(r,u,l,!0),a)||v4(h,i),c=v5(h,e);if(!h||d||c||(a.push(new vW(t.x1,t.y1,h.x,h.y)),a.push(new vW(h.x,h.y,t.x2,t.y2)),o=!0),o)continue;let f=v4(h=v9(r,u=n,l,!1),a)||v4(h,i);for(c=v5(h,e);!f&&c&&u>=1;)u/=1.5,f=v4(h=v9(r,u,l,!1),a)||v4(h,i),c=v5(h,e);h&&!f&&(a.push(new vW(t.x1,t.y1,h.x,h.y)),a.push(new vW(h.x,h.y,t.x2,t.y2)),o=!0),o||i.push(t)}for(;a.length>0;)i.push(a.pop());return i}(new vW(o.x,o.y,l.cx,l.cy),t,n,i),t)})(e,t,i.slice(0,a),r,n)).flat()}(n,this.nonMembers.map(t=>t.obj),this.o.maxRoutingIterations,this.o.morphBuffer),e=new Map(this.virtualEdges.map(t=>[t.obj.toString(),t.area]));this.virtualEdges=t.map(t=>{var r;return{raw:t,obj:t,area:null!==(r=e.get(t.toString()))&&void 0!==r?r:null}}),r=!0}let i=!1;if(t||r){let t=function(t,e){if(0===t.length)return new vZ(0,0,0,0);let r=vZ.from(t[0]);for(let e of t)r.add(e);for(let t of e)r.add(vH(t));return r}(n,this.virtualEdges.concat(this.edges).map(t=>t.obj)),e=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,r=vZ.from(v1(t,e));r.equals(this.activeRegion)||(i=!0,this.activeRegion=r)}if(i){let t=Math.ceil(this.activeRegion.width/this.o.pixelGroup),e=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=v0.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(t=>t.area=null),this.nonMembers.forEach(t=>t.area=null),this.edges.forEach(t=>t.area=null),this.virtualEdges.forEach(t=>t.area=null)):(t!==this.potentialArea.width||e!==this.potentialArea.height)&&(this.potentialArea=v0.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}let a=new Map,o=t=>{if(t.area){let e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof vZ?"R":"C"}`;a.set(e,t.area)}},l=t=>{if(t.area)return;let e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof vZ?"R":"C"}`;if(a.has(e)){let r=a.get(e);t.area=this.potentialArea.copy(r,{x:t.obj.x-this.o.nodeR1,y:t.obj.y-this.o.nodeR1});return}let r=t.obj instanceof vZ?function(t,e,r){let n=e.scale(t),i=e.addPadding(n,r),a=e.createSub(i,{x:t.x-r,y:t.y-r}),o=n.x-i.x,s=n.y-i.y,l=i.x2-n.x2,u=i.y2-n.y2,h=i.width-o-l,d=i.height-s-u,c=r*r;a.fillArea({x:o,y:s,width:h+1,height:d+1},c);let f=[0],p=Math.max(s,o,l,u);{let i=e.invertScaleX(n.x+n.width/2);for(let a=1;a<p;a++){let o=e.invertScaleY(n.y-a),s=t.distSquare(i,o);if(s<c){let t=r-Math.sqrt(s);f.push(t*t)}else break}}let g=[],y=Math.max(o,l),v=Math.max(s,l);for(let i=1;i<y;i++){let a=e.invertScaleX(n.x-i),o=[];for(let i=1;i<v;i++){let s=e.invertScaleY(n.y-i),l=t.distSquare(a,s);if(l<c){let t=r-Math.sqrt(l);o.push(t*t)}else o.push(0)}g.push(o)}for(let t=1;t<Math.min(s,f.length);t++){let e=f[t];a.fillHorizontalLine(o,s-t,h+1,e)}for(let t=1;t<Math.min(u,f.length);t++){let e=f[t];a.fillHorizontalLine(o,s+d+t,h+1,e)}for(let t=1;t<Math.min(o,f.length);t++){let e=f[t];a.fillVerticalLine(o-t,s,d+1,e)}for(let t=1;t<Math.min(u,f.length);t++){let e=f[t];a.fillVerticalLine(o+h+t,s,d+1,e)}for(let t=1;t<o;t++){let e=g[t-1],r=o-t;for(let t=1;t<s;t++)a.set(r,s-t,e[t-1]);for(let t=1;t<u;t++)a.set(r,s+d+t,e[t-1])}for(let t=1;t<l;t++){let e=g[t-1],r=o+h+t;for(let t=1;t<s;t++)a.set(r,s-t,e[t-1]);for(let t=1;t<u;t++)a.set(r,s+d+t,e[t-1])}return a}(t.obj,this.potentialArea,this.o.nodeR1):v3(t.obj,this.potentialArea,this.o.nodeR1);t.area=r,a.set(e,r)};this.members.forEach(o),this.nonMembers.forEach(o),this.members.forEach(l),this.nonMembers.forEach(t=>{this.activeRegion.intersects(t.obj)?l(t):t.area=null}),this.edges.forEach(t=>{t.area||(t.area=v2(t.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(t=>{t.area||(t.area=v2(t.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(t){for(let e of this.members)e.obj.draw(t)}drawNonMembers(t){for(let e of this.nonMembers)e.obj.draw(t)}drawEdges(t){for(let e of this.edges)e.obj.draw(t)}drawPotentialArea(t,e=!0){this.potentialArea.draw(t,e)}compute(){if(0===this.members.length)return new v7([]);this.dirty.size>0&&this.update();let{o:t,potentialArea:e}=this,r=this.members.map(t=>t.area),n=this.virtualEdges.concat(this.edges).map(t=>t.area),i=this.nonMembers.filter(t=>null!=t.area).map(t=>t.area),a=this.members.map(t=>t.obj);return function(t,e,r,n,i,a={}){let o=Object.assign({},me,a),s=o.threshold,l=o.memberInfluenceFactor,u=o.edgeInfluenceFactor,h=o.nonMemberInfluenceFactor,d=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),c=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1);for(let a=0;a<o.maxMarchingIterations;a++){if(t.clear(),0!==l){let r=l/d;for(let n of e)t.incArea(n,r)}if(0!==u){let e=u/c;for(let n of r)t.incArea(n,e)}if(0!==h){let e=h/d;for(let r of n)t.incArea(r,e)}let f=function(t,e){let r=new mt((Math.floor(t.width)+Math.floor(t.height))*2);function n(r,n,i,a){let o=t.get(r,n);return Number.isNaN(o)?Number.NaN:o>e?i+a:i}function i(t,e){let r=0;return(r=n(t,e,0,1),r=n(t+1,e,r,2),r=n(t,e+1,r,4),Number.isNaN(r=n(t+1,e+1,r,8)))?-1:r}let a=1;for(let n=0;n<t.width;n++)for(let o=0;o<t.height;o++){if(t.get(n,o)<=e)continue;let s=i(n,o);if(!(s<0)&&15!==s&&function(e,n){let o=e,s=n,l=t.invertScaleX(o),u=t.invertScaleY(s);for(let e=0;e<t.width*t.height;e++){let e={x:l,y:u};if(r.contains(e)){if(r.isFirst(e))break}else r.add(e);let n=i(o,s);switch(n){case -1:return!0;case 0:case 3:case 2:case 7:a=2;break;case 12:case 14:case 4:a=3;break;case 6:a=0===a?3:2;break;case 1:case 13:case 5:a=0;break;case 9:a=2===a?0:1;break;case 10:case 8:case 11:a=1;break;default:return console.warn("Marching squares invalid state: "+n),!0}switch(a){case 0:s--,u-=t.pixelGroup;break;case 1:s++,u+=t.pixelGroup;break;case 3:o--,l-=t.pixelGroup;break;case 2:o++,l+=t.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+n),!0}}return!0}(n,o))return r.path()}return null}(t,s);if(f&&i(f))return f;if(s*=.95,a<=.5*o.maxMarchingIterations)l*=1.2,u*=1.2;else if(0!==h&&n.length>0)h*=.8;else break}return new v7([])}(e,r,n,i,t=>t.containsElements(a),t)}}var ma=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class mo extends vB{constructor(t,e){super(t,lP({},mo.defaultOptions,e)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{let{style:t,bubbleSetOptions:e}=this.parseOptions();sd(this.bubbleSetOptions,e)||this.init(),this.bubbleSetOptions=Object.assign({},e);let r=Object.assign(Object.assign({},t),{d:this.getPath()});this.shape?this.shape.update(r):(this.shape=new uU({style:r}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=t=>{if(!this.shape)return;let e=lg(t.data);[...this.options.members,...this.options.avoidMembers].includes(e)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(e)}))},this.getPath=t=>{let{graph:e}=this.context,r=this.options.members,n=[...this.members.keys()],i=this.options.avoidMembers,a=[...this.avoidMembers.keys()];if(!t&&sd(r,n)&&sd(i,a))return this.path;let{enter:o=[],exit:s=[]}=lk(n,r,t=>t),{enter:l=[],exit:u=[]}=lk(a,i,t=>t);t&&(s.push(t),o.push(t));let h=(t,r,n)=>{t.forEach(t=>{let i=n?this.members:this.avoidMembers;if(r){let r;"edge"===e.getElementType(t)?([r]=ml(e,t),this.bubbleSets.pushEdge(r)):([r]=ms(e,t),this.bubbleSets[n?"pushMember":"pushNonMember"](r)),i.set(t,r)}else{let r=i.get(t);r&&("edge"===e.getElementType(t)?this.bubbleSets.removeEdge(r):this.bubbleSets[n?"removeMember":"removeNonMember"](r),i.delete(t))}})};h(s,!1,!0),h(o,!0,!0),h(u,!1,!1),h(l,!0,!1);let d=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=uG(d.points.map(l1)),this.path},this.bindEvents(),this.bubbleSets=new mi(this.options)}bindEvents(){this.context.graph.on(yG.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(yG.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new mi(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){let t=this.options,{type:e,key:r,members:n,avoidMembers:i}=t,a=ma(t,["type","key","members","avoidMembers"]);return Object.assign({type:e,key:r,members:n,avoidMembers:i},Object.keys(a).reduce((t,e)=>(e in me?t.bubbleSetOptions[e]=a[e]:t.style[e]=a[e],t),{style:{},bubbleSetOptions:{}}))}addMember(t){let e=Array.isArray(t)?t:[t];e.some(t=>this.options.avoidMembers.includes(t))&&(this.options.avoidMembers=this.options.avoidMembers.filter(t=>!e.includes(t))),this.options.members=[...new Set([...this.options.members,...e])],this.drawBubbleSets()}removeMember(t){let e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(t=>!e.includes(t)),this.drawBubbleSets()}updateMember(t){this.options.members=(0,sI.default)(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){let e=Array.isArray(t)?t:[t];e.some(t=>this.options.members.includes(t))&&(this.options.members=this.options.members.filter(t=>!e.includes(t))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...e])],this.drawBubbleSets()}removeAvoidMember(t){let e=Array.isArray(t)?t:[t];this.options.avoidMembers.some(t=>e.includes(t))&&(this.options.avoidMembers=this.options.avoidMembers.filter(t=>!e.includes(t)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(yG.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(yG.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}mo.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},me);const ms=(t,e)=>(Array.isArray(e)?e:[e]).map(e=>{let r=t.getElementRenderBounds(e);return new vZ(r.min[0],r.min[1],sV(r),sG(r))}),ml=(t,e)=>(Array.isArray(e)?e:[e]).map(e=>{let r=t.getEdgeData(e),n=t.getElementPosition(r.source),i=t.getElementPosition(r.target);return vW.from({x1:n[0],y1:n[1],x2:i[0],y2:i[1]})}),mu=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`;var mh=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class md extends vB{constructor(t,e){super(t,Object.assign({},md.defaultOptions,e)),this.targetElement=null,this.onTriggerEvent=t=>{var e;null===(e=t.preventDefault)||void 0===e||e.call(t),this.show(t)},this.onMenuItemClick=t=>{let{onClick:e,trigger:r}=this.options;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){let r=t.target.getAttribute("value");null==e||e(r,t.target,this.targetElement),this.hide()}"click"!==r&&this.hide()},this.initElement(),this.update(e)}initElement(){this.$element=vz("contextmenu",!1,{zIndex:"99"});let{className:t}=this.options;t&&this.$element.classList.add(t),this.context.canvas.getContainer().appendChild(this.$element),vV("g6-contextmenu-css","style",{},mu,document.head)}show(t){return mh(this,void 0,void 0,function*(){let{enable:e,offset:r}=this.options;if("function"==typeof e&&!e(t)||!e){this.hide();return}let n=yield this.getDOMContent(t);n instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(n)):this.$element.innerHTML=n;let i=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-i.left+r[0]}px`,this.$element.style.top=`${t.client.y-i.top+r[1]}px`,this.$element.style.display="block",this.targetElement=t.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return mh(this,void 0,void 0,function*(){let{getContent:e,getItems:r}=this.options;if(r){var n;return n=yield r(t),`
    <ul class="g6-contextmenu-ul">
      ${n.map(t=>`<li  class="g6-contextmenu-li" value="${t.value}">${t.name}</li>`).join("")}
    </ul>
  `}return yield e(t)})}bindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.on(`canvas:${e}`,this.onTriggerEvent),t.on(`node:${e}`,this.onTriggerEvent),t.on(`edge:${e}`,this.onTriggerEvent),t.on(`combo:${e}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){let{graph:t}=this.context,{trigger:e}=this.options;t.off(`canvas:${e}`,this.onTriggerEvent),t.off(`node:${e}`,this.onTriggerEvent),t.off(`edge:${e}`,this.onTriggerEvent),t.off(`combo:${e}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}md.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class mc extends vB{constructor(t,e){super(t,Object.assign({},mc.defaultOptions,e)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{let{model:t,element:e}=this.context,r=t.getEdgeData();this.divideEdges(this.options.divisions);let{cycles:n,iterRate:i,divRate:a}=this.options,{lambda:o,divisions:s,iterations:l}=this.options;for(let t=0;t<n;t++){for(let t=0;t<l;t++){let t={};r.forEach(e=>{var r;if(e.source===e.target)return;let n=lg(e);t[n]=this.getEdgeForces(e,s,o);for(let e=0;e<s+1;e++)(r=this.edgePoints)[n]||(r[n]=[]),this.edgePoints[n][e]=lL(this.edgePoints[n][e],t[n][e])})}o/=2,s*=a,l*=i,this.divideEdges(s)}r.forEach(t=>{let r=lg(t),n=e.getElement(r);null==n||n.update({d:dD(this.edgePoints[r])})})},this.bindEvents()}get nodeMap(){return Object.fromEntries(this.context.model.getNodeData().map(t=>[lg(t),lW(lZ(t))]))}divideEdges(t){this.context.model.getEdgeData().forEach(e=>{var r;let n=lg(e);(r=this.edgePoints)[n]||(r[n]=[]);let i=this.nodeMap[e.source],a=this.nodeMap[e.target];if(1===t)this.edgePoints[n].push(i),this.edgePoints[n].push(lB(lL(i,a),2)),this.edgePoints[n].push(a);else{let e=(0===this.edgePoints[n].length?lV(i,a):mb(this.edgePoints[n]))/(t+1),r=e,o=[i];for(let t=1;t<this.edgePoints[n].length;t++){let i=this.edgePoints[n][t-1],a=this.edgePoints[n][t],s=lV(a,i);for(;s>r;){let t=r/s,n=lL(i,lF(lj(a,i),t));o.push(n),s-=r,r=e}r-=s}o.push(a),this.edgePoints[n]=o}})}getVectorPosition(t){let e=this.nodeMap[t.source],r=this.nodeMap[t.target],[n,i]=lj(r,e),a=lV(e,r);return{source:e,target:r,vx:n,vy:i,length:a}}measureEdgeCompatibility(t,e){let r=this.getVectorPosition(t),n=this.getVectorPosition(e),i=mf(r,n);return i*mp(r,n)*mg(r,n)*mm(r,n)}getEdgeBundles(){let t={},e=this.options.bundleThreshold,r=this.context.model.getEdgeData();return r.forEach((n,i)=>{r.forEach((r,a)=>{var o,s;!(a<=i)&&this.measureEdgeCompatibility(n,r)>=e&&(t[o=lg(n)]||(t[o]=[]),t[lg(n)].push(r),t[s=lg(r)]||(t[s]=[]),t[lg(r)].push(n))})}),t}getSpringForce(t,e){let{pre:r,cur:n,next:i}=t;return lF(lj(lL(r,i),lF(n,2)),e)}getElectrostaticForce(t,e){uD(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());let r=this.edgeBundles[lg(e)],n=[0,0];return null==r||r.forEach(r=>{let i=this.edgePoints[lg(r)][t],a=this.edgePoints[lg(e)][t],o=lj(i,a),s=lV(i,a);n=lL(n,lF(o,1/s))}),n}getEdgeForces(t,e,r){let n=this.nodeMap[t.source],i=this.nodeMap[t.target],a=this.options.K/(lV(n,i)*(e+1)),o=[[0,0]],s=lg(t);for(let n=1;n<e;n++){let e=this.getSpringForce({pre:this.edgePoints[s][n-1],cur:this.edgePoints[s][n],next:this.edgePoints[s][n+1]||[0,0]},a),i=this.getElectrostaticForce(n,t);o.push(lF(lL(e,i),r))}return o.push([0,0]),o}bindEvents(){let{graph:t}=this.context;t.on(yG.AFTER_RENDER,this.onBundle)}unbindEvents(){let{graph:t}=this.context;t.off(yG.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}mc.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const mf=(t,e)=>{var r,n;return Math.abs((r=[t.vx,t.vy],n=[e.vx,e.vy],r.reduce((t,e,r)=>t+e*n[r],0)/(t.length*e.length)))},mp=(t,e)=>{let r=(t.length+e.length)/2;return 2/(r/Math.min(t.length,e.length)+Math.max(t.length,e.length)/r)},mg=(t,e)=>{let r=(t.length+e.length)/2;return r/(r+lV(lB(lL(t.source,t.target),2),lB(lL(e.source,e.target),2)))},my=(t,e)=>{if(e.source[0]===e.target[0])return[e.source[0],t[1]];if(e.source[1]===e.target[1])return[t[0],e.source[1]];let r=(e.source[1]-e.target[1])/(e.source[0]-e.target[0]),n=(r*r*e.source[0]+r*(t[1]-e.source[1])+t[0])/(r*r+1),i=r*(n-e.source[0])+e.source[1];return[n,i]},mv=(t,e)=>{let r=my(e.source,t),n=my(e.target,t),i=lB(lL(r,n),2),a=lB(lL(t.source,t.target),2);return 0===lV(r,n)?0:Math.max(0,1-2*lV(a,i)/lV(r,n))},mm=(t,e)=>Math.min(mv(t,e),mv(e,t)),mb=t=>{let e=0;for(let r=1;r<t.length;r++)e+=lV(t[r],t[r-1]);return e},mx={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0};class mE extends vB{constructor(t,e){super(t,Object.assign({},mE.defaultOptions,e)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;let e=l1(t.canvas);this.renderLens(e),this.renderFocusElements()},this.renderLens=t=>{let e=Object.assign({},mx,this.options.style);this.isLensOn||(this.lens=new u0({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,l2(t),{size:2*this.r}),this.lens.update(e)},this.getFilterData=()=>{let{filter:t}=this.options,{model:e}=this.context,r=e.getData();if(!t)return r;let{nodes:n,edges:i,combos:a}=r;return{nodes:n.filter(e=>t(lg(e),"node")),edges:i.filter(e=>t(lg(e),"edge")),combos:a.filter(e=>t(lg(e),"combo"))}},this.getFocusElements=t=>{let{nodes:e,edges:r}=this.getFilterData(),n=e.filter(e=>lV(lZ(e),t)<this.r),i=n.map(t=>lg(t));return{nodes:n,edges:r.filter(t=>{let{source:e,target:r}=t,n=i.includes(e),a=i.includes(r);switch(this.options.nodeType){case"both":return n&&a;case"either":return n!==a;case"source":return n&&!a;case"target":return!n&&a;default:return!1}})}},this.renderFocusElements=()=>{let{element:t,graph:e}=this.context;if(!this.isLensOn)return;let r=this.lens.getCenter(),{nodes:n,edges:i}=this.getFocusElements(r),a=new Set,o=r=>{let n=lg(r);a.add(n);let i=t.getElement(n);if(!i)return;let o=this.shapes.get(n)||i.cloneNode();o.setPosition(i.getPosition()),o.id=i.id,this.shapes.has(n)?Object.entries(i.attributes).forEach(([t,e])=>{o.style[t]!==e&&(o.style[t]=e)}):(this.canvas.appendChild(o),this.shapes.set(n,o));let s=e.getElementType(n),l=this.getElementStyle(s,r);o.update(l)};n.forEach(o),i.forEach(o),this.shapes.forEach((t,e)=>{a.has(e)||(t.destroy(),this.shapes.delete(e))})},this.scaleRByWheel=t=>{var e;this.options.preventDefault&&t.preventDefault();let{clientX:r,clientY:n,deltaX:i,deltaY:a}=t,{graph:o,canvas:s}=this.context,l=o.getCanvasByClient([r,n]),u=null===(e=this.lens)||void 0===e?void 0:e.getCenter();if(!this.isLensOn||lV(l,u)>this.r)return;let{maxR:h,minR:d}=this.options,c=Math.min(...s.getSize())/2;this.r=Math.max(d||0,Math.min(h||c,this.r*(i+a>0?1.0526315789473684:.95))),this.renderLens(u),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=t=>{var e;let r=l1(t.canvas),n=null===(e=this.lens)||void 0===e?void 0:e.getCenter();!this.isLensOn||lV(r,n)>this.r||(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;let e=l1(t.canvas);this.renderLens(e),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,e){let r="node"===t?this.options.nodeStyle:this.options.edgeStyle;return"function"==typeof r?r(e):r}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;let{graph:e}=this.context,{trigger:r,scaleRBy:n}=this.options,i=e.getCanvas().getLayer();["click","drag"].includes(r)&&i.addEventListener(yB.CLICK,this.onEdgeFilter),"pointermove"===r?i.addEventListener(yB.POINTER_MOVE,this.onEdgeFilter):"drag"===r&&(i.addEventListener(yB.DRAG_START,this.onDragStart),i.addEventListener(yB.DRAG,this.onDrag),i.addEventListener(yB.DRAG_END,this.onDragEnd)),"wheel"===n&&(null===(t=this.graphDom)||void 0===t||t.addEventListener(yB.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var t;let{graph:e}=this.context,{trigger:r,scaleRBy:n}=this.options,i=e.getCanvas().getLayer();["click","drag"].includes(r)&&i.removeEventListener(yB.CLICK,this.onEdgeFilter),"pointermove"===r?i.removeEventListener(yB.POINTER_MOVE,this.onEdgeFilter):"drag"===r&&(i.removeEventListener(yB.DRAG_START,this.onDragStart),i.removeEventListener(yB.DRAG,this.onDrag),i.removeEventListener(yB.DRAG_END,this.onDragEnd)),"wheel"===n&&(null===(t=this.graphDom)||void 0===t||t.removeEventListener(yB.WHEEL,this.scaleRByWheel))}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((t,e)=>{t.destroy(),this.shapes.delete(e)}),super.destroy()}}mE.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const mw={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12};class m_ extends vB{constructor(t,e){super(t,Object.assign({},m_.defaultOptions,e)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;let e=l1(t.canvas);this.onMagnify(e)},this.onMagnify=t=>{t.some(isNaN)||(this.renderLens(t),this.renderFocusElements())},this.renderLens=t=>{let e=Object.assign({},mw,this.options.style);this.isLensOn||(this.lens=new u0({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,l2(t),{size:2*this.r,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(e)},this.getDPercent=()=>{let{minD:t,maxD:e}=this.options,r=Math.round((this.d-t)/(e-t)*100);return`${r}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;let{graph:t}=this.context,e=this.lens.getCenter(),r=(this.d+1)*this.r,n=new Map,i=new Map;t.getNodeData().forEach(a=>{let o=lZ(a),s=lV(o,e);if(s>this.r)return;let l=r*s/(this.d*s+this.r),[u,h]=o,[d,c]=e,f=lg(a),p=this.getNodeStyle(a),g=dd(t.getElementRenderStyle(f),Object.keys(p));n.set(f,Object.assign(Object.assign({},l2([d+(u-d)/s*l,c+(h-c)/s*l])),p)),i.set(f,Object.assign(Object.assign({},l2(o)),g))}),this.updateStyle(n,i)},this.getNodeStyle=t=>{let{nodeStyle:e}=this.options;return"function"==typeof e?e(t):e},this.updateStyle=(t,e)=>{let{graph:r,element:n}=this.context,{enter:i,exit:a,keep:o}=lk(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(t.keys()),t=>t),s=new Set,l=(t,e)=>{let i=n.getElement(t);null==i||i.update(e),r.getRelatedEdgesData(t).forEach(t=>{s.add(lg(t))})};[...i,...o].forEach(e=>{l(e,t.get(e))}),a.forEach(t=>{l(t,this.prevOriginStyleMap.get(t)),this.prevOriginStyleMap.delete(t)}),s.forEach(t=>{let e=n.getElement(t);null==e||e.update({})}),this.prevMagnifiedStyleMap=t,e.forEach((t,e)=>{this.prevOriginStyleMap.has(e)||this.prevOriginStyleMap.set(e,t)})},this.isWheelValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;let{clientX:e,clientY:r}=t;return!(lV(this.context.graph.getCanvasByClient([e,r]),this.lens.getCenter())>this.r)},this.scaleR=t=>{let{maxR:e,minR:r}=this.options,n=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(r||0,Math.min(e||n,this.r*(t?1.0526315789473684:.95)))},this.scaleD=t=>{let{maxD:e,minD:r}=this.options,n=t?this.d+.1:this.d-.1;this.d=Math.max(r,Math.min(e,n))},this.scaleRByWheel=t=>{if(!this.isWheelValid(t))return;let{deltaX:e,deltaY:r}=t;this.scaleR(e+r>0);let n=this.lens.getCenter();this.onMagnify(n)},this.scaleDByWheel=t=>{if(!this.isWheelValid(t))return;let{deltaX:e,deltaY:r}=t;this.scaleD(e+r>0);let n=this.lens.getCenter();this.onMagnify(n)},this.isDragValid=t=>(this.options.preventDefault&&t.preventDefault(),!!this.isLensOn&&!(lV(l1(t.canvas),this.lens.getCenter())>this.r)),this.isLensDragging=!1,this.onDragStart=t=>{this.isDragValid(t)&&(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;let e=l1(t.canvas);this.onMagnify(e)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=t=>{if(!this.isLensDragging)return;let{dx:e,dy:r}=t;this.scaleR(e-r>0);let n=this.lens.getCenter();this.onMagnify(n)},this.scaleDByDrag=t=>{if(!this.isLensDragging)return;let{dx:e,dy:r}=t;this.scaleD(e-r>0);let n=this.lens.getCenter();this.onMagnify(n)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var t;let{graph:e}=this.context,{trigger:r,scaleRBy:n,scaleDBy:i}=this.options,a=e.getCanvas().getLayer();if(["click","drag"].includes(r)&&a.addEventListener(yB.CLICK,this.onCreateFisheye),"pointermove"===r&&a.addEventListener(yB.POINTER_MOVE,this.onCreateFisheye),"drag"===r||"drag"===n||"drag"===i){a.addEventListener(yB.DRAG_START,this.onDragStart),a.addEventListener(yB.DRAG_END,this.onDragEnd);let t="drag"===r?this.onDrag:"drag"===n?this.scaleRByDrag:this.scaleDByDrag;a.addEventListener(yB.DRAG,t)}if("wheel"===n||"wheel"===i){let e="wheel"===n?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.addEventListener(yB.WHEEL,e,{passive:!1})}}unbindEvents(){var t;let{graph:e}=this.context,{trigger:r,scaleRBy:n,scaleDBy:i}=this.options,a=e.getCanvas().getLayer();if(["click","drag"].includes(r)&&a.removeEventListener(yB.CLICK,this.onCreateFisheye),"pointermove"===r&&a.removeEventListener(yB.POINTER_MOVE,this.onCreateFisheye),"drag"===r||"drag"===n||"drag"===i){a.removeEventListener(yB.DRAG_START,this.onDragStart),a.removeEventListener(yB.DRAG_END,this.onDragEnd);let t="drag"===r?this.onDrag:"drag"===n?this.scaleRByDrag:this.scaleDByDrag;a.removeEventListener(yB.DRAG,t)}if("wheel"===n||"wheel"===i){let e="wheel"===n?this.scaleRByWheel:this.scaleDByWheel;null===(t=this.graphDom)||void 0===t||t.removeEventListener(yB.WHEEL,e)}}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){var t;this.unbindEvents(),this.isLensOn&&(null===(t=this.lens)||void 0===t||t.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}m_.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class mS extends vB{constructor(t,e){super(t,Object.assign({},mS.defaultOptions,e)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var t,e,r,n;let i=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(i),i?null===(e=(t=this.options).onEnter)||void 0===e||e.call(t):null===(n=(r=this.options).onExit)||void 0===n||n.call(r)},this.shortcut=new ur(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();let{request:t=[],exit:e=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(e,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.addEventListener(t,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.removeEventListener(t,this.onFullscreenChange,!1)})}setGraphSize(t=!0){var e,r;let n,i;t?(n=(null===(e=globalThis.screen)||void 0===e?void 0:e.width)||0,i=(null===(r=globalThis.screen)||void 0===r?void 0:r.height)||0,this.graphSize=this.context.graph.getSize()):[n,i]=this.graphSize,this.context.graph.setSize(n,i),this.context.graph.render()}request(){!document.fullscreenElement&&(document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled"))&&this.$el.requestFullscreen().catch(t=>{sx.warn(`Error attempting to enable full-screen: ${t.message} (${t.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}mS.defaultOptions={trigger:{},autoFit:!0};class mk extends vB{constructor(t,e){super(t,Object.assign({},mk.defaultOptions,e)),this.$element=vz("grid-line",!0),this.offset=[0,0],this.onTransform=t=>{if(!this.options.follow)return;let{data:{translate:e}}=t;e&&this.updateOffset(e)},this.context.canvas.getContainer().prepend(this.$element),this.updateStyle(),this.bindEvents()}update(t){super.update(t),this.updateStyle()}bindEvents(){let{graph:t}=this.context;t.on(yG.AFTER_TRANSFORM,this.onTransform)}updateStyle(){let{size:t,stroke:e,lineWidth:r,border:n,borderLineWidth:i,borderStroke:a,borderStyle:o}=this.options;Object.assign(this.$element.style,{border:n?`${i}px ${o} ${a}`:"none",backgroundImage:`linear-gradient(${e} ${r}px, transparent ${r}px), linear-gradient(90deg, ${e} ${r}px, transparent ${r}px)`,backgroundSize:`${t}px ${t}px`})}updateOffset(t){var e,r;this.offset=(e=lL(this.offset,t),r=this.options.size,e.map(t=>t%r)),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}destroy(){this.context.graph.off(yG.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}mk.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};var sc=y("6JKSc");function mN(t){let e={Added:new Map,Updated:new Map,Removed:new Map};return t.forEach(t=>{let{type:r,value:n}=t,i=lg(n);if("NodeAdded"===r||"EdgeAdded"===r||"ComboAdded"===r)e.Added.set(i,t);else if("NodeUpdated"===r||"EdgeUpdated"===r||"ComboUpdated"===r){if(e.Added.has(i))e.Added.set(i,{type:r.replace("Updated","Added"),value:n});else if(e.Updated.has(i)){let{original:t}=e.Updated.get(i);e.Updated.set(i,{type:r,value:n,original:t})}else e.Removed.has(i)||e.Updated.set(i,t)}else("NodeRemoved"===r||"EdgeRemoved"===r||"ComboRemoved"===r)&&(e.Added.has(i)?e.Added.delete(i):(e.Updated.has(i)&&e.Updated.delete(i),e.Removed.set(i,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function mO(t){let{NodeAdded:e=[],NodeUpdated:r=[],NodeRemoved:n=[],EdgeAdded:i=[],EdgeUpdated:a=[],EdgeRemoved:o=[],ComboAdded:s=[],ComboUpdated:l=[],ComboRemoved:u=[]}=sD(t,t=>t.type);return{add:{nodes:e,edges:i,combos:s},update:{nodes:r,edges:a,combos:l},remove:{nodes:n,edges:o,combos:u}}}class mT extends vB{constructor(t,e){super(t,Object.assign({},mT.defaultOptions,e)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(t,e=!0)=>{var r,n,i;this.freezed=!0,null===(n=(r=this.options).executeCommand)||void 0===n||n.call(r,t);let a=e?t.original:t.current;this.context.graph.addData(a.add),this.context.graph.updateData(a.update),this.context.graph.removeData(ly(a.remove,!1)),null===(i=this.context.element)||void 0===i||i.draw({silence:!0,animation:t.animation}),this.freezed=!1},this.addCommand=t=>{var e;if(!this.freezed){if(t.type===yG.AFTER_DRAW){let{dataChanges:r=[],animation:n=!0}=t.data;if(null===(e=this.context.batch)||void 0===e?void 0:e.isBatching){if(!this.batchChanges)return;this.batchChanges.push(r),this.batchAnimation&&(this.batchAnimation=n);return}this.batchChanges=[r],this.batchAnimation=n}this.undoStackPush(function(t,e=!1,r){let n={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:a,remove:o}=mO(mN(t));return["nodes","edges","combos"].forEach(t=>{a[t]&&a[t].forEach(e=>{var i,a;let o=Object.assign({},e.value),s=Object.assign({},e.original);if(r){let t=r.graph.getElementType(lg(e.original)),n="edge"===t?"stroke":"fill",i=r.element.getElementComputedStyle(t,e.original);s=Object.assign(Object.assign({},e.original),{style:Object.assign({[n]:i[n]},e.original.style)})}(function t(e,r){for(let n in e)(0,sc.default)(e[n])&&!Array.isArray(e[n])&&null!==e[n]?(r[n]||(r[n]={}),t(e[n],r[n])):void 0===r[n]&&(r[n]=sS(n))})(o,s),(i=n.current.update)[t]||(i[t]=[]),n.current.update[t].push(o),(a=n.original.update)[t]||(a[t]=[]),n.original.update[t].push(s)}),i[t]&&i[t].forEach(e=>{var r,i;let a=Object.assign({},e.value);(r=n.current.add)[t]||(r[t]=[]),n.current.add[t].push(a),(i=n.original.remove)[t]||(i[t]=[]),n.original.remove[t].push(a)}),o[t]&&o[t].forEach(e=>{var r,i;let a=Object.assign({},e.value);(r=n.current.remove)[t]||(r[t]=[]),n.current.remove[t].push(a),(i=n.original.add)[t]||(i[t]=[]),n.original.add[t].push(a)})}),n}(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(y$.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=t=>{let{initiate:e}=t.data;this.batchAnimation=!1,e?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)},this.emitter=new cT;let{graph:r}=this.context;r.on(yG.AFTER_DRAW,this.addCommand),r.on(yG.BATCH_START,this.initBatchCommand),r.on(yG.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var t,e,r,n;let i=this.undoStack.pop();if(i){if(this.executeCommand(i),!1===(null===(e=(t=this.options).beforeAddCommand)||void 0===e?void 0:e.call(t,i,!1)))return;this.redoStack.push(i),null===(n=(r=this.options).afterAddCommand)||void 0===n||n.call(r,i,!1),this.notify(y$.UNDO,i)}return this}redo(){let t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(y$.REDO,t)),this}undoAndCancel(){let t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(y$.CANCEL,t)),this}undoStackPush(t){var e,r,n,i;let{stackSize:a}=this.options;0!==a&&this.undoStack.length>=a&&this.undoStack.shift(),!1!==(null===(r=(e=this.options).beforeAddCommand)||void 0===r?void 0:r.call(e,t,!0))&&(this.undoStack.push(t),null===(i=(n=this.options).afterAddCommand)||void 0===i||i.call(n,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(y$.CLEAR,null)}notify(t,e){this.emitter.emit(t,{cmd:e}),this.emitter.emit(y$.CHANGE,{cmd:e})}on(t,e){this.emitter.on(t,e)}destroy(){let{graph:t}=this.context;t.off(yG.AFTER_DRAW,this.addCommand),t.off(yG.BATCH_START,this.initBatchCommand),t.off(yG.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}mT.defaultOptions={stackSize:0};var sI=y("ky7aH"),mM={},mA={};function mC(t,e,r,n,i,a){let o=(a-e)*(r-t)-(n-e)*(i-t);return o>0||!(o<0)}mA=function(t,e){let r=t[0][0],n=t[0][1],i=t[1][0],a=t[1][1],o=e[0][0],s=e[0][1],l=e[1][0],u=e[1][1];return mC(r,n,o,s,l,u)!==mC(i,a,o,s,l,u)&&mC(r,n,i,a,o,s)!==mC(r,n,i,a,l,u)};var mR={};function mI(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(let e=0;e<t.length;e++){let r=t[e],n=this.coordToCellNum(r[0]),i=this.coordToCellNum(r[1]);if(this._cells[n])this._cells[n][i]?this._cells[n][i].push(r):this._cells[n][i]=[r];else{let t=[];t[i]=[r],this._cells[n]=t}}}mI.prototype={cellPoints:function(t,e){return void 0!==this._cells[t]&&void 0!==this._cells[t][e]?this._cells[t][e]:[]},rangePoints:function(t){let e=this.coordToCellNum(t[0]),r=this.coordToCellNum(t[1]),n=this.coordToCellNum(t[2]),i=this.coordToCellNum(t[3]),a=[];for(let t=e;t<=n;t++)for(let e=r;e<=i;e++)for(let r=0;r<this.cellPoints(t,e).length;r++)a.push(this.cellPoints(t,e)[r]);return a},removePoint:function(t){let e;let r=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),i=this._cells[r][n];for(let r=0;r<i.length;r++)if(i[r][0]===t[0]&&i[r][1]===t[1]){e=r;break}return i.splice(e,1),i},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}},mR=function(t,e){return new mI(t,e)};var mP={};mP={toXy:function(t,e){return void 0===e?t.slice():t.map(function(t){return Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(t)})},fromXy:function(t,e){return void 0===e?t.slice():t.map(function(t){return Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(t)})}};var mD={};function mL(t,e,r){return(e[0]-t[0])*(r[1]-t[1])-(e[1]-t[1])*(r[0]-t[0])}function mj(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function mF(t,e,r){let n=[e[0]-t[0],e[1]-t[1]],i=[r[0]-t[0],r[1]-t[1]];return(n[0]*i[0]+n[1]*i[1])/Math.sqrt(mj(t,e)*mj(t,r))}function mB(t,e){for(let r=0;r<e.length-1;r++){let n=[e[r],e[r+1]];if((t[0][0]!==n[0][0]||t[0][1]!==n[0][1])&&(t[0][0]!==n[1][0]||t[0][1]!==n[1][1])&&mA(t,n))return!0}return!1}mD=function(t){let e=function(t){let e=[];for(let r=0;r<t.length;r++){for(;e.length>=2&&0>=mL(e[e.length-2],e[e.length-1],t[r]);)e.pop();e.push(t[r])}return e.pop(),e}(t),r=(function(t){let e=t.reverse(),r=[];for(let t=0;t<e.length;t++){for(;r.length>=2&&0>=mL(r[r.length-2],r[r.length-1],e[t]);)r.pop();r.push(e[t])}return r.pop(),r})(t).concat(e);return r.push(t[0]),r};const mz=Math.cos(90/(180/Math.PI));mM=function(t,e,r){let n=function(t){let e=[t[0]],r=t[0];for(let n=1;n<t.length;n++){let i=t[n];(r[0]!==i[0]||r[1]!==i[1])&&e.push(i),r=i}return e}(mP.toXy(t,r).sort(function(t,e){return t[0]-e[0]||t[1]-e[1]}));if(n.length<4){let t=n.concat([n[0]]);return r?mP.fromXy(t,r):t}let i=function(t){let e=1/0,r=1/0,n=-1/0,i=-1/0;for(let a=t.length-1;a>=0;a--)t[a][0]<e&&(e=t[a][0]),t[a][1]<r&&(r=t[a][1]),t[a][0]>n&&(n=t[a][0]),t[a][1]>i&&(i=t[a][1]);return[n-e,i-r]}(n),a=[.6*i[0],.6*i[1]],o=mD(n),s=n.filter(function(t){return 0>o.indexOf(t)}),l=Math.ceil(1/(n.length/(i[0]*i[1]))),u=function t(e,r,n,i,a){let o=!1;for(let t=0;t<e.length-1;t++){let s,l,u;let h=[e[t],e[t+1]],d=h[0][0]+","+h[0][1]+","+h[1][0]+","+h[1][1];if(mj(h[0],h[1])<r||a.has(d))continue;let c=0,f=[Math.min(h[0][0],h[1][0]),Math.min(h[0][1],h[1][1]),Math.max(h[0][0],h[1][0]),Math.max(h[0][1],h[1][1])];do s=(f=i.extendBbox(f,c))[2]-f[0],l=f[3]-f[1],u=function(t,e,r){let n=null,i=mz,a=mz,o,s;for(let l=0;l<e.length;l++)o=mF(t[0],t[1],e[l]),s=mF(t[1],t[0],e[l]),o>i&&s>a&&!mB([t[0],e[l]],r)&&!mB([t[1],e[l]],r)&&(i=o,a=s,n=e[l]);return n}(h,i.rangePoints(f),e),c++;while(null===u&&(n[0]>s||n[1]>l))s>=n[0]&&l>=n[1]&&a.add(d),null!==u&&(e.splice(t+1,0,u),i.removePoint(u),o=!0)}return o?t(e,r,n,i,a):e}(o,Math.pow(e||20,2),a,mR(s,l),new Set);return r?mP.fromXy(u,r):u};const mV=(t,e,r)=>{if("sharp"===r)return[["M",t[0]-e,t[1]-e],["L",t[0]+e,t[1]-e],["L",t[0]+e,t[1]+e],["L",t[0]-e,t[1]+e],["Z"]];let n=[e,e,0,0,0];return[["M",t[0],t[1]-e],["A",...n,t[0],t[1]+e],["A",...n,t[0],t[1]-e]]},mG=(t,e,r)=>{let n=[e,e,0,0,0],i="sharp"===r?lL(t[0],lz(l$(lj(t[0],t[1])),e)):t[0],a="sharp"===r?lL(t[1],lz(l$(lj(t[1],t[0])),e)):t[1],o=lz(l$(lH(lj(i,a),!1)),e),s=lz(o,-1),l=lL(i,o),u=lL(a,o),h=lL(a,s),d=lL(i,s);return"sharp"===r?[["M",l[0],l[1]],["L",u[0],u[1]],["L",h[0],h[1]],["L",d[0],d[1]],["Z"]]:[["M",l[0],l[1]],["L",u[0],u[1]],["A",...n,h[0],h[1]],["L",d[0],d[1]],["A",...n,l[0],l[1]]]},m$=(t,e)=>{let r=l7(t).map((r,n)=>{let i=(n-2+t.length)%t.length,a=(n-1+t.length)%t.length,o=(n+1)%t.length,s=t[i],l=t[a],u=t[o],h=lj(s,l),d=lj(l,r),c=lj(r,u),f=(t,e)=>lU(t,e,!0)<Math.PI,p=f(h,d),g=f(d,c),y=t=>lz(l$(lH(t,!1)),e),v=y(d);return[{p:lW(p?lL(l,y(h)):lL(l,v)),concave:p&&l},{p:lW(g?lL(r,y(c)):lL(r,v)),concave:g&&r}]}),n=[e,e,0,0,0],i=r.findIndex((t,e)=>!r[(e-1+r.length)%r.length][0].concave&&!r[(e-1+r.length)%r.length][1].concave&&!t[0].concave&&!t[0].concave&&!t[1].concave),a=r.slice(i).concat(r.slice(0,i)),o=[];return a.flatMap((t,e)=>{let i=[],s=a[r.length-1];return 0===e&&i.push(["M",...s[1].p]),t[0].concave?o.push(t[0].p,t[1].p):i.push(["A",...n,...t[0].p]),t[1].concave?o.unshift(t[1].p):i.push(["L",...t[1].p]),3===o.length&&(i.pop(),i.push(["C",...o.flat()]),o=[]),i})},mU=(t,e)=>{let r=l7(t).map((e,r)=>({p:e,v:l$(lj(t[(r+1)%t.length],e))}));return r.forEach((n,i)=>{let a=r[i>0?i-1:t.length-1].v,o=l$(lL(a,lz(n.v,lU(a,n.v,!0)<Math.PI?1:-1)));n.p=lL(n.p,lz(o,e))}),uG(r.map(t=>t.p))},mH=(t,e)=>{let r=t.map((r,n)=>{let i=t[0===n?t.length-1:n-1],a=lq(lz(l$(lH(lj(i,r),!1)),e));return[lL(i,a),lL(r,a)]}).flat();return r.map((t,e)=>e%2==0?null:lX([r[(e-1)%r.length],r[e%r.length]],[r[(e+1)%r.length],r[(e+2)%r.length]],!0)).filter(Boolean).map((t,e)=>[0===e?"M":"L",t[0],t[1]]).concat([["Z"]])};var mW=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class mq extends vB{constructor(t,e){super(t,Object.assign({},mq.defaultOptions,e)),this.hullMemberIds=[],this.drawHull=()=>{if(this.shape){let t=!sd(this.optionsCache,this.options);this.shape.update(this.getHullStyle(t))}else this.shape=new uU({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);this.optionsCache=Object.assign({},this.options)},this.updateHullPath=t=>{this.shape&&this.options.members.includes(lg(t.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(t=!1)=>{let{graph:e}=this.context,r=this.getMember();if(0===r.length)return"";let n=r.map(t=>e.getNodeData(t)),i=/*@__PURE__*/f(mM)(n.map(lZ),this.options.concavity).slice(1).reverse(),a=i.flatMap(t=>n.filter(e=>sd(lZ(e),t)).map(lg));return sd(a,this.hullMemberIds)&&!t||(this.hullMemberIds=a,this.path=function(t,e,r){if(1===t.length)return mV(t[0],e,r);if(2===t.length)return mG(t,e,r);switch(r){case"smooth":return mU(t,e);case"sharp":return mH(t,e);default:return m$(t,e)}}(i,this.getPadding(),this.options.corner)),this.path},this.bindEvents()}bindEvents(){this.context.graph.on(yG.AFTER_RENDER,this.drawHull),this.context.graph.on(yG.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){let e=this.options,{members:r,padding:n,corner:i}=e;return Object.assign(Object.assign({},mW(e,["members","padding","corner"])),{d:this.getHullPath(t)})}getPadding(){let{graph:t}=this.context;return this.hullMemberIds.reduce((e,r)=>{let{halfExtents:n}=t.getElementRenderBounds(r);return Math.max(e,Math.max(n[0],n[1]))},0)+this.options.padding}addMember(t){let e=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...e])],this.shape.update({d:this.getHullPath()})}removeMember(t){let e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(t=>!e.includes(t)),e.some(t=>this.hullMemberIds.includes(t))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=(0,sI.default)(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(yG.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}mq.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};var s6=(y("7WQrb"),y("7WQrb")),on=y("2eDEB"),s6=y("7WQrb"),on=(y("2eDEB"),y("2eDEB"));function mY(t){mX(t,!0)}function mK(t){mX(t,!1)}function mX(t,e){var r=e?"visible":"hidden";!function t(e,r){r(e),e.children&&e.children.forEach(function(e){e&&t(e,r)})}(t,function(t){t.attr("visibility",r)})}var mJ=function(t){function e(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=t.apply(this,(0,s6.__spreadArray)([],(0,s6.__read)(e),!1))||this;return n.isMutationObserved=!0,n.addEventListener(on.ElementEvent.INSERTED,function(){mK(n)}),n}return(0,s6.__extends)(e,t),e}(on.Group);function mZ(t){var e=t.appendChild(new mJ({class:"offscreen"}));return mK(e),e}var s6=y("7WQrb"),sR=y("1uF5a"),mQ=function(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=5),Object.entries(e).forEach(function(i){var a=(0,s6.__read)(i,2),o=a[0],s=a[1];Object.prototype.hasOwnProperty.call(e,o)&&(s?lI(s)?(lI(t[o])||(t[o]={}),r<n?mQ(t[o],s,r+1,n):t[o]=e[o]):(0,sR.default)(s)?(t[o]=[],t[o]=t[o].concat(s)):t[o]=s:t[o]=s)})},m0=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n+=1)mQ(t,e[n]);return t};function m1(){mX(this,"hidden"!==this.attributes.visibility)}var m2=function(t){function e(e,r){void 0===r&&(r={});var n=t.call(this,m0({},{style:r},e))||this;return n.initialized=!1,n._defaultOptions=r,n}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=mZ(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;null===(t=this._offscreen)||void 0===t||t.destroy()},e.prototype.attributeChangedCallback=function(t){"visibility"===t&&m1.call(this)},e.prototype.update=function(t,e){var r;return this.attr(m0({},this.attributes,t||{})),null===(r=this.render)||void 0===r?void 0:r.call(this,this.attributes,this,e)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,e){},e.prototype.getSubShapeStyle=function(t){return t.x,t.y,t.transform,t.transformOrigin,t.class,t.className,t.zIndex,(0,s6.__rest)(t,["x","y","transform","transformOrigin","class","className","zIndex"])},e}(on.CustomElement),s6=y("7WQrb"),m3=function(){function t(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=e,this.width=r,this.height=n}return Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},t.prototype.isPointIn=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},t}(),s6=y("7WQrb"),on=y("2eDEB"),s6=y("7WQrb"),on=y("2eDEB"),m6=function(t){function e(e){void 0===e&&(e={});var r=e.style,n=(0,s6.__rest)(e,["style"]);return t.call(this,(0,s6.__assign)({style:(0,s6.__assign)({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},r)},n))||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=mZ(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;null===(t=this._offscreen)||void 0===t||t.destroy()},e}(on.Text),m5=function(){var t,e,r;function n(e,r,n,i,a,o,s){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===a&&(a=[null,null,null,null,null]),void 0===o&&(o=[]),void 0===s&&(s=[]),t.add(this),this._elements=Array.from(e),this._data=r,this._parent=n,this._document=i,this._enter=a[0],this._update=a[1],this._exit=a[2],this._merge=a[3],this._split=a[4],this._transitions=o,this._facetElements=s}return n.prototype.selectAll=function(t){var r="string"==typeof t?this._parent.querySelectorAll(t):t;return new e(r,null,this._elements[0],this._document)},n.prototype.selectFacetAll=function(t){var r="string"==typeof t?this._parent.querySelectorAll(t):t;return new e(this._elements,null,this._parent,this._document,void 0,void 0,r)},n.prototype.select=function(t){var r="string"==typeof t?this._parent.querySelectorAll(t)[0]||null:t;return new e([r],null,r,this._document)},n.prototype.append=function(t){var r=this,n="function"==typeof t?t:function(){return r.createElement(t)},i=[];if(null!==this._data){for(var a=0;a<this._data.length;a++){var o=this._data[a],s=(0,s6.__read)(Array.isArray(o)?o:[o,null],2),l=s[0],u=s[1],h=n(l,a);h.__data__=l,null!==u&&(h.__fromElements__=u),this._parent.appendChild(h),i.push(h)}return new e(i,null,this._parent,this._document)}for(var a=0;a<this._elements.length;a++){var d=this._elements[a],l=d.__data__,h=n(l,a);d.appendChild(h),i.push(h)}return new e(i,null,i[0],this._document)},n.prototype.maybeAppend=function(e,n){var i=(0,s6.__classPrivateFieldGet)(this,t,"m",r).call(this,"#"===e[0]?e:"#".concat(e),n);return i.attr("id",e),i},n.prototype.maybeAppendByClassName=function(e,n){var i=e.toString(),a=(0,s6.__classPrivateFieldGet)(this,t,"m",r).call(this,"."===i[0]?i:".".concat(i),n);return a.attr("className",i),a},n.prototype.maybeAppendByName=function(e,n){var i=(0,s6.__classPrivateFieldGet)(this,t,"m",r).call(this,'[name="'.concat(e,'"]'),n);return i.attr("name",e),i},n.prototype.data=function(t,r,n){void 0===r&&(r=function(t){return t}),void 0===n&&(n=function(){return null});for(var i,a,o,s,l,u=[],h=[],d=new Set(this._elements),c=[],f=new Set,p=new Map(this._elements.map(function(t,e){return[r(t.__data__,e),t]})),g=new Map(this._facetElements.map(function(t,e){return[r(t.__data__,e),t]})),y=(i=this._elements,a=function(t){return n(t.__data__)},o=new Map,i.forEach(function(t){var e=a(t);o.has(e)||o.set(e,[]),o.get(e).push(t)}),o),v=0;v<t.length;v++){var m=t[v],b=r(m,v),x=n(m,v);if(p.has(b)){var E=p.get(b);E.__data__=m,E.__facet__=!1,h.push(E),d.delete(E),p.delete(b)}else if(g.has(b)){var E=g.get(b);E.__data__=m,E.__facet__=!0,h.push(E),g.delete(b)}else if(y.has(b)){var w=y.get(b);c.push([m,w]);try{for(var _=(s=void 0,(0,s6.__values)(w)),S=_.next();!S.done;S=_.next()){var E=S.value;d.delete(E)}}catch(t){s={error:t}}finally{try{S&&!S.done&&(l=_.return)&&l.call(_)}finally{if(s)throw s.error}}y.delete(b)}else if(p.has(x)){var E=p.get(x);E.__toData__?E.__toData__.push(m):E.__toData__=[m],f.add(E),d.delete(E)}else u.push(m)}var k=[new e([],u,this._parent,this._document),new e(h,null,this._parent,this._document),new e(d,null,this._parent,this._document),new e([],c,this._parent,this._document),new e(f,null,this._parent,this._document)];return new e(this._elements,null,this._parent,this._document,k)},n.prototype.merge=function(t){var r=(0,s6.__spreadArray)((0,s6.__spreadArray)([],(0,s6.__read)(this._elements),!1),(0,s6.__read)(t._elements),!1),n=(0,s6.__spreadArray)((0,s6.__spreadArray)([],(0,s6.__read)(this._transitions),!1),(0,s6.__read)(t._transitions),!1);return new e(r,null,this._parent,this._document,void 0,n)},n.prototype.createElement=function(t){if(this._document)return this._document.createElement(t,{});var r=e.registry[t];return r?new r:function(t){throw Error(t)}("Unknown node type: ".concat(t))},n.prototype.join=function(t,e,r,n,i){void 0===t&&(t=function(t){return t}),void 0===e&&(e=function(t){return t}),void 0===r&&(r=function(t){return t.remove()}),void 0===n&&(n=function(t){return t}),void 0===i&&(i=function(t){return t.remove()});var a=t(this._enter),o=e(this._update),s=r(this._exit),l=n(this._merge),u=i(this._split);return o.merge(a).merge(s).merge(l).merge(u)},n.prototype.remove=function(){for(var t=this,r=0;r<this._elements.length;r++)!function(e){var r=t._elements[e],n=t._transitions[e];n?n.then(function(){return r.remove()}):r.remove()}(r);return new e([],null,this._parent,this._document,void 0,this._transitions)},n.prototype.each=function(t){for(var e=0;e<this._elements.length;e++){var r=this._elements[e],n=r.__data__;t.call(r,n,e)}return this},n.prototype.attr=function(t,e){var r="function"!=typeof e?function(){return e}:e;return this.each(function(n,i){void 0!==e&&(this[t]=r.call(this,n,i))})},n.prototype.style=function(t,e,r){void 0===r&&(r=!0);var n="function"==typeof e&&r?e:function(){return e};return this.each(function(r,i){void 0!==e&&(this.style[t]=n.call(this,r,i))})},n.prototype.styles=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=!0),this.each(function(r,n){var i=this;Object.entries(t).forEach(function(t){var a=(0,s6.__read)(t,2),o=a[0],s=a[1],l="function"==typeof s&&e?s:function(){return s};void 0!==s&&i.attr(o,l.call(i,r,n))})})},n.prototype.update=function(t,e){void 0===e&&(e=!0);var r="function"==typeof t&&e?t:function(){return t};return this.each(function(e,n){t&&this.update&&this.update(r.call(this,e,n))})},n.prototype.maybeUpdate=function(t,e){void 0===e&&(e=!0);var r="function"==typeof t&&e?t:function(){return t};return this.each(function(e,n){t&&this.update&&this.update(r.call(this,e,n))})},n.prototype.transition=function(t){var e=this._transitions;return this.each(function(r,n){e[n]=t.call(this,r,n)})},n.prototype.on=function(t,e){return this.each(function(){this.addEventListener(t,e)}),this},n.prototype.call=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t.call.apply(t,(0,s6.__spreadArray)([this._parent,this],(0,s6.__read)(e),!1)),this},n.prototype.node=function(){return this._elements[0]},n.prototype.nodes=function(){return this._elements},n.prototype.transitions=function(){return this._transitions.filter(function(t){return!!t})},n.prototype.parent=function(){return this._parent},e=n,t=new WeakSet,r=function(t,r){var n=this._elements[0],i=n.querySelector(t);if(i)return new e([i],null,this._parent,this._document);var a="string"==typeof r?this.createElement(r):r();return n.appendChild(a),new e([a],null,this._parent,this._document)},n.registry={g:on.Group,rect:on.Rect,circle:on.Circle,path:on.Path,text:m6,ellipse:on.Ellipse,image:on.Image,line:on.Line,polygon:on.Polygon,polyline:on.Polyline,html:on.HTML},n}();function m4(t){return new m5([t],null,t,t.ownerDocument)}var s6=y("7WQrb");function m8(t){return t.toString().charAt(0).toUpperCase()+t.toString().slice(1)}function m9(t,e,r){void 0===r&&(r=!0);var n,i=e||(null===(n=t.match(/^([a-z][a-z0-9]+)/))||void 0===n?void 0:n[0])||"",a=t.replace(new RegExp("^(".concat(i,")")),"");return r?a.toString().charAt(0).toLowerCase()+a.toString().slice(1):a}var m7=function(t,e){if(!(null==t?void 0:t.startsWith(e)))return!1;var r=t[e.length];return r>="A"&&r<="Z"};function bt(t,e,r){void 0===r&&(r=!1);var n={};return Object.entries(t).forEach(function(t){var i=(0,s6.__read)(t,2),a=i[0],o=i[1];if("className"===a||"class"===a);else if(m7(a,"show")&&m7(m9(a,"show"),e)!==r)a==="".concat("show").concat(m8(e))?n[a]=o:n[a.replace(new RegExp(m8(e)),"")]=o;else if(!m7(a,"show")&&m7(a,e)!==r){var s=m9(a,e);"filter"===s&&"function"==typeof o||(n[s]=o)}}),n}function be(t,e){return Object.entries(t).reduce(function(t,r){var n=(0,s6.__read)(r,2),i=n[0],a=n[1];return i.startsWith("show")?t["show".concat(e).concat(i.slice(4))]=a:t["".concat(e).concat(m8(i))]=a,t},{})}function br(t,e){void 0===e&&(e=["x","y","class","className"]);var r=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],n={},i={};return Object.entries(t).forEach(function(t){var a=(0,s6.__read)(t,2),o=a[0],s=a[1];e.includes(o)||(-1!==r.indexOf(o)?i[o]=s:n[o]=s)}),[n,i]}var s6=(y("7WQrb"),y("7WQrb")),bn=function(t,e){var r=function(t){return"".concat(e,"-").concat(t)},n=Object.fromEntries(Object.entries(t).map(function(t){var e=(0,s6.__read)(t,2),n=e[0],i=r(e[1]);return[n,{name:i,class:".".concat(i),id:"#".concat(i),toString:function(){return i}}]}));return Object.assign(n,{prefix:r}),n};function bi(t,e,r,n,i){return(void 0===n&&(n=!0),void 0===i&&(i=function(t){t.node().removeChildren()}),t)?r(e):(n&&i(e),null)}var sR=y("1uF5a"),ol=y("jyI49");function ba(t){if((0,ol.default)(t))return[t,t,t,t];if((0,sR.default)(t)){var e=t.length;if(1===e)return[t[0],t[0],t[0],t[0]];if(2===e)return[t[0],t[1],t[0],t[1]];if(3===e)return[t[0],t[1],t[2],t[1]];if(4===e)return t}return[0,0,0,0]}var bo=bn({text:"text"},"title");function bs(t){return/\S+-\S+/g.test(t)?t.split("-").map(function(t){return t[0]}):t.length>2?[t[0]]:t.split("")}function bl(t,e){var r=Object.entries(e).reduce(function(e,r){var n=(0,s6.__read)(r,2),i=n[0],a=n[1];return t.node().attr(i)||(e[i]=a),e},{});t.styles(r)}var bu=function(t){function e(e){return t.call(this,e,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return(0,s6.__extends)(e,t),e.prototype.getAvailableSpace=function(){var t=this.attributes,e=t.width,r=t.height,n=t.position,i=t.spacing,a=t.inset,o=this.querySelector(bo.text.class);if(!o)return new m3(0,0,+e,+r);var s=o.getBBox(),l=s.width,u=s.height,h=(0,s6.__read)(ba(i),4),d=h[0],c=h[1],f=h[2],p=h[3],g=(0,s6.__read)([0,0,+e,+r],4),y=g[0],v=g[1],m=g[2],b=g[3],x=bs(n);if(x.includes("i"))return new m3(y,v,m,b);x.forEach(function(t,n){var i,a;"t"===t&&(v=(i=(0,s6.__read)(0===n?[u+f,+r-u-f]:[0,+r],2))[0],b=i[1]),"r"===t&&(m=(0,s6.__read)([+e-l-p],1)[0]),"b"===t&&(b=(0,s6.__read)([+r-u-d],1)[0]),"l"===t&&(y=(a=(0,s6.__read)(0===n?[l+c,+e-l-c]:[0,+e],2))[0],m=a[1])});var E=(0,s6.__read)(ba(a),4),w=E[0],_=E[1],S=E[2],k=E[3],N=(0,s6.__read)([k+_,w+S],2),O=N[0],T=N[1];return new m3(y+k,v+w,m-O,b-T)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new m3(0,0,0,0)},e.prototype.render=function(t,e){var r,n,i,a,o,s,l,u,h,d,c,f,p,g,y,v,m=this;t.width,t.height,t.position,t.spacing;var b=(0,s6.__rest)(t,["width","height","position","spacing"]),x=(0,s6.__read)(br(b),1)[0],E=(o=t.width,s=t.height,l=t.position,h=(u=(0,s6.__read)([+o/2,+s/2],2))[0],d=u[1],f=(c=(0,s6.__read)([+h,+d,"center","middle"],4))[0],p=c[1],g=c[2],y=c[3],(v=bs(l)).includes("l")&&(f=(r=(0,s6.__read)([0,"start"],2))[0],g=r[1]),v.includes("r")&&(f=(n=(0,s6.__read)([+o,"end"],2))[0],g=n[1]),v.includes("t")&&(p=(i=(0,s6.__read)([0,"top"],2))[0],y=i[1]),v.includes("b")&&(p=(a=(0,s6.__read)([+s,"bottom"],2))[0],y=a[1]),{x:f,y:p,textAlign:g,textBaseline:y}),w=E.x,_=E.y,S=E.textAlign,k=E.textBaseline;bi(!!b.text,m4(e),function(t){m.title=t.maybeAppendByClassName(bo.text,"text").styles(x).call(bl,{x:w,y:_,textAlign:S,textBaseline:k}).node()})},e}(m2),s6=y("7WQrb"),on=y("2eDEB"),bh=function(){},on=y("2eDEB"),s6=y("7WQrb"),sI=y("ky7aH");function bd(t,e){return(0,sI.default)(t)?t.apply(void 0,(0,s6.__spreadArray)([],(0,s6.__read)(e),!1)):t}var s6=y("7WQrb"),on=y("2eDEB"),ow=y("8hhuV"),s6=y("7WQrb"),o_=y("geZBG");function bc(t){if(!t)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],r=Object.fromEntries(Object.entries(t).filter(function(t){var r=(0,s6.__read)(t,1)[0];return!e.includes(r)}));return Object.fromEntries(e.map(function(e){return"boolean"!=typeof t&&"enter"in t&&"update"in t&&"exit"in t?!1===t[e]?[e,!1]:[e,(0,s6.__assign)((0,s6.__assign)({},t[e]),r)]:[e,r]}))}function bf(t,e){t?t.finished.then(e):e()}function bp(t,e){"update"in t?t.update(e):t.attr(e)}function bg(t,e,r){return 0===e.length?null:r?t.animate(e,r):(bp(t,{style:e.slice(-1)[0]}),null)}function by(t,e,r){var n={},i={};return(Object.entries(e).forEach(function(e){var r=(0,s6.__read)(e,2),a=r[0],o=r[1];if(!(0,o_.default)(o)){var s=t.style[a]||t.parsedStyle[a]||0;s!==o&&(n[a]=s,i[a]=o)}}),r)?bg(t,[n,i],(0,s6.__assign)({fill:"both"},r)):(bp(t,i),null)}var on=y("2eDEB");function bv(t,e,r){void 0===r&&(r=!1);var n=t.getBBox(),i=e/Math.max(n.width,n.height);return r&&(t.style.transform="scale(".concat(i,")")),i}var bm=function(t,e,r){return[["M",t-r,e],["A",r,r,0,1,0,t+r,e],["A",r,r,0,1,0,t-r,e],["Z"]]},bb=function(t,e,r){return[["M",t,e+r],["L",t,e-r]]},bx=function(t,e,r){return[["M",t-r,e],["L",t+r,e]]},bE=bn({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),bw=function(t){function e(e){var r=t.call(this,e,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:[["M",-6,-6],["L",6,0],["L",-6,6],["Z"]],buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(t,e){return"".concat(t,"/").concat(e)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return r.playState="idle",r.contentGroup=r.appendChild(new on.Group({class:bE.contentGroup.name})),r.playWindow=r.contentGroup.appendChild(new on.Group({class:bE.playWindow.name})),r.innerCurrPage=r.defaultPage,r}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return(0,ow.default)(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t,e,r=this.pageViews,n=(0,s6.__read)(((null===(e=(t=r.map(function(t){var e=t.getBBox();return[e.width,e.height]}))[0])||void 0===e?void 0:e.map(function(e,r){return t.map(function(t){return t[r]})}))||[]).map(function(t){return Math.max.apply(Math,(0,s6.__spreadArray)([],(0,s6.__read)(t),!1))}),2),i=n[0],a=n[1],o=this.attributes,s=o.pageWidth,l=o.pageHeight;return{pageWidth:void 0===s?i:s,pageHeight:void 0===l?a:l}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var e=t.prototype.getBBox.call(this),r=e.x,n=e.y,i=this.controllerShape,a=this.pageShape,o=a.pageWidth,s=a.pageHeight;return new m3(r,n,o+i.width,s)},e.prototype.goTo=function(t){var e=this,r=this.attributes.animate,n=this.currPage,i=this.playState,a=this.playWindow,o=this.pageViews;if("idle"!==i||t<0||o.length<=0||t>=o.length)return null;o[n].setLocalPosition(0,0),this.prepareFollowingPage(t);var s=(0,s6.__read)(this.getFollowingPageDiff(t),2),l=s[0],u=s[1];this.playState="running";var h=bg(a,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-l,", ").concat(-u,")")}],r);return bf(h,function(){e.innerCurrPage=t,e.playState="idle",e.setVisiblePages([t]),e.updatePageInfo()}),h},e.prototype.prev=function(){var t=this.attributes.loop,e=this.pageViews.length,r=this.currPage;if(!t&&r<=0)return null;var n=t?(r-1+e)%e:(0,ow.default)(r-1,0,e);return this.goTo(n)},e.prototype.next=function(){var t=this.attributes.loop,e=this.pageViews.length,r=this.currPage;if(!t&&r>=e-1)return null;var n=t?(r+1)%e:(0,ow.default)(r+1,0,e);return this.goTo(n)},e.prototype.renderClipPath=function(t){var e=this.pageShape,r=e.pageWidth,n=e.pageHeight;if(!r||!n){this.contentGroup.style.clipPath=void 0;return}this.clipPath=t.maybeAppendByClassName(bE.clipPath,"rect").styles({width:r,height:n}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach(function(e,r){t.includes(r)?mY(e):mK(e)})},e.prototype.adjustControllerLayout=function(){var t=this.prevBtnGroup,e=this.nextBtnGroup,r=this.pageInfoGroup,n=this.attributes,i=n.orientation,a=n.controllerPadding,o=r.getBBox(),s=o.width;o.height;var l=(0,s6.__read)("horizontal"===i?[-180,0]:[-90,90],2),u=l[0],h=l[1];t.setLocalEulerAngles(u),e.setLocalEulerAngles(h);var d=t.getBBox(),c=d.width,f=d.height,p=e.getBBox(),g=p.width,y=p.height,v=Math.max(c,s,g),m="horizontal"===i?{offset:[[0,0],[c/2+a,0],[c+s+2*a,0]],textAlign:"start"}:{offset:[[v/2,-f-a],[v/2,0],[v/2,y+a]],textAlign:"center"},b=(0,s6.__read)(m.offset,3),x=(0,s6.__read)(b[0],2),E=x[0],w=x[1],_=(0,s6.__read)(b[1],2),S=_[0],k=_[1],N=(0,s6.__read)(b[2],2),O=N[0],T=N[1],M=m.textAlign,A=r.querySelector("text");A&&(A.style.textAlign=M),t.setLocalPosition(E,w),r.setLocalPosition(S,k),e.setLocalPosition(O,T)},e.prototype.updatePageInfo=function(){var t,e=this.currPage,r=this.pageViews,n=this.attributes.formatter;r.length<2||(null===(t=this.pageInfoGroup.querySelector(bE.pageInfo.class))||void 0===t||t.attr("text",n(e+1,r.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var e=this.currPage;if(e===t)return[0,0];var r=this.attributes.orientation,n=this.pageShape,i=n.pageWidth,a=n.pageHeight,o=t<e?-1:1;return"horizontal"===r?[o*i,0]:[0,o*a]},e.prototype.prepareFollowingPage=function(t){var e=this.currPage,r=this.pageViews;if(this.setVisiblePages([t,e]),t!==e){var n=(0,s6.__read)(this.getFollowingPageDiff(t),2),i=n[0],a=n[1];r[t].setLocalPosition(i,a)}},e.prototype.renderController=function(t){var e=this,r=this.attributes.controllerSpacing,n=this.pageShape,i=n.pageWidth,a=n.pageHeight,o=this.pageViews.length>=2,s=t.maybeAppendByClassName(bE.controller,"g");if(mX(s.node(),o),o){var l=bt(this.attributes,"button"),u=bt(this.attributes,"pageNum"),h=(0,s6.__read)(br(l),2),d=h[0],c=h[1],f=d.size,p=(0,s6.__rest)(d,["size"]),g=!s.select(bE.prevBtnGroup.class).node(),y=s.maybeAppendByClassName(bE.prevBtnGroup,"g").styles(c);this.prevBtnGroup=y.node();var v=y.maybeAppendByClassName(bE.prevBtn,"path"),m=s.maybeAppendByClassName(bE.nextBtnGroup,"g").styles(c);this.nextBtnGroup=m.node(),[v,m.maybeAppendByClassName(bE.nextBtn,"path")].forEach(function(t){t.styles((0,s6.__assign)((0,s6.__assign)({},p),{transformOrigin:"center"})),bv(t.node(),f,!0)});var b=s.maybeAppendByClassName(bE.pageInfoGroup,"g");this.pageInfoGroup=b.node(),b.maybeAppendByClassName(bE.pageInfo,"text").styles(u),this.updatePageInfo(),s.node().setLocalPosition(i+r,a/2),g&&(this.prevBtnGroup.addEventListener("click",function(){e.prev()}),this.nextBtnGroup.addEventListener("click",function(){e.next()}))}},e.prototype.render=function(t,e){var r=t.x,n=t.y;this.attr("transform","translate(".concat(void 0===r?0:r,", ").concat(void 0===n?0:n,")"));var i=m4(e);this.renderClipPath(i),this.renderController(i),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,e=c_(function(){return t.render(t.attributes,t)},50);this.playWindow.addEventListener(on.ElementEvent.INSERTED,e),this.playWindow.addEventListener(on.ElementEvent.REMOVED,e)},e}(m2),s6=(y("7WQrb"),y("7WQrb")),sI=(y("ky7aH"),y("ky7aH")),sc=y("6JKSc"),ou=y("kVcyu"),b_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),e.prototype.render=function(t,r){var n,i=t.x,a=void 0===i?0:i,o=t.y,s=void 0===o?0:o,l=this.getSubShapeStyle(t),u=l.symbol,h=l.size,d=void 0===h?16:h,c=(0,s6.__rest)(l,["symbol","size"]),f=["base64","url","image"].includes(n=function(t){var e="default";if((0,sc.default)(t)&&t instanceof Image)e="image";else if((0,sI.default)(t))e="symbol";else if((0,ou.default)(t)){var r=RegExp("data:(image|text)");e=t.match(r)?"base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(t)?"url":"symbol"}return e}(u))?"image":u&&"symbol"===n?"path":null;bi(!!f,m4(r),function(t){t.maybeAppendByClassName("marker",f).attr("className","marker ".concat(f,"-marker")).call(function(t){if("image"===f){var r=2*d;t.styles({img:u,width:r,height:r,x:a-d,y:s-d})}else{var r=d/2,n=(0,sI.default)(u)?u:e.getSymbol(u);t.styles((0,s6.__assign)({d:null==n?void 0:n(a,s,r)},c))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,r){e.MARKER_SYMBOL_MAP.set(t,r)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(m2);function bS(t,e,r){return void 0===t&&(t="horizontal"),"horizontal"===t?e:r}b_.registerSymbol("cross",function(t,e,r){return[["M",t-r,e-r],["L",t+r,e+r],["M",t+r,e-r],["L",t-r,e+r]]}),b_.registerSymbol("hyphen",function(t,e,r){return[["M",t-r,e],["L",t+r,e]]}),b_.registerSymbol("line",bb),b_.registerSymbol("plus",function(t,e,r){return[["M",t-r,e],["L",t+r,e],["M",t,e-r],["L",t,e+r]]}),b_.registerSymbol("tick",function(t,e,r){return[["M",t-r/2,e-r],["L",t+r/2,e-r],["M",t,e-r],["L",t,e+r],["M",t-r/2,e+r],["L",t+r/2,e+r]]}),b_.registerSymbol("circle",bm),b_.registerSymbol("point",bm),b_.registerSymbol("bowtie",function(t,e,r){var n=r-1.5;return[["M",t-r,e-n],["L",t+r,e+n],["L",t+r,e-n],["L",t-r,e+n],["Z"]]}),b_.registerSymbol("hexagon",function(t,e,r){var n=r/2*Math.sqrt(3);return[["M",t,e-r],["L",t+n,e-r/2],["L",t+n,e+r/2],["L",t,e+r],["L",t-n,e+r/2],["L",t-n,e-r/2],["Z"]]}),b_.registerSymbol("square",function(t,e,r){return[["M",t-r,e-r],["L",t+r,e-r],["L",t+r,e+r],["L",t-r,e+r],["Z"]]}),b_.registerSymbol("diamond",function(t,e,r){return[["M",t-r,e],["L",t,e-r],["L",t+r,e],["L",t,e+r],["Z"]]}),b_.registerSymbol("triangle",function(t,e,r){var n=r*Math.sin(1/3*Math.PI);return[["M",t-r,e+n],["L",t,e-n],["L",t+r,e+n],["Z"]]}),b_.registerSymbol("triangle-down",function(t,e,r){var n=r*Math.sin(1/3*Math.PI);return[["M",t-r,e-n],["L",t+r,e-n],["L",t,e+n],["Z"]]}),b_.registerSymbol("line",bb),b_.registerSymbol("dot",bx),b_.registerSymbol("dash",bx),b_.registerSymbol("smooth",function(t,e,r){return[["M",t-r,e],["A",r/2,r/2,0,1,1,t,e],["A",r/2,r/2,0,1,0,t+r,e]]}),b_.registerSymbol("hv",function(t,e,r){return[["M",t-r-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+r+1,e+2.5]]}),b_.registerSymbol("vh",function(t,e,r){return[["M",t-r-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+r+1,e-2.5]]}),b_.registerSymbol("hvh",function(t,e,r){return[["M",t-(r+1),e+2.5],["L",t-r/2,e+2.5],["L",t-r/2,e-2.5],["L",t+r/2,e-2.5],["L",t+r/2,e+2.5],["L",t+r+1,e+2.5]]}),b_.registerSymbol("vhv",function(t,e){return[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]]}),b_.registerSymbol("hiddenHandle",function(t,e,r){var n=1.4*r;return[["M",t-r,e-n],["L",t+r,e-n],["L",t+r,e+n],["L",t-r,e+n],["Z"]]}),b_.registerSymbol("verticalHandle",function(t,e,r){var n=1.4*r,i=r/2,a=r/6,o=t+.4*n;return[["M",t,e],["L",o,e+i],["L",t+n,e+i],["L",t+n,e-i],["L",o,e-i],["Z"],["M",o,e+a],["L",t+n-2,e+a],["M",o,e-a],["L",t+n-2,e-a]]}),b_.registerSymbol("horizontalHandle",function(t,e,r){var n=1.4*r,i=r/2,a=r/6,o=e+.4*n;return[["M",t,e],["L",t-i,o],["L",t-i,e+n],["L",t+i,e+n],["L",t+i,o],["Z"],["M",t-a,o],["L",t-a,e+n-2],["M",t+a,o],["L",t+a,e+n-2]]});var s6=y("7WQrb"),on=y("2eDEB"),s6=y("7WQrb");function bk(t){var e=t.getLocalBounds(),r=e.min,n=e.max,i=(0,s6.__read)([r,n],2),a=(0,s6.__read)(i[0],2),o=a[0],s=a[1],l=(0,s6.__read)(i[1],2),u=l[0],h=l[1];return{x:o,y:s,width:u-o,height:h-s,left:o,bottom:h,top:s,right:u}}function bN(t,e){var r=(0,s6.__read)(t,2),n=r[0],i=r[1],a=(0,s6.__read)(e,2),o=a[0],s=a[1];return n!==o&&i===s}var on=y("2eDEB"),bO=vL(function(t,e){var r=e.fontSize,n=e.fontFamily,i=e.fontWeight,a=e.fontStyle,o=e.fontVariant;return d?d(t,r):(h||(h=(0,on.runtime).offscreenCanvasCreator.getOrCreateContext(void 0)),h.font=[a,o,i,"".concat(r,"px"),n].join(" "),h.measureText(t).width)},function(t,e){return[t,Object.values(e||bT(t)).join()].join("")},4096),bT=function(t){var e=t.style.fontFamily||"sans-serif",r=t.style.fontWeight||"normal",n=t.style.fontStyle||"normal",i=t.style.fontVariant,a=t.style.fontSize;return{fontSize:a="object"==typeof a?a.value:a,fontFamily:e,fontWeight:r,fontStyle:n,fontVariant:i}};function bM(t){return"text"===t.nodeName?t:"g"===t.nodeName&&1===t.children.length&&"text"===t.children[0].nodeName?t.children[0]:null}function bA(t,e){var r=bM(t);r&&r.attr(e)}function bC(t,e,r){void 0===r&&(r="..."),bA(t,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:r})}var ol=y("jyI49"),ou=y("kVcyu");function bR(t){return"function"==typeof t?t():(0,ou.default)(t)||(0,ol.default)(t)?new m6({style:{text:String(t)}}):t}var bI=bn({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item"),bP=function(t){function e(e){return t.call(this,e,{span:[1,1],marker:function(){return new on.Circle({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return!!t&&("string"==typeof t||"number"==typeof t?""!==t:"function"==typeof t||""!==t.attr("text"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,e=this.valueGroup,r=this.attributes.markerSize,n=t.node().getBBox(),i=n.width,a=n.height,o=e.node().getBBox();return{markerWidth:r,labelWidth:i,valueWidth:o.width,height:Math.max(r,a,o.height)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var e=(0,s6.__read)(ba(t),2),r=e[0],n=e[1],i=this.showValue?n:0,a=r+i;return[r/a,i/a]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,e=this.attributes,r=e.markerSize,n=e.width,i=this.actualSpace,a=i.markerWidth,o=i.height,s=this.actualSpace,l=s.labelWidth,u=s.valueWidth,h=(0,s6.__read)(this.spacing,2),d=h[0],c=h[1];if(n){var f=n-r-d-c,p=(0,s6.__read)(this.span,2),g=p[0],y=p[1];l=(t=(0,s6.__read)([g*f,y*f],2))[0],u=t[1]}return{width:a+l+u+d+c,height:o,markerWidth:a,labelWidth:l,valueWidth:u}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var e=(0,s6.__read)(ba(t),2),r=e[0],n=e[1];return this.showValue?[r,n]:[r,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,e=t.markerWidth,r=t.labelWidth,n=t.valueWidth,i=t.width,a=t.height,o=(0,s6.__read)(this.spacing,2),s=o[0];return{height:a,width:i,markerWidth:e,labelWidth:r,valueWidth:n,position:[e/2,e+s,e+r+s+o[1]]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t,e=(t=this.markerGroup.node().querySelector(bI.marker.class))?t.style:{},r=this.attributes,n=r.markerSize,i=r.markerStrokeWidth,a=void 0===i?e.strokeWidth:i,o=r.markerLineWidth,s=void 0===o?e.lineWidth:o,l=r.markerStroke,u=void 0===l?e.stroke:l,h=+(a||s||(u?1:0))*Math.sqrt(2),d=this.markerGroup.node().getBBox();return(1-h/Math.max(d.width,d.height))*n},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var e=this,r=this.attributes.marker,n=bt(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(bI.markerGroup,"g").style("zIndex",0),bi(!!r,this.markerGroup,function(){var t,i=e.markerGroup.node(),a=null===(t=i.childNodes)||void 0===t?void 0:t[0],o="string"==typeof r?new b_({style:{symbol:r},className:bI.marker.name}):r();a?o.nodeName===a.nodeName?a instanceof b_?a.update((0,s6.__assign)((0,s6.__assign)({},n),{symbol:r})):(function(t,e){var r,n,i=e.attributes;try{for(var a=(0,s6.__values)(Object.entries(i)),o=a.next();!o.done;o=a.next()){var s=(0,s6.__read)(o.value,2),l=s[0],u=s[1];"id"!==l&&"className"!==l&&t.attr(l,u)}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}}(a,o),m4(a).styles(n)):(a.remove(),m4(o).attr("className",bI.marker.name).styles(n),i.appendChild(o)):(o instanceof b_||m4(o).attr("className",bI.marker.name).styles(n),i.appendChild(o)),e.markerGroup.node().scale(1/e.markerGroup.node().getScale()[0]);var s=bv(e.markerGroup.node(),e.scaleSize,!0);e.markerGroup.node().style._transform="scale(".concat(s,")")})},e.prototype.renderLabel=function(t){var e=bt(this.attributes,"label"),r=e.text,n=(0,s6.__rest)(e,["text"]);this.labelGroup=t.maybeAppendByClassName(bI.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(bI.label,function(){return bR(r)}).styles(n)},e.prototype.renderValue=function(t){var e=this,r=bt(this.attributes,"value"),n=r.text,i=(0,s6.__rest)(r,["text"]);this.valueGroup=t.maybeAppendByClassName(bI.valueGroup,"g").style("zIndex",0),bi(this.showValue,this.valueGroup,function(){e.valueGroup.maybeAppendByClassName(bI.value,function(){return bR(n)}).styles(i)})},e.prototype.renderBackground=function(t){var e=this.shape,r=e.width,n=e.height,i=bt(this.attributes,"background");this.background=t.maybeAppendByClassName(bI.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(bI.background,"rect").styles((0,s6.__assign)({width:r,height:n},i))},e.prototype.adjustLayout=function(){var t=this.layout,e=t.labelWidth,r=t.valueWidth,n=t.height,i=(0,s6.__read)(t.position,3),a=i[0],o=i[1],s=i[2],l=n/2;this.markerGroup.styles({transform:"translate(".concat(a,", ").concat(l,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(o,", ").concat(l,")")}),bC(this.labelGroup.select(bI.label.class).node(),Math.ceil(e)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(s,", ").concat(l,")")}),bC(this.valueGroup.select(bI.value.class).node(),Math.ceil(r)))},e.prototype.render=function(t,e){var r=m4(e),n=t.x,i=t.y;r.styles({transform:"translate(".concat(void 0===n?0:n,", ").concat(void 0===i?0:i,")")}),this.renderMarker(r),this.renderLabel(r),this.renderValue(r),this.renderBackground(r),this.adjustLayout()},e}(m2),bD=bn({page:"item-page",navigator:"navigator",item:"item"},"items"),bL=function(t,e,r){return(void 0===r&&(r=!0),t)?e(t):r},bj=function(t){function e(e){var r=t.call(this,e,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:bh,mouseenter:bh,mouseleave:bh})||this;return r.navigatorShape=[0,0],r}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,e=t.gridRow,r=t.gridCol,n=t.data;if(!e&&!r)throw Error("gridRow and gridCol can not be set null at the same time");return e&&r?[e,r]:e?[e,n.length]:[n.length,r]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,e=t.data,r=t.layout,n=bt(this.attributes,"item");return e.map(function(t,i){var a=t.id,o=void 0===a?i:a,s=t.label,l=t.value;return{id:"".concat(o),index:i,style:(0,s6.__assign)({layout:r,labelText:s,valueText:l},Object.fromEntries(Object.entries(n).map(function(r){var n=(0,s6.__read)(r,2);return[n[0],bd(n[1],[t,i,e])]})))}})},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,e=this.attributes,r=e.orientation,n=e.width,i=e.rowPadding,a=e.colPadding,o=(0,s6.__read)(this.navigatorShape,1)[0],s=(0,s6.__read)(this.grid,2),l=s[0],u=s[1],h=u*l,d=0;return this.pageViews.children.map(function(e,s){var c,f,p=Math.floor(s/h),g=s%h,y=t.ifHorizontal(u,l),v=[Math.floor(g/y),g%y];"vertical"===r&&v.reverse();var m=(0,s6.__read)(v,2),b=m[0],x=m[1],E=(n-o-(u-1)*a)/u,w=e.getBBox().height,_=(0,s6.__read)([0,0],2),S=_[0],k=_[1];return"horizontal"===r?(S=(c=(0,s6.__read)([d,b*(w+i)],2))[0],k=c[1],d=x===u-1?0:d+E+a):(S=(f=(0,s6.__read)([x*(E+a),d],2))[0],k=f[1],d=b===l-1?0:d+w+i),{page:p,index:s,row:b,col:x,pageIndex:g,width:E,height:w,x:S,y:k}})},e.prototype.getFlexLayout=function(){var t=this.attributes,e=t.width,r=t.height,n=t.rowPadding,i=t.colPadding,a=(0,s6.__read)(this.navigatorShape,1)[0],o=(0,s6.__read)(this.grid,2),s=o[0],l=o[1],u=(0,s6.__read)([e-a,r],2),h=u[0],d=u[1],c=(0,s6.__read)([0,0,0,0,0,0,0,0],8),f=c[0],p=c[1],g=c[2],y=c[3],v=c[4],m=c[5],b=c[6],x=c[7];return this.pageViews.children.map(function(t,e){var r,a,o,u,c=t.getBBox(),E=c.width,w=c.height,_=0===b?0:i,S=b+_+E;return S<=h&&bL(v,function(t){return t<l})?(f=(r=(0,s6.__read)([b+_,x,S],3))[0],p=r[1],b=r[2]):(m=(a=(0,s6.__read)([m+1,0,0,x+w+n],4))[0],v=a[1],b=a[2],(x=a[3])+w<=d&&bL(m,function(t){return t<s}))?(f=(o=(0,s6.__read)([b,x,E],3))[0],p=o[1],b=o[2]):(f=(u=(0,s6.__read)([0,0,E,0,g+1,0,0,0],8))[0],p=u[1],b=u[2],x=u[3],g=u[4],y=u[5],m=u[6],v=u[7]),{width:E,height:w,x:f,y:p,page:g,index:e,pageIndex:y++,row:m,col:v++}})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t="grid"===this.attributes.layout?this.getGridLayout:this.getFlexLayout,e=t.call(this);return e.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):e},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,e){return bS(this.attributes.orientation,t,e)},e.prototype.flattenPage=function(t){t.querySelectorAll(bD.item.class).forEach(function(e){t.appendChild(e)}),t.querySelectorAll(bD.page.class).forEach(function(e){t.removeChild(e).destroy()})},e.prototype.renderItems=function(t){var e=this.attributes,r=e.click,n=e.mouseenter,i=e.mouseleave;this.flattenPage(t);var a=this.dispatchCustomEvent.bind(this);m4(t).selectAll(bD.item.class).data(this.renderData,function(t){return t.id}).join(function(t){return t.append(function(t){return new bP({style:t.style})}).attr("className",bD.item.name).on("click",function(){null==r||r(this),a("itemClick",{item:this})}).on("pointerenter",function(){null==n||n(this),a("itemMouseenter",{item:this})}).on("pointerleave",function(){null==i||i(this),a("itemMouseleave",{item:this})})},function(t){return t.each(function(t){var e=t.style;this.update(e)})},function(t){return t.remove()})},e.prototype.relayoutNavigator=function(){var t,e=this.attributes,r=e.layout,n=e.width,i=(null===(t=this.pageViews.children[0])||void 0===t?void 0:t.getBBox().height)||0,a=(0,s6.__read)(this.navigatorShape,2),o=a[0],s=a[1];this.navigator.update("grid"===r?{pageWidth:n-o,pageHeight:i-s}:{})},e.prototype.adjustLayout=function(){var t,e,r=this,n=Object.entries((t=this.itemsLayout,e="page",t.reduce(function(t,r){return(t[r[e]]=t[r[e]]||[]).push(r),t},{}))).map(function(t){var e=(0,s6.__read)(t,2);return{page:e[0],layouts:e[1]}}),i=(0,s6.__spreadArray)([],(0,s6.__read)(this.navigator.getContainer().children),!1);n.forEach(function(t){var e=t.layouts,n=r.pageViews.appendChild(new on.Group({className:bD.page.name}));e.forEach(function(t){var e=t.x,r=t.y,a=t.index,o=t.width,s=t.height,l=i[a];n.appendChild(l),up(l,"__layout__",t),l.update({x:e,y:r,width:o,height:s})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var e=m0({orientation:this.attributes.orientation},bt(this.attributes,"nav")),r=this;return t.selectAll(bD.navigator.class).data(["nav"]).join(function(t){return t.append(function(){return new bw({style:e})}).attr("className",bD.navigator.name).each(function(){r.navigator=this})},function(t){return t.each(function(){this.update(e)})},function(t){return t.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,e){var r=this.attributes.data;if(r&&0!==r.length){var n=this.renderNavigator(m4(e));this.renderItems(n.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,e){var r=new on.CustomEvent(t,{detail:e});this.dispatchEvent(r)},e}(m2),s6=y("7WQrb"),bF=bn({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),bB={showLabel:!0,formatter:function(t){return t.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0};!function(t){function e(e){return t.call(this,e,bB)||this}(0,s6.__extends)(e,t),e.prototype.render=function(t,e){var r=m4(e).maybeAppendByClassName(bF.markerGroup,"g");this.renderMarker(r);var n=m4(e).maybeAppendByClassName(bF.labelGroup,"g");this.renderLabel(n)},e.prototype.renderMarker=function(t){var e=this,r=this.attributes,n=r.orientation,i=r.markerSymbol,a=void 0===i?bS(n,"horizontalHandle","verticalHandle"):i;bi(!!a,t,function(t){var r=bt(e.attributes,"marker"),n=(0,s6.__assign)({symbol:a},r);e.marker=t.maybeAppendByClassName(bF.marker,function(){return new b_({style:n})}).update(n)})},e.prototype.renderLabel=function(t){var e=this,r=this.attributes,n=r.showLabel,i=r.orientation,a=r.spacing,o=void 0===a?0:a,s=r.formatter;bi(n,t,function(t){var r,n=bt(e.attributes,"label"),a=n.text,l=(0,s6.__rest)(n,["text"]),u=(null===(r=t.select(bF.marker.class))||void 0===r?void 0:r.node().getBBox())||{},h=u.width,d=u.height,c=(0,s6.__read)(bS(i,[0,(void 0===d?0:d)+o,"center","top"],[(void 0===h?0:h)+o,0,"start","middle"]),4),f=c[0],p=c[1],g=c[2],y=c[3];t.maybeAppendByClassName(bF.label,"text").styles((0,s6.__assign)((0,s6.__assign)({},l),{x:f,y:p,text:s(a).toString(),textAlign:g,textBaseline:y}))})}}(m2);var bz={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},bV=m0({},bz,{});m0({},bz,be(bB,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"});var bG=bn({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),b$=function(t){function e(e){return t.call(this,e,bV)||this}return(0,s6.__extends)(e,t),e.prototype.renderTitle=function(t,e,r){var n=this.attributes,i=n.showTitle,a=n.titleText,o=bt(this.attributes,"title"),s=(0,s6.__read)(br(o),2),l=s[0],u=s[1];this.titleGroup=t.maybeAppendByClassName(bG.titleGroup,"g").styles(u);var h=(0,s6.__assign)((0,s6.__assign)({width:e,height:r},l),{text:i?a:""});this.title=this.titleGroup.maybeAppendByClassName(bG.title,function(){return new bu({style:h})}).update(h)},e.prototype.renderItems=function(t,e){var r=e.x,n=e.y,i=e.width,a=e.height,o=bt(this.attributes,"title",!0),s=(0,s6.__read)(br(o),2),l=s[0],u=s[1],h=(0,s6.__assign)((0,s6.__assign)({},l),{width:i,height:a,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(bG.itemsGroup,"g").styles((0,s6.__assign)((0,s6.__assign)({},u),{transform:"translate(".concat(r,", ").concat(n,")")}));var d=this;this.itemsGroup.selectAll(bG.items.class).data(["items"]).join(function(t){return t.append(function(){return new bj({style:h})}).attr("className",bG.items.name).each(function(){d.items=m4(this)})},function(t){return t.update(h)},function(t){return t.remove()})},e.prototype.adjustLayout=function(){if(this.attributes.showTitle){var t=this.title.node().getAvailableSpace(),e=t.x,r=t.y;this.itemsGroup.node().style.transform="translate(".concat(e,", ").concat(r,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,e=t.showTitle,r=t.width,n=t.height;return e?this.title.node().getAvailableSpace():new m3(0,0,r,n)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var e,r,n=null===(e=this.title)||void 0===e?void 0:e.node(),i=null===(r=this.items)||void 0===r?void 0:r.node();return n&&i?function(t,e){var r=t.attributes,n=r.position,i=r.spacing,a=r.inset,o=r.text,s=t.getBBox(),l=e.getBBox(),u=bs(n),h=(0,s6.__read)(ba(o?i:0),4),d=h[0],c=h[1],f=h[2],p=h[3],g=(0,s6.__read)(ba(a),4),y=g[0],v=g[1],m=g[2],b=g[3],x=(0,s6.__read)([p+c,d+f],2),E=x[0],w=x[1],_=(0,s6.__read)([b+v,y+m],2),S=_[0],k=_[1];if("l"===u[0])return new m3(s.x,s.y,l.width+s.width+E+S,Math.max(l.height+k,s.height));if("t"===u[0])return new m3(s.x,s.y,Math.max(l.width+S,s.width),l.height+s.height+w+k);var N=(0,s6.__read)([e.attributes.width||l.width,e.attributes.height||l.height],2),O=N[0],T=N[1];return new m3(l.x,l.y,O+s.width+E+S,T+s.height+w+k)}(n,i):t.prototype.getBBox.call(this)},e.prototype.render=function(t,e){var r=this.attributes,n=r.width,i=r.height,a=r.x,o=r.y,s=m4(e);e.style.transform="translate(".concat(void 0===a?0:a,", ").concat(void 0===o?0:o,")"),this.renderTitle(s,n,i),this.renderItems(s,this.availableSpace),this.adjustLayout()},e}(m2),sI=y("ky7aH"),on=y("2eDEB");function bU(t){let{width:e,height:r,renderer:n,containerStyle:i}=t,a=function(t){var e;let{container:r,className:n,graphCanvas:i}=t;if(r)return"string"==typeof r?document.getElementById(r):r;let a=vz(n,!1);return null===(e=i.getContainer())||void 0===e||e.appendChild(a),a}(t),[o,s]=function(t){let{width:e,height:r,placement:n,graphCanvas:i}=t,[a,o]=i.getSize(),[s,l]=lJ(n);return[s*(a-e),l*(o-r)]}(t);Object.assign(a.style,Object.assign({position:"absolute",left:o+"px",top:s+"px",width:e+"px",height:r+"px"},i));let l=new on.Canvas({width:e,height:r,container:a,renderer:n||new ds});return[a,l]}var bH=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class bW extends vB{constructor(t,e){super(t,Object.assign({},bW.defaultOptions,e)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{let{graph:t}=this.context;t.on(yG.AFTER_DRAW,this.createElement)},this.changeState=(t,e)=>{let{graph:r}=this.context,{typePrefix:n}=this,i=uf(t,[n,"id"]),a=uf(t,[n,"style","labelText"]),[o]=i.split("__"),s=this.fieldMap[o].get(a)||[];r.setElementState(Object.fromEntries(null==s?void 0:s.map(t=>[t,e])))},this.click=t=>{if("hover"===this.options.trigger)return;let e=uf(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?(this.selectedItems=this.selectedItems.filter(t=>t!==e),this.changeState(t,[])):(this.selectedItems.push(e),this.changeState(t,"selected"))},this.mouseleave=t=>{"click"!==this.options.trigger&&(this.selectedItems=[],this.changeState(t,[]))},this.mouseenter=t=>{if("click"===this.options.trigger)return;let e=uf(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?this.selectedItems=this.selectedItems.filter(t=>t!==e):(this.selectedItems.push(e),this.changeState(t,"active"))},this.setFieldMap=(t,e,r)=>{if(!t)return;let n=this.fieldMap[r];if(n){if(n.has(t)){let r=n.get(t);r&&(r.push(e),n.set(t,r))}else n.set(t,[e])}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(t,e)=>{if(!t)return[];let{model:r,element:n}=this.context,{nodes:i,edges:a,combos:o}=r.getData(),s={},l=e=>(0,sI.default)(t)?t(e):t,u={node:"circle",edge:"line",combo:"rect"},h={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},d=(t,e)=>null==n?void 0:n.getElementComputedStyle(t,e),c=(t,e)=>{t.forEach(t=>{let{id:r}=t,i=uf(t,["data",l(t)]),a=(null==n?void 0:n.getElementType(e,t))||"circle",o=d(e,t),c=("edge"===e?null==o?void 0:o.stroke:null==o?void 0:o.fill)||"#1783ff";r&&i&&i.replace(/\s+/g,"")&&(this.setFieldMap(i,r,e),s[i]||(s[i]={id:`${e}__${r}`,label:i,marker:h[a]||u[e],elementType:e,lineWidth:1,stroke:c,fill:c}))})};switch(e){case"node":c(i,"node");break;case"edge":c(a,"edge");break;case"combo":c(o,"combo");break;default:return[]}return Object.values(s)},this.createElement=()=>{if(this.draw){this.updateElement();return}let t=this.options,{width:e,height:r,nodeField:n,edgeField:i,comboField:a,trigger:o,position:s,container:l,containerStyle:u,className:h}=t,d=bH(t,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),c=this.getMarkerData(n,"node"),f=this.getMarkerData(i,"edge"),p=new b$({className:"legend",style:Object.assign({width:e,height:r,data:[...c,...this.getMarkerData(a,"combo"),...f],itemMarkerLineWidth:({lineWidth:t})=>t,itemMarker:({marker:t})=>t,itemMarkerStroke:({stroke:t})=>t,itemMarkerFill:({fill:t})=>t,gridCol:c.length},d,this.getEvents())});this.category=p,this.upsertCanvas().appendChild(p),this.draw=!0},this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t,e;null===(t=this.canvas)||void 0===t||t.destroy(),null===(e=this.container)||void 0===e||e.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5,itemLabelOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;let t=this.context.canvas,[e,r]=t.getSize(),{width:n=e,height:i=r,position:a,container:o,containerStyle:s,className:l}=this.options,[u,h]=bU({width:n,height:i,graphCanvas:t,container:o,containerStyle:s,placement:a,className:"legend"});return this.container=u,l&&u.classList.add(l),this.canvas=h,this.canvas}destroy(){this.clear(),this.context.graph.off(yG.AFTER_DRAW,this.createElement),super.destroy()}}bW.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class bq extends vB{constructor(t,e){super(t,Object.assign({},bq.defaultOptions,e)),this.onDraw=t=>{var e;null!==(e=null==t?void 0:t.data)&&void 0!==e&&e.render||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=t=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(t.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=t=>{if(!this.mask||!this.isMaskDragging)return;let{size:[e,r]}=this.options,{movementX:n,movementY:i}=t,{left:a,top:o,width:s,height:l}=this.mask.style,[,,u,h]=this.maskBBox,d=parseInt(a)+n,c=parseInt(o)+i,f=parseInt(s),p=parseInt(l);d<0&&(d=0),c<0&&(c=0),d+f>e&&(d=bK(e-f,0)),c+p>r&&(c=bK(r-p,0)),f<u&&(n>0?(d=bK(d-n,0),f=bY(f+n,e)):n<0&&(f=bY(f-n,e))),p<h&&(i>0?(c=bK(c-i,0),p=bY(p+i,r)):i<0&&(p=bY(p-i,r))),Object.assign(this.mask.style,{left:d+"px",top:c+"px",width:f+"px",height:p+"px"});let g=parseInt(a)-d,y=parseInt(o)-c;if(0===g&&0===y)return;let v=this.context.canvas.getCamera().getZoom()/this.canvas.getCamera().getZoom();this.context.graph.translateBy([g*v,y*v],!1)},this.onMaskDragEnd=t=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(t.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=sL(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),"delay"in t&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=c_(()=>{this.renderMinimap(),this.renderMask()},this.options.delay,!0)}bindEvents(){let{graph:t}=this.context;t.on(yG.AFTER_DRAW,this.onDraw),t.on(yG.AFTER_RENDER,this.onRender),t.on(yG.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){let{graph:t}=this.context;t.off(yG.AFTER_DRAW,this.onDraw),t.off(yG.AFTER_RENDER,this.onRender),t.off(yG.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){let t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}getElements(){let{filter:t}=this.options,{model:e}=this.context,r=e.getData();if(!t)return r;let{nodes:n,edges:i,combos:a}=r;return{nodes:n.filter(e=>t(lg(e),"node")),edges:i.filter(e=>t(lg(e),"edge")),combos:a.filter(e=>t(lg(e),"combo"))}}setShapes(t,e){let{nodes:r,edges:n,combos:i}=e,{shape:a}=this.options,{element:o}=this.context;if("key"===a){let e=new Set,a=r=>{let n=lg(r);e.add(n);let i=o.getElement(n);if(!i)return;let a=i.getShape("key"),s=this.shapes.get(n)||a.cloneNode();s.setPosition(a.getPosition()),i.style.zIndex&&(s.style.zIndex=i.style.zIndex),s.id=i.id,this.shapes.has(n)?Object.entries(a.attributes).forEach(([t,e])=>{s.style[t]!==e&&(s.style[t]=e)}):(t.appendChild(s),this.shapes.set(n,s))};n.forEach(a),i.forEach(a),r.forEach(a),this.shapes.forEach((r,n)=>{e.has(n)||(t.removeChild(r),this.shapes.delete(n))});return}let s=(t,e)=>{let r=o.getElement(t).getPosition();return e.setPosition(r),e};t.removeChildren(),n.forEach(e=>t.appendChild(a(lg(e),"edge"))),i.forEach(e=>{t.appendChild(s(lg(e),a(lg(e),"combo")))}),r.forEach(e=>{t.appendChild(s(lg(e),a(lg(e),"node")))})}initCanvas(){let{renderer:t,size:[e,r]}=this.options;if(this.canvas){let{width:n,height:i}=this.canvas.getConfig();(e!==n||r!==i)&&this.canvas.resize(e,r),t&&this.canvas.setRenderer(t)}else{let{className:n,position:i,container:a,containerStyle:o}=this.options,[s,l]=bU({renderer:t,width:e,height:r,placement:i,className:"minimap",container:a,containerStyle:o,graphCanvas:this.context.canvas});n&&s.classList.add(n),this.container=s,this.canvas=l}return this.setCamera(),this.canvas}createLandmark(t,e,r){let n=`${t.join(",")}-${e.join(",")}-${r}`;if(this.landmarkMap.has(n))return this.landmarkMap.get(n);let i=this.canvas.getCamera().createLandmark(n,{position:t,focalPoint:e,zoom:r});return this.landmarkMap.set(n,i),i}setCamera(){var t;let{canvas:e}=this.context,r=null===(t=this.canvas)||void 0===t?void 0:t.getCamera();if(!r)return;let{size:[n,i],padding:a}=this.options,[o,s,l,u]=sz(a),{min:h,max:d,center:c}=e.getBounds("elements"),f=Math.min((n-u-s)/(d[0]-h[0]),(i-o-l)/(d[1]-h[1])),p=this.createLandmark(c,c,f);r.gotoLandmark(p,0)}get maskBBox(){let{canvas:t}=this.context,e=t.getSize(),r=t.getCanvasByViewport([0,0]),n=t.getCanvasByViewport(e),i=this.canvas.canvas2Viewport(l2(r)),a=this.canvas.canvas2Viewport(l2(n)),o=a.x-i.x,s=a.y-i.y;return[i.x,i.y,o,s]}calculateMaskBBox(){let{size:[t,e]}=this.options,[r,n,i,a]=this.maskBBox;return r<0&&(i=bY(i+r,t),r=0),n<0&&(a=bY(a+n,e),n=0),r+i>t&&(i=bK(t-r,0)),n+a>e&&(a=bK(e-n,0)),[bY(r,t),bY(n,e),bK(i,0),bK(a,0)]}renderMask(){let{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;let[t,e,r,n]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:e+"px",left:t+"px",width:r+"px",height:n+"px"})}destroy(){var t;this.unbindEvents(),this.canvas.destroy(),null===(t=this.mask)||void 0===t||t.remove(),super.destroy()}}bq.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const bY=(t,e)=>Math.min(t,e),bK=(t,e)=>Math.max(t,e);var on=y("2eDEB"),bX=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};const bJ={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class bZ extends vB{constructor(t,e){super(t,Object.assign({},bZ.defaultOptions,e)),this.initSnapline=()=>{let t=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=t.appendChild(new on.Line({style:Object.assign(Object.assign({},bJ),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=t.appendChild(new on.Line({style:Object.assign(Object.assign({},bJ),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(t,e,r)=>bX(this,void 0,void 0,function*(){let{verticalX:n,horizontalY:i}=r,{tolerance:a}=this.options,{min:[o,s],max:[l,u],center:[h,d]}=e,c=0,f=0;null!==n&&(bQ(l,n)<a&&(c=n-l),bQ(o,n)<a&&(c=n-o),bQ(h,n)<a&&(c=n-h),0!==c&&(this.isVerticalSticking=!0)),null!==i&&(bQ(u,i)<a&&(f=i-u),bQ(s,i)<a&&(f=i-s),bQ(d,i)<a&&(f=i-d),0!==f&&(this.isHorizontalSticking=!0)),(0!==c||0!==f)&&(yield this.context.graph.translateElementBy({[t]:[c,f]},!1))}),this.enableSnap=t=>{let{target:e}=t;if(this.isHorizontalSticking||this.isVerticalSticking){let[r,n]=this.getDelta(t);if(this.isHorizontalSticking&&this.isVerticalSticking&&.5>=Math.abs(r)&&.5>=Math.abs(n))return this.context.graph.translateElementBy({[e.id]:[-r,-n]},!1),!1;if(this.isHorizontalSticking&&.5>=Math.abs(n))return this.context.graph.translateElementBy({[e.id]:[0,-n]},!1),!1;if(this.isVerticalSticking&&.5>=Math.abs(r))return this.context.graph.translateElementBy({[e.id]:[-r,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(t,e)=>{let{tolerance:r,shape:n}=this.options,{min:[i,a],max:[o,s],center:[l,u]}=e,h=null,d=null,c=null,f=null,p=null,g=null;return this.getNodes().some(e=>{if(sd(t.id,e.id))return!1;let{min:[y,v],max:[m,b],center:[x,E]}=b0(e,n).getRenderBounds();return null===h&&(bQ(x,l)<r?h=x:bQ(y,i)<r?h=y:bQ(y,o)<r?h=y:bQ(m,o)<r?h=m:bQ(m,i)<r&&(h=m),null!==h&&(d=Math.min(v,a),c=Math.max(b,s))),null===f&&(bQ(E,u)<r?f=E:bQ(v,a)<r?f=v:bQ(v,s)<r?f=v:bQ(b,s)<r?f=b:bQ(b,a)<r&&(f=b),null!==f&&(p=Math.min(y,i),g=Math.max(m,o))),null!==h&&null!==f}),{verticalX:h,verticalMinY:d,verticalMaxY:c,horizontalY:f,horizontalMinX:p,horizontalMaxX:g}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=t=>bX(this,void 0,void 0,function*(){let{target:e}=t;if(this.options.autoSnap&&!this.enableSnap(t))return;let r=b0(e,this.options.shape).getRenderBounds(),n=this.calcSnaplineMetadata(e,r);this.hideSnapline(),(null!==n.verticalX||null!==n.horizontalY)&&this.updateSnapline(n),this.options.autoSnap&&(yield this.autoSnapToLine(e.id,r,n))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var t;let{filter:e}=this.options,r=((null===(t=this.context.element)||void 0===t?void 0:t.getNodes())||[]).filter(t=>{var e;return"hidden"!==uf(t,["style","visibility"])&&(null===(e=this.context.viewport)||void 0===e?void 0:e.isInViewport(t.getRenderBounds()))});return e?r.filter(t=>e(t)):r}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){let{lineWidth:e}=this.options[`${t}LineStyle`];return+(e||bJ.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){let{verticalX:e,verticalMinY:r,verticalMaxY:n,horizontalY:i,horizontalMinX:a,horizontalMaxX:o}=t,[s,l]=this.context.canvas.getSize(),{offset:u}=this.options;null!==i?Object.assign(this.horizontalLine.style,{x1:u===1/0?0:a-u,y1:i,x2:u===1/0?s:o+u,y2:i,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",null!==e?Object.assign(this.verticalLine.style,{x1:e,y1:u===1/0?0:r-u,x2:e,y2:u===1/0?l:n+u,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){let e=this.context.graph.getZoom();return lB([t.dx,t.dy],e)}bindEvents(){return bX(this,void 0,void 0,function*(){let{graph:t}=this.context;t.on(yU.DRAG_START,this.onDragStart),t.on(yU.DRAG,this.onDrag),t.on(yU.DRAG_END,this.onDragEnd)})}unbindEvents(){let{graph:t}=this.context;t.off(yU.DRAG_START,this.onDragStart),t.off(yU.DRAG,this.onDrag),t.off(yU.DRAG_END,this.onDragEnd)}destroyElements(){var t,e;null===(t=this.horizontalLine)||void 0===t||t.destroy(),null===(e=this.verticalLine)||void 0===e||e.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}bZ.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const bQ=(t,e)=>Math.abs(t-e),b0=(t,e)=>"function"==typeof e?e(t):t.getShape(e);var s6=y("7WQrb"),ow=y("8hhuV"),on=y("2eDEB");function b1(t,e){var r={YYYY:t.getFullYear(),MM:t.getMonth()+1,DD:t.getDate(),HH:t.getHours(),mm:t.getMinutes(),ss:t.getSeconds()},n=e;return Object.keys(r).forEach(function(t){var e=r[t];n=n.replace(t,"YYYY"===t?"".concat(e):"".concat(e).padStart(2,"0"))}),n}var s6=(y("7WQrb"),y("7WQrb")),on=y("2eDEB"),b2={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new on.Path({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]};lP({},b2,{style:{type:"arc"}}),lP({},b2,{style:{}});var b3=bn({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"),s6=y("7WQrb"),sI=y("ky7aH");function b6(t){return t*Math.PI/180}function b5(t){return Number((180*t/Math.PI).toPrecision(5))}function b4(t,e){return[t[0]*e,t[1]*e]}function b8(t,e){return[t[0]+e[0],t[1]+e[1]]}function b9(t,e){return[t[0]-e[0],t[1]-e[1]]}function b7(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1])]}function xt(t,e){return[Math.max(t[0],e[0]),Math.max(t[1],e[1])]}function xe(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function xr(t){if(0===t[0]&&0===t[1])return[0,0];var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return[t[0]/e,t[1]/e]}var s6=(y("7WQrb"),y("7WQrb"));function xn(t,e){return t.style.opacity||(t.style.opacity=1),by(t,{opacity:0},e)}var xi=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function xa(t){var e={};for(var r in t)xi.includes(r)&&(e[r]=t[r]);return e}var xo=bn({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function xs(t){return t.reduce(function(t,e,r){return t.push((0,s6.__spreadArray)([0===r?"M":"L"],(0,s6.__read)(e),!1)),t},[])}function xl(t,e,r){return"surround"===e.type?function(t,e,r){var n=e.connect,i=e.center;if("line"===(void 0===n?"line":n))return xs(t);if(!i)return[];var a=xe(t[0],i),o=r?0:1;return t.reduce(function(t,e,r){return 0===r?t.push((0,s6.__spreadArray)(["M"],(0,s6.__read)(e),!1)):t.push((0,s6.__spreadArray)(["A",a,a,0,0,o],(0,s6.__read)(e),!1)),t},[])}(t,e,r):xs(t)}var xu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),e.prototype.render=function(t,e){t.type,t.center,t.areaFill,t.closed;var r,n,i,a,o,s=(0,s6.__rest)(t,["type","center","areaFill","closed"]),l=(n=void 0===(r=t.data)?[]:r,t.closed?n.map(function(t){var e=t.points,r=(0,s6.__read)(e,1)[0];return(0,s6.__assign)((0,s6.__assign)({},t),{points:(0,s6.__spreadArray)((0,s6.__spreadArray)([],(0,s6.__read)(e),!1),[r],!1)})}):n),u=m4(e).maybeAppendByClassName(xo.lineGroup,"g"),h=m4(e).maybeAppendByClassName(xo.regionGroup,"g"),d=(i=t.animate,a=t.isBillboard,o=l.map(function(e,r){return{id:e.id||"grid-line-".concat(r),d:xl(e.points,t)}}),u.selectAll(xo.line.class).data(o,function(t){return t.id}).join(function(t){return t.append("path").each(function(t,e){var r=bd(xa((0,s6.__assign)({d:t.d},s)),[t,e,o]);this.attr((0,s6.__assign)({class:xo.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:a},r))})},function(t){return t.transition(function(t,e){return by(this,bd(xa((0,s6.__assign)({d:t.d},s)),[t,e,o]),i.update)})},function(t){return t.transition(function(){var t=this,e=xn(this,i.exit);return bf(e,function(){return t.remove()}),e})}).transitions()),c=function(t,e,r){var n=r.animate,i=r.connect,a=r.areaFill;if(e.length<2||!a||!i)return[];for(var o=Array.isArray(a)?a:[a,"transparent"],s=[],l=0;l<e.length-1;l++){var u=(0,s6.__read)([e[l].points,e[l+1].points],2),h=function(t,e,r){var n=r.type,i=r.connect,a=r.center,o=r.closed?[["Z"]]:[],s=(0,s6.__read)([xl(t,r),xl(e.slice().reverse(),r,!0)],2),l=s[0],u=s[1],h=(0,s6.__read)([t[0],e.slice(-1)[0]],2),d=h[0],c=h[1],f=function(t,e){return[l,t,u,e,o].flat()};if("line"===i||"surround"===n)return f([(0,s6.__spreadArray)(["L"],(0,s6.__read)(c),!1)],[(0,s6.__spreadArray)(["L"],(0,s6.__read)(d),!1)]);if(!a)throw Error("Arc grid need to specified center");var p=(0,s6.__read)([xe(c,a),xe(d,a)],2),g=p[0],y=p[1];return f([(0,s6.__spreadArray)(["A",g,g,0,0,1],(0,s6.__read)(c),!1),(0,s6.__spreadArray)(["L"],(0,s6.__read)(c),!1)],[(0,s6.__spreadArray)(["A",y,y,0,0,0],(0,s6.__read)(d),!1),(0,s6.__spreadArray)(["L"],(0,s6.__read)(d),!1)])}(u[0],u[1],r);s.push({d:h,fill:o[l%o.length]})}return t.selectAll(xo.region.class).data(s,function(t,e){return e}).join(function(t){return t.append("path").each(function(t,e){var r=bd(t,[t,e,s]);this.attr(r)}).attr("className",xo.region.name)},function(t){return t.transition(function(t,e){return by(this,bd(t,[t,e,s]),n.update)})},function(t){return t.transition(function(){var t=this,e=xn(this,n.exit);return bf(e,function(){return t.remove()}),e})}).transitions()}(h,l,t);return(0,s6.__spreadArray)((0,s6.__spreadArray)([],(0,s6.__read)(d),!1),(0,s6.__read)(c),!1)},e}(m2);function xh(t,e){var r={},n=Array.isArray(e)?e:[e];for(var i in t)n.includes(i)||(r[i]=t[i]);return r}var s6=(y("7WQrb"),y("7WQrb"),y("7WQrb"),y("7WQrb")),sI=y("ky7aH");function xd(t,e){return Object.fromEntries(Object.entries(t).map(function(t){var r=(0,s6.__read)(t,2);return[r[0],bd(r[1],e)]}))}function xc(t,e){return e&&(0,sI.default)(e)?t.filter(e):t}function xf(t,e){var r=e.startAngle;return(e.endAngle-r)*t+r}function xp(t,e){if("linear"===e.type){var r=(0,s6.__read)(e.startPos,2),n=r[0],i=r[1],a=(0,s6.__read)(e.endPos,2),o=a[0],s=a[1],l=(0,s6.__read)([o-n,s-i],2);return xr([l[0],l[1]])}var u=b6(xf(t,e));return[-Math.sin(u),Math.cos(u)]}function xg(t,e,r){var n;return n=xp(t,r),"positive"!==e?[n[1],-n[0]]:[-n[1],n[0]]}function xy(t,e){return xg(t,e.labelDirection,e)}function xv(t,e){var r,n,i,a,o,s,l,u,h,d,c,f;return"linear"===e.type?(n=(r=(0,s6.__read)(e.startPos,2))[0],i=r[1],o=(a=(0,s6.__read)(e.endPos,2))[0],s=a[1],l=(0,s6.__read)([o-n,s-i],2),[n+l[0]*t,i+l[1]*t]):(u=e.radius,d=(h=(0,s6.__read)(e.center,2))[0],c=h[1],[d+u*Math.cos(f=b6(xf(t,e))),c+u*Math.sin(f)])}function xm(t){return 0===xp(0,t)[1]}function xb(t){return 0===xp(0,t)[0]}function xx(t,e,r,n,i){var a=e-t,o=(0,s6.__read)([i,i],2),s=o[0],l=o[1],u=(0,s6.__read)([b6(t),b6(e)],2),h=u[0],d=u[1],c=function(t){return[r+i*Math.cos(t),n+i*Math.sin(t)]},f=(0,s6.__read)(c(h),2),p=f[0],g=f[1],y=(0,s6.__read)(c(d),2),v=y[0],m=y[1];if(e-t==360){var b=(0,s6.__read)(c((d+h)/2),2);return[["M",p,g],["A",s,l,0,1,0,b[0],b[1]],["A",s,l,0,1,0,v,m]]}return"M".concat(p,",").concat(g,",A").concat(s,",").concat(l,",0,").concat(a>180?1:0,",").concat(t>e?0:1,",").concat(v,",").concat(m)}function xE(t){var e=(0,s6.__read)(t,2),r=(0,s6.__read)(e[0],2),n=r[0],i=r[1],a=(0,s6.__read)(e[1],2);return{x1:n,y1:i,x2:a[0],y2:a[1]}}function xw(t){var e=t.type,r=t.gridCenter;return"linear"===e?r:r||t.center}var s6=y("7WQrb"),sI=y("ky7aH"),x_=function(t){return void 0!==t&&null!=t&&!Number.isNaN(t)};function xS(t,e,r,n,i){return void 0===n&&(n=!0),void 0===i&&(i=!1),!!n&&t===e||!!i&&t===r||t>e&&t<r}function xk(t,e){if(e)try{var r=e.replace(/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,function(e,r,n){var i,a,o,s;return"translate(".concat((a=(i=t.getBBox()).width,o=i.height,[(s=(0,s6.__read)([r,n].map(function(t,e){var r;return t.includes("%")?parseFloat((null===(r=t.match(/[+-]?([0-9]*[.])?[0-9]+/))||void 0===r?void 0:r[0])||"0")/100*(0===e?a:o):t}),2))[0],s[1]]),")")});t.attr("transform",r)}catch(t){}}var s6=(y("7WQrb"),y("7WQrb")),o_=y("geZBG"),s6=(y("7WQrb"),y("7WQrb")),xN=function(){function t(t,e,r,n){this.set(t,e,r,n)}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),t.prototype.rotatedPoints=function(t,e,r){var n=this.x1,i=this.y1,a=this.x2,o=this.y2,s=Math.cos(t),l=Math.sin(t),u=e-e*s+r*l,h=r-e*l-r*s;return[[s*n-l*o+u,l*n+s*o+h],[s*a-l*o+u,l*a+s*o+h],[s*n-l*i+u,l*n+s*i+h],[s*a-l*i+u,l*a+s*i+h]]},t.prototype.set=function(t,e,r,n){return r<t?(this.x2=t,this.x1=r):(this.x1=t,this.x2=r),n<e?(this.y2=e,this.y1=n):(this.y1=e,this.y2=n),this},t.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE},t}();function xO(t,e){var r=t.getEulerAngles()||0;t.setEulerAngles(0);var n=t.getBounds(),i=(0,s6.__read)(n.min,2),a=i[0],o=i[1],s=(0,s6.__read)(n.max,2),l=s[0],u=s[1],h=t.getBBox(),d=h.width,c=h.height,f=0,p=0,g=a,y=o,v=bM(t);if(v){c-=1.5;var m=v.style.textAlign,b=v.style.textBaseline;"center"===m?g=(a+l)/2:("right"===m||"end"===m)&&(g=l),"middle"===b?y=(o+u)/2:"bottom"===b&&(y=u)}var x=(0,s6.__read)(ba(e),4),E=x[0],w=void 0===E?0:E,_=x[1],S=void 0===_?0:_,k=x[2],N=x[3],O=new xN((f+=a)-(void 0===N?S:N),(p+=o)-w,f+d+S,p+c+(void 0===k?w:k));return t.setEulerAngles(r),O.rotatedPoints(b6(r),g,y)}function xT(t,e){return e[0]<=Math.max(t[0][0],t[1][0])&&e[0]<=Math.min(t[0][0],t[1][0])&&e[1]<=Math.max(t[0][1],t[1][1])&&e[1]<=Math.min(t[0][1],t[1][1])}function xM(t,e,r){var n=(e[1]-t[1])*(r[0]-e[0])-(e[0]-t[0])*(r[1]-e[1]);return 0===n?0:n<0?2:1}function xA(t,e,r){var n,i,a=e.crossPadding,o=new Set,s=null,l=function(t,e){var r=t.type,n=t.labelDirection,i=t.crossSize;if(!i)return!1;if("arc"===r){var a=t.center,o=t.radius,s=(0,s6.__read)(a,2),l=s[0],u=s[1],h="negative"===n?0:i,d=-o-h,c=o+h,f=(0,s6.__read)(ba(e),4),p=f[0],g=f[1],y=f[2];return new xN(l+d-f[3],u+d-p,l+c+g,u+c+y)}var v=(0,s6.__read)(t.startPos,2),m=v[0],b=v[1],x=(0,s6.__read)(t.endPos,2),E=x[0],w=x[1],_=(0,s6.__read)(xb(t)?[-e,0,e,0]:[0,e,0,-e],4),S=_[0],k=_[1],N=_[2],O=_[3],T=b4(xy(0,t),i),M=new xN(m,b,E,w);return M.x1+=O,M.y1+=S,M.x2+=k+T[0],M.y2+=N+T[1],M}(e,a);try{for(var u=(0,s6.__values)(t),h=u.next();!h.done;h=u.next()){var d,c=h.value;!function(t){if(l){var e,r,n,i,a,o;return e=l.x1,r=l.x2,n=l.y1,i=l.y2,a=xO(t,void 0),o=[[e,n],[r,n],[r,i],[e,i]],a.every(function(t){return function(t,e){var r=t.length;if(r<3)return!1;var n=[e,[9999,e[1]]],i=0,a=0;do{var o=[t[a],t[(a+1)%r]];if(function(t,e){var r=xM(t[0],t[1],e[0]),n=xM(t[0],t[1],e[1]),i=xM(e[0],e[1],t[0]),a=xM(e[0],e[1],t[1]);return!!(r!==n&&i!==a||0===r&&xT(t,e[0])||0===n&&xT(t,e[1])||0===i&&xT(e,t[0])||0===a&&xT(e,t[1]))}(o,n)){if(0===xM(o[0],e,o[1]))return xT(o,e);i++}a=(a+1)%r}while(0!==a)return!!(1&i)}(o,t)})}return!0}(c)?o.add(c):s&&((d=s)&&d.firstChild?function(t,e,r){var n,i,a=xO(t,r).flat(1),o=xO(e,r).flat(1),s=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var l=(0,s6.__values)(s),u=l.next();!u.done;u=l.next()){var h=u.value;if(function(t,e){return[[t[0],t[1],t[2],t[3]],[t[2],t[3],t[4],t[5]],[t[4],t[5],t[6],t[7]],[t[6],t[7],t[0],t[1]]].some(function(t){return function(t,e){var r=(0,s6.__read)(t,4),n=r[0],i=r[1],a=r[2],o=r[3],s=(0,s6.__read)(e,4),l=s[0],u=s[1],h=s[2],d=s[3],c=a-n,f=o-i,p=h-l,g=d-u,y=c*g-p*f;if(0===y)return!1;var v=y>0,m=n-l,b=i-u,x=c*b-f*m;if(x<0===v)return!1;var E=p*b-g*m;return E<0!==v&&x>y!==v&&E>y!==v}(e,t)})}(o,h))return!0}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return!1}(d.firstChild,c.firstChild,ba(r)):0)?(o.add(s),o.add(c)):s=c}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}return Array.from(o)}function xC(t,e){return(void 0===e&&(e={}),(0,o_.default)(t))?0:"number"==typeof t?t:Math.floor(bO(t,e))}var s6=(y("7WQrb"),y("7WQrb")),xR={parity:function(t,e){var r=e.seq,n=void 0===r?2:r;return t.filter(function(t,e){return!(e%n)||(mK(t),!1)})}},s6=(y("7WQrb"),y("7WQrb")),xI=new Map([["hide",function(t,e,r,n){var i,a,o=t.length,s=e.keepHeader,l=e.keepTail;if(!(o<=1)&&(2!==o||!s||!l)){var u=xR.parity,h=function(t){return t.forEach(n.show),t},d=2,c=t.slice(),f=t.slice(),p=Math.min.apply(Math,(0,s6.__spreadArray)([1],(0,s6.__read)(t.map(function(t){return t.getBBox().width})),!1));if("linear"===r.type&&(xm(r)||xb(r))){var g=bk(t[0]).left,y=Math.abs(bk(t[o-1]).right-g)||1;d=Math.max(Math.floor(o*p/y),d)}for(s&&(i=c.splice(0,1)[0]),l&&(a=c.splice(-1,1)[0],c.reverse()),h(c);d<t.length&&xA((a?(0,s6.__spreadArray)((0,s6.__spreadArray)([a],(0,s6.__read)(f),!1),[i],!1):(0,s6.__spreadArray)([i],(0,s6.__read)(f),!1)).filter(x_),r,null==e?void 0:e.margin).length;){if(a&&!i&&d%2==0){var v=c.splice(0,1);v.forEach(n.hide)}else if(a&&i){var v=c.splice(0,1);v.forEach(n.hide)}f=u(h(c),{seq:d}),d++}}}],["rotate",function(t,e,r,n){var i,a,o=e.optionalAngles,s=e.margin,l=e.recoverWhenFailed,u=t.map(function(t){return t.getLocalEulerAngles()}),h=function(e){return t.forEach(function(t,r){var i=Array.isArray(e)?e[r]:e;n.rotate(t,+i)})};try{for(var d=(0,s6.__values)(void 0===o?[0,45,90]:o),c=d.next();!c.done;c=d.next()){var f=c.value;if(h(f),xA(t,r,s).length<1)return}}catch(t){i={error:t}}finally{try{c&&!c.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}(void 0===l||l)&&h(u)}],["ellipsis",function(t,e,r,n){if(!(t.length<=1)){var i=e.suffix,a=void 0===i?"...":i,o=e.minLength,s=e.maxLength,l=void 0===s?1/0:s,u=e.step,h=e.margin,d=void 0===h?[0,0,0,0]:h,c=bT(n.getTextShape(t[0])),f=xC(void 0===u?" ":u,c),p=o?xC(o,c):f,g=xC(l,c);((0,o_.default)(g)||g===1/0)&&(g=Math.max.apply(null,t.map(function(t){return t.getBBox().width})));var y=t.slice(),v=(0,s6.__read)(d,4);v[0],v[1],v[2],v[3];for(var m=function(e){if(y.forEach(function(t){n.ellipsis(n.getTextShape(t),e,a)}),(y=xA(t,r,d)).length<1)return{value:void 0}},b=g;b>p+f;b-=f){var x=m(b);if("object"==typeof x)return x.value}}}],["wrap",function(t,e,r,n){var i,a,o=e.wordWrapWidth,s=void 0===o?50:o,l=e.maxLines,u=void 0===l?3:l,h=e.recoverWhenFailed,d=e.margin,c=void 0===d?[0,0,0,0]:d,f=t.map(function(t){return t.attr("maxLines")||1}),p=Math.min.apply(Math,(0,s6.__spreadArray)([],(0,s6.__read)(f),!1)),g=(i=r.type,a=r.labelDirection,"linear"===i&&xm(r)?"negative"===a?"bottom":"top":"middle"),y=function(e){return t.forEach(function(t,r){var i=Array.isArray(e)?e[r]:e;n.wrap(t,s,i,g)})};if(!(p>u)){for(var v=p;v<=u;v++)if(y(v),xA(t,r,c).length<1)return;(void 0===h||h)&&y(f)}}]]);function xP(t){for(var e=t;e<0;)e+=360;return Math.round(e%360)}function xD(t,e){var r=(0,s6.__read)(t,2),n=r[0],i=r[1],a=(0,s6.__read)(e,2),o=a[0],s=a[1],l=(0,s6.__read)([n*o+i*s,n*s-i*o],2),u=l[0];return Math.atan2(l[1],u)}function xL(t,e,r){var n=r.type,i=r.labelAlign,a=xy(t,r),o=xP(e),s=xP(b5(xD([1,0],a))),l="center",u="middle";return"linear"===n?[90,270].includes(s)&&0===o?(l="center",u=1===a[1]?"top":"bottom"):!(s%180)&&[90,270].includes(o)?l="center":0===s?xS(o,0,90,!1,!0)?l="start":(xS(o,0,90)||xS(o,270,360))&&(l="start"):90===s?xS(o,0,90,!1,!0)?l="start":(xS(o,90,180)||xS(o,270,360))&&(l="end"):270===s?xS(o,0,90,!1,!0)?l="end":(xS(o,90,180)||xS(o,270,360))&&(l="start"):180===s&&(90===o?l="start":(xS(o,0,90)||xS(o,270,360))&&(l="end")):"parallel"===i?u=xS(s,0,180,!0)?"top":"bottom":"horizontal"===i?xS(s,90,270,!1)?l="end":(xS(s,270,360,!1)||xS(s,0,90))&&(l="start"):"perpendicular"===i&&(l=xS(s,90,270)?"end":"start"),{textAlign:l,textBaseline:u}}function xj(t,e,r){var n=r.showTick,i=r.tickLength,a=r.tickDirection,o=r.labelDirection,s=r.labelSpacing,l=e.indexOf(t),u=bd(s,[t,l,e]),h=(0,s6.__read)([xy(t.value,r),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.reduce(function(t,e){return t*("positive"===e?-1:1)},1)}(o,a)],2),d=h[0],c=1===h[1]?bd(n?i:0,[t,l,e]):0,f=(0,s6.__read)(b8(b4(d,u+c),xv(t.value,r)),2);return{x:f[0],y:f[1]}}function xF(t,e){"text"===t.nodeName&&t.attr(e)}function xB(t){var e,r,n,i;e=this.node().childNodes,r={hide:mK,show:mY,rotate:function(e,r){!function(t,e,r){e.setLocalEulerAngles(t);var n=xL(e.__data__.value,t,r),i=e.querySelector(b3.labelItem.class);i&&xF(i,n)}(+r,e,t)},ellipsis:function(t,e,r){t&&bC(t,e||1/0,r)},wrap:function(t,e,r){var n,i;t&&(void 0===(n=r)&&(n=2),void 0===i&&(i="top"),bA(t,{wordWrap:!0,wordWrapWidth:e,maxLines:n,textBaseline:i}))},getTextShape:function(t){return t.querySelector("text")}},(i=void 0===(n=t.labelOverlap)?[]:n).length&&i.forEach(function(n){var i=n.type,a=xI.get(i);t.labelOverlap.length<1||("hide"===i?function(t){for(var e=t;e;){if("offscreen"===e.className)return!0;e=e.parent}return!1}(e[0]):"rotate"===i?e.some(function(t){var e;return!!(null===(e=t.attr("transform"))||void 0===e?void 0:e.includes("rotate"))}):("ellipsis"===i||"wrap"===i)&&!(e.filter(function(t){return t.querySelector("text")}).length>1))||null==a||a(e,n,t,r)})}function xz(t,e,r,n,i){var a,o=r.indexOf(e),s=m4(t).append((a=i.labelFormatter,(0,sI.default)(a)?function(){return bR(bd(a,[e,o,r,xy(e.value,i)]))}:function(){return bR(e.label||"")})).attr("className",b3.labelItem.name).node(),l=(0,s6.__read)(br(xd(n,[e,o,r])),2),u=l[0],h=l[1],d=h.transform,c=(0,s6.__rest)(h,["transform"]);xk(s,d);var f=function(t,e,r){var n,i,a=r.labelAlign;if(null===(i=e.style.transform)||void 0===i?void 0:i.includes("rotate"))return e.getLocalEulerAngles();var o=0,s=xy(t.value,r),l=xp(t.value,r);return"horizontal"===a?0:(xS(n=(b5(o="perpendicular"===a?xD([1,0],s):xD([l[0]<0?-1:1,0],l))+360)%180,-90,90)||(n+=180),n)}(e,s,i);return s.getLocalEulerAngles()||s.setLocalEulerAngles(f),xF(s,(0,s6.__assign)((0,s6.__assign)({},xL(e.value,f,i)),u)),t.attr(c),s}var s6=y("7WQrb"),sI=y("ky7aH");function xV(t,e){return xg(t,e.tickDirection,e)}function xG(t,e,r,n,i,a){var o,s,l,u,h,d,c,f,p,g,y,v,m,b,x,E,w,_,S,k,N,O=(o=m4(this),s=n.tickFormatter,l=xV(t.value,n),u="line",(0,sI.default)(s)&&(u=function(){return bd(s,[t,e,r,l])}),o.append(u).attr("className",b3.tickItem.name));h=xV(t.value,n),x=(d=n.tickLength,p=(0,s6.__read)((c=bd(d,[t,e,r]),[[0,0],[(f=(0,s6.__read)(h,2))[0]*c,f[1]*c]]),2),y=(g=(0,s6.__read)(p[0],2))[0],v=g[1],b={x1:y,x2:(m=(0,s6.__read)(p[1],2))[0],y1:v,y2:m[1]}).x1,E=b.x2,w=b.y1,_=b.y2,k=(S=(0,s6.__read)(br(xd(i,[t,e,r,h])),2))[0],N=S[1],"line"===O.node().nodeName&&O.styles((0,s6.__assign)({x1:x,x2:E,y1:w,y2:_},k)),this.attr(N),O.styles(k);var T=(0,s6.__read)(xv(t.value,n),2),M=T[0],A=T[1];return by(this,{transform:"translate(".concat(M,", ").concat(A,")")},a)}var s6=y("7WQrb");function x$(t,e,r,n,i){var a=bt(n,"title"),o=(0,s6.__read)(br(a),2),s=o[0],l=o[1],u=l.transform,h=l.transformOrigin,d=(0,s6.__rest)(l,["transform","transformOrigin"]);e.styles(d);var c=u||function(t,e,r){var n=2*t.getGeometryBounds().halfExtents[1];if("vertical"===e){if("left"===r)return"rotate(-90) translate(0, ".concat(n/2,")");if("right"===r)return"rotate(-90) translate(0, -".concat(n/2,")")}return""}(t.node(),s.direction,s.position);t.styles((0,s6.__assign)((0,s6.__assign)({},s),{transformOrigin:h})),xk(t.node(),c);var f=function(t,e,r){var n=r.titlePosition,i=void 0===n?"lb":n,a=r.titleSpacing,o=bs(i),s=t.node().getLocalBounds(),l=(0,s6.__read)(s.min,2),u=l[0],h=l[1],d=(0,s6.__read)(s.halfExtents,2),c=d[0],f=d[1],p=(0,s6.__read)(e.node().getLocalBounds().halfExtents,2),g=p[0],y=p[1],v=(0,s6.__read)([u+c,h+f],2),m=v[0],b=v[1],x=(0,s6.__read)(ba(a),4),E=x[0],w=x[1],_=x[2],S=x[3];if(["start","end"].includes(i)&&"linear"===r.type){var k=r.startPos,N=r.endPos,O=(0,s6.__read)("start"===i?[k,N]:[N,k],2),T=O[0],M=O[1],A=xr([-M[0]+T[0],-M[1]+T[1]]),C=(0,s6.__read)(b4(A,E),2),R=C[0],I=C[1];return{x:T[0]+R,y:T[1]+I}}return o.includes("t")&&(b-=f+y+E),o.includes("r")&&(m+=c+g+w),o.includes("l")&&(m-=c+g+S),o.includes("b")&&(b+=f+y+_),{x:m,y:b}}(m4(r._offscreen||r.querySelector(b3.mainGroup.class)),e,n),p=f.x,g=f.y;return by(e.node(),{transform:"translate(".concat(p,", ").concat(g,")")},i)}function xU(t,e,r,n){var i=t.showLine,a=t.showTick,o=t.showLabel,s=bi(i,e.maybeAppendByClassName(b3.lineGroup,"g"),function(e){var r,i,a,o,s,l,u,h,d,c,f;return r=e,i=t,a=n,c=i.type,f=bt(i,"line"),"linear"===c?d=function(t,e,r,n){var i,a,o,s,l,u,h,d,c,f,p,g,y,v,m,b,x,E,w=e.showTrunc,_=e.startPos,S=e.endPos,k=e.truncRange,N=e.lineExtension,O=(0,s6.__read)([_,S],2),T=(0,s6.__read)(O[0],2),M=T[0],A=T[1],C=(0,s6.__read)(O[1],2),R=C[0],I=C[1],P=(0,s6.__read)(N?(void 0===(i=N)&&(i=[0,0]),a=(0,s6.__read)([_,S,i],3),s=(o=(0,s6.__read)(a[0],2))[0],l=o[1],h=(u=(0,s6.__read)(a[1],2))[0],d=u[1],f=(c=(0,s6.__read)(a[2],2))[0],p=c[1],m=Math.sqrt(Math.pow(y=(g=(0,s6.__read)([h-s,d-l],2))[0],2)+Math.pow(v=g[1],2)),[(x=(b=(0,s6.__read)([-f/m,p/m],2))[0])*y,x*v,(E=b[1])*y,E*v]):[,,,,].fill(0),4),D=P[0],L=P[1],j=P[2],F=P[3],B=function(e){return t.selectAll(b3.line.class).data(e,function(t,e){return e}).join(function(t){return t.append("line").attr("className",function(t){return"".concat(b3.line.name," ").concat(t.className)}).styles(r).transition(function(t){return by(this,xE(t.line),!1)})},function(t){return t.styles(r).transition(function(t){return by(this,xE(t.line),n.update)})},function(t){return t.remove()}).transitions()};if(!w||!k)return B([{line:[[M+D,A+L],[R+j,I+F]],className:b3.line.name}]);var z=(0,s6.__read)(k,2),V=z[0],G=z[1],$=R-M,U=I-A,H=(0,s6.__read)([M+$*V,A+U*V],2),W=H[0],q=H[1],Y=(0,s6.__read)([M+$*G,A+U*G],2),K=Y[0],X=Y[1],J=B([{line:[[M+D,A+L],[W,q]],className:b3.lineFirst.name},{line:[[K,X],[R+j,I+F]],className:b3.lineSecond.name}]);return e.truncRange,e.truncShape,e.lineExtension,J}(r,i,xh(f,"arrow"),a):(o=xh(f,"arrow"),s=i.startAngle,l=i.endAngle,u=i.center,h=i.radius,d=r.selectAll(b3.line.class).data([{d:xx.apply(void 0,(0,s6.__spreadArray)((0,s6.__spreadArray)([s,l],(0,s6.__read)(u),!1),[h],!1))}],function(t,e){return e}).join(function(t){return t.append("path").attr("className",b3.line.name).styles(i).styles({d:function(t){return t.d}})},function(t){return t.transition(function(){var t,e,r,n,i,o=this,d=function(t,e,r,n){if(!n)return t.attr("__keyframe_data__",r),null;var i=n.duration,a=function t(e,r){var n,i,a,o,s,l;return"number"==typeof e&&"number"==typeof r?function(t){return e*(1-t)+r*t}:Array.isArray(e)&&Array.isArray(r)?(n=r?r.length:0,i=e?Math.min(n,e.length):0,function(a){var o=Array(i),s=Array(n),l=0;for(l=0;l<i;++l)o[l]=t(e[l],r[l]);for(;l<n;++l)s[l]=r[l];for(l=0;l<i;++l)s[l]=o[l](a);return s}):"object"==typeof e&&"object"==typeof r?(void 0===(a=e)&&(a={}),void 0===(o=r)&&(o={}),s={},l={},Object.entries(o).forEach(function(e){var r=(0,s6.__read)(e,2),n=r[0],i=r[1];n in a?s[n]=t(a[n],i):l[n]=i}),function(t){return Object.entries(s).forEach(function(e){var r=(0,s6.__read)(e,2),n=r[0],i=r[1];return l[n]=i(t)}),l}):function(t){return e}}(e,r),o=Array(Math.ceil(+(void 0===i?0:i)/16)).fill(0).map(function(t,e,r){return{__keyframe_data__:a(e/(r.length-1))}});return t.animate(o,(0,s6.__assign)({fill:"both"},n))}(this,(e=(t=this.attributes).startAngle,r=t.endAngle,n=t.center,i=t.radius,(0,s6.__spreadArray)((0,s6.__spreadArray)([e,r],(0,s6.__read)(n),!1),[i],!1)),(0,s6.__spreadArray)((0,s6.__spreadArray)([s,l],(0,s6.__read)(u),!1),[h],!1),a.update);if(d){var c=function(){var t=uf(o.attributes,"__keyframe_data__");o.style.d=xx.apply(void 0,(0,s6.__spreadArray)([],(0,s6.__read)(t),!1))};d.onframe=c,d.onfinish=c}return d}).styles(i)},function(t){return t.remove()}).styles(o).transitions()),!function(t,e,r,n){var i,a,o=r.showArrow,s=r.showTrunc,l=r.lineArrow,u=r.lineArrowOffset,h=r.lineArrowSize;if(a="arc"===e?t.select(b3.line.class):s?t.select(b3.lineSecond.class):t.select(b3.line.class),!o||!l||"arc"===r.type&&(i=r.startAngle,r.endAngle-i==360)){var d=a.node();d&&(d.style.markerEnd=void 0);return}var c=bR(l);c.attr(n),bv(c,h,!0),a.style("markerEnd",c).style("markerEndOffset",-u)}(r,c,i,f),d})||[],l=bi(a,e.maybeAppendByClassName(b3.tickGroup,"g"),function(e){var i,a;return i=xc(r,t.tickFilter),a=bt(t,"tick"),e.selectAll(b3.tick.class).data(i,function(t){return t.id||t.label}).join(function(e){return e.append("g").attr("className",b3.tick.name).transition(function(e,r){return xG.call(this,e,r,i,t,a,!1)})},function(e){return e.transition(function(e,r){return this.removeChildren(),xG.call(this,e,r,i,t,a,n.update)})},function(t){return t.transition(function(){var t=this,e=xn(this.childNodes[0],n.exit);return bf(e,function(){return t.remove()}),e})}).transitions()})||[],u=bi(o,e.maybeAppendByClassName(b3.labelGroup,"g"),function(e){var i,a;return i=xc(r,t.labelFilter),a=bt(t,"label"),e.selectAll(b3.label.class).data(i,function(t,e){return e}).join(function(n){return n.append("g").attr("className",b3.label.name).transition(function(e){xz(this,e,r,a,t);var n=xj(e,r,t),i=n.x,o=n.y;return this.style.transform="translate(".concat(i,", ").concat(o,")"),null}).call(function(){xB.call(e,t)})},function(i){return i.transition(function(e){var i=function(t,e,r,n){if(void 0===n&&(n="destroy"),"text"===t.nodeName&&"text"===e.nodeName&&t.attributes.text===e.attributes.text)return t.remove(),[null];var i=function(){"destroy"===n?t.destroy():"hide"===n&&mK(t),e.isVisible()&&mY(e)};if(!r)return i(),[null];var a=r.duration,o=void 0===a?0:a,s=r.delay,l=void 0===s?0:s,u=Math.ceil(+o/2),h=+o/4,d=(0,s6.__read)(t.getGeometryBounds().center,2),c=d[0],f=d[1],p=(0,s6.__read)(e.getGeometryBounds().center,2),g=p[0],y=p[1],v=(0,s6.__read)([(c+g)/2-c,(f+y)/2-f],2),m=v[0],b=v[1],x=t.style.opacity,E=e.style.opacity,w=t.style.transform||"",_=e.style.transform||"",S=t.animate([{opacity:void 0===x?1:x,transform:"translate(0, 0) ".concat(w)},{opacity:0,transform:"translate(".concat(m,", ").concat(b,") ").concat(w)}],(0,s6.__assign)((0,s6.__assign)({fill:"both"},r),{duration:l+u+h})),k=e.animate([{opacity:0,transform:"translate(".concat(-m,", ").concat(-b,") ").concat(_),offset:.01},{opacity:void 0===E?1:E,transform:"translate(0, 0) ".concat(_)}],(0,s6.__assign)((0,s6.__assign)({fill:"both"},r),{duration:u+h,delay:l+u-h}));return bf(k,i),[S,k]}(this.querySelector(b3.labelItem.class),xz(this,e,r,a,t),n.update),o=xj(e,r,t),s=o.x,l=o.y,u=by(this,{transform:"translate(".concat(s,", ").concat(l,")")},n.update);return(0,s6.__spreadArray)((0,s6.__spreadArray)([],(0,s6.__read)(i),!1),[u],!1)}).call(function(r){var n,i;n=uf(r,"_transitions").flat().filter(x_),i=function(){xB.call(e,t)},0===n.length?i():Promise.all(n.map(function(t){return null==t?void 0:t.finished})).then(i)})},function(t){return t.transition(function(){var t=this,e=xn(this.childNodes[0],n.exit);return bf(e,function(){return m4(t).remove()}),e})}).transitions()})||[];return(0,s6.__spreadArray)((0,s6.__spreadArray)((0,s6.__spreadArray)([],(0,s6.__read)(s),!1),(0,s6.__read)(l),!1),(0,s6.__read)(u),!1).filter(function(t){return!!t})}var xH=function(t){function e(e){return t.call(this,e,b2)||this}return(0,s6.__extends)(e,t),e.prototype.render=function(t,e,r){var n=this,i=t.titleText,a=t.data,o=t.animate,s=t.showTitle,l=t.showGrid,u=t.dataThreshold,h=t.truncRange,d=(function(t,e){if(t.length<=e)return t;for(var r=Math.floor(t.length/e),n=[],i=0;i<t.length;i+=r)n.push(t[i]);return n})(a,u).filter(function(t){var e=t.value;return!h||!(e>h[0])||!(e<h[1])}),c=bc(void 0===r?o:r),f=bi(l,m4(e).maybeAppendByClassName(b3.gridGroup,"g"),function(e){var r,n,i,a,o,s,l,u;return n=(r=bt(t,"grid")).type,i=r.areaFill,a=xw(t),o=xc(d,t.gridFilter),l="segment"===n?(s=t.gridLength,o.map(function(e,r){var n=e.value,i=(0,s6.__read)(xv(n,t),2),a=i[0],o=i[1],l=(0,s6.__read)(b4(xg(n,t.gridDirection,t),s),2);return{id:r,points:[[a,o],[a+l[0],o+l[1]]]}})):function(t,e){var r=e.gridControlAngles,n=xw(e);if(!n)throw Error("grid center is not provide");if(t.length<2)throw Error("Invalid grid data");if(!r||0===r.length)throw Error("Invalid gridControlAngles");var i=(0,s6.__read)(n,2),a=i[0],o=i[1];return t.map(function(t,n){var i=t.value,s=(0,s6.__read)(xv(i,e),2),l=s[0],u=s[1],h=(0,s6.__read)([l-a,u-o],2),d=h[0],c=h[1],f=[];return r.forEach(function(t){var e=b6(t),r=(0,s6.__read)([Math.cos(e),Math.sin(e)],2),n=r[0],i=r[1];f.push([d*n-c*i+a,d*i+c*n+o])}),{points:f,id:n}})}(o,t),u=(0,s6.__assign)((0,s6.__assign)({},r),{center:a,areaFill:(0,sI.default)(i)?o.map(function(t,e){return bd(i,[t,e,o])}):i,animate:c,data:l}),e.selectAll(b3.grid.class).data([1]).join(function(t){return t.append(function(){return new xu({style:u})}).attr("className",b3.grid.name)},function(t){return t.transition(function(){return this.update(u)})},function(t){return t.remove()}).transitions()})||[],p=m4(e).maybeAppendByClassName(b3.mainGroup,"g");i&&(!this.initialized&&c.enter||this.initialized&&c.update)&&xU(t,m4(this.offscreenGroup),d,bc(!1));var g=xU(t,m4(p.node()),d,c),y=bi(s,m4(e).maybeAppendByClassName(b3.titleGroup,"g"),function(e){var r;return r=t.titleText,e.selectAll(b3.title.class).data([{title:r}].filter(function(t){return!!t.title}),function(t,e){return t.title}).join(function(i){return i.append(function(){return bR(r)}).attr("className",b3.title.name).transition(function(){return x$(m4(this),e,n,t,c.enter)})},function(r){return r.transition(function(){return x$(m4(this),e,n,t,c.update)})},function(t){return t.remove()}).transitions()})||[];return(0,s6.__spreadArray)((0,s6.__spreadArray)((0,s6.__spreadArray)([],(0,s6.__read)(f),!1),(0,s6.__read)(g),!1),(0,s6.__read)(y),!1).flat().filter(function(t){return!!t})},e}(m2),s6=y("7WQrb"),on=y("2eDEB"),ow=y("8hhuV");function xW(t){var e=t.canvas,r=t.touches,n=t.offsetX,i=t.offsetY;if(e)return[e.x,e.y];if(r){var a=r[0];return[a.clientX,a.clientY]}return n&&i?[n,i]:[0,0]}function xq(t,e){return+t.toPrecision(e)}var s6=y("7WQrb");function xY({map:t,initKey:e},r){let n=e(r);return t.has(n)?t.get(n):r}function xK(t){return"object"==typeof t?t.valueOf():t}class xX extends Map{constructor(t){if(super(),this.map=new Map,this.initKey=xK,null!==t)for(let[e,r]of t)this.set(e,r)}get(t){return super.get(xY({map:this.map,initKey:this.initKey},t))}has(t){return super.has(xY({map:this.map,initKey:this.initKey},t))}set(t,e){return super.set(function({map:t,initKey:e},r){let n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}({map:this.map,initKey:this.initKey},t),e)}delete(t){return super.delete(function({map:t,initKey:e},r){let n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}({map:this.map,initKey:this.initKey},t))}}class xJ{constructor(t){this.options=lP({},this.getDefaultOptions()),this.update(t)}getOptions(){return this.options}update(t={}){this.options=lP({},this.options,t),this.rescale(t)}rescale(t){}}const xZ=Symbol("defaultUnknown");function xQ(t,e,r){for(let n=0;n<e.length;n+=1)t.has(e[n])||t.set(r(e[n]),n)}function x0(t){let{value:e,from:r,to:n,mapper:i,notFoundReturn:a}=t,o=i.get(e);if(void 0===o){if(a!==xZ)return a;o=r.push(e)-1,i.set(e,o)}return n[o%n.length]}function x1(t){return t instanceof Date?t=>`${t}`:"object"==typeof t?t=>JSON.stringify(t):t=>t}class x2 extends xJ{getDefaultOptions(){return{domain:[],range:[],unknown:xZ}}constructor(t){super(t)}map(t){return 0===this.domainIndexMap.size&&xQ(this.domainIndexMap,this.getDomain(),this.domainKey),x0({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(t){return 0===this.rangeIndexMap.size&&xQ(this.rangeIndexMap,this.getRange(),this.rangeKey),x0({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(t){let[e]=this.options.domain,[r]=this.options.range;if(this.domainKey=x1(e),this.rangeKey=x1(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!t||t.range)&&this.rangeIndexMap.clear(),(!t||t.domain||t.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new x2(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;let{domain:t,compare:e}=this.options;return this.sortedDomain=e?[...t].sort(e):t,this.sortedDomain}}class x3 extends x2{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:xZ,flex:[]}}constructor(t){super(t)}clone(){return new x3(this.options)}getStep(t){return void 0===this.valueStep?1:"number"==typeof this.valueStep?this.valueStep:void 0===t?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}getBandWidth(t){return void 0===this.valueBandWidth?1:"number"==typeof this.valueBandWidth?this.valueBandWidth:void 0===t?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}getRange(){return this.adjustedRange}getPaddingInner(){let{padding:t,paddingInner:e}=this.options;return t>0?t:e}getPaddingOuter(){let{padding:t,paddingOuter:e}=this.options;return t>0?t:e}rescale(){super.rescale();let{align:t,domain:e,range:r,round:n,flex:i}=this.options,{adjustedRange:a,valueBandWidth:o,valueStep:s}=function(t){var e;let r,n;let{domain:i}=t,a=i.length;if(0===a)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(null===(e=t.flex)||void 0===e?void 0:e.length)return function(t){let{domain:e,range:r,paddingOuter:n,paddingInner:i,flex:a,round:o,align:s}=t,l=e.length,u=function(t,e){let r=e-t.length;return r>0?[...t,...Array(r).fill(1)]:r<0?t.slice(0,e):t}(a,l),[h,d]=r,c=d-h,f=c/(2/l*n+1-1/l*i),p=f*i/l,g=f-l*p,y=function(t){let e=Math.min(...t);return t.map(t=>t/e)}(u),v=g/y.reduce((t,e)=>t+e),m=new xX(e.map((t,e)=>{let r=y[e]*v;return[t,o?Math.floor(r):r]})),b=new xX(e.map((t,e)=>{let r=y[e]*v+p;return[t,o?Math.floor(r):r]})),x=Array.from(b.values()).reduce((t,e)=>t+e),E=h+(c-(x-x/l*i))*s,w=o?Math.round(E):E,_=Array(l);for(let t=0;t<l;t+=1){_[t]=Math.round(1e12*w)/1e12;let r=e[t];w+=b.get(r)}return{valueBandWidth:m,valueStep:b,adjustedRange:_}}(t);let{range:o,paddingOuter:s,paddingInner:l,round:u,align:h}=t,d=o[0],c=o[1]-d;r=c/Math.max(1,2*s+(a-l)),u&&(r=Math.floor(r)),d+=(c-r*(a-l))*h,n=r*(1-l),u&&(d=Math.round(d),n=Math.round(n));let f=Array(a).fill(0).map((t,e)=>d+e*r);return{valueStep:r,valueBandWidth:n,adjustedRange:f}}({align:t,range:r,round:n,flex:i,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:e});this.valueStep=s,this.valueBandWidth=o,this.adjustedRange=a}}var x6=function(t){return t};function x5(t,...e){return e.reduce((t,e)=>r=>t(e(r)),t)}var x4={},x8={};x8={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var x9={},x7={};x7=function(t){return!!t&&"string"!=typeof t&&(t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))};var Et=Array.prototype.concat,Ee=Array.prototype.slice,Er=x9=function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];x7(i)?e=Et.call(e,Ee.call(i)):e.push(i)}return e};Er.wrap=function(t){return function(){return t(Er(arguments))}};var En=Object.hasOwnProperty,Ei=Object.create(null);for(var Ea in x8)En.call(x8,Ea)&&(Ei[x8[Ea]]=Ea);var Eo=x4={to:{},get:{}};function Es(t,e,r){return Math.min(Math.max(e,t),r)}function El(t){var e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}function Eu(t,e,r){let n=r;return(n<0&&(n+=1),n>1&&(n-=1),n<1/6)?t+(e-t)*6*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Eh(t){let e=/*@__PURE__*/f(x4).get(t);if(!e)return null;let{model:r,value:n}=e;return"rgb"===r?n:"hsl"===r?function(t){let e=t[0]/360,r=t[1]/100,n=t[2]/100,i=t[3];if(0===r)return[255*n,255*n,255*n,i];let a=n<.5?n*(1+r):n+r-n*r,o=2*n-a;return[255*Eu(o,a,e+1/3),255*Eu(o,a,e),255*Eu(o,a,e-1/3),i]}(n):null}Eo.get=function(t){var e,r;switch(t.substring(0,3).toLowerCase()){case"hsl":e=Eo.get.hsl(t),r="hsl";break;case"hwb":e=Eo.get.hwb(t),r="hwb";break;default:e=Eo.get.rgb(t),r="rgb"}return e?{model:r,value:e}:null},Eo.get.rgb=function(t){if(!t)return null;var e,r,n,i=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=0,n=e[2],e=e[1];r<3;r++){var a=2*r;i[r]=parseInt(e.slice(a,a+2),16)}n&&(i[3]=parseInt(n,16)/255)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(r=0,n=(e=e[1])[3];r<3;r++)i[r]=parseInt(e[r]+e[r],16);n&&(i[3]=parseInt(n+n,16)/255)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(r=0;r<3;r++)i[r]=parseInt(e[r+1],0);e[4]&&(e[5]?i[3]=.01*parseFloat(e[4]):i[3]=parseFloat(e[4]))}else if(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(r=0;r<3;r++)i[r]=Math.round(2.55*parseFloat(e[r+1]));e[4]&&(e[5]?i[3]=.01*parseFloat(e[4]):i[3]=parseFloat(e[4]))}else if(!(e=t.match(/^(\w+)$/)))return null;else return"transparent"===e[1]?[0,0,0,0]:En.call(x8,e[1])?((i=x8[e[1]])[3]=1,i):null;for(r=0;r<3;r++)i[r]=Es(i[r],0,255);return i[3]=Es(i[3],0,1),i},Eo.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var r=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,Es(parseFloat(e[2]),0,100),Es(parseFloat(e[3]),0,100),Es(isNaN(r)?1:r,0,1)]}return null},Eo.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var r=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,Es(parseFloat(e[2]),0,100),Es(parseFloat(e[3]),0,100),Es(isNaN(r)?1:r,0,1)]}return null},Eo.to.hex=function(){var t=x9(arguments);return"#"+El(t[0])+El(t[1])+El(t[2])+(t[3]<1?El(Math.round(255*t[3])):"")},Eo.to.rgb=function(){var t=x9(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},Eo.to.rgb.percent=function(){var t=x9(arguments),e=Math.round(t[0]/255*100),r=Math.round(t[1]/255*100),n=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+r+"%, "+n+"%)":"rgba("+e+"%, "+r+"%, "+n+"%, "+t[3]+")"},Eo.to.hsl=function(){var t=x9(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},Eo.to.hwb=function(){var t=x9(arguments),e="";return t.length>=4&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},Eo.to.keyword=function(t){return Ei[t.slice(0,3)]};const Ed=(t,e)=>r=>t*(1-r)+e*r,Ec=(t,e)=>{let r=Eh(t),n=Eh(e);return null===r||null===n?r?()=>t:()=>e:t=>{let e=[,,,,];for(let i=0;i<4;i+=1){let a=r[i],o=n[i];e[i]=a*(1-t)+o*t}let[i,a,o,s]=e;return`rgba(${Math.round(i)}, ${Math.round(a)}, ${Math.round(o)}, ${s})`}},Ef=(t,e)=>"number"==typeof t&&"number"==typeof e?Ed(t,e):"string"==typeof t&&"string"==typeof e?Ec(t,e):()=>t,Ep=(t,e)=>{let r=Ed(t,e);return t=>Math.round(r(t))};function Eg(t,e){return e-t?r=>(r-t)/(e-t):t=>.5}const Ey=Math.sqrt(50),Ev=Math.sqrt(10),Em=Math.sqrt(2);function Eb(t,e,r){let n=(e-t)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),a=n/10**i;return i>=0?(a>=Ey?10:a>=Ev?5:a>=Em?2:1)*10**i:-(10**-i)/(a>=Ey?10:a>=Ev?5:a>=Em?2:1)}const Ex=(t,e,r=5)=>{let n;let i=[t,e],a=0,o=i.length-1,s=i[a],l=i[o];return l<s&&([s,l]=[l,s],[a,o]=[o,a]),(n=Eb(s,l,r))>0?n=Eb(s=Math.floor(s/n)*n,l=Math.ceil(l/n)*n,r):n<0&&(n=Eb(s=Math.ceil(s*n)/n,l=Math.floor(l*n)/n,r)),n>0?(i[a]=Math.floor(s/n)*n,i[o]=Math.ceil(l/n)*n):n<0&&(i[a]=Math.ceil(s*n)/n,i[o]=Math.floor(l*n)/n),i};var dl=y("aFcWQ");function EE(t){return!(0,dl.default)(t)&&null!==t&&!Number.isNaN(t)}const Ew=(t,e,r)=>{let n,i;let[a,o]=t,[s,l]=e;return a<o?(n=Eg(a,o),i=r(s,l)):(n=Eg(o,a),i=r(l,s)),x5(i,n)},E_=(t,e,r)=>{let n=Math.min(t.length,e.length)-1,i=Array(n),a=Array(n),o=t[0]>t[n],s=o?[...t].reverse():t,l=o?[...e].reverse():e;for(let t=0;t<n;t+=1)i[t]=Eg(s[t],s[t+1]),a[t]=r(l[t],l[t+1]);return e=>{let r=function(t,e,r,n,i){let a=1,o=n||t.length,s=t=>t;for(;a<o;){let r=Math.floor((a+o)/2);s(t[r])>e?o=r:a=r+1}return a}(t,e,0,n)-1,o=i[r];return x5(a[r],o)(e)}},ES=(t,e,r,n)=>(Math.min(t.length,e.length)>2?E_:Ew)(t,e,n?Ep:r);class Ek extends xJ{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Ed,tickCount:5}}map(t){return EE(t)?this.output(t):this.options.unknown}invert(t){return EE(t)?this.input(t):this.options.unknown}nice(){if(!this.options.nice)return;let[t,e,r,...n]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(t,e,r,...n)}getTicks(){let{tickMethod:t}=this.options,[e,r,n,...i]=this.getTickMethodOptions();return t(e,r,n,...i)}getTickMethodOptions(){let{domain:t,tickCount:e}=this.options;return[t[0],t[t.length-1],e]}chooseNice(){return Ex}rescale(){this.nice();let[t,e]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t)),this.composeInput(t,e,this.chooseClamp(e))}chooseClamp(t){let{clamp:e,range:r}=this.options,n=this.options.domain.map(t),i=Math.min(n.length,r.length);return e?function(t,e){let r=e<t?e:t,n=t>e?t:e;return t=>Math.min(Math.max(r,t),n)}(n[0],n[i-1]):x6}composeOutput(t,e){let{domain:r,range:n,round:i,interpolate:a}=this.options,o=ES(r.map(t),n,a,i);this.output=x5(o,e,t)}composeInput(t,e,r){let{domain:n,range:i}=this.options,a=ES(i,n.map(t),Ed);this.input=x5(e,r,a)}}const EN=(t,e,r)=>{let n,i;let a=t,o=e;if(a===o&&r>0)return[a];let s=Eb(a,o,r);if(0===s||!Number.isFinite(s))return[];if(s>0){a=Math.ceil(a/s),i=Array(n=Math.ceil((o=Math.floor(o/s))-a+1));for(let t=0;t<n;t+=1)i[t]=(a+t)*s}else{a=Math.ceil(a*(s=-s)),i=Array(n=Math.ceil((o=Math.floor(o*s))-a+1));for(let t=0;t<n;t+=1)i[t]=(a+t)/s}return i};class EO extends Ek{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:Ef,tickMethod:EN,tickCount:5}}chooseTransforms(){return[x6,x6]}clone(){return new EO(this.options)}}var sR=y("1uF5a"),sI=y("ky7aH"),ol=y("jyI49"),s6=y("7WQrb"),on=y("2eDEB"),ET=function(t){function e(e){var r=this,n=e.style,i=(0,s6.__rest)(e,["style"]);return(r=t.call(this,lP({},{type:"column"},(0,s6.__assign)({style:n},i)))||this).columnsGroup=new on.Group({name:"columns"}),r.appendChild(r.columnsGroup),r.render(),r}return(0,s6.__extends)(e,t),e.prototype.render=function(){var t=this.attributes,e=t.columns,r=t.x,n=t.y;this.columnsGroup.style.transform="translate(".concat(r,", ").concat(n,")"),m4(this.columnsGroup).selectAll(".column").data(e.flat()).join(function(t){return t.append("rect").attr("className","column").each(function(t){this.attr(t)})},function(t){return t.each(function(t){this.attr(t)})},function(t){return t.remove()})},e.prototype.update=function(t){this.attr(m0({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(on.DisplayObject),s6=y("7WQrb"),on=y("2eDEB"),EM=function(t){function e(e){var r=this,n=e.style,i=(0,s6.__rest)(e,["style"]);return(r=t.call(this,lP({},{type:"lines"},(0,s6.__assign)({style:n},i)))||this).linesGroup=r.appendChild(new on.Group),r.areasGroup=r.appendChild(new on.Group),r.render(),r}return(0,s6.__extends)(e,t),e.prototype.render=function(){var t=this.attributes,e=t.lines,r=t.areas,n=t.x,i=t.y;this.style.transform="translate(".concat(n,", ").concat(i,")"),e&&this.renderLines(e),r&&this.renderAreas(r)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(m0({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){m4(this.linesGroup).selectAll(".line").data(t).join(function(t){return t.append("path").attr("className","line").each(function(t){this.attr(t)})},function(t){return t.each(function(t){this.attr(t)})},function(t){return t.remove()})},e.prototype.renderAreas=function(t){m4(this.linesGroup).selectAll(".area").data(t).join(function(t){return t.append("path").attr("className","area").each(function(t){this.attr(t)})},function(t){return t.each(function(t){this.style(t)})},function(t){return t.remove()})},e}(on.DisplayObject),s6=y("7WQrb"),ow=y("8hhuV");function EA(t,e){void 0===e&&(e=!1);var r=e?t.length-1:0,n=t.map(function(t,e){return(0,s6.__spreadArray)([e===r?"M":"L"],(0,s6.__read)(t),!1)});return e?n.reverse():n}function EC(t,e){if(void 0===e&&(e=!1),t.length<=2)return EA(t);for(var r=[],n=t.length,i=0;i<n;i+=1){var a=e?t[n-i-1]:t[i];sd(a,r.slice(-2))||r.push.apply(r,(0,s6.__spreadArray)([],(0,s6.__read)(a),!1))}var o=function(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=[[0,0],[1,1]]);for(var n,i,a,o=!!e,s=[],l=0,u=t.length;l<u;l+=2)s.push([t[l],t[l+1]]);for(var h=function(t,e,r,n){var i,a,o,s,l,u,h=[],d=!!n,c=[1/0,1/0],f=[-1/0,-1/0];if(d){c=(i=(0,s6.__read)(n,2))[0],f=i[1];for(var p=0,g=t.length;p<g;p+=1){var y=t[p];c=b7(c,y),f=xt(f,y)}}for(var p=0,v=t.length;p<v;p+=1){var y=t[p];if(0!==p||r){if(p!==v-1||r){a=t[[p?p-1:v-1,p-1][r?0:1]];var m=[0,0];m=b4(m=b9(o=t[r?(p+1)%v:p+1],a),.4);var b=xe(y,a),x=xe(y,o),E=b+x;0!==E&&(b/=E,x/=E);var w=b4(m,-b),_=b4(m,x);l=b8(y,w),s=b7(s=b8(y,_),xt(o,y)),w=b4(w=b9(s=xt(s,b7(o,y)),y),-b/x),l=b7(l=b8(y,w),xt(a,y)),l=xt(l,b7(a,y)),_=b4(_=b9(y,l),x/b),s=b8(y,_),d&&(l=b7(l=xt(l,c),f),s=b7(s=xt(s,c),f)),h.push(u),h.push(l),u=s}else l=y,h.push(u),h.push(l)}else u=y}return r&&h.push(h.shift()),h}(s,0,o,r),d=s.length,c=[],l=0;l<d-1;l+=1)n=h[2*l],i=h[2*l+1],a=s[l+1],c.push(["C",n[0],n[1],i[0],i[1],a[0],a[1]]);return o&&(n=h[d],i=h[d+1],a=(0,s6.__read)(s,1)[0],c.push(["C",n[0],n[1],i[0],i[1],a[0],a[1]])),c}(r,!1);return e?o.unshift((0,s6.__spreadArray)(["M"],(0,s6.__read)(t[n-1]),!1)):o.unshift((0,s6.__spreadArray)(["M"],(0,s6.__read)(t[0]),!1)),o}function ER(t,e,r){var n=sj(t);return n.push(["L",e,r],["L",0,r],["Z"]),n}var s6=(y("7WQrb"),y("7WQrb")),EI=y("bFgqX"),sR=y("1uF5a"),sI=y("ky7aH"),EP=function(t,e){if((0,sR.default)(t)){for(var r,n=-1/0,i=0;i<t.length;i++){var a=t[i],o=(0,sI.default)(e)?e(a):a[e];o>n&&(r=a,n=o)}return r}},ED=y("04Wz9"),sR=y("1uF5a"),sI=y("ky7aH"),EL=function(t,e){if((0,sR.default)(t)){for(var r,n=1/0,i=0;i<t.length;i++){var a=t[i],o=(0,sI.default)(e)?e(a):a[e];o<n&&(r=a,n=o)}return r}};function Ej(t){return 0===t.length?[0,0]:[(0,ED.default)(EL(t,function(t){return(0,ED.default)(t)||0})),(0,EI.default)(EP(t,function(t){return(0,EI.default)(t)||0}))]}function EF(t){for(var e=sj(t),r=e[0].length,n=(0,s6.__read)([Array(r).fill(0),Array(r).fill(0)],2),i=n[0],a=n[1],o=0;o<e.length;o+=1)for(var s=e[o],l=0;l<r;l+=1)s[l]>=0?(s[l]+=i[l],i[l]=s[l]):(s[l]+=a[l],a[l]=s[l]);return e}var EB=function(t){function e(e){return t.call(this,e,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||(null==t?void 0:t.length)===0)return[[]];var e=sj(t);return(0,ol.default)(e[0])?[e]:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?EF(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,e=(0,s6.__read)(t.getOptions().domain||[0,0],2),r=e[0],n=e[1];return n<0?t.map(n):t.map(r<0?0:r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes;return{width:t.width,height:t.height}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,e=this.attributes,r=e.type,n=e.isStack,i=e.smooth;if("line"!==r)throw Error("linesStyle can only be used in line type");var a=bt(this.attributes,"area"),o=bt(this.attributes,"line"),s=this.containerShape.width,l=this.data;if(0===l[0].length)return{lines:[],areas:[]};var u=this.scales,h=(p=(c={type:"line",x:u.x,y:u.y}).x,g=c.y,v=(y=(0,s6.__read)(g.getOptions().range||[0,0],2))[0],(m=y[1])>v&&(m=(f=(0,s6.__read)([v,m],2))[0],v=f[1]),l.map(function(t){return t.map(function(t,e){return[p.map(e),(0,ow.default)(g.map(t),m,v)]})})),d=[];if(a){var c,f,p,g,y,v,m,b=this.baseline;d=n?i?function(t,e,r){for(var n=[],i=t.length-1;i>=0;i-=1){var a=t[i],o=EC(a),s=void 0;if(0===i)s=ER(o,e,r);else{var l=EC(t[i-1],!0),u=a[0];l[0][0]="L",s=(0,s6.__spreadArray)((0,s6.__spreadArray)((0,s6.__spreadArray)([],(0,s6.__read)(o),!1),(0,s6.__read)(l),!1),[(0,s6.__spreadArray)(["M"],(0,s6.__read)(u),!1),["Z"]],!1)}n.push(s)}return n}(h,s,b):function(t,e,r){for(var n=[],i=t.length-1;i>=0;i-=1){var a=EA(t[i]),o=void 0;if(0===i)o=ER(a,e,r);else{var s=EA(t[i-1],!0);s[0][0]="L",o=(0,s6.__spreadArray)((0,s6.__spreadArray)((0,s6.__spreadArray)([],(0,s6.__read)(a),!1),(0,s6.__read)(s),!1),[["Z"]],!1)}n.push(o)}return n}(h,s,b):h.map(function(t){return ER(i?EC(t):EA(t),s,b)})}return{lines:h.map(function(e,r){return(0,s6.__assign)({stroke:t.getColor(r),d:i?EC(e):EA(e)},o)}),areas:d.map(function(e,r){return(0,s6.__assign)({d:e,fill:t.getColor(r)},a)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,e=bt(this.attributes,"column"),r=this.attributes,n=r.isStack,i=r.type,a=r.scale;if("column"!==i)throw Error("columnsStyle can only be used in column type");var o=this.containerShape.height,s=this.rawData;if(!s)return{columns:[]};n&&(s=EF(s));var l=this.createScales(s),u=l.x,h=l.y,d=(0,s6.__read)(Ej(s),2),c=d[0],f=new EO({domain:[0,d[1]-(c>0?0:c)],range:[0,o*a]}),p=u.getBandWidth(),g=this.rawData;return{columns:s.map(function(r,i){return r.map(function(r,a){var o=p/s.length;return(0,s6.__assign)((0,s6.__assign)({fill:t.getColor(i)},e),n?{x:u.map(a),y:h.map(r),width:p,height:f.map(g[i][a])}:{x:u.map(a)+o*i,y:r>=0?h.map(r):h.map(0),width:o,height:f.map(Math.abs(r))})})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){(r=".container",n="rect",e.querySelector(r)?m4(e).select(r):m4(e).append(n)).attr("className","container").node();var r,n,i=t.type,a=t.x,o=t.y,s="spark".concat(i),l=(0,s6.__assign)({x:a,y:o},"line"===i?this.linesStyle:this.columnsStyle);m4(e).selectAll(".spark").data([i]).join(function(t){return t.append(function(t){return"line"===t?new EM({className:s,style:l}):new ET({className:s,style:l})}).attr("className","spark ".concat(s))},function(t){return t.update(l)},function(t){return t.remove()})},e.prototype.getColor=function(t){var e=this.attributes.color;return(0,sR.default)(e)?e[t%e.length]:(0,sI.default)(e)?e.call(null,t):e},e.prototype.createScales=function(t){var e,r,n=this.attributes,i=n.type,a=n.scale,o=n.range,s=void 0===o?[]:o,l=n.spacing,u=this.containerShape,h=u.width,d=u.height,c=(0,s6.__read)(Ej(t),2),f=c[0],p=c[1],g=new EO({domain:[null!==(e=s[0])&&void 0!==e?e:f,null!==(r=s[1])&&void 0!==r?r:p],range:[d,d*(1-a)]});return"line"===i?{type:i,x:new EO({domain:[0,t[0].length-1],range:[0,h]}),y:g}:{type:i,x:new x3({domain:t[0].map(function(t,e){return e}),range:[0,h],paddingInner:l,paddingOuter:l/2,align:.5}),y:g}},e.tag="sparkline",e}(m2),Ez={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},EV={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},EG={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},E$=bn({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),s6=y("7WQrb"),EU=bn({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),EH=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),e.prototype.render=function(t,e){var r=t.x,n=t.y,i=t.size,a=void 0===i?10:i,o=t.radius,s=t.orientation,l=(0,s6.__rest)(t,["x","y","size","radius","orientation"]),u=2.4*a,h=m4(e).maybeAppendByClassName(EU.iconRect,"rect").styles((0,s6.__assign)((0,s6.__assign)({},l),{width:a,height:u,radius:void 0===o?a/4:o,x:r-a/2,y:n-u/2,transformOrigin:"center"})),d=r+1/3*a-a/2,c=r+2/3*a-a/2,f=n+1/4*u-u/2,p=n+3/4*u-u/2;h.maybeAppendByClassName("".concat(EU.iconLine,"-1"),"line").styles((0,s6.__assign)({x1:d,x2:d,y1:f,y2:p},l)),h.maybeAppendByClassName("".concat(EU.iconLine,"-2"),"line").styles((0,s6.__assign)({x1:c,x2:c,y1:f,y2:p},l)),"vertical"===s&&(h.node().style.transform="rotate(90)")},e}(m2),EW=function(t){function e(e){return t.call(this,e,EG)||this}return(0,s6.__extends)(e,t),e.prototype.renderLabel=function(t){var e=this,r=this.attributes,n=r.x,i=r.y,a=r.showLabel,o=bt(this.attributes,"label"),s=o.x,l=void 0===s?0:s,u=o.y,h=void 0===u?0:u,d=o.transform,c=o.transformOrigin,f=(0,s6.__rest)(o,["x","y","transform","transformOrigin"]),p=(0,s6.__read)(br(f,[]),2),g=p[0],y=p[1],v=m4(t).maybeAppendByClassName(EU.labelGroup,"g").styles(y),m=(0,s6.__assign)((0,s6.__assign)({},EV),g),b=m.text,x=(0,s6.__rest)(m,["text"]);bi(!!a,v,function(t){e.label=t.maybeAppendByClassName(EU.label,"text").styles((0,s6.__assign)((0,s6.__assign)({},x),{x:n+l,y:i+h,transform:d,transformOrigin:c,text:"".concat(b)})),e.label.on("mousedown",function(t){t.stopPropagation()}),e.label.on("touchstart",function(t){t.stopPropagation()})})},e.prototype.renderIcon=function(t){var e=this.attributes,r=e.x,n=e.y,i=e.orientation,a=e.type,o=(0,s6.__assign)((0,s6.__assign)({x:r,y:n,orientation:i},Ez),bt(this.attributes,"icon")),s=this.attributes.iconShape,l=void 0===s?function(){return new EH({style:o})}:s;m4(t).maybeAppendByClassName(EU.iconGroup,"g").selectAll(EU.icon.class).data([l]).join(function(t){return t.append("string"==typeof l?l:function(){return l(a)}).attr("className",EU.icon.name)},function(t){return t.update(o)},function(t){return t.remove()})},e.prototype.render=function(t,e){this.renderIcon(e),this.renderLabel(e)},e}(m2),Eq=function(t){function e(e){var r=t.call(this,e,(0,s6.__assign)((0,s6.__assign)((0,s6.__assign)({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(t){return t.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},be(EG,"handle")),be(Ez,"handleIcon")),be(EV,"handleLabel")))||this;return r.range=[0,1],r.onDragStart=function(t){return function(e){e.stopPropagation(),r.target=t,r.prevPos=r.getOrientVal(xW(e));var n=r.availableSpace,i=n.x,a=n.y,o=r.getBBox(),s=o.x,l=o.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([i,a])-r.getOrientVal([+s,+l])),r.selectionWidth=0,document.addEventListener("pointermove",r.onDragging),document.addEventListener("pointerup",r.onDragEnd)}},r.onDragging=function(t){var e=r.attributes,n=e.slidable,i=e.brushable,a=e.type;t.stopPropagation();var o=r.getOrientVal(xW(t)),s=o-r.prevPos;if(s){var l=r.getRatio(s);switch(r.target){case"start":n&&r.setValuesOffset(l);break;case"end":n&&r.setValuesOffset(0,l);break;case"selection":n&&r.setValuesOffset(l,l);break;case"track":if(!i)return;r.selectionWidth+=l,"range"===a?r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0):r.innerSetValues([0,r.selectionStartPos+r.selectionWidth],!0)}r.prevPos=o}},r.onDragEnd=function(){document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointerup",r.onDragEnd),r.target="",r.updateHandlesPosition(!1)},r.onValueChange=function(t){var e=r.attributes,n=e.onChange,i=e.type,a="range"===i?t:t[1],o="range"===i?r.getValues():r.getValues()[1],s=new on.CustomEvent("valuechange",{detail:{oldValue:a,value:o}});r.dispatchEvent(s),null==n||n(o)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){if("horizontal"!==this.attributes.orientation)return null;var t=bt(this.attributes,"sparkline");return(0,s6.__assign)((0,s6.__assign)({zIndex:0},this.availableSpace),t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,e=t.trackLength,r=t.trackSize,n=(0,s6.__read)(this.getOrientVal([[e,r],[r,e]]),2);return{width:n[0],height:n[1]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,e=(t.x,t.y,t.padding),r=(0,s6.__read)(ba(e),4),n=r[0],i=r[1],a=r[2],o=r[3],s=this.shape;return{x:o,y:n,width:s.width-(o+i),height:s.height-(n+a)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1),this.attributes.values=t;var r=!1!==e&&this.attributes.animate;this.updateSelectionArea(r),this.updateHandlesPosition(r)},e.prototype.updateSelectionArea=function(t){var e=this.calcSelectionArea();this.foregroundGroup.selectAll(E$.selection.class).each(function(r,n){by(this,e[n],t)})},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&by(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&by(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1);var r=this.values,n=this.clampValues(t);this.attributes.values=n,this.setValues(n),e&&this.onValueChange(r)},e.prototype.renderTrack=function(t){var e=this.attributes,r=e.x,n=e.y,i=bt(this.attributes,"track");this.trackShape=m4(t).maybeAppendByClassName(E$.track,"rect").styles((0,s6.__assign)((0,s6.__assign)({x:r,y:n},this.shape),i))},e.prototype.renderBrushArea=function(t){var e=this.attributes,r=e.x,n=e.y,i=e.brushable;this.brushArea=m4(t).maybeAppendByClassName(E$.brushArea,"rect").styles((0,s6.__assign)({x:r,y:n,fill:"transparent",cursor:i?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var e=this,r=this.attributes,n=r.x,i=r.y;bi("horizontal"===r.orientation,m4(t).maybeAppendByClassName(E$.sparklineGroup,"g"),function(t){var r=(0,s6.__assign)((0,s6.__assign)({},e.sparklineStyle),{x:n,y:i});t.maybeAppendByClassName(E$.sparkline,function(){return new EB({style:r})}).update(r)})},e.prototype.renderHandles=function(){var t,e=this,r=this.attributes,n=r.showHandle,i=r.type,a=this;null===(t=this.foregroundGroup)||void 0===t||t.selectAll(E$.handle.class).data((n?"range"===i?["start","end"]:["end"]:[]).map(function(t){return{type:t}}),function(t){return t.type}).join(function(t){return t.append(function(t){var r=t.type;return new EW({style:e.getHandleStyle(r)})}).each(function(t){var e=t.type;this.attr("class","".concat(E$.handle.name," ").concat(e,"-handle")),a["".concat(e,"Handle")]=this,this.addEventListener("pointerdown",a.onDragStart(e))})},function(t){return t.each(function(t){var e=t.type;this.update(a.getHandleStyle(e))})},function(t){return t.each(function(t){var e=t.type;a["".concat(e,"Handle")]=void 0}).remove()})},e.prototype.renderSelection=function(t){var e=this.attributes,r=e.x,n=e.y,i=e.type,a=e.selectionType;this.foregroundGroup=m4(t).maybeAppendByClassName(E$.foreground,"g");var o=bt(this.attributes,"selection"),s=function(t){return t.style("visibility",function(t){return t.show?"visible":"hidden"}).style("cursor",function(t){return"select"===a?"grab":"invert"===a?"crosshair":"default"}).styles((0,s6.__assign)((0,s6.__assign)({},o),{transform:"translate(".concat(r,", ").concat(n,")")}))},l=this;this.foregroundGroup.selectAll(E$.selection.class).data("value"===i?[]:this.calcSelectionArea().map(function(t,e){return{style:(0,s6.__assign)({},t),index:e,show:"select"===a?1===e:1!==e}}),function(t){return t.index}).join(function(t){return t.append("rect").attr("className",E$.selection.name).call(s).each(function(t,e){var r=this;1===e?(l.selectionShape=m4(this),this.on("pointerdown",function(t){r.attr("cursor","grabbing"),l.onDragStart("selection")(t)}),l.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),l.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),l.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){r.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){r.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){r.attr("cursor","pointer")})):this.on("pointerdown",l.onDragStart("track"))})},function(t){return t.call(s)},function(t){return t.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,e){this.renderTrack(e),this.renderSparkline(e),this.renderBrushArea(e),this.renderSelection(e)},e.prototype.clampValues=function(t,e){void 0===e&&(e=4);var r,n=(0,s6.__read)(this.range,2),i=n[0],a=n[1],o=(0,s6.__read)(this.getValues().map(function(t){return xq(t,e)}),2),s=o[0],l=o[1],u=Array.isArray(t)?t:[s,null!=t?t:l],h=(0,s6.__read)((u||[s,l]).map(function(t){return xq(t,e)}),2),d=h[0],c=h[1];if("value"===this.attributes.type)return[0,(0,ow.default)(c,i,a)];d>c&&(d=(r=(0,s6.__read)([c,d],2))[0],c=r[1]);var f=c-d;return f>a-i?[i,a]:d<i?s===i&&l===c?[i,c]:[i,f+i]:c>a?l===a&&s===d?[d,a]:[a-f,a]:[d,c]},e.prototype.calcSelectionArea=function(t){var e=(0,s6.__read)(this.clampValues(t),2),r=e[0],n=e[1],i=this.availableSpace,a=i.x,o=i.y,s=i.width,l=i.height;return this.getOrientVal([[{y:o,height:l,x:a,width:r*s},{y:o,height:l,x:r*s+a,width:(n-r)*s},{y:o,height:l,x:n*s,width:(1-n)*s}],[{x:a,width:s,y:o,height:r*l},{x:a,width:s,y:r*l+o,height:(n-r)*l},{x:a,width:s,y:n*l,height:(1-n)*l}]])},e.prototype.calcHandlePosition=function(t){var e=this.attributes.handleIconOffset,r=this.availableSpace,n=r.x,i=r.y,a=r.width,o=r.height,s=(0,s6.__read)(this.clampValues(),2),l=s[0],u=s[1],h=("start"===t?l:u)*this.getOrientVal([a,o])+("start"===t?-e:e);return{x:n+this.getOrientVal([h,a/2]),y:i+this.getOrientVal([o/2,h])}},e.prototype.inferTextStyle=function(t){return"horizontal"===this.attributes.orientation?{}:"start"===t?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:"end"===t?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var e,r=this.attributes,n=r.type,i=r.orientation,a=r.formatter,o=r.autoFitLabel,s=bt(this.attributes,"handle"),l=bt(s,"label"),u=s.spacing,h=this.getHandleSize(),d=this.clampValues(),c=a("start"===t?d[0]:d[1]),f=new m6({style:(0,s6.__assign)((0,s6.__assign)((0,s6.__assign)({},l),this.inferTextStyle(t)),{text:c})}),p=f.getBBox(),g=p.width,y=p.height;if(f.destroy(),!o){if("value"===n)return{text:c,x:0,y:-y-u};var v=u+h+("horizontal"===i?g/2:0);return(e={text:c})["horizontal"===i?"x":"y"]="start"===t?-v:v,e}var m=0,b=0,x=this.availableSpace,E=x.width,w=x.height,_=this.calcSelectionArea()[1],S=_.x,k=_.y,N=_.width,O=_.height,T=u+h;if("horizontal"===i){var M=T+g/2;m="start"===t?S-T-g>0?-M:M:E-S-N-T>g?M:-M}else{var A=y+T;b="start"===t?k-h>y?-A:T:w-(k+O)-h>y?A:-T}return{x:m,y:b,text:c}},e.prototype.getHandleLabelStyle=function(t){var e=bt(this.attributes,"handleLabel");return(0,s6.__assign)((0,s6.__assign)((0,s6.__assign)({},e),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,e=bt(this.attributes,"handleIcon"),r=this.getOrientVal(["ew-resize","ns-resize"]),n=this.getHandleSize();return(0,s6.__assign)({cursor:r,shape:t,size:n},e)},e.prototype.getHandleStyle=function(t){var e=this.attributes,r=e.x,n=e.y,i=e.showLabel,a=e.showLabelOnInteraction,o=e.orientation,s=this.calcHandlePosition(t),l=s.x,u=s.y,h=this.calcHandleText(t),d=i;return!i&&a&&(d=!!this.target),(0,s6.__assign)((0,s6.__assign)((0,s6.__assign)({},be(this.getHandleIconStyle(),"icon")),be((0,s6.__assign)((0,s6.__assign)({},this.getHandleLabelStyle(t)),h),"label")),{transform:"translate(".concat(l+r,", ").concat(u+n,")"),orientation:o,showLabel:d,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,e=t.handleIconSize,r=t.width,n=t.height;return e||Math.floor((this.getOrientVal([+n,+r])+4)/2.4)},e.prototype.getOrientVal=function(t){var e=(0,s6.__read)(t,2),r=e[0],n=e[1];return"horizontal"===this.attributes.orientation?r:n},e.prototype.setValuesOffset=function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=!1);var n=this.attributes.type,i=(0,s6.__read)(this.getValues(),2),a=[i[0]+("range"===n?t:0),i[1]+e].sort();r?this.setValues(a):this.innerSetValues(a,!0)},e.prototype.getRatio=function(t){var e=this.availableSpace,r=e.width,n=e.height;return t/this.getOrientVal([r,n])},e.prototype.dispatchCustomEvent=function(t,e,r){var n=this;t.on(e,function(t){t.stopPropagation(),n.dispatchEvent(new on.CustomEvent(r,{detail:t}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){if(this.attributes.scrollable){var e=t.deltaX,r=t.deltaY,n=this.getRatio(r||e);this.setValuesOffset(n,n,!0)}},e.tag="slider",e}(m2),s6=y("7WQrb"),on=y("2eDEB"),s6=y("7WQrb"),ow=y("8hhuV"),on=y("2eDEB"),s6=y("7WQrb"),on=(y("2eDEB"),y("2eDEB")),EY={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(t){return t.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},EK=bn({background:"background",labelGroup:"label-group",label:"label"},"indicator"),EX=function(t){function e(e){var r=t.call(this,e,EY)||this;return r.point=[0,0],r.group=r.appendChild(new on.Group({})),r.isMutationObserved=!0,r}return(0,s6.__extends)(e,t),e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,e=t.position,r=t.padding,n=(0,s6.__read)(ba(r),4),i=n[0],a=n[1],o=n[2],s=n[3],l=this.label.node().getLocalBounds(),u=l.min,h=l.max,d=new m3(u[0]-s,u[1]-i,h[0]+a-u[0]+s,h[1]+o-u[1]+i),c=this.getPath(e,d),f=bt(this.attributes,"background");this.background=m4(this.group).maybeAppendByClassName(EK.background,"path").styles((0,s6.__assign)((0,s6.__assign)({},f),{d:c})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,e=t.formatter,r=t.labelText,n=bt(this.attributes,"label"),i=(0,s6.__read)(br(n),2),a=i[0],o=i[1],s=(a.text,(0,s6.__rest)(a,["text"]));this.label=m4(this.group).maybeAppendByClassName(EK.labelGroup,"g").styles(o),r&&this.label.maybeAppendByClassName(EK.label,function(){return bR(e(r))}).style("text",e(r).toString()).selectAll("text").styles(s)},e.prototype.adjustLayout=function(){var t=(0,s6.__read)(this.point,2),e=t[0],r=t[1],n=this.attributes,i=n.x,a=n.y;this.group.attr("transform","translate(".concat(i-e,", ").concat(a-r,")"))},e.prototype.getPath=function(t,e){var r=this.attributes.radius,n=e.x,i=e.y,a=e.width,o=e.height,s=[["M",n+r,i],["L",n+a-r,i],["A",r,r,0,0,1,n+a,i+r],["L",n+a,i+o-r],["A",r,r,0,0,1,n+a-r,i+o],["L",n+r,i+o],["A",r,r,0,0,1,n,i+o-r],["L",n,i+r],["A",r,r,0,0,1,n+r,i],["Z"]],l={top:4,right:6,bottom:0,left:2}[t],u=this.createCorner([s[l].slice(-2),s[l+1].slice(-2)]);return s.splice.apply(s,(0,s6.__spreadArray)([l+1,1],(0,s6.__read)(u),!1)),s[0][0]="M",s},e.prototype.createCorner=function(t,e){void 0===e&&(e=10);var r=bN.apply(void 0,(0,s6.__spreadArray)([],(0,s6.__read)(t),!1)),n=(0,s6.__read)(t,2),i=(0,s6.__read)(n[0],2),a=i[0],o=i[1],s=(0,s6.__read)(n[1],2),l=s[0],u=s[1],h=(0,s6.__read)(r?[l-a,[a,l]]:[u-o,[o,u]],2),d=h[0],c=(0,s6.__read)(h[1],2),f=c[0],p=c[1],g=d/2,y=d/Math.abs(d)*e,v=y/2,m=y*Math.sqrt(3)/2*.8,b=(0,s6.__read)([f,f+g-v,f+g,f+g+v,p],5),x=b[0],E=b[1],w=b[2],_=b[3],S=b[4];return r?(this.point=[w,o-m],[["L",x,o],["L",E,o],["L",w,o-m],["L",_,o],["L",S,o]]):(this.point=[a+m,w],[["L",a,x],["L",a,E],["L",a+m,w],["L",a,_],["L",a,S]])},e.prototype.applyVisibility=function(){"hidden"===this.attributes.visibility?mK(this):mY(this)},e.prototype.bindEvents=function(){this.label.on(on.ElementEvent.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(m2),s6=y("7WQrb"),on=(y("2eDEB"),y("2eDEB")),s6=y("7WQrb"),on=y("2eDEB"),EJ=function(t){function e(r){var n=t.call(this,m0({},e.defaultOptions,r))||this;return n.hoverColor="#f5f5f5",n.selectedColor="#e6f7ff",n.background=n.appendChild(new on.Rect({})),n.label=n.background.appendChild(new on.Group({})),n}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return ba(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,e=t.label,r=t.value,n=bt(this.attributes,"label");m4(this.label).maybeAppend(".label",function(){return bR(e)}).attr("className","label").styles(n),this.label.attr("__data__",r)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),e=(0,s6.__read)(this.padding,4),r=e[0],n=e[1],i=e[2],a=e[3],o=t.width,s=t.height,l=s+r+i,u=bt(this.attributes,"background"),h=this.style,d=h.width,c=h.height,f=h.selected;this.background.attr((0,s6.__assign)((0,s6.__assign)({},u),{width:Math.max(o+a+n,void 0===d?0:d),height:Math.max(l,void 0===c?0:c),fill:f?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(a,", ").concat((l-s)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",function(){t.style.selected||t.background.attr("fill",t.hoverColor)}),this.addEventListener("pointerleave",function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)});var e=this;this.addEventListener("click",function(){var r=t.style,n=r.label,i=r.value,a=r.onClick;null==a||a(i,{label:n,value:i},e)})},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(m2),EZ=function(t){function e(r){var n,i,a=t.call(this,m0({},e.defaultOptions,r))||this;a.currentValue=null===(n=e.defaultOptions.style)||void 0===n?void 0:n.defaultValue,a.isPointerInSelect=!1,a.select=a.appendChild(new on.Rect({className:"select",style:{cursor:"pointer",width:0,height:0}})),a.dropdown=a.appendChild(new on.Rect({className:"dropdown"}));var o=a.style.defaultValue;return o&&(null===(i=a.style.options)||void 0===i?void 0:i.some(function(t){return t.value===o}))&&(a.currentValue=o),a}return(0,s6.__extends)(e,t),e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return ba(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t,e=this,r=this.style,n=r.x,i=r.y,a=r.width,o=r.height,s=r.bordered,l=r.showDropdownIcon,u=bt(this.attributes,"select"),h=bt(this.attributes,"placeholder");this.select.attr((0,s6.__assign)((0,s6.__assign)({x:n,y:i,width:a,height:o},u),{fill:"#fff",strokeWidth:s?1:0}));var d=this.dropdownPadding;l&&m4(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(n+a-10-d[1]-d[3],", ").concat(i+o/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var c=null===(t=this.style.options)||void 0===t?void 0:t.find(function(t){return t.value===e.currentValue}),f=(0,s6.__assign)({x:n+d[3]},h);m4(this.select).selectAll(".placeholder").data(c?[]:[1]).join(function(t){return t.append("text").attr("className","placeholder").styles(f).style("y",function(){return i+(o-this.getBBox().height)/2})},function(t){return t.styles(f)},function(t){return t.remove()});var p=bt(this.attributes,"optionLabel"),g=(0,s6.__assign)({x:n+d[3]},p);m4(this.select).selectAll(".value").data(c?[c]:[]).join(function(t){return t.append(function(t){return bR(t.label)}).attr("className","value").styles(g).style("y",function(){return i+(o-this.getBBox().height)/2})},function(t){return t.styles(g)},function(t){return t.remove()})},e.prototype.renderDropdown=function(){var t,e,r=this,n=this.style,i=n.x,a=n.y,o=n.width,s=n.height,l=n.options,u=n.onSelect,h=n.open,d=bt(this.attributes,"dropdown"),c=bt(this.attributes,"option"),f=this.dropdownPadding;m4(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(l,function(t){return t.value}).join(function(t){return t.append(function(t){return new EJ({className:"dropdown-item",style:(0,s6.__assign)((0,s6.__assign)((0,s6.__assign)({},t),c),{width:o-f[1]-f[3],selected:t.value===r.currentValue,onClick:function(t,e,n){r.setValue(t),null==u||u(t,e,n),r.dispatchEvent(new on.CustomEvent("change",{detail:{value:t,option:e,item:n}})),mK(r.dropdown)}})})}).each(function(t,e){var r,n=(null===(r=this.parentNode)||void 0===r?void 0:r.children).reduce(function(t,r,n){return n<e&&(t+=r.getBBox().height),t},0);this.attr("transform","translate(".concat(f[3],", ").concat(f[0]+n,")"))})},function(t){return t.update(function(t){return{selected:t.value===r.currentValue}})},function(t){return t.remove()});var p=null===(e=null===(t=this.dropdown.getElementsByClassName("dropdown-container"))||void 0===t?void 0:t[0])||void 0===e?void 0:e.getBBox(),g=d.spacing;this.dropdown.attr((0,s6.__assign)({transform:"translate(".concat(i,", ").concat(a+s+g,")"),width:p.width+f[1]+f[3],height:p.height+f[0]+f[2]},d)),h||mK(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",function(t){t.stopPropagation()}),this.select.addEventListener("click",function(){"visible"===t.dropdown.style.visibility?mK(t.dropdown):mY(t.dropdown)}),this.addEventListener("pointerenter",function(){t.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){t.isPointerInSelect=!1}),null==document||document.addEventListener("click",function(){t.isPointerInSelect||mK(t.dropdown)})},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(m2),EQ=function(t){function e(r){var n=t.call(this,m0({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,r))||this;return n.showBackground=!0,n.background=n.appendChild(new on.Rect({})),n.icon=n.appendChild(new on.Group({})),n}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return ba(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,e=(0,s6.__read)(this.padding,4),r=e[0],n=e[1],i=e[2];return Math.max(t-Math.max(e[3]+n,r+i),2*this.lineWidth+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,r=t.y,n=t.size,i=n/2,a=bt(this.attributes,"background");this.background.attr((0,s6.__assign)({x:e-i,y:r-i,width:n,height:n},a))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,e=this.background.getBBox(),r=e.x,n=e.y;this.indicator.update({x:r+t/2,y:n-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){t.prototype.connectedCallback.call(this);var e,r=this.attributes.size,n=this.background.getBBox(),i=n.x,a=n.y,o=null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView;o&&(this.indicator=o.appendChild(new EX({style:{x:i+r/2,y:a-r/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,r=this.attributes.onClick;if(this.addEventListener("click",function(){null==r||r(t)}),this.showBackground){var n=function(){return t.background.attr({opacity:e.backgroundOpacities.default})};this.addEventListener("pointerenter",function(){t.background.attr({opacity:e.backgroundOpacities.hover}),t.showIndicator()}),this.addEventListener("pointerleave",function(){n(),t.hideIndicator()}),this.addEventListener("pointerdown",function(){t.background.attr({opacity:e.backgroundOpacities.active})}),this.addEventListener("pointerup",function(){n()})}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(m2),E0=function(t,e){return void 0===e&&(e="#565758"),new on.Path({style:{fill:e,d:"M ".concat(t,",").concat(t," L -").concat(t,",0 L ").concat(t,",-").concat(t," Z"),transformOrigin:"center"}})},E1=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),e.prototype.arcPath=function(t,e,r){var n=(0,s6.__read)([r,r],2),i=n[0],a=n[1],o=function(n){return[t+r*Math.cos(n),e+r*Math.sin(n)]},s=(0,s6.__read)(o(-5/4*Math.PI),2),l=s[0],u=s[1],h=(0,s6.__read)(o(1/4*Math.PI),2),d=h[0],c=h[1];return"M".concat(l,",").concat(u,",A").concat(i,",").concat(a,",0,1,1,").concat(d,",").concat(c)},Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,r=t.y,n=t.color,i=this.iconSize,a=this.lineWidth;m4(this.icon).maybeAppend(".reset","path").styles({stroke:n,lineWidth:a,d:this.arcPath(e,r,i/2-a),markerStart:E0(a+.5,n)})},e}(EQ),E2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,r=t.y,n=t.color,i=this.iconSize,a=i/2,o=i/2/1.7320508075688772;m4(this.icon).maybeAppend(".backward","polygon").styles({points:[[e,r],[e,r-o],[e-a,r],[e,r+o],[e,r],[e+a,r-o],[e+a,r+o],[e,r]],fill:n})},e}(EQ),E3=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,r=t.y,n=t.color,i=this.iconSize,a=i/2,o=i/2/1.7320508075688772;m4(this.icon).maybeAppend(".forward","polygon").styles({points:[[e,r],[e,r-o],[e+a,r],[e,r+o],[e,r],[e-a,r-o],[e-a,r+o],[e,r]],fill:n})},e}(EQ),E6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,r=t.y,n=t.color,i=this.iconSize,a=i/3*1.3856406460551018;m4(this.icon).maybeAppend(".play","polygon").styles({points:[[e+a,r],[e-a/2,r-i/2*.8],[e-a/2,r+i/2*.8],[e+a,r]],fill:n})},e}(EQ),E5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,r=t.y,n=t.color,i=this.iconSize,a=i/3;m4(this.icon).maybeAppend(".pause","polygon").styles({points:[[e-a,r-i/2],[e-a,r+i/2],[e-a/2,r+i/2],[e-a/2,r-i/2],[e-a,r-i/2],[e+a/2,r-i/2],[e+a/2,r+i/2],[e+a,r+i/2],[e+a,r-i/2]],fill:n})},e}(EQ),E4=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,r=t.y,n=t.color,i=this.iconSize,a=this.lineWidth;m4(this.icon).maybeAppend(".left-line","line").styles({x1:e-i/2,y1:r-i/2,x2:e-i/2,y2:r+i/2,stroke:n,lineWidth:a}),m4(this.icon).maybeAppend(".right-line","line").styles({x1:e+i/2,y1:r-i/2,x2:e+i/2,y2:r+i/2,stroke:n,lineWidth:a}),m4(this.icon).maybeAppend(".left-arrow","line").styles({x1:e,y1:r,x2:e-i/2+2*a,y2:r,stroke:n,lineWidth:a,markerEnd:E0(2*a,n)}),m4(this.icon).maybeAppend(".right-arrow","line").styles({x1:e,y1:r,x2:e+i/2-2*a,y2:r,stroke:n,lineWidth:a,markerEnd:E0(2*a,n)})},e}(EQ),E8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,r=t.y,n=t.color,i=this.iconSize,a=this.lineWidth;m4(this.icon).maybeAppend(".line","line").styles({x1:e,y1:r-i/2,x2:e,y2:r+i/2,stroke:n,lineWidth:a}),m4(this.icon).maybeAppend(".left-arrow","line").styles({x1:e-i/2-2*a,y1:r,x2:e-2*a,y2:r,stroke:n,lineWidth:a,markerEnd:E0(2*a,n)}),m4(this.icon).maybeAppend(".right-arrow","line").styles({x1:e+i/2+2*a,y1:r,x2:e+2*a,y2:r,stroke:n,lineWidth:a,markerEnd:E0(2*a,n)})},e}(EQ),E9=function(t){return[[-t/2,-t/2],[-t/2,t/2],[t/2,t/2]]},E7=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,r=t.y,n=t.color,i=this.iconSize,a=this.lineWidth,o=(i-2*a-a)/4,s=(i-2*a-a)/2,l=(0,s6.__read)([e-i/2+a,r+i/2-2*a],2),u=l[0],h=l[1];m4(this.icon).maybeAppend(".coordinate","polyline").styles({points:E9(i).map(function(t){var n=(0,s6.__read)(t,2);return[n[0]+e,n[1]+r]}),stroke:n,lineWidth:a}),m4(this.icon).maybeAppend(".line","polyline").styles({points:[[u,h],[u+o,h-s],[u+2*o,h],[u+4*o,h-2*s]],stroke:n,lineWidth:a})},e}(EQ),wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,e=this.attributes,r=e.x,n=e.y,i=e.color,a=this.iconSize,o=this.lineWidth,s=(a-o)/t.length,l=(a-2*o)/4,u=(0,s6.__read)([r-a/2+2*o,n+a/2-o],2),h=u[0],d=u[1];m4(this.icon).maybeAppend(".coordinate","polyline").styles({points:E9(a).map(function(t){var e=(0,s6.__read)(t,2);return[e[0]+r,e[1]+n]}),stroke:i,lineWidth:o}),m4(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(t,e){return{value:t,index:e}})).join(function(t){return t.append("line").attr("className","column").style("x1",function(t){return h+s*t.index}).style("y1",d).style("x2",function(t){return h+s*t.index}).style("y2",function(t){return d-l*t.value}).styles({y1:d,stroke:i,lineWidth:o})})},e}(EQ),we=function(t){function e(e){var r=t.call(this,m0({},{style:{color:"#d8d9d9"}},e))||this;return r.showBackground=!1,r}return(0,s6.__extends)(e,t),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,r=t.y,n=t.color,i=this.iconSize,a=this.lineWidth;m4(this.icon).maybeAppend(".split","line").styles({x1:e,y1:r-i/2,x2:e,y2:r+i/2,stroke:n,lineWidth:a})},e}(EQ),wr=function(t){function e(){var e=t.apply(this,(0,s6.__spreadArray)([],(0,s6.__read)(arguments),!1))||this;return e.showBackground=!1,e}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return ba(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,e=this.attributes,r=e.x,n=e.y,i=e.speed,a=vF(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),o=(0,ow.default)(t,20,1/0),s=(0,s6.__assign)((0,s6.__assign)({},a),{x:r-o/2,y:n-10,width:o,height:20,defaultValue:void 0===i?1:i,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});m4(this.icon).maybeAppend(".speed",function(){return new EZ({style:s})}).attr("className","speed").each(function(){this.update(s)})},e.tag="SpeedSelect",e}(EQ),wn=function(t){function e(e){var r=t.call(this,e)||this;return r.icon=r.appendChild(new on.Group({})),r.currentType=r.attributes.type,r}return(0,s6.__extends)(e,t),e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,e=this.attributes,r=(e.onChange,(0,s6.__rest)(e,["onChange"]));m4(this.icon).selectAll(".icon").data([this.currentType]).join(function(e){return e.append(function(e){var r,n=null===(r=t.toggles.find(function(t){return(0,s6.__read)(t,1)[0]===e}))||void 0===r?void 0:r[1];if(!n)throw Error("Invalid type: ".concat(e));return new n({})}).attr("className","icon").styles(r,!1).update({})},function(t){return t.styles({restStyles:r}).update({})},function(t){return t.remove()})},e.prototype.bindEvents=function(){var t=this,e=this.attributes.onChange;this.addEventListener("click",function(r){r.preventDefault(),r.stopPropagation();var n=(t.toggles.findIndex(function(e){return(0,s6.__read)(e,1)[0]===t.currentType})+1)%t.toggles.length,i=t.toggles[n][0];null==e||e(t.currentType),t.currentType=i,t.render()})},e.tag="ToggleIcon",e}(m2),wi=function(t){function e(e){var r=t.call(this,m0({},{style:{type:"play"}},e))||this;return r.toggles=[["play",E6],["pause",E5]],r}return(0,s6.__extends)(e,t),e}(wn),wa=function(t){function e(e){var r=t.call(this,m0({},{style:{type:"range"}},e))||this;return r.toggles=[["range",E4],["value",E8]],r}return(0,s6.__extends)(e,t),e}(wn),wo=function(t){function e(e){var r=t.call(this,m0({},{style:{type:"column"}},e))||this;return r.toggles=[["line",E7],["column",wt]],r}return(0,s6.__extends)(e,t),e}(wn),ws={reset:E1,speed:wr,backward:E2,playPause:wi,forward:E3,selectionType:wa,chartType:wo,split:we},wl=function(t){function e(r){var n=t.call(this,m0({},e.defaultOptions,r))||this;return n.background=n.appendChild(new on.Rect({})),n.functions=n.appendChild(new on.Group({})),n}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return ba(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,e=t.x,r=t.y,n=t.width,i=t.height,a=bt(this.attributes,"background");this.background.attr((0,s6.__assign)({x:e,y:r,width:n,height:i},a))},e.prototype.renderFunctions=function(){var t,e=this,r=this.attributes,n=r.functions,i=r.iconSize,a=r.iconSpacing,o=r.x,s=r.y,l=r.width,u=r.height,h=r.align,d=(0,s6.__read)(this.padding,4),c=d[1],f=d[3],p=n.reduce(function(t,e){return t.length&&e.length?t.concat.apply(t,(0,s6.__spreadArray)(["split"],(0,s6.__read)(e),!1)):t.concat.apply(t,(0,s6.__spreadArray)([],(0,s6.__read)(e),!1))},[]),g=p.length*(i+a)-a,y={left:f+i/2,center:(l-g)/2+i/2,right:l-g-f-c+i/2}[h]||0;null===(t=this.speedSelect)||void 0===t||t.destroy(),this.functions.removeChildren(),p.forEach(function(t,r){var n,l=ws[t],h={x:o+r*(i+a)+y,y:s+u/2,size:i};if(l===wr?(h.speed=e.attributes.speed,h.onSelect=function(r){return e.handleFunctionChange(t,{value:r})}):[wi,wa,wo].includes(l)?(h.onChange=function(r){return e.handleFunctionChange(t,{value:r})},l===wi&&(h.type="play"===e.attributes.state?"pause":"play"),l===wa&&(h.type="range"===e.attributes.selectionType?"value":"range"),l===wo&&(h.type="line"===e.attributes.chartType?"column":"line")):h.onClick=function(){return e.handleFunctionChange(t,{value:t})},l===wr){var d=null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView;d&&(e.speedSelect=new l({style:(0,s6.__assign)((0,s6.__assign)({},h),{zIndex:100})}),d.appendChild(e.speedSelect))}else e.functions.appendChild(new l({style:h}))})},e.prototype.disconnectedCallback=function(){var e;t.prototype.disconnectedCallback.call(this),null===(e=this.speedSelect)||void 0===e||e.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,e){var r=this.attributes.onChange;null==r||r(t,e)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(m2),s6=y("7WQrb"),on=y("2eDEB"),wu=function(t){function e(r){var n=t.call(this,m0({},e.defaultOptions,r))||this;return n.bindEvents(),n}return(0,s6.__extends)(e,t),e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))}),this.addEventListener("mouseleave",function(){t.attr("lineWidth",0)})},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(on.Circle),wh=function(t){function e(r){return t.call(this,m0({},e.defaultOptions,r))||this}return(0,s6.__extends)(e,t),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,r=t.y,n=t.width,i=t.height,a=bt(this.attributes,"background");m4(this).maybeAppend("background","rect").attr("className","background").styles((0,s6.__assign)({x:e-n/2,y:r-i/2,width:n,height:i},a))},e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,r=t.y,n=t.iconSize,i=bt(this.attributes,"icon"),a=n/2;m4(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles((0,s6.__assign)({x1:e-1,y1:r-a,x2:e-1,y2:r+a},i)),m4(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles((0,s6.__assign)({x1:e+1,y1:r-a,x2:e+1,y2:r+a},i))},e.prototype.renderBorder=function(){var t=this.attributes,e=t.x,r=t.y,n=t.width,i=t.height,a=t.type,o=bt(this.attributes,"border"),s="start"===a?+n/2:-n/2;m4(this).maybeAppend("border","line").attr("className","border").styles((0,s6.__assign)({x1:s+e,y1:r-i/2,x2:s+e,y2:r+i/2},o))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(m2);function wd(t){var e=String(Math.floor(t/3600)).padStart(2,"0"),r=String(Math.floor(t%3600/60)).padStart(2,"0"),n=String(Math.floor(t%60)).padStart(2,"0");return t<3600?"".concat(r,":").concat(n):"".concat(e,":").concat(r,":").concat(n)}var wc=function(t){function e(r){var n=t.call(this,m0({},e.defaultOptions,r))||this;n.axis=n.appendChild(new xH({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),n.timeline=n.appendChild(new Eq({style:{onChange:function(t){n.handleSliderChange(t)}}})),n.controller=n.appendChild(new wl({})),n.states={},n.handleSliderChange=function(t){var e,r=Array.isArray(e=n.states.values)?(0,s6.__spreadArray)([],(0,s6.__read)(e),!1):e;n.setBySliderValues(t),n.dispatchOnChange(r)};var i=n.attributes,a=i.selectionType,o=i.chartType,s=i.speed,l=i.state,u=i.playMode,h=i.values;return n.states={chartType:o,playMode:u,selectionType:a,speed:s,state:l},n.setByTimebarValues(h),n}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.data.sort(function(t,e){return t.time<e.time?-1:t.time>e.time?1:0})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t,e=this.attributes,r=e.x,n=e.y,i=e.width,a=e.height,o=e.type,s=e.controllerHeight,l=(0,ow.default)(+a-s,0,+a),u=new m3(r,n+ +a-s,+i,s),h=0;t="chart"===o?new m3(r,n+l-(h=35),+i,h):new m3;var d="time"===o?10:l;return{axisBBox:t,controllerBBox:u,timelineBBox:new m3(r,n+("time"===o?l:l-d),+i,d-h)}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var e,r,n=this.data,i=(0,s6.__read)(Array.isArray(t)?t:[0,t],2),a=i[0],o=i[1],s=n.length,l=n[Math.floor(a*s)],u=n[Math.ceil(o*s)-(Array.isArray(t)?0:1)];this.states.values=[null!==(e=null==l?void 0:l.time)&&void 0!==e?e:n[0].time,null!==(r=null==u?void 0:u.time)&&void 0!==r?r:1/0]},e.prototype.setByTimebarValues=function(t){var e,r,n,i=this.data,a=(0,s6.__read)(Array.isArray(t)?t:[void 0,t],2),o=a[0],s=a[1],l=i.find(function(t){return t.time===o}),u=i.find(function(t){return t.time===s});this.states.values=[null!==(e=null==l?void 0:l.time)&&void 0!==e?e:null===(r=i[0])||void 0===r?void 0:r.time,null!==(n=null==u?void 0:u.time)&&void 0!==n?n:1/0]},e.prototype.setByIndex=function(t){var e,r,n,i,a=this.data,o=(0,s6.__read)(t,2),s=o[0],l=o[1];this.states.values=[null!==(r=null===(e=a[s])||void 0===e?void 0:e.time)&&void 0!==r?r:a[0].time,null!==(i=null===(n=this.data[l])||void 0===n?void 0:n.time)&&void 0!==i?i:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t,e=this.states,r=e.values,n=e.selectionType,i=(0,s6.__read)(Array.isArray(r)?r:[void 0,r],2),a=i[0],o=i[1],s=this.data,l=s.length,u="value"===n;return[(t=s.findIndex(function(t){return t.time===a}),u?0:t>-1?t/l:0),function(){if(o===1/0)return 1;var t=s.findIndex(function(t){return t.time===o});return t>-1?t/l:u?.5:1}()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,e=t.values,r=t.selectionType,n=(0,s6.__read)(Array.isArray(e)?e:[this.data[0].time,e],2),i=n[0],a=n[1];return"value"===r?a:[i,a]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var e=this.data,r=Math.floor(t*(e.length-1));return e[r]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,e=this.space.timelineBBox.height;return"range"===t?function(t){return new wh({style:{type:t,height:e,iconSize:e/6}})}:function(){return new on.Line({style:{x1:0,y1:-e/2,x2:0,y2:e/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var e=this,r=t.x,n=t.y,i=t.width,a=t.height,o=this.states,s=o.selectionType,l=o.chartType,u=this.data,h=this.attributes,d=h.type,c=h.labelFormatter,f=bt(this.attributes,"chart"),p=(f.type,(0,s6.__rest)(f,["type"])),g="range"===s;if("time"===d)return(0,s6.__assign)({handleIconShape:function(){return new wu({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:g?-15:0,autoFitLabel:g,handleSpacing:g?-15:0,trackFill:"#edeeef",trackLength:i,trackOpacity:.5,trackRadius:a/2,trackSize:a/2,type:s,values:this.sliderValues,formatter:function(t){if(c)return c(t);var r=e.getDatumByRatio(t).time;return"number"==typeof r?wd(r):b1(r,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(r,", ").concat(n,")"),zIndex:1},p);var y="range"===s?5:0,v=u.map(function(t){return t.value});return(0,s6.__assign)({handleIconOffset:y,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:v,sparklineType:l,sparklineScale:.8,trackLength:i,trackSize:a,type:s,values:this.sliderValues,transform:"translate(".concat(r,", ").concat(n,")"),zIndex:1},p)},e.prototype.renderChart=function(t){void 0===t&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var e=this.data,r=this.attributes,n=r.interval,i=r.labelFormatter,a=bt(this.attributes,"axis"),o=t.x,s=t.y,l=t.width,u=(0,s6.__spreadArray)((0,s6.__spreadArray)([],(0,s6.__read)(e),!1),[{time:0}],!1).map(function(t,e,r){var n=t.time;return{label:"".concat(n),value:e/(r.length-1),time:n}});return(0,s6.__assign)({startPos:[o,s],endPos:[o+l,s],data:u,labelFilter:function(t,e){return e<u.length-1},labelFormatter:function(t){var e=t.time;return i?i(e):"number"==typeof e?wd(e):function(t,e){var r=new Date(t);switch(e){case"half-hour":case"hour":case"four-hour":if([0,6,12,18].includes(r.getHours())&&0===r.getMinutes())return b1(r,"HH:mm\nYYYY-MM-DD");return b1(r,"HH:mm");case"half-day":if(12>r.getHours())return"AM\n".concat(b1(r,"YYYY-MM-DD"));return"PM";case"day":if([1,10,20].includes(r.getDate()))return b1(r,"DD\nYYYY-MM");return b1(r,"DD");case"week":if(7>=r.getDate())return b1(r,"DD\nYYYY-MM");return b1(r,"DD");case"month":if([0,6].includes(r.getMonth()))return b1(r,"MM\nYYYY");return b1(r,"MM");case"season":if([0].includes(r.getMonth()))return b1(r,"MM\nYYYY");return b1(r,"MM");case"year":return b1(r,"YYYY");default:return b1(r,"YYYY-MM-DD HH:mm")}}(e,n)}},a)},e.prototype.renderAxis=function(t){void 0===t&&(t=this.space.axisBBox),"chart"===this.attributes.type&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){void 0===t&&(t=this.space.controllerBBox);var e=this.attributes.type,r=this.states,n=r.state,i=r.speed,a=r.selectionType,o=r.chartType,s=bt(this.attributes,"controller"),l=this,u=(0,s6.__assign)((0,s6.__assign)((0,s6.__assign)({},t),{iconSize:20,speed:i,state:n,selectionType:a,chartType:o,onChange:function(t,e){var r=e.value;switch(t){case"reset":l.internalReset();break;case"speed":l.handleSpeedChange(r);break;case"backward":l.internalBackward();break;case"playPause":"play"===r?l.internalPlay():l.internalPause();break;case"forward":l.internalForward();break;case"selectionType":l.handleSelectionTypeChange(r);break;case"chartType":l.handleChartTypeChange(r)}}}),s);"time"===e&&(u.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(u)},e.prototype.dispatchOnChange=function(t){var e,r=this.data,n=this.attributes.onChange,i=this.states,a=i.values,o=i.selectionType,s=(0,s6.__read)(a,2),l=s[0],u=s[1],h=u===1/0?r.at(-1).time:u;(!t||(e="range"===o?[l,h]:h,Array.isArray(t)?!Array.isArray(e)||t[0]!==e[0]||t[1]!==e[1]&&t[1]!==1/0&&e[1]!==1/0:Array.isArray(e)||t!==e))&&null!=n&&n("range"===o?[l,h]:h)},e.prototype.internalReset=function(t){var e,r,n=this.states.selectionType;this.internalPause(),this.setBySliderValues("range"===n?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||(null===(r=null===(e=this.attributes)||void 0===e?void 0:e.onReset)||void 0===r||r.call(e),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,e){var r,n,i,a,o,s,l=this.data,u=l.length,h=this.states,d=h.values,c=h.selectionType,f=h.playMode,p=(0,s6.__read)(d,2),g=p[0],y=p[1],v=l.findIndex(function(t){return t.time===g}),m=l.findIndex(function(t){return t.time===y});-1===m&&(m=u);var b="backward"===t?-1:1;"range"===c?"acc"===f?(s=[v,m+b],-1===b&&v===m&&(s=[v,u])):s=[v+b,m+b]:s=[v,m+b];var x=(r=s,i=(n=(0,s6.__read)(r.sort(function(t,e){return t-e}),2))[0],a=n[1],o=function(t){return(0,ow.default)(t,0,u)},a>u?"value"===c?[0,0]:"acc"===f?[o(i),o(i)]:[0,o(a-i)]:i<0?"acc"===f?[0,o(a)]:[o(i+u-a),u]:[o(i),o(a)]);return this.setByIndex(x),this.updateSelection(),x},e.prototype.internalBackward=function(t){var e,r,n=this.moveSelection("backward",t);return t||(null===(r=null===(e=this.attributes)||void 0===e?void 0:e.onBackward)||void 0===r||r.call(e),this.dispatchOnChange()),n},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var e,r,n=this,i=this.data,a=this.attributes.loop,o=this.states.speed;this.playInterval=window.setInterval(function(){n.internalForward()[1]!==i.length||a||(n.internalPause(),n.renderController())},1e3/(void 0===o?1:o)),this.states.state="play",t||null===(r=null===(e=this.attributes)||void 0===e?void 0:e.onPlay)||void 0===r||r.call(e)},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var e,r;clearInterval(this.playInterval),this.states.state="pause",t||null===(r=null===(e=this.attributes)||void 0===e?void 0:e.onPause)||void 0===r||r.call(e)},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var e,r,n=this.moveSelection("forward",t);return t||(null===(r=null===(e=this.attributes)||void 0===e?void 0:e.onForward)||void 0===r||r.call(e),this.dispatchOnChange()),n},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var e,r;this.states.speed=t,"play"===this.states.state&&(this.internalPause(!0),this.internalPlay(!0)),null===(r=null===(e=this.attributes)||void 0===e?void 0:e.onSpeedChange)||void 0===r||r.call(e,t)},e.prototype.handleSelectionTypeChange=function(t){var e,r;this.states.selectionType=t,this.renderChart(),null===(r=null===(e=this.attributes)||void 0===e?void 0:e.onSelectionTypeChange)||void 0===r||r.call(e,t)},e.prototype.handleChartTypeChange=function(t){var e,r;this.states.chartType=t,this.renderChart(),null===(r=null===(e=this.attributes)||void 0===e?void 0:e.onChartTypeChange)||void 0===r||r.call(e,t)},e.prototype.render=function(){var t=this.space,e=t.axisBBox,r=t.controllerBBox,n=t.timelineBBox;this.renderController(r),this.renderAxis(e),this.renderChart(n),"play"===this.states.state&&this.internalPlay()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(m2),sR=y("1uF5a"),ol=y("jyI49"),wf=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const wp=["timestamp","time","date","datetime"];class wg extends vB{get padding(){return sz(this.options.padding)}constructor(t,e){super(t,Object.assign({},wg.defaultOptions,e)),this.backup(),this.upsertTimebar()}play(){var t;null===(t=this.timebar)||void 0===t||t.play()}pause(){var t;null===(t=this.timebar)||void 0===t||t.pause()}forward(){var t;null===(t=this.timebar)||void 0===t||t.forward()}backward(){var t;null===(t=this.timebar)||void 0===t||t.backward()}reset(){var t;null===(t=this.timebar)||void 0===t||t.reset()}update(t){super.update(t),this.backup(),this.upsertTimebar()}backup(){this.originalData=wy(this.context.graph.getData())}upsertTimebar(){let{canvas:t}=this.context,e=this.options,{onChange:r,timebarType:n,data:i,x:a,y:o,width:s,height:l,mode:u}=e,h=wf(e,["onChange","timebarType","data","x","y","width","height","mode"]),d=t.getSize(),[c]=this.padding;this.upsertCanvas().ready.then(()=>{var t;let e=Object.assign(Object.assign({x:d[0]/2-s/2,y:c,onChange:t=>{let e=((0,sR.default)(t)?t:[t,t]).map(t=>t instanceof Date?t.getTime():t);"modify"===this.options.mode?this.filterElements(e):this.hiddenElements(e),null==r||r(e)}},h),{data:i.map(t=>(0,ol.default)(t)?{time:t,value:0}:t),width:s,height:l,type:n});this.timebar?this.timebar.update(e):(this.timebar=new wc({style:e}),null===(t=this.canvas)||void 0===t||t.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;let{className:t,height:e,position:r}=this.options,n=this.context.canvas,[i]=n.getSize(),[a,,o]=this.padding,[s,l]=bU({width:i,height:e+a+o,graphCanvas:n,className:"timebar",placement:r});return this.container=s,t&&s.classList.add(t),this.canvas=l,this.canvas}filterElements(t){var e,r,n,i;return e=this,r=void 0,n=void 0,i=function*(){var e;if(!this.originalData)return;let{elementTypes:r,getTime:n}=this.options,{graph:i,element:a}=this.context,o=wy(this.originalData);r.forEach(e=>{let r=`${e}s`;o[r]=(this.originalData[r]||[]).filter(e=>!!wv(n(e),t))});let s=[...o.nodes,...o.combos].map(t=>lg(t));o.edges=o.edges.filter(t=>{let e=t.source,r=t.target;return s.includes(e)&&s.includes(r)}),i.setData(o),yield null===(e=a.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished},new(n||(n=Promise))(function(t,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n(function(t){t(r)})).then(o,s)}l((i=i.apply(e,r||[])).next())})}hiddenElements(t){let{graph:e}=this.context,{elementTypes:r,getTime:n}=this.options,i=[],a=[];r.forEach(e=>{var r;let o=`${e}s`;((null===(r=this.originalData)||void 0===r?void 0:r[o])||[]).forEach(e=>{let r=lg(e);wv(n(e),t)?a.push(r):i.push(r)})}),e.hideElement(i,!1),e.showElement(a,!1)}destroy(){var t,e,r;let{graph:n}=this.context;this.originalData&&n.setData(Object.assign({},this.originalData)),null===(t=this.timebar)||void 0===t||t.destroy(),null===(e=this.canvas)||void 0===e||e.destroy(),null===(r=this.container)||void 0===r||r.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}wg.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:t=>wm(t,wp,void 0),loop:!1};const wy=t=>{let{nodes:e=[],edges:r=[],combos:n=[]}=t;return{nodes:[...e],edges:[...r],combos:[...n]}},wv=(t,e)=>{if((0,ol.default)(e))return t===e;let[r,n]=e;return t>=r&&t<=n},wm=(t,e,r)=>{var n;for(let r=0;r<e.length;r++){let i=e[r],a=null===(n=t.data)||void 0===n?void 0:n[i];if(a)return a}return r},wb=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,wx=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`;var wE=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class ww extends vB{constructor(t,e){super(t,Object.assign({},ww.defaultOptions,e)),this.$element=vz("toolbar",!1),this.onToolbarItemClick=t=>{let{onClick:e}=this.options;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){let r=t.target.getAttribute("value");null==e||e(r,t.target)}};let r=this.context.canvas.getContainer();this.$element.style.display="flex",r.appendChild(this.$element),vV("g6-toolbar-css","style",{},wb,document.head),vV("g6-toolbar-svgicon","div",{display:"none"},wx),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(e)}update(t){let e=Object.create(null,{update:{get:()=>super.update}});return wE(this,void 0,void 0,function*(){e.update.call(this,t);let{className:r,position:n,style:i}=this.options;this.$element.className=`g6-toolbar ${r||""}`,Object.assign(this.$element.style,i,function(t){let e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return t.split("-").forEach(t=>{e[t]="8px"}),e.flexDirection=t.startsWith("top")||t.startsWith("bottom")?"row":"column",e}(n)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return wE(this,void 0,void 0,function*(){return(yield this.options.getItems()).map(t=>`
          <div class="g6-toolbar-item" value="${t.value}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${t.id}"></use>
            </svg>
          </div>`).join("")})}}function w_(t){var e=document.createElement("div");e.innerHTML=t;var r=e.childNodes[0];return r&&e.contains(r)&&e.removeChild(r),r}ww.defaultOptions={position:"top-left"};var s6=(y("7WQrb"),y("7WQrb")),wS=function(t,e){if(null==e){t.innerHTML="";return}t.replaceChildren?Array.isArray(e)?t.replaceChildren.apply(t,(0,s6.__spreadArray)([],(0,s6.__read)(e),!1)):t.replaceChildren(e):(t.innerHTML="",Array.isArray(e)?e.forEach(function(e){return t.appendChild(e)}):t.appendChild(e))},s6=y("7WQrb");function wk(t){return void 0===t&&(t=""),{CONTAINER:"".concat(t,"tooltip"),TITLE:"".concat(t,"tooltip-title"),LIST:"".concat(t,"tooltip-list"),LIST_ITEM:"".concat(t,"tooltip-list-item"),NAME:"".concat(t,"tooltip-list-item-name"),MARKER:"".concat(t,"tooltip-list-item-marker"),NAME_LABEL:"".concat(t,"tooltip-list-item-name-label"),VALUE:"".concat(t,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(t,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(t,"tooltip-crosshair-y")}}var wN={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},wO=function(t){function e(e){var r,n,i,a,o,s=this,l=null===(o=null===(a=e.style)||void 0===a?void 0:a.template)||void 0===o?void 0:o.prefixCls,u=wk(l);return(s=t.call(this,e,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(u.CONTAINER,'"></div>'),title:'<div class="'.concat(u.TITLE,'"></div>'),item:'<li class="'.concat(u.LIST_ITEM,'" data-index={index}>\n        <span class="').concat(u.NAME,'">\n          <span class="').concat(u.MARKER,'" style="background:{color}"></span>\n          <span class="').concat(u.NAME_LABEL,'" title="{name}">{name}</span>\n        </span>\n        <span class="').concat(u.VALUE,'" title="{value}">{value}</span>\n      </li>')},style:(void 0===(r=l)&&(r=""),i=wk(r),(n={})[".".concat(i.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},n[".".concat(i.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},n[".".concat(i.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},n[".".concat(i.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},n[".".concat(i.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},n[".".concat(i.NAME)]={display:"flex","align-items":"center","max-width":"216px"},n[".".concat(i.NAME_LABEL)]=(0,s6.__assign)({flex:1},wN),n[".".concat(i.VALUE)]=(0,s6.__assign)({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},wN),n[".".concat(i.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},n[".".concat(i.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},n)})||this).timestamp=-1,s.prevCustomContentKey=s.attributes.contentKey,s.initShape(),s.render(s.attributes,s),s}return(0,s6.__extends)(e,t),Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){return{width:this.element.offsetWidth,height:this.element.offsetHeight}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,e=t.data,r=t.template;return e.map(function(t,e){var n,i=t.name,a=t.color,o=t.index,s=(0,s6.__rest)(t,["name","color","index"]),l=(0,s6.__assign)({name:void 0===i?"":i,color:void 0===a?"black":a,index:null!=o?o:e},s);return w_((n=r.item)&&l?n.replace(/\\?\{([^{}]+)\}/g,function(t,e){return"\\"===t.charAt(0)?t.slice(1):void 0===l[e]?"":l[e]}):n)})},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var e;null===(e=this.element)||void 0===e||e.remove(),t.prototype.destroy.call(this)},e.prototype.show=function(t,e){var r=this;if(void 0!==t&&void 0!==e){var n="hidden"===this.element.style.visibility,i=function(){r.attributes.x=null!=t?t:r.attributes.x,r.attributes.y=null!=e?e:r.attributes.y,r.updatePosition()};n?this.closeTransition(i):i()}this.element.style.visibility="visible"},e.prototype.hide=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.attributes.enterable&&this.isCursorEntered(t,e)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=w_(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(void 0===this.prevCustomContentKey||this.prevCustomContentKey!==this.attributes.contentKey){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&("string"==typeof t?this.element.innerHTML=t:wS(this.element,t))}},e.prototype.renderHTMLTooltipElement=function(){var t,e,r=this.attributes,n=r.template,i=r.title,a=r.enterable,o=r.style,s=r.content,l=wk(n.prefixCls),u=this.element;if(this.element.style.pointerEvents=a?"auto":"none",s)this.renderCustomContent();else{i?(u.innerHTML=n.title,u.getElementsByClassName(l.TITLE)[0].innerHTML=i):null===(e=null===(t=u.getElementsByClassName(l.TITLE))||void 0===t?void 0:t[0])||void 0===e||e.remove();var h=this.HTMLTooltipItemsElements,d=document.createElement("ul");d.className=l.LIST,wS(d,h);var c=this.element.querySelector(".".concat(l.LIST));c?c.replaceWith(d):u.appendChild(d)}!function(t,e){Object.entries(e).forEach(function(e){var r=(0,s6.__read)(e,2),n=r[0],i=r[1];(0,s6.__spreadArray)([t],(0,s6.__read)(t.querySelectorAll(n)),!1).filter(function(t){return t.matches(n)}).forEach(function(t){t&&(t.style.cssText+=Object.entries(i).reduce(function(t,e){return"".concat(t).concat(e.join(":"),";")},""))})})}(u,o)},e.prototype.getRelativeOffsetFromCursor=function(t){var e=this.attributes,r=e.position,n=e.offset,i=(t||r).split("-"),a={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},o=this.elementSize,s=o.width,l=o.height,u=[-s/2,-l/2];return i.forEach(function(t){var e=(0,s6.__read)(u,2),r=e[0],i=e[1],o=(0,s6.__read)(a[t],2),h=o[0],d=o[1];u=[r+(s/2+n[0])*h,i+(l/2+n[1])*d]}),u},e.prototype.setOffsetPosition=function(t){var e=(0,s6.__read)(t,2),r=e[0],n=e[1],i=this.attributes,a=i.x,o=i.y,s=i.container,l=s.x,u=s.y;this.element.style.left="".concat(+(void 0===a?0:a)+l+r,"px"),this.element.style.top="".concat(+(void 0===o?0:o)+u+n,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,e=Date.now();this.timestamp>0&&e-this.timestamp<(void 0===t?60:t)||(this.timestamp=e,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var e=(0,s6.__read)(t,2),r=e[0],n=e[1],i=this.attributes,a=i.x,o=i.y,s=i.bounding,l=i.position;if(!s)return[r,n];var u=this.element,h=u.offsetWidth,d=u.offsetHeight,c=(0,s6.__read)([+a+r,+o+n],2),f=c[0],p=c[1],g={left:"right",right:"left",top:"bottom",bottom:"top"},y=s.x,v=s.y,m={left:f<y,right:f+h>y+s.width,top:p<v,bottom:p+d>v+s.height},b=[];l.split("-").forEach(function(t){m[t]?b.push(g[t]):b.push(t)});var x=b.join("-");return this.getRelativeOffsetFromCursor(x)},e.prototype.isCursorEntered=function(t,e){if(this.element){var r=this.element.getBoundingClientRect();return new m3(r.x,r.y,r.width,r.height).isPointIn(t,e)}return!1},e.prototype.closeTransition=function(t){var e=this,r=this.element.style.transition;this.element.style.transition="none",t(),setTimeout(function(){e.element.style.transition=r},10)},e.tag="tooltip",e}(m2);class wT extends vB{constructor(t,e){super(t,Object.assign({},wT.defaultOptions,e)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=t=>{let{enable:e}=this.options;return"function"==typeof e?e(t):e},this.onClick=t=>{let{target:{id:e}}=t;this.currentTarget===e?(this.hide(t),this.currentTarget=null):(this.currentTarget=e,this.show(t))},this.onPointerMove=t=>{let{target:e}=t;this.currentTarget&&e.id!==this.currentTarget&&this.show(t)},this.onPointerLeave=t=>{this.hide(t),this.currentTarget=null},this.onCanvasMove=t=>{this.hide(t),this.currentTarget=null},this.onPointerEnter=t=>{this.show(t)},this.showById=t=>{this.show({target:{id:t}})},this.getElementData=(t,e)=>{let{model:r}=this.context;switch(e){case"node":return r.getNodeData([t]);case"edge":return r.getEdgeData([t]);case"combo":return r.getComboData([t]);default:return[]}},this.show=t=>{let e,r;let{client:n,target:{id:i}}=t;if(cv(t.target)||!this.tooltipElement||!this.isEnable(t))return;let a=this.context.graph.getElementType(i),{getContent:o,title:s}=this.options;this.currentTarget=i;let l=this.getElementData(i,a);if(n)e=n.x,r=n.y;else{let t=uf(l,"0.style",{x:0,y:0});e=t.x,r=t.y}let u={};if(o)u.content=o(t,l);else{let t=this.context.graph.getElementRenderStyle(i),e="node"===a?t.fill:t.stroke;u={title:s||a,data:l.map(t=>({name:"ID",value:t.id||`${t.source} -> ${t.target}`,color:e}))}}this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:e,y:r,style:{".tooltip":{visibility:"visible"}}}),u))},this.hide=t=>{var e;if(!t){null===(e=this.tooltipElement)||void 0===e||e.hide();return}if(!this.tooltipElement||!this.currentTarget)return;let{client:{x:r,y:n}}=t;this.tooltipElement.hide(r,n)},this.initTooltip=()=>{var t;let e=new wO({className:"tooltip",style:this.tooltipStyleProps});return null===(t=this.container)||void 0===t||t.appendChild(e.HTMLTooltipElement),e},this.render(),this.bindEvents()}getEvents(){return"click"===this.options.trigger?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var e;this.unbindEvents(),super.update(t),this.tooltipElement&&(null===(e=this.container)||void 0===e||e.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){let{canvas:t}=this.context,e=t.getContainer();e&&(this.container=e,this.tooltipElement=this.initTooltip())}unbindEvents(){let{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(r=>{t.off(r,e[r])})}bindEvents(){let{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(r=>{t.on(r,e[r])})}get tooltipStyleProps(){let{canvas:t}=this.context,{center:e}=t.getBounds(),{top:r,left:n}=t.getContainer().getBoundingClientRect(),{style:i,position:a,enterable:o,container:s={x:-n,y:-r},title:l,offset:u}=this.options,[h,d]=e,[c,f]=t.getSize();return{x:h,y:d,container:s,title:l,bounding:{x:0,y:0,width:c,height:f},position:a,enterable:o,offset:u,style:i}}destroy(){var t;this.unbindEvents(),this.tooltipElement&&(null===(t=this.container)||void 0===t||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}wT.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var wM=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};function wA(t,e){return r||(r=document.createElement("canvas")),r.width=t,r.height=e,r.getContext("2d").clearRect(0,0,t,e),r}var wC=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class wR extends vB{constructor(t,e){super(t,Object.assign({},wR.defaultOptions,e)),this.$element=vz("watermark"),this.context.canvas.getContainer().appendChild(this.$element),this.update(e)}update(t){var e,r,n,i;let a=Object.create(null,{update:{get:()=>super.update}});return e=this,r=void 0,n=void 0,i=function*(){a.update.call(this,t);let e=this.options,{width:r,height:n,text:i,imageURL:o}=e,s=wC(e,["width","height","text","imageURL"]);Object.keys(s).forEach(e=>{e.startsWith("background")&&(this.$element.style[e]=t[e])});let l=o?yield function(t,e,r,n){return wM(this,void 0,void 0,function*(){let i=wA(t,e),a=i.getContext("2d"),{rotate:o,opacity:s}=n;o&&a.rotate(o),s&&(a.globalAlpha=s);let l=new Image;return l.crossOrigin="anonymous",l.src=r,new Promise(r=>{l.onload=function(){let n=t>l.width?(t-l.width)/2:0,o=e>l.height?(e-l.height)/2:0;a.drawImage(l,0,0,l.width,l.height,n,o,t-2*n,e-2*o),r(i.toDataURL())}})})}(r,n,o,s):yield function(t,e,r,n){return wM(this,void 0,void 0,function*(){let i=wA(t,e),a=i.getContext("2d"),{rotate:o,opacity:s,textFill:l,textFontSize:u,textFontFamily:h,textFontVariant:d,textFontWeight:c,textAlign:f,textBaseline:p}=n;return a.textAlign=f,a.textBaseline=p,a.translate(t/2,e/2),a.font=`${u}px ${h} ${d} ${c}`,o&&a.rotate(o),s&&(a.globalAlpha=s),l&&(a.fillStyle=l,a.fillText(`${r}`,0,0)),i.toDataURL()})}(r,n,i,s);this.$element.style.backgroundImage=`url(${l})`},new(n||(n=Promise))(function(t,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n(function(t){t(r)})).then(o,s)}l((i=i.apply(e,r||[])).next())})}destroy(){super.destroy(),this.$element.remove()}}wR.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};var on=y("2eDEB"),hf=y("cbdLd"),oi=y("fu0YK"),oa=y("lR7jo"),oo=y("jLNr1"),os=y("f8wIT"),on=y("2eDEB"),hu=y("8HV7i"),hh=y("fOd0O"),wI=y("aoFex"),wP=/*#__PURE__*/function(){function t(e){/*@__PURE__*/f(oi)(this,t),this.dragndropPluginOptions=e}return /*@__PURE__*/f(oa)(t,[{key:"apply",value:function(e){var r=this,n=e.renderingService,i=e.renderingContext.root.ownerDocument,a=i.defaultView,o=function(t){var e=t.target,n=e===i,o=n&&r.dragndropPluginOptions.isDocumentDraggable?i:e.closest&&e.closest("[draggable=true]");if(o){var s,l=!1,u=t.timeStamp,h=[t.clientX,t.clientY],d=null,c=[t.clientX,t.clientY],p=(s=/*@__PURE__*/f(hh)(/*#__PURE__*//*@__PURE__*/f(hu)().mark(function t(a){var s,p,g,y,v,m;return /*@__PURE__*/f(hu)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(l){t.next=8;break}if(s=a.timeStamp-u,p=(0,wI.distanceSquareRoot)([a.clientX,a.clientY],h),!(s<=r.dragndropPluginOptions.dragstartTimeThreshold||p<=r.dragndropPluginOptions.dragstartDistanceThreshold)){t.next=5;break}return t.abrupt("return");case 5:a.type="dragstart",o.dispatchEvent(a),l=!0;case 8:if(a.type="drag",a.dx=a.clientX-c[0],a.dy=a.clientY-c[1],o.dispatchEvent(a),c=[a.clientX,a.clientY],n){t.next=21;break}return g="pointer"===r.dragndropPluginOptions.overlap?[a.canvasX,a.canvasY]:e.getBounds().center,t.next=17,i.elementsFromPoint(g[0],g[1]);case 17:m=(null==(v=(y=t.sent)[y.indexOf(e)+1])?void 0:v.closest("[droppable=true]"))||(r.dragndropPluginOptions.isDocumentDroppable?i:null),d!==m&&(d&&(a.type="dragleave",a.target=d,d.dispatchEvent(a)),m&&(a.type="dragenter",a.target=m,m.dispatchEvent(a)),(d=m)&&(a.type="dragover",a.target=d,d.dispatchEvent(a)));case 21:case"end":return t.stop()}},t)})),function(t){return s.apply(this,arguments)});a.addEventListener("pointermove",p);var g=function(t){if(l){t.detail={preventClick:!0};var e=t.clone();d&&(e.type="drop",e.target=d,d.dispatchEvent(e)),e.type="dragend",o.dispatchEvent(e),l=!1}a.removeEventListener("pointermove",p)};e.addEventListener("pointerup",g,{once:!0}),e.addEventListener("pointerupoutside",g,{once:!0})}};n.hooks.init.tap(t.tag,function(){a.addEventListener("pointerdown",o)}),n.hooks.destroy.tap(t.tag,function(){a.removeEventListener("pointerdown",o)})}}])}();wP.tag="Dragndrop";var wD=/*#__PURE__*/function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return /*@__PURE__*/f(oi)(this,e),(t=/*@__PURE__*/f(oo)(this,e)).name="dragndrop",t.options=r,t}return /*@__PURE__*/f(os)(e,t),/*@__PURE__*/f(oa)(e,[{key:"init",value:function(){this.addRenderingPlugin(new wP(/*@__PURE__*/f(hf)({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)}}])}(on.AbstractRendererPlugin),wL=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})},wj=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const wF=["main"],wB=["background","main","label","transient"];class wz{getConfig(){return this.config}getLayer(t="main"){return this.extends.layers[t]||this.getLayers().main}getLayers(){return this.extends.layers}getRenderer(t){return this.extends.renderers[t]}getCamera(t="main"){return this.getLayer(t).getCamera()}getRoot(t="main"){return this.getLayer(t).getRoot()}getContextService(t="main"){return this.getLayer(t).getContextService()}setCursor(t){this.config.cursor=t,this.getLayer().setCursor(t)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(t){this.config={enableMultiLayer:!0},Object.assign(this.config,t);let e=this.config,{renderer:r,background:n,cursor:i,enableMultiLayer:a}=e,o=wj(e,["renderer","background","cursor","enableMultiLayer"]),s=a?wB:wF,l=wV(r,s),u=Object.fromEntries(s.map(t=>{let e=new on.Canvas(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:a,renderer:l[t],background:a?"background"===t?n:void 0:n}));return[t,e]}));wG(u),this.extends={config:this.config,renderer:r,renderers:l,layers:u}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,t])=>t.ready))}resize(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach(r=>{let n=r.getCamera(),i=n.getPosition(),a=n.getFocalPoint();r.resize(t,e),n.setPosition(i),n.setFocalPoint(a)})}getBounds(t){return sq(Object.values(this.getLayers()).map(e=>t?e.getRoot().childNodes.find(e=>e.classList.includes(t)):e.getRoot()).filter(t=>(null==t?void 0:t.childNodes.length)>0).map(t=>t.getBounds()))}getContainer(){let t=this.extends.config.container;return"string"==typeof t?document.getElementById(t):t}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(t,e){var r;let n=(null===(r=t.style)||void 0===r?void 0:r.$layer)||"main";return this.getLayer(n).appendChild(t,e)}setRenderer(t){if(t===this.extends.renderer)return;let e=wV(t,this.config.enableMultiLayer?wB:wF);this.extends.renderers=e,Object.entries(e).forEach(([t,e])=>this.getLayer(t).setRenderer(e)),wG(this.getLayers())}getCanvasByViewport(t){return l1(this.getLayer().viewport2Canvas(l2(t)))}getViewportByCanvas(t){return l1(this.getLayer().canvas2Viewport(l2(t)))}getViewportByClient(t){return l1(this.getLayer().client2Viewport(l2(t)))}getClientByViewport(t){return l1(this.getLayer().viewport2Client(l2(t)))}getClientByCanvas(t){return this.getClientByViewport(this.getViewportByCanvas(t))}getCanvasByClient(t){let e=this.getLayer(),r=e.client2Viewport(l2(t));return l1(e.viewport2Canvas(r))}toDataURL(){return wL(this,arguments,void 0,function*(t={}){let e=globalThis.devicePixelRatio||1,{mode:r="viewport"}=t,n=wj(t,["mode"]),[i,a,o,s]=[0,0,0,0];if("viewport"===r)[o,s]=this.getSize();else if("overall"===r){let t=this.getBounds(),e=s$(t);[i,a]=t.min,[o,s]=e}let l=w_('<div id="virtual-image"></div>'),u=new on.Canvas({width:o,height:s,renderer:new ds,devicePixelRatio:e,container:l,background:this.extends.config.background});yield u.ready,u.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),u.appendChild(this.getRoot().cloneNode(!0));let h=this.getLayer("label").getRoot().cloneNode(!0),d=u.viewport2Canvas({x:0,y:0}),c=this.getCanvasByViewport([0,0]);h.translate([c[0]-d.x,c[1]-d.y]),h.scale(1/this.getCamera().getZoom()),u.appendChild(h),u.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));let f=this.getCamera(),p=u.getCamera();if("viewport"===r)p.setZoom(f.getZoom()),p.setPosition(f.getPosition()),p.setFocalPoint(f.getFocalPoint());else if("overall"===r){let[t,e,r]=p.getPosition(),[n,o,s]=p.getFocalPoint();p.setPosition([t+i,e+a,r]),p.setFocalPoint([n+i,o+a,s])}let g=u.getContextService();return new Promise(t=>{u.addEventListener(on.CanvasEvent.RERENDER,()=>wL(this,void 0,void 0,function*(){yield new Promise(t=>setTimeout(t,300)),t((yield g.toDataURL(n)))}))})})}destroy(){Object.values(this.getLayers()).forEach(t=>{t.getCamera().cancelLandmarkAnimation(),t.destroy()})}}function wV(t,e){return Object.fromEntries(e.map(e=>{let r=(null==t?void 0:t(e))||new ds;return"main"===e?r.registerPlugin(new wD({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):r.unregisterPlugin(r.getPlugin("dom-interaction")),[e,r]}))}function wG(t){Object.entries(t).forEach(([t,e])=>{let r=e.getContextService().getDomElement();(null==r?void 0:r.style)&&(r.style.gridArea="1 / 1 / 2 / 2",r.style.outline="none",r.tabIndex=1,"main"!==t&&(r.style.pointerEvents="none")),(null==r?void 0:r.parentElement)&&(r.parentElement.style.display="grid")})}var sI=y("ky7aH"),ol=y("jyI49"),sc=y("6JKSc"),ou=y("kVcyu"),ol=y("jyI49");const w$=t=>t?parseInt(t):0;function wU(t){if(!t)return[0,0];let e=640,r=480,[n,i]=function(t){let e=getComputedStyle(t),r=t.clientWidth||w$(e.width),n=t.clientHeight||w$(e.height);return[r-(w$(e.paddingLeft)+w$(e.paddingRight)),n-(w$(e.paddingTop)+w$(e.paddingBottom))]}(t);return e=n||e,r=i||r,[Math.max((0,ol.default)(e)?e:1,1),Math.max((0,ol.default)(r)?r:1,1)]}var on=y("2eDEB");class wH{constructor(t){this.type=t}}class wW extends wH{constructor(t,e){super(t),this.data=e}}class wq extends wH{constructor(t,e,r,n){super(t),this.animationType=e,this.animation=r,this.data=n}}class wY extends wH{constructor(t,e,r){super(t),this.elementType=e,this.data=r}}class wK extends wH{constructor(t,e){super(t),this.data=e}}function wX(t,e){t.emit(e.type,e)}function wJ(t){var e;return(null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.zIndex)||0}const wZ="cachedStyle",wQ=t=>`__${t}__`;class w0{constructor(t){this.tasks=[],this.animations=new Set,this.context=t}getTasks(){let t=[...this.tasks];return this.tasks=[],t}add(t,e){this.tasks.push([t,e])}animate(t,e,r){var n,i,a;null===(n=null==e?void 0:e.before)||void 0===n||n.call(e);let o=this.getTasks().map(([e,n])=>{var i,a,o;let{element:s,elementType:l,stage:u}=e,h=function(t,e,r,n){var i,a;let{animation:o}=t,s=null===(i=null==t?void 0:t[e])||void 0===i?void 0:i.animation;if(!1===s)return[];let l=null==s?void 0:s[r];if(!1===l||!1===o||!1===n)return[];let u=null===(a=sE(t)[e])||void 0===a?void 0:a.animation,h=(t=[])=>{var e;return("string"==typeof(e=t)?sm(yH.ANIMATION,e)||(sx.warn(`The animation of ${e} is not registered.`),[]):e).map(t=>Object.assign(Object.assign(Object.assign(Object.assign({},sp),(0,sc.default)(o)&&o),t),(0,sc.default)(n)&&n))};if(l)return h(l);if(!u)return[];let d=u[r];return!1===d?[]:h(d)}(this.context.options,l,u,t);null===(i=null==n?void 0:n.before)||void 0===i||i.call(n);let d=h.length?sT(s,this.inferStyle(e,r),h):null;return d?(null===(a=null==n?void 0:n.beforeAnimate)||void 0===a||a.call(n,d),d.finished.then(()=>{var t,e;null===(t=null==n?void 0:n.afterAnimate)||void 0===t||t.call(n,d),null===(e=null==n?void 0:n.after)||void 0===e||e.call(n),this.animations.delete(d)})):null===(o=null==n?void 0:n.after)||void 0===o||o.call(n),d}).filter(Boolean);o.forEach(t=>this.animations.add(t));let s=sw(o);return s?(null===(i=null==e?void 0:e.beforeAnimate)||void 0===i||i.call(e,s),s.finished.then(()=>{var t,r;null===(t=null==e?void 0:e.afterAnimate)||void 0===t||t.call(e,s),null===(r=null==e?void 0:e.after)||void 0===r||r.call(e),this.release()})):null===(a=null==e?void 0:e.after)||void 0===a||a.call(e),s}inferStyle(t,e){var r,n;let{element:i,elementType:a,stage:o,originalStyle:s,updatedStyle:l={}}=t;t.modifiedStyle||(t.modifiedStyle=Object.assign(Object.assign({},s),l));let{modifiedStyle:u}=t,h={},d={};if("enter"===o)Object.assign(h,{opacity:0});else if("exit"===o)Object.assign(d,{opacity:0});else if("show"===o)Object.assign(h,{opacity:0}),Object.assign(d,{opacity:null!==(r=uf(i,[wZ,wQ("opacity")]))&&void 0!==r?r:sS("opacity")});else if("hide"===o)Object.assign(h,{opacity:null!==(n=uf(i,[wZ,wQ("opacity")]))&&void 0!==n?n:sS("opacity")}),Object.assign(d,{opacity:0});else if("collapse"===o){let{collapse:t}=e||{},{target:r,descendants:n,position:o}=t;if("node"===a){if(n.includes(i.id)){let[t,e,r]=o;Object.assign(d,{x:t,y:e,z:r})}}else if("combo"===a){if(i.id===r||n.includes(i.id)){let[t,e]=o;Object.assign(d,{x:t,y:e,childrenNode:s.childrenNode})}}else"edge"===a&&Object.assign(d,{sourceNode:u.sourceNode,targetNode:u.targetNode})}else if("expand"===o){let{expand:t}=e||{},{target:r,descendants:n,position:o}=t;if("node"===a){if(i.id===r||n.includes(i.id)){let[t,e,r]=o;Object.assign(h,{x:t,y:e,z:r})}}else if("combo"===a){if(i.id===r||n.includes(i.id)){let[t,e,r]=o;Object.assign(h,{x:t,y:e,z:r,childrenNode:u.childrenNode})}}else"edge"===a&&Object.assign(h,{sourceNode:u.sourceNode,targetNode:u.targetNode})}return[Object.keys(h).length>0?Object.assign({},s,h):s,Object.keys(d).length>0?Object.assign({},u,d):u]}stop(){this.animations.forEach(t=>t.cancel())}clear(){this.tasks=[]}release(){var t,e;let{canvas:r}=this.context,n=null===(e=null===(t=r.document)||void 0===t?void 0:t.timeline)||void 0===e?void 0:e.animationsWithPromises;n&&(r.document.timeline.animationsWithPromises=n.filter(t=>"finished"!==t.playState))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class w1{constructor(t){this.batchCount=0,this.context=t}emit(t){let{graph:e}=this.context;e.emit(t.type,t)}startBatch(t=!0){this.batchCount++,1===this.batchCount&&this.emit(new wW(yG.BATCH_START,{initiate:t}))}endBatch(){this.batchCount--,0===this.batchCount&&this.emit(new wW(yG.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class w2 extends lT{constructor(t){super(t),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=t=>{let{target:e}=t,r=function(t){if(!t)return null;if(t instanceof on.Document)return{type:"canvas",element:t};let e=t;for(;e;){if(cn(e))return{type:"node",element:e};if(ci(e))return{type:"edge",element:e};if(ca(e))return{type:"combo",element:e};e=e.parentElement}return null}(e);if(!r)return;let{graph:n,canvas:i}=this.context,{type:a,element:o}=r;if("destroyed"in o&&(cv(o)||o.destroyed))return;let{type:s,detail:l,button:u}=t,h=Object.assign(Object.assign({},t),{target:o,targetType:a,originalTarget:e});s===yB.POINTER_MOVE&&(this.currentTarget!==o&&(this.currentTarget&&n.emit(`${this.currentTargetType}:${yB.POINTER_LEAVE}`,Object.assign(Object.assign({},h),{type:yB.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),o&&(Object.assign(h,{type:yB.POINTER_ENTER}),n.emit(`${a}:${yB.POINTER_ENTER}`,h))),this.currentTarget=o,this.currentTargetType=a),s===yB.CLICK&&2===u||(n.emit(`${a}:${s}`,h),n.emit(s,h)),s===yB.CLICK&&2===l&&(Object.assign(h,{type:yB.DBLCLICK}),n.emit(`${a}:${yB.DBLCLICK}`,h),n.emit(yB.DBLCLICK,h)),s===yB.POINTER_DOWN&&2===u&&(Object.assign(h,{type:yB.CONTEXT_MENU,preventDefault:()=>{var t;null===(t=i.getContainer())||void 0===t||t.addEventListener(yB.CONTEXT_MENU,t=>t.preventDefault(),{once:!0})}}),n.emit(`${a}:${yB.CONTEXT_MENU}`,h),n.emit(yB.CONTEXT_MENU,h))},this.forwardContainerEvents=t=>{this.context.graph.emit(t.type,t)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){let t=this.context.canvas.getContainer();t&&[yz.KEY_DOWN,yz.KEY_UP].forEach(e=>{t.addEventListener(e,this.forwardContainerEvents)});let e=this.context.canvas.document;e&&[yB.CLICK,yB.DBLCLICK,yB.POINTER_OVER,yB.POINTER_LEAVE,yB.POINTER_ENTER,yB.POINTER_MOVE,yB.POINTER_OUT,yB.POINTER_DOWN,yB.POINTER_UP,yB.CONTEXT_MENU,yB.DRAG_START,yB.DRAG,yB.DRAG_END,yB.DRAG_ENTER,yB.DRAG_OVER,yB.DRAG_LEAVE,yB.DROP,yB.WHEEL].forEach(t=>{e.addEventListener(t,this.forwardCanvasEvents)})}destroy(){let t=this.context.canvas.getContainer();t&&[yz.KEY_DOWN,yz.KEY_UP].forEach(e=>{t.removeEventListener(e,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var ol=y("jyI49"),dl=y("aFcWQ"),w3=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};function w6(t,e){let{data:r,style:n}=t,i=w3(t,["data","style"]),{data:a,style:o}=e,s=w3(e,["data","style"]),l=Object.assign(Object.assign({},i),s);return(r||a)&&Object.assign(l,{data:Object.assign(Object.assign({},r),a)}),(n||o)&&Object.assign(l,{style:Object.assign(Object.assign({},n),o)}),l}function w5(t){let{data:e,style:r}=t,n=w3(t,["data","style"]);return e&&(n.data=Object.assign({},e)),r&&(n.style=Object.assign({},r)),n}function w4(t={},e={}){let{states:r=[],data:n={},style:i={},children:a=[]}=t,o=w3(t,["states","data","style","children"]),{states:s=[],data:l={},style:u={},children:h=[]}=e,d=w3(e,["states","data","style","children"]),c=(t,e)=>t.length===e.length&&t.every((t,r)=>t===e[r]),f=(t,e)=>{let r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&r.every(r=>t[r]===e[r])};return!!(f(o,d)&&c(a,h)&&c(r,s)&&f(n,l)&&f(i,u))}var w8=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};function w9(t){let{id:e=lg(t),style:r,data:n}=t,i=w8(t,["id","style","data"]),a=Object.assign(Object.assign({},t),{style:Object.assign({},r),data:Object.assign({},n)});return"source"in t&&"target"in t?Object.assign({id:e,data:a},i):{id:e,data:a}}function w7(t){return t.data}class _t{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new cI}pushChange(t){if(this.isTraceless)return;let{type:e}=t;if(e===yD.NodeUpdated||e===yD.EdgeUpdated||e===yD.ComboUpdated){let{value:r,original:n}=t;this.changes.push({value:w5(r),original:w5(n),type:e})}else this.changes.push({value:w5(t.value),type:e})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(t){this.batchCount++,this.model.batch(t),this.batchCount--}isBatching(){return this.batchCount>0}silence(t){this.isTraceless=!0,t(),this.isTraceless=!1}isCombo(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(t){return this.model.getAllNodes().reduce((e,r)=>{let n=w7(r);return this.isCombo(lg(n))||(void 0===t?e.push(n):t.includes(lg(n))&&e.push(n)),e},[])}getEdgeDatum(t){return w7(this.model.getEdge(t))}getEdgeData(t){return this.model.getAllEdges().reduce((e,r)=>{let n=w7(r);return void 0===t?e.push(n):t.includes(lg(n))&&e.push(n),e},[])}getComboData(t){return this.model.getAllNodes().reduce((e,r)=>{let n=w7(r);return this.isCombo(lg(n))&&(void 0===t?e.push(n):t.includes(lg(n))&&e.push(n)),e},[])}getRootsData(t=sy){return this.model.getRoots(t).map(w7)}getAncestorsData(t,e){let{model:r}=this;return r.hasNode(t)&&r.hasTreeStructure(e)?r.getAncestors(t,e).map(w7):[]}getDescendantsData(t){let e=this.getElementDataById(t),r=[];return uo(e,t=>{t!==e&&r.push(t)},t=>this.getChildrenData(lg(t)),"TB"),r}getParentData(t,e){let{model:r}=this;if(!e){sx.warn("The hierarchy structure key is not specified");return}if(!r.hasNode(t)||!r.hasTreeStructure(e))return;let n=r.getParent(t,e);return n?w7(n):void 0}getChildrenData(t){let e="node"===this.getElementType(t)?sy:sg,{model:r}=this;return r.hasNode(t)&&r.hasTreeStructure(e)?r.getChildren(t,e).map(w7):[]}getElementsDataByType(t){return"node"===t?this.getNodeData():"edge"===t?this.getEdgeData():"combo"===t?this.getComboData():[]}getElementDataById(t){return"edge"===this.getElementType(t)?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}getNodeLikeDatum(t){return w7(this.model.getNode(t))}getNodeLikeData(t){return this.model.getAllNodes().reduce((e,r)=>{let n=w7(r);return t?t.includes(lg(n))&&e.push(n):e.push(n),e},[])}getElementDataByState(t,e){return this.getElementsDataByType(t).filter(t=>{var r;return null===(r=t.states)||void 0===r?void 0:r.includes(e)})}getElementState(t){var e;return(null===(e=this.getElementDataById(t))||void 0===e?void 0:e.states)||[]}hasNode(t){return this.model.hasNode(t)&&!this.isCombo(t)}hasEdge(t){return this.model.hasEdge(t)}hasCombo(t){return this.model.hasNode(t)&&this.isCombo(t)}getRelatedEdgesData(t,e="both"){return this.model.getRelatedEdges(t,e).map(w7)}getNeighborNodesData(t){return this.model.getNeighbors(t).map(w7)}setData(t){let{nodes:e=[],edges:r=[],combos:n=[]}=t,{nodes:i,edges:a,combos:o}=this.getData(),s=lk(i,e,t=>lg(t),w4),l=lk(a,r,t=>lg(t),w4),u=lk(o,n,t=>lg(t),w4);this.batch(()=>{let t={nodes:s.enter,edges:l.enter,combos:u.enter};this.addData(t),this.computeZIndex(t,"add",!0);let e={nodes:s.update,edges:l.update,combos:u.update};this.updateData(e),this.computeZIndex(e,"update",!0);let r={nodes:s.exit.map(lg),edges:l.exit.map(lg),combos:u.exit.map(lg)};this.removeData(r)})}addData(t){let{nodes:e,edges:r,combos:n}=t;this.batch(()=>{this.addComboData(n),this.addNodeData(e),this.addEdgeData(r)}),this.computeZIndex(t,"add")}addNodeData(t=[]){t.length&&(this.model.addNodes(t.map(t=>(this.pushChange({value:t,type:yD.NodeAdded}),w9(t)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({nodes:t},"add"))}addEdgeData(t=[]){t.length&&(this.model.addEdges(t.map(t=>(this.pushChange({value:t,type:yD.EdgeAdded}),w9(t)))),this.computeZIndex({edges:t},"add"))}addComboData(t=[]){if(!t.length)return;let{model:e}=this;e.hasTreeStructure(sg)||e.attachTreeStructure(sg),e.addNodes(t.map(t=>(this.comboIds.add(lg(t)),this.pushChange({value:t,type:yD.ComboAdded}),w9(t)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({combos:t},"add")}addChildrenData(t,e){let r=this.getNodeLikeDatum(t),n=e.map(lg);this.addNodeData(e),this.updateNodeData([{id:t,children:[...r.children||[],...n]}]),this.addEdgeData(n.map(e=>({source:t,target:e})))}computeZIndex(t,e,r=!1){!r&&this.isBatching()||this.batch(()=>{let{nodes:r=[],edges:n=[],combos:i=[]}=t;i.forEach(t=>{var r,n,i;let a=lg(t);if("add"===e&&(0,ol.default)(null===(r=t.style)||void 0===r?void 0:r.zIndex)||"update"===e&&!("combo"in t))return;let o=this.getParentData(a,sg),s=o?(null!==(i=null===(n=o.style)||void 0===n?void 0:n.zIndex)&&void 0!==i?i:0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:a,style:{zIndex:s}}])})}),r.forEach(t=>{var r,n,i;let a=lg(t);if("add"===e&&(0,ol.default)(null===(r=t.style)||void 0===r?void 0:r.zIndex)||"update"===e&&!("combo"in t)&&!("children"in t))return;let o=0,s=this.getParentData(a,sg);if(s)o=((null===(n=s.style)||void 0===n?void 0:n.zIndex)||0)+1;else{let t=this.getParentData(a,sy);t&&(o=(null===(i=null==t?void 0:t.style)||void 0===i?void 0:i.zIndex)||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:a,style:{zIndex:o}}])})}),n.forEach(t=>{var e,r,n,i,a;if((0,ol.default)(null===(e=t.style)||void 0===e?void 0:e.zIndex))return;let{id:o,source:s,target:l}=t;if(o){let t=this.getEdgeDatum(o);s=t.source,l=t.target}else o=lg(t);if(!s||!l)return;let u=(null===(n=null===(r=this.getNodeLikeDatum(s))||void 0===r?void 0:r.style)||void 0===n?void 0:n.zIndex)||0,h=(null===(a=null===(i=this.getNodeLikeDatum(l))||void 0===i?void 0:i.style)||void 0===a?void 0:a.zIndex)||0;this.updateEdgeData([{id:lg(t),style:{zIndex:Math.max(u,h)-1}}])})})}getFrontZIndex(t){var e;let r=this.getElementType(t),n=this.getElementDataById(t),i=this.getData();if(Object.assign(i,{[`${r}s`]:i[`${r}s`].filter(e=>lg(e)!==t)}),"combo"===r&&!uc(n)){let e=new Set(this.getAncestorsData(t,sg).map(lg));i.nodes=i.nodes.filter(t=>!e.has(lg(t))),i.combos=i.combos.filter(t=>!e.has(lg(t))),i.edges=i.edges.filter(({source:t,target:r})=>!e.has(t)&&!e.has(r))}return Math.max((null===(e=n.style)||void 0===e?void 0:e.zIndex)||0,0,...Object.values(i).flat().map(t=>{var e;return((null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.zIndex)||0)+1}))}updateNodeLikeHierarchy(t){if(!this.enableUpdateNodeLikeHierarchy)return;let{model:e}=this;t.forEach(t=>{let r=lg(t);t.combo&&(e.hasTreeStructure(sg)||e.attachTreeStructure(sg),this.setParent(r,t.combo,sg));let n=t.children||[];if(n.length){e.hasTreeStructure(sy)||e.attachTreeStructure(sy);let t=n.filter(t=>e.hasNode(t));t.forEach(t=>this.setParent(t,r,sy)),t.length!==n.length&&this.updateNodeData([{id:r,children:t}])}})}preventUpdateNodeLikeHierarchy(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}updateData(t){let{nodes:e,edges:r,combos:n}=t;this.batch(()=>{this.updateNodeData(e),this.updateComboData(n),this.updateEdgeData(r)}),this.computeZIndex(t,"update")}updateNodeData(t=[]){if(!t.length)return;let{model:e}=this;this.batch(()=>{let r=[];t.forEach(t=>{let n=lg(t),i=w7(e.getNode(n));if(w4(i,t))return;let a=w6(i,t);this.pushChange({value:a,original:i,type:yD.NodeUpdated}),e.mergeNodeData(n,a),r.push(a)}),this.updateNodeLikeHierarchy(r)}),this.computeZIndex({nodes:t},"update")}refreshData(){let{nodes:t,edges:e,combos:r}=this.getData();t.forEach(t=>{this.pushChange({value:t,original:t,type:yD.NodeUpdated})}),e.forEach(t=>{this.pushChange({value:t,original:t,type:yD.EdgeUpdated})}),r.forEach(t=>{this.pushChange({value:t,original:t,type:yD.ComboUpdated})})}syncNodeDatum(t){let{model:e}=this,r=lg(t),n=w6(w7(e.getNode(r)),t);e.mergeNodeData(r,n)}updateEdgeData(t=[]){if(!t.length)return;let{model:e}=this;this.batch(()=>{t.forEach(t=>{let r=lg(t),n=w7(e.getEdge(r));if(w4(n,t))return;t.source&&n.source!==t.source&&e.updateEdgeSource(r,t.source),t.target&&n.target!==t.target&&e.updateEdgeTarget(r,t.target);let i=w6(n,t);this.pushChange({value:i,original:n,type:yD.EdgeUpdated}),e.mergeEdgeData(r,i)})}),this.computeZIndex({edges:t},"update")}updateComboData(t=[]){if(!t.length)return;let{model:e}=this;e.batch(()=>{let r=[];t.forEach(t=>{let n=lg(t),i=w7(e.getNode(n));if(w4(i,t))return;let a=w6(i,t);this.pushChange({value:a,original:i,type:yD.ComboUpdated}),e.mergeNodeData(n,a),r.push(a)}),this.updateNodeLikeHierarchy(r)}),this.computeZIndex({combos:t},"update")}setParent(t,e,r,n=!0){if(t===e)return;let i=this.getNodeLikeDatum(t).combo;if(i!==e&&r===sg){let r={id:t,combo:e};this.isCombo(t)?this.syncComboDatum(r):this.syncNodeDatum(r)}this.model.setParent(t,e,r),n&&r===sg&&(function(t,e){void 0===e&&(e=new Map);var r=[];if(Array.isArray(t))for(var n=0,i=t.length;n<i;n++){var a=t[n];e.has(a)||(r.push(a),e.set(a,!0))}return r})([i,e]).forEach(t=>{void 0!==t&&this.refreshComboData(t)})}refreshComboData(t){let e=this.getComboData([t])[0],r=this.getAncestorsData(t,sg);e&&this.pushChange({value:e,original:e,type:yD.ComboUpdated}),r.forEach(t=>{this.pushChange({value:t,original:t,type:yD.ComboUpdated})})}syncComboDatum(t){let{model:e}=this,r=lg(t);if(!e.hasNode(r))return;let n=w6(w7(e.getNode(r)),t);e.mergeNodeData(r,n)}getElementPosition(t){return lZ(this.getElementDataById(t))}translateNodeLikeBy(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}translateNodeLikeTo(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}translateNodeBy(t,e){let r=lL(this.getElementPosition(t),[...e,0].slice(0,3));this.translateNodeTo(t,r)}translateNodeTo(t,e){let[r=0,n=0,i=0]=e;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:t,style:{x:r,y:n,z:i}}])})}translateComboBy(t,e){let[r=0,n=0,i=0]=e;if([r,n,i].some(isNaN)||[r,n,i].every(t=>0===t))return;let a=this.getComboData([t])[0];if(!a)return;let o=new Set;uo(a,t=>{let e=lg(t);if(o.has(e))return;o.add(e);let[a,s,l]=lZ(t),u=w6(t,{style:{x:a+r,y:s+n,z:l+i}});this.pushChange({value:u,original:t,type:this.isCombo(e)?yD.ComboUpdated:yD.NodeUpdated}),this.model.mergeNodeData(e,u)},t=>this.getChildrenData(lg(t)),"BT")}translateComboTo(t,e){var r;if(e.some(isNaN))return;let[n=0,i=0,a=0]=e,o=null===(r=this.getComboData([t]))||void 0===r?void 0:r[0];if(!o)return;let[s,l,u]=lZ(o),h=n-s,d=i-l,c=a-u;uo(o,t=>{let e=lg(t),[r,n,i]=lZ(t),a=w6(t,{style:{x:r+h,y:n+d,z:i+c}});this.pushChange({value:a,original:t,type:this.isCombo(e)?yD.ComboUpdated:yD.NodeUpdated}),this.model.mergeNodeData(e,a)},t=>this.getChildrenData(lg(t)),"BT")}removeData(t){let{nodes:e,edges:r,combos:n}=t;this.batch(()=>{this.removeEdgeData(r),this.removeNodeData(e),this.removeComboData(n),this.latestRemovedComboIds=new Set(n)})}removeNodeData(t=[]){t.length&&this.batch(()=>{t.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(lg)),this.pushChange({value:this.getNodeData([t])[0],type:yD.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(t)})}removeEdgeData(t=[]){t.length&&(t.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:yD.EdgeRemoved})),this.model.removeEdges(t))}removeComboData(t=[]){t.length&&this.batch(()=>{t.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:yD.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(t)})}removeNodeLikeHierarchy(t){if(this.model.hasTreeStructure(sg)){let e=this.getNodeLikeDatum(t).combo;this.setParent(t,void 0,sg,!1),this.model.getChildren(t,sg).forEach(t=>{let r=w7(t),n=lg(r);this.setParent(lg(r),e,sg,!1);let i=w6(r,{id:lg(r),combo:e});this.pushChange({value:i,original:r,type:this.isCombo(n)?yD.ComboUpdated:yD.NodeUpdated}),this.model.mergeNodeData(lg(r),i)}),(0,dl.default)(e)||this.refreshComboData(e)}}getElementType(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw Error(sb(`Unknown element type of id: ${t}`))}destroy(){let{model:t}=this,e=t.getAllNodes(),r=t.getAllEdges();t.removeEdges(r.map(t=>t.id)),t.removeNodes(e.map(t=>t.id)),this.context={}}}var on=y("2eDEB"),_e=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class _r{constructor(t){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=t}init(){if(!this.container){let{canvas:t}=this.context;this.container=t.appendChild(new on.Group({className:"elements"}))}}emit(t,e){e.silence||wX(this.context.graph,t)}forEachElementData(t){ua.forEach(e=>{let r=this.context.model.getElementsDataByType(e);t(e,r)})}getElementType(t,e){var r;let{options:n,graph:i}=this.context,a=(null===(r=n[t])||void 0===r?void 0:r.type)||e.type;return a?"string"==typeof a?a:a.call(i,e):"edge"===t?"line":"circle"}getTheme(t){return sE(this.context.options)[t]||{}}getThemeStyle(t){return this.getTheme(t).style||{}}getThemeStateStyle(t,e){let{state:r={}}=this.getTheme(t);return Object.assign({},...e.map(t=>r[t]||{}))}computePaletteStyle(){let{options:t}=this.context;this.paletteStyle={},this.forEachElementData((e,r)=>{var n,i;let a=Object.assign({},uO(null===(n=this.getTheme(e))||void 0===n?void 0:n.palette),uO(null===(i=t[e])||void 0===i?void 0:i.palette));(null==a?void 0:a.field)&&Object.assign(this.paletteStyle,function(t,e){if(!e)return{};let{type:r,color:n,field:i,invert:a}=e,o=t=>{let e="string"==typeof n?sm("palette",n):n;if("function"==typeof e){let r={};return t.forEach(([t,n])=>{r[t]=e(a?1-n:n)}),r}if(Array.isArray(e)){let r=a?[...e].reverse():e,n={};return t.forEach(([t,i])=>{n[t]=r[i%e.length]}),n}return{}},s=(t,e)=>{var r;return"string"==typeof t?null===(r=e.data)||void 0===r?void 0:r[t]:null==t?void 0:t(e)};if("group"===r){let e=sD(t,t=>{if(!i)return"default";let e=s(i,t);return e?String(e):"default"}),r=o(Object.keys(e).map((t,e)=>[t,e])),n={};return Object.entries(e).forEach(([t,e])=>{e.forEach(e=>{n[lg(e)]=r[t]})}),n}if("value"===r){let[e,r]=t.reduce(([t,e],r)=>{let n=s(i,r);if("number"!=typeof n)throw Error(sb(`Palette field ${i} is not a number`));return[Math.min(t,n),Math.max(e,n)]},[1/0,-1/0]),n=r-e;return o(t.map(t=>[t.id,(s(i,t)-e)/n]))}}(r,a))})}getPaletteStyle(t,e){let r=this.paletteStyle[e];return r?"edge"===t?{stroke:r}:{fill:r}:{}}computeElementDefaultStyle(t,e){var r;let{options:n}=this.context,i=(null===(r=n[t])||void 0===r?void 0:r.style)||{};"transform"in i&&Array.isArray(i.transform)&&(i.transform=[...i.transform]),this.defaultStyle[lg(e.datum)]=uw(i,e)}computeElementsDefaultStyle(t){let{graph:e}=this.context;this.forEachElementData((r,n)=>{let i=n.length;for(let a=0;a<i;a++){let i=n[a];(void 0===t||t.includes(lg(i)))&&this.computeElementDefaultStyle(r,{datum:i,graph:e})}})}getDefaultStyle(t){return this.defaultStyle[t]||{}}getElementState(t){try{let{model:e}=this.context;return e.getElementState(t)}catch(t){return[]}}getElementStateStyle(t,e,r){var n,i;let{options:a}=this.context;return uw((null===(i=null===(n=a[t])||void 0===n?void 0:n.state)||void 0===i?void 0:i[e])||{},r)}computeElementStatesStyle(t,e,r){this.stateStyle[lg(r.datum)]=Object.assign({},...e.map(e=>this.getElementStateStyle(t,e,r)))}computeElementsStatesStyle(t){let{graph:e}=this.context;this.forEachElementData((r,n)=>{let i=n.length;for(let a=0;a<i;a++){let i=n[a];if(void 0===t||t.includes(lg(i))){let t=this.getElementState(lg(i));this.computeElementStatesStyle(r,t,{datum:i,graph:e})}}})}getStateStyle(t){return this.stateStyle[t]||{}}computeStyle(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}getElement(t){return this.elementMap[t]}getNodes(){return this.context.model.getNodeData().map(({id:t})=>this.elementMap[t])}getEdges(){return this.context.model.getEdgeData().map(t=>this.elementMap[lg(t)])}getCombos(){return this.context.model.getComboData().map(({id:t})=>this.elementMap[t])}getElementComputedStyle(t,e){let r=lg(e),n=this.getThemeStyle(t),i=this.getPaletteStyle(t,r),a=e.style||{},o=Object.assign({},n,i,a,this.getDefaultStyle(r),this.getThemeStateStyle(t,this.getElementState(r)),this.getStateStyle(r));if("combo"===t){let t=this.context.model.getChildrenData(r),e=o.collapsed?[]:t.map(lg).filter(t=>this.getElement(t));Object.assign(o,{childrenNode:e,childrenData:t})}return o}draw(t={animation:!0}){this.init();let e=this.computeChangesAndDrawData(t);if(!e)return null;let{type:r="draw",stage:n=r,animation:i,silence:a}=t,{dataChanges:o,drawData:s}=e;this.markDestroyElement(s),this.computeStyle(n);let{add:l,update:u,remove:h}=s;return this.destroyElements(h,t),this.createElements(l,t),this.updateElements(u,t),this.context.animation.animate(i,a?{}:{before:()=>this.emit(new wW(yG.BEFORE_DRAW,{dataChanges:o,animation:i,stage:n,render:"render"===r}),t),beforeAnimate:e=>this.emit(new wq(yG.BEFORE_ANIMATE,yL.DRAW,e,s),t),afterAnimate:e=>this.emit(new wq(yG.AFTER_ANIMATE,yL.DRAW,e,s),t),after:()=>this.emit(new wW(yG.AFTER_DRAW,{dataChanges:o,animation:i,stage:n,render:"render"===r,firstRender:!1===this.context.graph.rendered}),t)})}computeChangesAndDrawData(t){let{model:e}=this.context,r=e.getChanges(),n=mN(r);if(0===n.length)return null;let{NodeAdded:i=[],NodeUpdated:a=[],NodeRemoved:o=[],EdgeAdded:s=[],EdgeUpdated:l=[],EdgeRemoved:u=[],ComboAdded:h=[],ComboUpdated:d=[],ComboRemoved:c=[]}=sD(n,t=>t.type),f=t=>new Map(t.map(t=>{let e=t.value;return[lg(e),e]})),p={add:{nodes:f(i),edges:f(s),combos:f(h)},update:{nodes:f(a),edges:f(l),combos:f(d)},remove:{nodes:f(o),edges:f(u),combos:f(c)}},g=this.transformData(p,t);return e.clearChanges(),{dataChanges:r,drawData:g}}transformData(t,e){return Object.values(this.context.transform.getTransformInstance()).reduce((t,r)=>r.beforeDraw(t,e),t)}createElement(t,e,r){var n;let i=lg(e);if(this.getElement(i))return;let a=this.getElementType(t,e),o=this.getElementComputedStyle(t,e),s=sm(t,a);if(!s)return sx.warn(`The element ${a} of ${t} is not registered.`);this.emit(new wY(yG.BEFORE_ELEMENT_CREATE,t,e),r);let l=this.container.appendChild(new s({id:i,context:this.context,style:Object.assign({},o)}));this.shapeTypeMap[i]=a,this.elementMap[i]=l;let{stage:u="enter"}=r;null===(n=this.context.animation)||void 0===n||n.add({element:l,elementType:t,stage:u,originalStyle:Object.assign({},l.attributes),updatedStyle:o},{after:()=>{var n;this.emit(new wY(yG.AFTER_ELEMENT_CREATE,t,e),r),null===(n=l.onCreate)||void 0===n||n.call(l)}})}createElements(t,e){let{nodes:r,edges:n,combos:i}=t;[["node",r],["combo",i],["edge",n]].forEach(([t,r])=>{r.forEach(r=>this.createElement(t,r,e))})}getUpdateStageStyle(t,e,r){let{stage:n="update"}=r;if("translate"===n){if("node"!==t&&"combo"!==t)return{};{let{style:{x:t=0,y:r=0,z:n=0}={}}=e;return{x:t,y:r,z:n}}}return this.getElementComputedStyle(t,e)}updateElement(t,e,r){var n;let i=lg(e),{stage:a="update"}=r,o=this.getElement(i);if(!o)return()=>null;this.emit(new wY(yG.BEFORE_ELEMENT_UPDATE,t,e),r);let s=this.getElementType(t,e),l=this.getUpdateStageStyle(t,e,r);this.shapeTypeMap[i]!==s&&(o.destroy(),delete this.shapeTypeMap[i],delete this.elementMap[i],this.createElement(t,e,{animation:!1,silence:!0}));let u="visibility"!==a?a:"hidden"===l.visibility?"hide":"show";"hide"===u&&delete l.visibility,null===(n=this.context.animation)||void 0===n||n.add({element:o,elementType:t,stage:u,originalStyle:Object.assign({},o.attributes),updatedStyle:l},{before:()=>{let t=this.elementMap[i];"collapse"!==a&&cy(t,l),"visibility"===a&&(wQ("opacity")in(uf(t,wZ)||{})||function(t,e){let r=Array.isArray(e)?e:[e];uf(t,wZ)||up(t,wZ,{}),r.forEach(e=>{up(uf(t,wZ),wQ(e),t.attributes[e])})}(t,"opacity"),this.visibilityCache.set(t,"show"===u?"visible":"hidden"),"show"===u&&lO(t,"visible"))},after:()=>{var n;let o=this.elementMap[i];"collapse"===a&&cy(o,l),"hide"===u&&lO(o,this.visibilityCache.get(o)),this.emit(new wY(yG.AFTER_ELEMENT_UPDATE,t,e),r),null===(n=o.onUpdate)||void 0===n||n.call(o)}})}updateElements(t,e){let{nodes:r,edges:n,combos:i}=t;[["node",r],["combo",i],["edge",n]].forEach(([t,r])=>{r.forEach(r=>this.updateElement(t,r,e))})}markDestroyElement(t){Object.values(t.remove).forEach(t=>{t.forEach(t=>{let e=lg(t),r=this.getElement(e);r&&up(r,"__to_be_destroyed__",!0)})})}destroyElement(t,e,r){var n;let{stage:i="exit"}=r,a=lg(e),o=this.elementMap[a];if(!o)return()=>null;this.emit(new wY(yG.BEFORE_ELEMENT_DESTROY,t,e),r),null===(n=this.context.animation)||void 0===n||n.add({element:o,elementType:t,stage:i,originalStyle:Object.assign({},o.attributes),updatedStyle:{}},{after:()=>{var n;this.clearElement(a),o.destroy(),null===(n=o.onDestroy)||void 0===n||n.call(o),this.emit(new wY(yG.AFTER_ELEMENT_DESTROY,t,e),r)}})}destroyElements(t,e){let{nodes:r,edges:n,combos:i}=t;[["combo",i],["edge",n],["node",r]].forEach(([t,r])=>{r.forEach(r=>this.destroyElement(t,r,e))})}clearElement(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}collapseNode(t,e){return _e(this,void 0,void 0,function*(){var r;let{model:n,layout:i}=this.context,a=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!a)return;this.markDestroyElement(a.drawData);let o=yield i.simulate();n.updateData(o);let s=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!s)return;let{drawData:l}=s,{add:u,remove:h,update:d}=l;this.markDestroyElement(l);let c={animation:e,stage:"collapse",data:l};this.destroyElements(h,c),this.createElements(u,c),this.updateElements(d,c),yield null===(r=this.context.animation.animate(e,{beforeAnimate:t=>this.emit(new wq(yG.BEFORE_ANIMATE,yL.COLLAPSE,t,l),c),afterAnimate:t=>this.emit(new wq(yG.AFTER_ANIMATE,yL.COLLAPSE,t,l),c)},{collapse:{target:t,descendants:Array.from(h.nodes).map(([,t])=>lg(t)),position:lZ(d.nodes.get(t))}}))||void 0===r?void 0:r.finished})}expandNode(t,e){return _e(this,void 0,void 0,function*(){var r;let{model:n,layout:i}=this.context;if(!n.getAncestorsData(t,sg).every(t=>uc(t)))return;let a=lZ(n.getNodeData([t])[0]),o=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!o)return;let{drawData:{add:s}}=o;this.createElements(s,{animation:!1,stage:"expand",target:t}),this.context.animation.clear();let l=yield i.simulate();n.updateData(l),this.computeStyle("expand");let u=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!u)return;let{drawData:h}=u,{update:d}=h,c={animation:e,stage:"expand",data:h};s.edges.forEach(t=>d.edges.set(lg(t),t)),s.nodes.forEach(t=>d.nodes.set(lg(t),t)),this.updateElements(d,c),yield null===(r=this.context.animation.animate(e,{beforeAnimate:t=>this.emit(new wq(yG.BEFORE_ANIMATE,yL.EXPAND,t,h),c),afterAnimate:t=>this.emit(new wq(yG.AFTER_ANIMATE,yL.EXPAND,t,h),c)},{expand:{target:t,descendants:Array.from(s.nodes).map(([,t])=>lg(t)),position:a}}))||void 0===r?void 0:r.finished})}collapseCombo(t,e){return _e(this,void 0,void 0,function*(){var r;let{model:n,element:i}=this.context;if(n.getAncestorsData(t,sg).some(t=>uc(t)))return;let a=i.getElement(t),o=a.getComboPosition(Object.assign(Object.assign({},a.attributes),{collapsed:!0})),s=this.computeChangesAndDrawData({stage:"collapse",animation:e});if(!s)return;let{dataChanges:l,drawData:u}=s;this.markDestroyElement(u);let{update:h,remove:d}=u,c={animation:e,stage:"collapse",data:u};this.destroyElements(d,c),this.updateElements(h,c);let f=t=>Array.from(t).map(([,t])=>lg(t));yield null===(r=this.context.animation.animate(e,{before:()=>this.emit(new wW(yG.BEFORE_DRAW,{dataChanges:l,animation:e}),c),beforeAnimate:t=>this.emit(new wq(yG.BEFORE_ANIMATE,yL.COLLAPSE,t,u),c),afterAnimate:t=>this.emit(new wq(yG.AFTER_ANIMATE,yL.COLLAPSE,t,u),c),after:()=>this.emit(new wW(yG.AFTER_DRAW,{dataChanges:l,animation:e}),c)},{collapse:{target:t,descendants:[...f(d.nodes),...f(d.combos)],position:o}}))||void 0===r?void 0:r.finished})}expandCombo(t,e){return _e(this,void 0,void 0,function*(){var r;let{model:n}=this.context,i=lZ(n.getComboData([t])[0]);this.computeStyle("expand");let a=this.computeChangesAndDrawData({stage:"expand",animation:e});if(!a)return;let{dataChanges:o,drawData:s}=a,{add:l,update:u}=s,h={animation:e,stage:"expand",data:s,target:t};this.createElements(l,h),this.updateElements(u,h);let d=t=>Array.from(t).map(([,t])=>lg(t));yield null===(r=this.context.animation.animate(e,{before:()=>this.emit(new wW(yG.BEFORE_DRAW,{dataChanges:o,animation:e}),h),beforeAnimate:t=>this.emit(new wq(yG.BEFORE_ANIMATE,yL.EXPAND,t,s),h),afterAnimate:t=>this.emit(new wq(yG.AFTER_ANIMATE,yL.EXPAND,t,s),h),after:()=>this.emit(new wW(yG.AFTER_DRAW,{dataChanges:o,animation:e}),h)},{expand:{target:t,descendants:[...d(l.nodes),...d(l.combos)],position:i}}))||void 0===r?void 0:r.finished})}destroy(){this.container.destroy(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={},this.context={}}}var s6=y("7WQrb"),sI=y("ky7aH");/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _n=Symbol("Comlink.proxy"),_i=Symbol("Comlink.endpoint"),_a=Symbol("Comlink.releaseProxy"),_o=Symbol("Comlink.finalizer"),_s=Symbol("Comlink.thrown"),_l=t=>"object"==typeof t&&null!==t||"function"==typeof t,_u=new Map([["proxy",{canHandle:t=>_l(t)&&t[_n],serialize(t){let{port1:e,port2:r}=new MessageChannel;return function t(e,r=globalThis,n=["*"]){r.addEventListener("message",function i(a){let o;if(!a||!a.data)return;if(!function(t,e){for(let r of t)if(e===r||"*"===r||r instanceof RegExp&&r.test(e))return!0;return!1}(n,a.origin)){console.warn(`Invalid origin '${a.origin}' for comlink proxy`);return}let{id:s,type:l,path:u}=Object.assign({path:[]},a.data),h=(a.data.argumentList||[]).map(_b);try{var d,c;let r=u.slice(0,-1).reduce((t,e)=>t[e],e),n=u.reduce((t,e)=>t[e],e);switch(l){case"GET":o=n;break;case"SET":r[u.slice(-1)[0]]=_b(a.data.value),o=!0;break;case"APPLY":o=n.apply(r,h);break;case"CONSTRUCT":d=new n(...h),o=Object.assign(d,{[_n]:!0});break;case"ENDPOINT":{let{port1:r,port2:n}=new MessageChannel;t(e,n),c=[r],_v.set(r,c),o=r}break;case"RELEASE":o=void 0;break;default:return}}catch(t){o={value:t,[_s]:0}}Promise.resolve(o).catch(t=>({value:t,[_s]:0})).then(t=>{let[n,a]=_m(t);r.postMessage(Object.assign(Object.assign({},n),{id:s}),a),"RELEASE"===l&&(r.removeEventListener("message",i),_h(r),_o in e&&"function"==typeof e[_o]&&e[_o]())}).catch(t=>{let[e,n]=_m({value:TypeError("Unserializable return value"),[_s]:0});r.postMessage(Object.assign(Object.assign({},e),{id:s}),n)})}),r.start&&r.start()}(t,e),[r,[r]]},deserialize:t=>(t.start(),_d(t))}],["throw",{canHandle:t=>_l(t)&&_s in t,serialize:({value:t})=>[t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[]],deserialize(t){if(t.isError)throw Object.assign(Error(t.value.message),t.value);throw t.value}}]]);function _h(t){"MessagePort"===t.constructor.name&&t.close()}function _d(t,e){let r=new Map;return t.addEventListener("message",function(t){let{data:e}=t;if(!e||!e.id)return;let n=r.get(e.id);if(n)try{n(e)}finally{r.delete(e.id)}}),function t(e,r,n=[],i=function(){}){let a=!1,o=new Proxy(i,{get(i,s){if(_c(a),s===_a)return()=>{_g&&_g.unregister(o),_f(e),r.clear(),a=!0};if("then"===s){if(0===n.length)return{then:()=>o};let t=_x(e,r,{type:"GET",path:n.map(t=>t.toString())}).then(_b);return t.then.bind(t)}return t(e,r,[...n,s])},set(t,i,o){_c(a);let[s,l]=_m(o);return _x(e,r,{type:"SET",path:[...n,i].map(t=>t.toString()),value:s},l).then(_b)},apply(i,o,s){_c(a);let l=n[n.length-1];if(l===_i)return _x(e,r,{type:"ENDPOINT"}).then(_b);if("bind"===l)return t(e,r,n.slice(0,-1));let[u,h]=_y(s);return _x(e,r,{type:"APPLY",path:n.map(t=>t.toString()),argumentList:u},h).then(_b)},construct(t,i){_c(a);let[o,s]=_y(i);return _x(e,r,{type:"CONSTRUCT",path:n.map(t=>t.toString()),argumentList:o},s).then(_b)}});return function(t,e){let r=(_p.get(e)||0)+1;_p.set(e,r),_g&&_g.register(t,e,t)}(o,e),o}(t,r,[],e)}function _c(t){if(t)throw Error("Proxy has been released and is not useable")}function _f(t){return _x(t,new Map,{type:"RELEASE"}).then(()=>{_h(t)})}const _p=new WeakMap,_g="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{let e=(_p.get(t)||0)-1;_p.set(t,e),0===e&&_f(t)});function _y(t){var e;let r=t.map(_m);return[r.map(t=>t[0]),(e=r.map(t=>t[1]),Array.prototype.concat.apply([],e))]}const _v=new WeakMap;function _m(t){for(let[e,r]of _u)if(r.canHandle(t)){let[n,i]=r.serialize(t);return[{type:"HANDLER",name:e,value:n},i]}return[{type:"RAW",value:t},_v.get(t)||[]]}function _b(t){switch(t.type){case"HANDLER":return _u.get(t.name).deserialize(t.value);case"RAW":return t.value}}function _x(t,e,r,n){return new Promise(i=>{let a=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.set(a,i),t.start&&t.start(),t.postMessage(Object.assign({id:a},r),n)})}var _E={},_w={};_w=function(t,e,r){if(e===self.location.origin)return t;var n=r?"import "+JSON.stringify(t)+";":"importScripts("+JSON.stringify(t)+");";return URL.createObjectURL(new Blob([n],{type:"application/javascript"}))};let __=new URL("worker.1c31f1cd.js",import.meta.url);_E=_w(__.toString(),__.origin,!0);class _S extends cT{constructor(t,e,r){super(),this.graph=t,this.layout=e,this.options=r,this.spawnWorker()}spawnWorker(){this.proxy=_d(new Worker(_E)),this.running&&(this.running=!1,this.execute())}execute(){var t;return(0,s6.__awaiter)(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;let e=this.layout.options,{onTick:r}=e,n=(0,s6.__rest)(e,["onTick"]),i={};Object.keys(n).forEach(t=>{(0,sI.default)(n[t])||(i[t]=n[t])});let a={layout:{id:this.layout.id,options:i,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),[s]=yield this.proxy.calculateLayout(a,[o]);return s})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[_a]()}isRunning(){return this.running}}var _k=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})},_N=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&0>e.indexOf(n)&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)0>e.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class _O{get presetOptions(){return{animation:!!sk(this.context.options,!0)}}get options(){let{options:t}=this.context;return t.layout}constructor(t){this.instances=[],this.context=t}getLayoutInstance(){return this.instances}layout(){return _k(this,void 0,void 0,function*(){if(!this.options)return;let t=Array.isArray(this.options)?this.options:[this.options],{graph:e}=this.context;for(let r of(wX(e,new wW(yG.BEFORE_LAYOUT)),t)){let n=t.indexOf(r),i=this.getLayoutData(r),a=Object.assign(Object.assign({},this.presetOptions),r);wX(e,new wW(yG.BEFORE_STAGE_LAYOUT,{options:a,index:n}));let o=yield this.stepLayout(i,a,n);wX(e,new wW(yG.AFTER_STAGE_LAYOUT,{options:a,index:n})),r.animation||this.updateElementPosition(o,!1)}wX(e,new wW(yG.AFTER_LAYOUT)),this.transformDataAfterLayout()})}transformDataAfterLayout(){Object.values(this.context.transform.getTransformInstance()).forEach(t=>t.afterLayout())}simulate(){return _k(this,void 0,void 0,function*(){if(!this.options)return{};let t=Array.isArray(this.options)?this.options:[this.options],e={};for(let r of t){let n=t.indexOf(r),i=this.getLayoutData(r);e=yield this.stepLayout(i,Object.assign(Object.assign(Object.assign({},this.presetOptions),r),{animation:!1}),n)}return e})}stepLayout(t,e,r){return _k(this,void 0,void 0,function*(){return!function(t){let{type:e}=t;return["compact-box","mindmap","dendrogram","indented"].includes(e)}(e)?yield this.graphLayout(t,e,r):yield this.treeLayout(t,e,r)})}graphLayout(t,e,r){return _k(this,void 0,void 0,function*(){let{animation:n,enableWorker:i,iterations:a=300}=e,o=this.initGraphLayout(e);if(!o)return{};if(this.instances[r]=o,this.instance=o,i)return this.supervisor=new _S(o.graphData2LayoutModel(t),o.instance,{iterations:a}),cL((yield this.supervisor.execute()));if(yt(o))return n?yield o.execute(t,{onTick:t=>{this.updateElementPosition(t,!1)}}):(o.execute(t),o.stop(),o.tick(a));let s=yield o.execute(t);if(n){let t=this.updateElementPosition(s,n);yield null==t?void 0:t.finished}return s})}treeLayout(t,e,r){return _k(this,void 0,void 0,function*(){let{type:r,animation:n}=e,i=sm("layout",r);if(!i)return{};let{nodes:a=[],edges:o=[]}=t,s=new cI({nodes:a.map(t=>({id:lg(t),data:t.data||{}})),edges:o.map(t=>({id:lg(t),source:t.source,target:t.target,data:t.data||{}}))});!function(t){if(!t.hasTreeStructure(sy))for(let e of(t.attachTreeStructure(sy),t.getAllEdges())){let{source:r,target:n}=e;t.setParent(n,r,sy)}}(s);let l={nodes:[],edges:[]},u={nodes:[],edges:[]};s.getRoots(sy).forEach(t=>{uo(t,t=>{t.children=s.getSuccessors(t.id)},t=>s.getSuccessors(t.id),"TB");let r=i(t,e),{x:n,y:a,z:o=0}=r;uo(r,t=>{let{id:e,x:r,y:i,z:s=0}=t;l.nodes.push({id:e,style:{x:n,y:a,z:o}}),u.nodes.push({id:e,style:{x:r,y:i,z:s}})},t=>t.children,"TB")});let h=this.inferTreeLayoutOffset(u);if(_T(u,h),n){_T(l,h),this.updateElementPosition(l,!1);let t=this.updateElementPosition(u,n);yield null==t?void 0:t.finished}return u})}inferTreeLayoutOffset(t){var e;let[r,n]=[1/0,-1/0],[i,a]=[1/0,-1/0];null===(e=t.nodes)||void 0===e||e.forEach(t=>{let{x:e=0,y:o=0}=t.style||{};r=Math.min(r,e),n=Math.max(n,e),i=Math.min(i,o),a=Math.max(a,o)});let{canvas:o}=this.context,s=o.getSize(),[l,u]=o.getCanvasByViewport([0,0]),[h,d]=o.getCanvasByViewport(s);return r>=l&&n<=h&&i>=u&&a<=d?[0,0]:[(l+h)/2-(r+n)/2,(u+d)/2-(i+a)/2]}stopLayout(){this.instance&&yt(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(t){let{nodeFilter:e=()=>!0}=t,{nodes:r,edges:n,combos:i}=this.context.model.getData(),a=t=>this.context.element.getElement(t),o=r.filter(t=>{let r=a(lg(t));return!(!r||cv(r))&&e(t)}),s=new Map(o.map(t=>[lg(t),t]));return{nodes:o,edges:n.filter(t=>{let{source:e,target:r}=t;return!!(s.has(e)&&s.has(r))}),combos:i}}initGraphLayout(t){var e,r;let{element:n,viewport:i}=this.context,{type:a,enableWorker:o,animation:s,iterations:l}=t,u=_N(t,["type","enableWorker","animation","iterations"]),[h,d]=i.getCanvasSize(),c=null!==(e=null==t?void 0:t.nodeSize)&&void 0!==e?e:t=>{let e=null==n?void 0:n.getElement(t.id),{size:r}=(null==e?void 0:e.attributes)||{};return r},f=sm("layout",a);if(!f)return sx.warn(`The layout of ${a} is not registered.`);let p=new(Object.getPrototypeOf(f.prototype)===cP.prototype?f:(r=this.context,class extends cP{constructor(t,e){if(super(t,e),this.instance=new f({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){let t=this.instance;this.stop=t.stop.bind(t),this.tick=e=>cL(t.tick(e))}}execute(t,e){var r,n,i,a;return r=this,n=void 0,i=void 0,a=function*(){return cL((yield this.instance.execute(this.graphData2LayoutModel(t),this.transformOptions(lP({},this.options,e)))))},new(i||(i=Promise))(function(t,e){function o(t){try{l(a.next(t))}catch(t){e(t)}}function s(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var r;e.done?t(e.value):((r=e.value)instanceof i?r:new i(function(t){t(r)})).then(o,s)}l((a=a.apply(r,n||[])).next())})}transformOptions(t){let{onTick:e}=t;return e&&(t.onTick=t=>e(cL(t))),t}graphData2LayoutModel(t){let{nodes:e=[],edges:n=[],combos:i=[]}=t,a=e.map(t=>{let e=lg(t),{data:r,style:n,combo:i}=t,a=cD(t,["data","style","combo"]),o={id:e,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},r),{data:r}),i?{parentId:i}:{}),{style:n}),a)};return(null==n?void 0:n.x)&&Object.assign(o.data,{x:n.x}),(null==n?void 0:n.y)&&Object.assign(o.data,{y:n.y}),(null==n?void 0:n.z)&&Object.assign(o.data,{z:n.z}),o}),o=new Map(a.map(t=>[t.id,t])),s=n.filter(t=>{let{source:e,target:r}=t;return o.has(e)&&o.has(r)}).map(t=>{let{source:e,target:r,data:n,style:i}=t;return{id:lg(t),source:e,target:r,data:Object.assign({},n),style:Object.assign({},i)}}),l=new cI({nodes:[...a,...i.map(t=>({id:lg(t),data:Object.assign({_isCombo:!0},t.data),style:Object.assign({},t.style)}))],edges:s});return r.model.model.hasTreeStructure(sg)&&(l.attachTreeStructure(sg),a.forEach(t=>{let e=r.model.model.getParent(t.id,sg);e&&l.hasNode(e.id)&&l.setParent(t.id,e.id,sg)})),l}}))(this.context),g={nodeSize:c,width:h,height:d,center:[h/2,d/2]};switch(p.id){case"d3-force":case"d3-force-3d":Object.assign(g,{center:{x:h/2,y:d/2,z:0}})}return lP(p.options,g,u),p}updateElementPosition(t,e){let{model:r,element:n}=this.context;return n?(r.updateData(t),n.draw({animation:e,silence:!0})):null}destroy(){var t;this.stopLayout(),this.context={},null===(t=this.supervisor)||void 0===t||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const _T=(t,e)=>{var r;let[n,i]=e;null===(r=t.nodes)||void 0===r||r.forEach(t=>{if(t.style){let{x:e=0,y:r=0}=t.style;t.style.x=e+n,t.style.y=r+i}else t.style={x:n,y:i}})};class _M extends lT{constructor(t){super(t),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){let e=this.extensionMap[t];if(e)return e;sx.warn(`Cannot find the plugin ${t}, will try to find it by type.`);let r=this.extensions.find(e=>e.type===t);if(r)return this.extensionMap[r.key]}}const _A=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class _C extends lT{constructor(t){super(t),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([..._A.slice(0,_A.length-1),...t,_A[_A.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}var on=y("2eDEB"),ow=y("8hhuV"),ol=y("jyI49"),_R=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class _I{get padding(){return sz(this.context.options.padding)}get paddingOffset(){let[t,e,r,n]=this.padding,[i,a,o]=[(n-e)/2,(t-r)/2,0];return[i,a,o]}constructor(t){this.landmarkCounter=0,this.context=t;let[e,r]=this.paddingOffset,{zoom:n,rotation:i,x:a=e,y:o=r}=t.options;this.transform({mode:"absolute",scale:n,translate:[a,o],rotate:i},!1)}get camera(){let{canvas:t}=this.context;return new Proxy(t.getCamera(),{get:(e,r)=>{let n=Object.entries(t.getLayers()).filter(([t])=>!["main"].includes(t)).map(([,t])=>t.getCamera()),i=e[r];if("function"==typeof i)return(...t)=>{let a=i.apply(e,t);return n.forEach(e=>{e[r].apply(e,t)}),a}}})}createLandmark(t){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,t)}getAnimation(t){let e=sk(this.context.options,t);return!!e&&dd(Object.assign({},e),["easing","duration"])}getCanvasSize(){let{canvas:t}=this.context,{width:e=0,height:r=0}=t.getConfig();return[e,r]}getCanvasCenter(){let{canvas:t}=this.context,{width:e=0,height:r=0}=t.getConfig();return[e/2,r/2,0]}getViewportCenter(){let[t,e]=this.camera.getPosition();return[t,e,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(t){let{camera:e}=this,{mode:r,translate:n=[]}=t,i=this.getZoom(),a=e.getPosition(),o=e.getFocalPoint(),[s,l]=this.getCanvasCenter(),[u=0,h=0,d=0]=n,c=lB([-u,-h,-d],i);return"relative"===r?{position:lL(a,c),focalPoint:lL(o,c)}:{position:lL([s,l,a[2]],c),focalPoint:lL([s,l,o[2]],c)}}getRotateOptions(t){let{mode:e,rotate:r=0}=t;return{roll:"relative"===e?this.camera.getRoll()+r:r}}getZoomOptions(t){let{zoomRange:e}=this.context.options,r=this.camera.getZoom(),{mode:n,scale:i=1}=t;return(0,ow.default)("relative"===n?r*i:i,...e)}transform(t,e){return _R(this,void 0,void 0,function*(){let{graph:r}=this.context,{translate:n,rotate:i,scale:a,origin:o}=t;this.cancelAnimation();let s=this.getAnimation(e);if(wX(r,new wK(yG.BEFORE_TRANSFORM,t)),!i&&a&&!n&&o&&!s){this.camera.setZoomByViewportPoint(this.getZoomOptions(t),o),wX(r,new wK(yG.AFTER_TRANSFORM,t));return}let l={};if(n&&Object.assign(l,this.getTranslateOptions(t)),(0,ol.default)(i)&&Object.assign(l,this.getRotateOptions(t)),(0,ol.default)(a)&&Object.assign(l,{zoom:this.getZoomOptions(t)}),s)return wX(r,new wq(yG.BEFORE_ANIMATE,yL.TRANSFORM,null,t)),new Promise(e=>{this.transformResolver=e,this.camera.gotoLandmark(this.createLandmark(l),Object.assign(Object.assign({},s),{onfinish:()=>{wX(r,new wq(yG.AFTER_ANIMATE,yL.TRANSFORM,null,t)),wX(r,new wK(yG.AFTER_TRANSFORM,t)),this.transformResolver=void 0,e()}}))});this.camera.gotoLandmark(this.createLandmark(l),{duration:0}),wX(r,new wK(yG.AFTER_TRANSFORM,t))})}fitView(t,e){return _R(this,void 0,void 0,function*(){let[r,n,i,a]=this.padding,{when:o="always",direction:s="both"}=t||{},[l,u]=this.context.canvas.getSize(),h=l-a-n,d=u-r-i,c=this.context.canvas.getBounds(),[f,p]=s$(this.getBBoxInViewport(c));if("overflow"===o&&!("x"===s&&f>=h||"y"===s&&p>=d||"both"===s&&f>=h&&p>=d))return yield this.fitCenter(e);let g=h/f,y=d/p,v="x"===s?g:"y"===s?y:Math.min(g,y),m=this.getAnimation(e);yield this.transform({mode:"relative",scale:v,translate:lL(lj(this.getCanvasCenter(),this.getBBoxInViewport(c).center),lB(this.paddingOffset,v))},m)})}fitCenter(t){return _R(this,void 0,void 0,function*(){let e=this.context.canvas.getBounds();yield this.focus(e,t)})}focusElements(t,e){return _R(this,void 0,void 0,function*(){let{element:r}=this.context;if(!r)return;let n=sq(t.map(t=>r.getElement(t).getRenderBounds()));yield this.focus(n,e)})}focus(t,e){return _R(this,void 0,void 0,function*(){let r=this.context.graph.getViewportByCanvas(t.center),n=lj(this.getCanvasCenter(),r);yield this.transform({mode:"relative",translate:lL(n,this.paddingOffset)},e)})}getBBoxInViewport(t){let{min:e,max:r}=t,{graph:n}=this.context,[i,a]=n.getViewportByCanvas(e),[o,s]=n.getViewportByCanvas(r),l=new on.AABB;return l.setMinMax([i,a,0],[o,s,0]),l}isInViewport(t,e=!1,r=0){let{graph:n}=this.context,i=this.getCanvasSize(),[a,o]=n.getCanvasByViewport([0,0]),[s,l]=n.getCanvasByViewport(i),u=new on.AABB;return u.setMinMax([a,o,0],[s,l,0]),r&&(u=sW(u,r)),sF(t)?sY(t,u):e?function(t,e){let[r,n]=t.min,[i,a]=t.max,[o,s]=e.min,[l,u]=e.max;return r>=o&&i<=l&&n>=s&&a<=u}(t,u):u.intersects(t)}cancelAnimation(){var t,e;(null===(t=this.camera.landmarks)||void 0===t?void 0:t.length)&&this.camera.cancelLandmarkAnimation(),null===(e=this.transformResolver)||void 0===e||e.call(this)}}var _P=function(t,e,r,n){return new(r||(r=Promise))(function(i,a){function o(t){try{l(n.next(t))}catch(t){a(t)}}function s(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):((e=t.value)instanceof r?e:new r(function(t){t(e)})).then(o,s)}l((n=n.apply(t,e||[])).next())})};class _D extends cT{constructor(t){var e;super(),this.rendered=!1,this.destroyed=!1,this.context={model:new _t},this.isCollapsingExpanding=!1,this.onResize=c_(()=>{this.resize()},300),this.options=Object.assign({},_D.defaultOptions,t),this._setOptions(this.options,!0),this.context.graph=this,this.options.autoResize&&(null===(e=globalThis.addEventListener)||void 0===e||e.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(t){this._setOptions(t,!1)}_setOptions(t,e){if(this.updateCanvas(t),e){let{data:e}=t;e&&this.addData(e);return}Object.assign(this.options,t);let{behaviors:r,combo:n,data:i,edge:a,layout:o,node:s,plugins:l,theme:u,transforms:h}=t;r&&this.setBehaviors(r),i&&this.setData(i),s&&this.setNode(s),a&&this.setEdge(a),n&&this.setCombo(n),o&&this.setLayout(o),u&&this.setTheme(u),l&&this.setPlugins(l),h&&this.setTransforms(h)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,e){t&&(this.options.width=t),e&&(this.options.height=e),this.resize(t,e)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=(0,sI.default)(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=(0,sI.default)(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var e;this.options.behaviors=(0,sI.default)(t)?t(this.getBehaviors()):t,null===(e=this.context.behavior)||void 0===e||e.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var e;this.options.plugins=(0,sI.default)(t)?t(this.getPlugins()):t,null===(e=this.context.plugin)||void 0===e||e.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var e;this.options.transforms=(0,sI.default)(t)?t(this.getTransforms()):t,null===(e=this.context.transform)||void 0===e||e.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map(t=>this.context.model.getElementDataById(t)):this.context.model.getElementDataById(t)}getNodeData(t){var e;return void 0===t?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):null===(e=this.context.model.getNodeData([t]))||void 0===e?void 0:e[0]}getEdgeData(t){var e;return void 0===t?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):null===(e=this.context.model.getEdgeData([t]))||void 0===e?void 0:e[0]}getComboData(t){var e;return void 0===t?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):null===(e=this.context.model.getComboData([t]))||void 0===e?void 0:e[0]}setData(t){this.context.model.setData((0,sI.default)(t)?t(this.getData()):t)}addData(t){this.context.model.addData((0,sI.default)(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData((0,sI.default)(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData((0,sI.default)(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData((0,sI.default)(t)?t(this.getComboData()):t)}addChildrenData(t,e){this.context.model.addChildrenData(t,e)}updateData(t){this.context.model.updateData((0,sI.default)(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData((0,sI.default)(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData((0,sI.default)(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData((0,sI.default)(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData((0,sI.default)(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData((0,sI.default)(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData((0,sI.default)(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData((0,sI.default)(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,e="both"){return this.context.model.getRelatedEdgesData(t,e)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,e){return this.context.model.getAncestorsData(t,e)}getParentData(t,e){return this.context.model.getParentData(t,e)}getChildrenData(t){return this.context.model.getChildrenData(t)}getDescendantsData(t){return this.context.model.getDescendantsData(t)}getElementDataByState(t,e){return this.context.model.getElementDataByState(t,e)}initCanvas(){return _P(this,void 0,void 0,function*(){var t;if(this.context.canvas)return yield this.context.canvas.ready;let{container:e="container",width:r,height:n,renderer:i,cursor:a,background:o,canvas:s,devicePixelRatio:l=null!==(t=globalThis.devicePixelRatio)&&void 0!==t?t:1}=this.options;if(e instanceof wz)this.context.canvas=e,a&&e.setCursor(a),i&&e.setRenderer(i),yield e.ready;else{let t=(0,ou.default)(e)?document.getElementById(e):e,u=wU(t);this.emit(yG.BEFORE_CANVAS_INIT,{container:t,width:r,height:n});let h=new wz(Object.assign(Object.assign({},s),{container:t,width:r||u[0],height:n||u[1],background:o,renderer:i,cursor:a,devicePixelRatio:l}));this.context.canvas=h,yield h.ready,this.emit(yG.AFTER_CANVAS_INIT,{canvas:h})}})}updateCanvas(t){var e,r;let{renderer:n,cursor:i,height:a,width:o}=t,s=this.context.canvas;s&&(n&&(this.emit(yG.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),s.setRenderer(n),this.emit(yG.AFTER_RENDERER_CHANGE,{renderer:n})),i&&s.setCursor(i),((0,ol.default)(o)||(0,ol.default)(a))&&this.setSize(null!==(e=null!=o?o:this.options.width)&&void 0!==e?e:0,null!==(r=null!=a?a:this.options.height)&&void 0!==r?r:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new w1(this.context)),this.context.plugin||(this.context.plugin=new _M(this.context)),this.context.viewport||(this.context.viewport=new _I(this.context)),this.context.transform||(this.context.transform=new _C(this.context)),this.context.element||(this.context.element=new _r(this.context)),this.context.animation||(this.context.animation=new w0(this.context)),this.context.layout||(this.context.layout=new _O(this.context)),this.context.behavior||(this.context.behavior=new w2(this.context))}prepare(){return _P(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed)throw Error(sb("The graph instance has been destroyed"));yield this.initCanvas(),this.initRuntime()})}render(){return _P(this,void 0,void 0,function*(){yield this.prepare(),wX(this,new wW(yG.BEFORE_RENDER));let t=this.context.element.draw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.context.layout.layout()]),yield this.autoFit(),this.rendered=!0,wX(this,new wW(yG.AFTER_RENDER))})}draw(){return _P(this,void 0,void 0,function*(){var t;yield this.prepare(),yield null===(t=this.context.element.draw())||void 0===t?void 0:t.finished})}layout(){return _P(this,void 0,void 0,function*(){yield this.context.layout.layout()})}stopLayout(){this.context.layout.stopLayout()}clear(){return _P(this,void 0,void 0,function*(){this.context.model.setData({}),yield this.draw()})}destroy(){var t;wX(this,new wW(yG.BEFORE_DESTROY));let{layout:e,animation:r,element:n,model:i,canvas:a,behavior:o,plugin:s}=this.context;null==s||s.destroy(),null==o||o.destroy(),null==e||e.destroy(),null==r||r.destroy(),null==n||n.destroy(),i.destroy(),null==a||a.destroy(),this.options={},this.context={},this.off(),null===(t=globalThis.removeEventListener)||void 0===t||t.call(globalThis,"resize",this.onResize),this.destroyed=!0,wX(this,new wW(yG.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,e){var r;let n=wU(null===(r=this.context.canvas)||void 0===r?void 0:r.getContainer()),i=[t||n[0],e||n[1]];this.context.canvas&&(sd(i,this.context.canvas.getSize())||(wX(this,new wW(yG.BEFORE_SIZE_CHANGE,{size:i})),this.context.canvas.resize(...i),wX(this,new wW(yG.AFTER_SIZE_CHANGE,{size:i}))))}fitView(t,e){return _P(this,void 0,void 0,function*(){var r;yield null===(r=this.context.viewport)||void 0===r?void 0:r.fitView(t,e)})}fitCenter(t){return _P(this,void 0,void 0,function*(){var e;yield null===(e=this.context.viewport)||void 0===e?void 0:e.fitCenter(t)})}autoFit(){return _P(this,void 0,void 0,function*(){let{autoFit:t}=this.context.options;if(t){if((0,ou.default)(t))"view"===t?yield this.fitView():"center"===t&&(yield this.fitCenter());else{let{type:e,animation:r}=t;"view"===e?yield this.fitView(t.options,r):"center"===e&&(yield this.fitCenter(r))}}})}focusElement(t,e){return _P(this,void 0,void 0,function*(){var r;yield null===(r=this.context.viewport)||void 0===r?void 0:r.focusElements(Array.isArray(t)?t:[t],e)})}zoomBy(t,e,r){return _P(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:r},e)})}zoomTo(t,e,r){return _P(this,void 0,void 0,function*(){this.context.viewport.transform({mode:"absolute",scale:t,origin:r},e)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,e,r){return _P(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:r},e)})}rotateTo(t,e,r){return _P(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:r},e)})}getRotation(){return this.context.viewport.getRotation()}translateBy(t,e){return _P(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:t},e)})}translateTo(t,e){return _P(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},e)})}getPosition(){return lj([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,e){return _P(this,arguments,void 0,function*(t,e,r=!0){var n;let[i,a]=(0,sc.default)(t)?[t,null==e||e]:[{[t]:e},r];Object.entries(i).forEach(([t,e])=>this.context.model.translateNodeLikeBy(t,e)),yield null===(n=this.context.element.draw({animation:a,stage:"translate"}))||void 0===n?void 0:n.finished})}translateElementTo(t,e){return _P(this,arguments,void 0,function*(t,e,r=!0){var n;let[i,a]=(0,sc.default)(t)?[t,null==e||e]:[{[t]:e},r];Object.entries(i).forEach(([t,e])=>this.context.model.translateNodeLikeTo(t,e)),yield null===(n=this.context.element.draw({animation:a,stage:"translate"}))||void 0===n?void 0:n.finished})}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return vF(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,e){return _P(this,arguments,void 0,function*(t,e,r=!0){var n;let[i,a]=(0,sc.default)(t)?[t,null==e||e]:[{[t]:e},r],o={nodes:[],edges:[],combos:[]};Object.entries(i).forEach(([t,e])=>{let r=this.getElementType(t);o[`${r}s`].push({id:t,style:{visibility:e}})});let{model:s,element:l}=this.context;s.preventUpdateNodeLikeHierarchy(()=>{s.updateData(o)}),yield null===(n=l.draw({animation:a,stage:"visibility"}))||void 0===n?void 0:n.finished})}showElement(t,e){return _P(this,void 0,void 0,function*(){let r=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(r.map(t=>[t,"visible"])),e)})}hideElement(t,e){return _P(this,void 0,void 0,function*(){let r=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(r.map(t=>[t,"hidden"])),e)})}getElementVisibility(t){var e,r;let n=this.context.element.getElement(t);return null!==(r=null===(e=null==n?void 0:n.style)||void 0===e?void 0:e.visibility)&&void 0!==r?r:"visible"}setElementZIndex(t,e){return _P(this,void 0,void 0,function*(){var r;let n={nodes:[],edges:[],combos:[]};Object.entries((0,sc.default)(t)?t:{[t]:e}).forEach(([t,e])=>{let r=this.getElementType(t);n[`${r}s`].push({id:t,style:{zIndex:e}})});let{model:i,element:a}=this.context;i.preventUpdateNodeLikeHierarchy(()=>i.updateData(n)),yield null===(r=a.draw({animation:!1,stage:"zIndex"}))||void 0===r?void 0:r.finished})}frontElement(t){return _P(this,void 0,void 0,function*(){let e=Array.isArray(t)?t:[t],{model:r}=this.context,n={};e.map(t=>{let e=r.getFrontZIndex(t);if("combo"===r.getElementType(t)){let i=r.getAncestorsData(t,sg).at(-1)||this.getComboData(t),a=[i,...r.getDescendantsData(lg(i))],o=e-wJ(i);a.forEach(t=>{n[lg(t)]=this.getElementZIndex(lg(t))+o});let{internal:s}=dF(a.map(lg),t=>r.getRelatedEdgesData(t));s.forEach(t=>{let e=lg(t);n[e]=this.getElementZIndex(e)+o})}else n[t]=e}),yield this.setElementZIndex(n)})}getElementZIndex(t){return wJ(this.context.model.getElementDataById(t))}setElementState(t,e){return _P(this,arguments,void 0,function*(t,e,r=!0){var n;let[i,a]=(0,sc.default)(t)?[t,null==e||e]:[{[t]:e},r],o=t=>t?Array.isArray(t)?t:[t]:[],s={nodes:[],edges:[],combos:[]};Object.entries(i).forEach(([t,e])=>{let r=this.getElementType(t);s[`${r}s`].push({id:t,states:o(e)})}),this.updateData(s),yield null===(n=this.context.element.draw({animation:a,stage:"state"}))||void 0===n?void 0:n.finished})}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t){return _P(this,arguments,void 0,function*(t,e=!0){let{model:r,element:n}=this.context;if(uc(r.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;let i=r.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!0),"node"===i?yield n.collapseNode(t,e):"combo"===i&&(yield n.collapseCombo(t,e)),this.isCollapsingExpanding=!1})}expandElement(t){return _P(this,arguments,void 0,function*(t,e=!0){let{model:r,element:n}=this.context;if(!uc(r.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;let i=r.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!1),"node"===i?yield n.expandNode(t,e):"combo"===i&&(yield n.expandCombo(t,e)),this.isCollapsingExpanding=!1})}setElementCollapsibility(t,e){let r=this.getElementType(t);"node"===r?this.updateNodeData([{id:t,style:{collapsed:e}}]):"combo"===r&&this.updateComboData([{id:t,style:{collapsed:e}}])}toDataURL(){return _P(this,arguments,void 0,function*(t={}){return this.context.canvas.toDataURL(t)})}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,e,r){return super.on(t,e,r)}once(t,e){return super.once(t,e)}off(t,e){return super.off(t,e)}}_D.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};class _L extends lM{beforeDraw(t,e){return t}afterLayout(){}}function _j(t,e,r,n,i){let a=lg(n),o=`${r}s`,s=i?n:t.add[o].get(a)||t.update[o].get(a)||t.remove[o].get(a)||n;Object.entries(t).forEach(([t,r])=>{e===t?r[o].set(a,s):r[o].delete(a)})}function _F(t,e){return Object.keys(t).every(r=>t[r]===e[r])}const _B=(t,e,r,n)=>{let i=`${r}s`,a=lg(n);t.add[i].has(a)||t.update[i].has(a)||t[e][i].set(lg(n),n)},_z=(t,e)=>{let{source:r,target:n}=e,i=t.getElementDataById(r),a=t.getElementDataById(n),o=dB(i,e=>t.getParentData(e,sg)),s=dB(a,e=>t.getParentData(e,sg)),l={sourceNode:lg(o),targetNode:lg(s)};return e.style?Object.assign(e.style,l):e.style=l,e},_V=(t,e,r)=>{let[n,i]=e,[a,o]=r;return i===n?a:a+(t-n)/(i-n)*(o-a)},_G=(t,e,r)=>{let[n,i]=e,[a,o]=r;return a+Math.log(t-n+1)/Math.log(i-n+1)*(o-a)},_$=(t,e,r,n=2)=>{let[i,a]=e,[o,s]=r;return o+Math.pow((t-i)/(a-i),n)*(s-o)},_U=(t,e,r)=>{let[n,i]=e,[a,o]=r;return a+Math.sqrt((t-n)/(i-n))*(o-a)};class _H extends _L{constructor(t,e){super(t,lP({},_H.defaultOptions,e)),this.assignSizeByCentrality=(t,e,r,n,i,a)=>{let o=[e,r],s=[n[0],i[0]],l=[n[1],i[1]],u=[n[2],i[2]],h=(t,e)=>{if("function"==typeof a)return a(t,o,e);switch(a){case"linear":return _V(t,o,e);case"log":return _G(t,o,e);case"pow":return _$(t,o,e,2);case"sqrt":return _U(t,o,e);default:return e[0]}};return[h(t,s),h(t,l),h(t,u)]}}beforeDraw(t){let{model:e}=this.context,r=e.getNodeData(),n=ux(this.options.maxSize),i=ux(this.options.minSize),a=this.getCentralities(this.options.centrality),o=a.size>0?Math.max(...a.values()):0,s=a.size>0?Math.min(...a.values()):0;return r.forEach(e=>{var r;let l=this.assignSizeByCentrality(a.get(lg(e))||0,s,o,i,n,this.options.scale),u=null===(r=this.context.element)||void 0===r?void 0:r.getElement(lg(e)),h={size:l};this.assignLabelStyle(h,l,e,u),u&&_F(h,u.attributes)||_j(t,u?"update":"add","node",lP(e,{style:h}),!0)}),t}assignLabelStyle(t,e,r,n){var i;if(Object.assign(t,dd(n?n.config.style:null===(i=this.context.element)||void 0===i?void 0:i.getElementComputedStyle("node",r),["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){let r=this.getLabelSizeByNodeSize(e,1/0,Number(t.labelFontSize));Object.assign(t,{labelFontSize:r,labelLineHeight:r+function(t=0){let e=sz(t);return e[0]+e[2]}(t.labelPadding)})}return t}getLabelSizeByNodeSize(t,e,r){let n=Math.min(...t)/2,[i,a]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[r,e];return Math.min(a,Math.max(n,i))}getCentralities(t){let{model:e}=this.context,r=e.getData();return"function"==typeof t?t(r):lv(r,e.getRelatedEdgesData.bind(e),t)}}_H.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};var on=y("2eDEB");class _W extends _L{constructor(t,e){super(t,Object.assign({},_W.defaultOptions,e))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var t;let e=lZ(this.ref),{graph:r,model:n}=this.context;null===(t=n.getData().nodes)||void 0===t||t.forEach(t=>{if(lg(t)===lg(this.ref))return;let i=lY(lj(lZ(t),e)),a=Math.abs(i)>Math.PI/2,o=!t.children||0===t.children.length,s=(o?1:-1)*(ux(r.getElementRenderStyle(lg(t)).size)[0]/2+this.options.offset),l=[["translate",s*Math.cos(i),s*Math.sin(i)],["rotate",a?(0,on.rad2deg)(i)+180:(0,on.rad2deg)(i)]];n.updateNodeData([{id:lg(t),style:{labelTextAlign:a===o?"right":"left",labelTextBaseline:"middle",labelTransform:l}}])}),r.draw()}}_W.defaultOptions={offset:5};var _q=y("2LrCM"),sI=y("ky7aH");const _Y=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class _K extends _L{constructor(t,e){super(t,Object.assign({},_K.defaultOptions,e)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=t=>{let{add:{edges:e},update:{nodes:r,edges:n,combos:i},remove:{edges:a}}=t,{model:o}=this.context,s=new Map,l=(t,e)=>{o.getRelatedEdgesData(e).forEach(t=>!s.has(lg(t))&&s.set(lg(t),t))};r.forEach(l),i.forEach(l);let u=t=>{_J(t,o.getEdgeData().map(t=>_z(o,t)),!0).forEach(t=>!s.has(lg(t))&&s.set(lg(t),t))};if(a.size&&a.forEach(u),e.size&&e.forEach(u),n.size){let t=mO(mN(o.getChanges())).update.edges;n.forEach(e=>{var r;u(e);let n=null===(r=t.find(t=>lg(t.value)===lg(e)))||void 0===r?void 0:r.original;n&&!_Z(e,n)&&u(n)})}uD(this.options.edges)||s.forEach((t,e)=>!this.options.edges.includes(e)&&s.delete(e));let h=o.getEdgeData().map(lg);return new Map([...s].sort((t,e)=>h.indexOf(t[0])-h.indexOf(e[0])))},this.applyBundlingStyle=(t,e,r)=>{let{edgeMap:n,reverses:i}=_X(e);n.forEach(e=>{e.forEach((e,n,a)=>{var o;let s=a.length,l=e.style||{};if(e.source===e.target){let t=_Y.length;l.loopPlacement=_Y[n%t],l.loopDist=Math.floor(n/t)*r+50}else if(1===s)l.curveOffset=0;else{let t=(n%2==0?1:-1)*(i[`${e.source}|${e.target}|${n}`]?-1:1);l.curveOffset=s%2==1?t*Math.ceil(n/2)*r*2:t*(Math.floor(n/2)*r*2+r)}let u=Object.assign(e,{type:"quadratic",style:l}),h=null===(o=this.context.element)||void 0===o?void 0:o.getElement(lg(e));h&&_F(u.style,h.attributes)||_j(t,h?"update":"add","edge",u,!0)})})},this.resetEdgeStyle=t=>{let e=t.style||{},r=this.cacheMergeStyle.get(lg(t))||{};return Object.keys(r).forEach(n=>{sd(e[n],r[n])&&(t[n]?e[n]=t[n]:delete e[n])}),Object.assign(t,{style:e})},this.applyMergingStyle=(t,e)=>{let{edgeMap:r,reverses:n}=_X(e);r.forEach(e=>{var r;if(1===e.length){let n=e[0],i=null===(r=this.context.element)||void 0===r?void 0:r.getElement(lg(n)),a=this.resetEdgeStyle(n);i&&_F(a,i.attributes)||_j(t,i?"update":"add","edge",a);return}let i=e.map(({source:t,target:e,style:r={}},i)=>{let{startArrow:a,endArrow:o}=r,s={},[l,u]=n[`${t}|${e}|${i}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return(0,_q.default)(a)&&(s[l]=a),(0,_q.default)(o)&&(s[u]=o),s}).reduce((t,e)=>Object.assign(Object.assign({},t),e),{});e.forEach((e,r,n)=>{var a;if(0!==r){_j(t,"remove","edge",e);return}let o=Object.assign({},(0,sI.default)(this.options.style)?this.options.style(n):this.options.style,{childrenData:n});this.cacheMergeStyle.set(lg(e),o);let s=Object.assign(Object.assign({},e),{type:"line",style:Object.assign(Object.assign(Object.assign({},e.style),i),o)}),l=null===(a=this.context.element)||void 0===a?void 0:a.getElement(lg(e));l&&_F(s.style,l.attributes)||_j(t,l?"update":"add","edge",s,!0)})})}}beforeDraw(t){let e=this.getAffectedParallelEdges(t);return 0===e.size||("bundle"===this.options.mode?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}}_K.defaultOptions={mode:"bundle",distance:15};const _X=t=>{let e=new Map,r=new Set,n={};for(let[i,a]of t){if(r.has(i))continue;let{source:o,target:s}=a,l=`${o}-${s}`;for(let[u,h]of(e.has(l)||e.set(l,[]),e.get(l).push(a),r.add(i),t))!r.has(u)&&_Z(a,h)&&(e.get(l).push(h),r.add(u),o===h.target&&s===h.source&&(n[`${h.source}|${h.target}|${e.get(l).length-1}`]=!0))}return{edgeMap:e,reverses:n}},_J=(t,e,r)=>e.filter(e=>(r||lg(e)!==lg(t))&&_Z(e,t)),_Z=(t,e)=>{let{sourceNode:r,targetNode:n}=t.style||{},{sourceNode:i,targetNode:a}=e.style||{};return r===i&&n===a||r===a&&n===i};class _Q extends cP{constructor(){super(...arguments),this.id="fishbone"}getRoot(){let t=this.context.model.getRootsData();if(!uD(t)&&!(t.length>2))return t[0]}formatSize(t){let e="function"==typeof t?t:()=>t;return t=>ux(e(t))}doLayout(t,e){let{hGap:r,getRibSep:n,vGap:i,nodeSize:a,height:o}=e,{model:s}=this.context,l=this.formatSize(a),u=l(t)[0]+n(t),h=(t,e=0)=>{var n;return e+=r*((t.children||[]).length+1),null===(n=t.children)||void 0===n||n.forEach(t=>{var r;null===(r=s.getNodeLikeDatum(t).children)||void 0===r||r.forEach(t=>{e=h(s.getNodeLikeDatum(t),e)})}),e},d=t=>{if(1===t.depth)return u;let e=s.getParentData(t.id,"tree");if(_2(t)){let n=s.getParentData(e.id,"tree"),a=p(t)-p(n);return d(e)+a*r/i}{let r=(e.children||[]).indexOf(t.id),n=s.getNodeData((e.children||[]).slice(r));return c(e)-n.reduce((t,e)=>t+h(e),0)-l(e)[0]/2}},c=vL(t=>{if(_1(t))return l(t)[0]/2;let e=s.getParentData(t.id,"tree");if(_2(t))return d(t)+h(t)+l(t)[0]/2;{let n=p(t)-p(e);return d(t)+r/i*n}},t=>t.id),f=t=>p(s.getParentData(t,"tree")),p=vL(t=>{if(_1(t))return o/2;if(_2(t)){let e=s.getParentData(t.id,"tree"),r=e.children.indexOf(t.id);if(0===r)return f(e.id)+i;let n=s.getNodeLikeDatum(e.children[r-1]);return uD(n.children)?p(n)+i:Math.max(...s.getDescendantsData(n.id).map(t=>_2(t)?f(t.id):p(t)))+i}{if(uD(t.children))return f(t.id)+i;let e=s.getNodeLikeDatum(t.children.slice(-1)[0]);if(uD(e.children))return p(e)+i;let r=s.getDescendantsData(t.id).slice(-1)[0];return(_2(r)?f(r.id):p(r))+i}},t=>t.id),g=0,y={nodes:[],edges:[]},v=t=>{var e;null===(e=t.children)||void 0===e||e.forEach(t=>v(s.getNodeLikeDatum(t)));let r=p(t),i=c(t);if(y.nodes.push({id:t.id,x:i,y:r}),_1(t))return;let a=s.getRelatedEdgesData(t.id,"in")[0],o=[d(t),_2(t)?r:f(t.id)];y.edges.push({id:lg(a),controlPoints:[o],relatedNodeId:t.id}),g=Math.max(g,i+n(t)),1===t.depth&&(u=g)};return v(t),y}placeAlterative(t,e){let r=(e.children||[]).filter((t,e)=>e%2!=0);if(0===r.length)return t;let{model:n}=this.context,i=t.nodes.find(t=>t.id===e.id).y,a=t=>{let e=n.getAncestorsData(t,"tree");if(uD(e))return!1;let i=1===e.length?t:e[e.length-2].id;return r.includes(i)};t.nodes.forEach(t=>{a(t.id)&&(t.y=2*i-t.y)}),t.edges.forEach(t=>{a(t.relatedNodeId)&&(t.controlPoints=t.controlPoints.map(t=>[t[0],2*i-t[1]]))})}rightToLeft(t,e){return t.nodes.forEach(t=>t.x=e.width-t.x),t.edges.forEach(t=>{t.controlPoints=t.controlPoints.map(t=>[e.width-t[0],t[1]])}),t}execute(t,e){var r,n,i,a;return r=this,n=void 0,i=void 0,a=function*(){let r=Object.assign(Object.assign(Object.assign({},_Q.defaultOptions),this.options),e),{direction:n,nodeSize:i}=r,a=this.getRoot();if(!a)return t;let o=this.formatSize(i);r.vGap||(r.vGap=Math.max(...(t.nodes||[]).map(t=>o(t)[1]))),r.hGap||(r.hGap=Math.max(...(t.nodes||[]).map(t=>o(t)[0])));let s=this.doLayout(a,r);this.placeAlterative(s,a),"RL"===n&&(s=this.rightToLeft(s,r));let{model:l}=this.context,u=[],h=[];return s.nodes.forEach(t=>{let{id:e,x:r,y:n}=t,i=l.getNodeLikeDatum(e);u.push(_0(i,{x:r,y:n}))}),s.edges.forEach(t=>{let{id:e,controlPoints:r}=t,n=l.getEdgeDatum(e);h.push(_0(n,{controlPoints:r}))}),{nodes:u,edges:h}},new(i||(i=Promise))(function(t,e){function o(t){try{l(a.next(t))}catch(t){e(t)}}function s(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var r;e.done?t(e.value):((r=e.value)instanceof i?r:new i(function(t){t(r)})).then(o,s)}l((a=a.apply(r,n||[])).next())})}}_Q.defaultOptions={direction:"RL",getRibSep:()=>60};const _0=(t,e)=>Object.assign(Object.assign({},t),{style:Object.assign(Object.assign({},t.style||{}),e)}),_1=t=>0===t.depth,_2=t=>(t.depth||(t.depth=0))%2==0,_3=["#7E92B5","#F4664A","#FFBE3A"],_6={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},_5={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function _4(t){let{bgColor:e,textColor:r,nodeColor:n,nodeColorDisabled:i,nodeStroke:a,nodeHaloStrokeOpacityActive:o=.15,nodeHaloStrokeOpacitySelected:s=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:u=.85,nodeOpacityInactive:h=.25,nodeBadgePalette:d=_3,nodePaletteOptions:c=_6,edgeColor:f,edgeColorDisabled:p,edgePaletteOptions:g=_5,comboColor:y,comboColorDisabled:v,comboStroke:m,comboStrokeDisabled:b,edgeColorInactive:x}=t;return{background:e,node:{palette:c,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:d,fill:n,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:r,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:n,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:s,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:o},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:h,donutOpacity:h,fillOpacity:h,iconOpacity:u,labelFill:r,labelFillOpacity:h,strokeOpacity:h},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:i,fillOpacity:l,iconFill:i,iconOpacity:.25,labelFill:r,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:g,style:{badgeBackgroundFill:f,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:r,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:f,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:x,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:p,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:y,halo:!1,haloLineWidth:12,haloStroke:m,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:r,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:m},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:v,fillOpacity:.25,labelOpacity:.25,stroke:b,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const _8=_4({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),_9=_4({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"}),_7={animation:{"combo-collapse":sC,"combo-expand":sC,"node-collapse":sM,"node-expand":sM,"path-in":sA,"path-out":sA,fade:[{fields:["opacity"]}],translate:[{fields:["x","y"]}]},behavior:{"brush-select":un,"click-select":ud,"collapse-expand":cm,"create-edge":cw,"drag-canvas":ck,"drag-element-force":class extends cO{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(t=>["d3-force","d3-force-3d"].includes(null==t?void 0:t.id))}validate(t){return!!this.context.layout&&(this.forceLayoutInstance?super.validate(t):(sx.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1))}moveElement(t,e){var r,n,i,a;return r=this,n=void 0,i=void 0,a=function*(){let r=this.forceLayoutInstance;this.context.graph.getNodeData(t).forEach((n,i)=>{let{x:a=0,y:o=0}=n.style||{};r&&cj(r,"setFixedPosition",t[i],[...lL([+a,+o],e)])})},new(i||(i=Promise))(function(t,e){function o(t){try{l(a.next(t))}catch(t){e(t)}}function s(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var r;e.done?t(e.value):((r=e.value)instanceof i?r:new i(function(t){t(r)})).then(o,s)}l((a=a.apply(r,n||[])).next())})}onDragStart(t){if(this.enable=this.validate(t),!this.enable)return;this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);let e=this.forceLayoutInstance;e&&cF(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(t=>{let{x:r=0,y:n=0}=t.style||{};e&&cj(e,"setFixedPosition",lg(t),[+r,+n])})}onDrag(t){if(!this.enable)return;let e=this.getDelta(t);this.moveElement(this.target,e)}onDragEnd(){let t=this.forceLayoutInstance;t&&cF(t,"simulation").alphaTarget(0),this.context.graph.getNodeData(this.target).forEach(e=>{t&&cj(t,"setFixedPosition",lg(e),[null,null,null])})}},"drag-element":cO,"fix-element-size":cz,"focus-element":cV,"hover-activate":cG,"lasso-select":class extends un{onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;let{canvas:e}=this.context;this.pathShape=new on.Path({id:"g6-lasso-select",style:this.options.style}),e.appendChild(this.pathShape),this.points=[ui(t)]}onPointerMove(t){var e;if(!this.points)return;let{immediately:r,mode:n}=this.options;this.points.push(ui(t)),null===(e=this.pathShape)||void 0===e||e.setAttribute("d",function(t,e=!0){let r=[];return t.forEach((t,e)=>{r.push([0===e?"M":"L",...t])}),e&&r.push(["Z"]),r}(this.points)),r&&"default"===n&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var t;null===(t=this.pathShape)||void 0===t||t.remove(),this.pathShape=void 0,this.points=void 0}},"auto-adapt-label":lC,"optimize-viewport-transform":c$,"scroll-canvas":cH,"zoom-canvas":cq},combo:{circle:class extends dm{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",on.Circle,this.getKeyStyle(t),e)}getKeyStyle(t){let{collapsed:e}=t,r=super.getKeyStyle(t),[n]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},r),e&&uv(r,"collapsed")),{r:n/2})}getCollapsedKeySize(t){let[e,r]=ux(t.collapsedSize),n=Math.max(e,r)/2;return[2*n,2*n,0]}getExpandedKeySize(t){let[e,r]=s$(this.getContentBBox(t)),n=Math.sqrt(Math.pow(e,2)+Math.pow(r,2))/2;return[2*n,2*n,0]}getIntersectPoint(t,e=!1){return l8(t,this.getShape("key").getBounds(),e)}},rect:class extends dm{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",on.Rect,this.getKeyStyle(t),e)}getKeyStyle(t){let e=super.getKeyStyle(t),[r,n]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},e),t.collapsed&&uv(e,"collapsed")),{width:r,height:n,x:-r/2,y:-n/2})}}},edge:{cubic:dX,line:d0,polyline:ce,quadratic:cr,"cubic-horizontal":dJ,"cubic-radial":dZ,"cubic-vertical":dQ},layout:{"antv-dagre":class{constructor(t={}){this.options=t,this.id="antv-dagre",this.options=Object.assign(Object.assign({},p9),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,t,e)})}genericDagreLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let n;let{nodeSize:i,align:a,rankdir:o="TB",ranksep:s,nodesep:l,ranksepFunc:u,nodesepFunc:h,edgeLabelSpace:d,ranker:c,nodeOrder:f,begin:p,controlPoints:g,radial:y,sortByCombo:v,preset:m}=Object.assign(Object.assign({},this.options),r),b=new cI({tree:[]}),x=p5(s||50,u),E=p5(l||50,h),w=E,_=x;("LR"===o||"RL"===o)&&(w=x,_=E);let S=p4(10,i,!1),k=e.getAllNodes(),N=e.getAllEdges();k.forEach(t=>{let e=p6(S(t)),r=_(t),n=w(t),i=e[0]+2*n,a=e[1]+2*r,o=t.data.layer;(0,ol.default)(o)?b.addNode({id:t.id,data:{width:i,height:a,layer:o}}):b.addNode({id:t.id,data:{width:i,height:a}})}),v&&(b.attachTreeStructure("combo"),k.forEach(t=>{let{parentId:e}=t.data;void 0!==e&&b.hasNode(e)&&b.setParent(t.id,e,"combo")})),N.forEach(t=>{b.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})}),(null==m?void 0:m.length)&&(n=new cI({nodes:m})),pR(b,{prevGraph:n,edgeLabelSpace:d,keepNodeOrder:!!f,nodeOrder:f||[],acyclicer:"greedy",ranker:c,rankdir:o,nodesep:l,align:a});let O=[0,0];if(p){let t=1/0,e=1/0;b.getAllNodes().forEach(r=>{t>r.data.x&&(t=r.data.x),e>r.data.y&&(e=r.data.y)}),b.getAllEdges().forEach(r=>{var n;null===(n=r.data.points)||void 0===n||n.forEach(r=>{t>r.x&&(t=r.x),e>r.y&&(e=r.y)})}),O[0]=p[0]-t,O[1]=p[1]-e}let T="LR"===o||"RL"===o;if(y);else{let t=new Set,e="BT"===o||"RL"===o;b.getAllNodes().forEach(e=>{e.data.x=e.data.x+O[0],e.data.y=e.data.y+O[1],t.add(T?e.data.x:e.data.y)});let r=Array.from(t).sort(e?(t,e)=>e-t:(t,e)=>t-e),n=T?(t,e)=>t.x!==e.x:(t,e)=>t.y!==e.y,i=T?(t,e,r)=>{let n=Math.max(e.y,r.y),i=Math.min(e.y,r.y);return t.filter(t=>t.y<=n&&t.y>=i)}:(t,e,r)=>{let n=Math.max(e.x,r.x),i=Math.min(e.x,r.x);return t.filter(t=>t.x<=n&&t.x>=i)};b.getAllEdges().forEach((t,e)=>{var a;d&&g&&"loop"!==t.data.type&&(t.data.controlPoints=p7(null===(a=t.data.points)||void 0===a?void 0:a.map(({x:t,y:e})=>({x:t+O[0],y:e+O[1]})),b.getNode(t.source),b.getNode(t.target),r,T,n,i))})}let M=[];M=b.getAllNodes().map(t=>p3(t));let A=b.getAllEdges();return t&&(M.forEach(t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}),A.forEach(t=>{e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})})),{nodes:M,edges:A}})}},"combo-combined":class{constructor(t={}){this.options=t,this.id="comboCombined",this.options=Object.assign(Object.assign({},yr),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericComboCombinedLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericComboCombinedLayout(!0,t,e)})}genericComboCombinedLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let n;let i=this.initVals(Object.assign(Object.assign({},this.options),r)),{center:a,treeKey:o,outerLayout:s}=i,l=e.getAllNodes().filter(t=>!t.data._isCombo),u=e.getAllNodes().filter(t=>t.data._isCombo),h=e.getAllEdges(),d=null==l?void 0:l.length;if(!d||1===d)return gt(e,t,a);let c=[],f=new Map;l.forEach(t=>{f.set(t.id,t)});let p=new Map;u.forEach(t=>{p.set(t.id,t)});let g=new Map,y=this.getInnerGraphs(e,o,f,p,h,i,g);yield Promise.all(y);let v=new Map,m=[],b=new Map,x=!0;e.getRoots(o).forEach(t=>{let r=g.get(t.id),n=p.get(t.id)||f.get(t.id),i={id:t.id,data:Object.assign(Object.assign({},t.data),{x:r.data.x||n.data.x,y:r.data.y||n.data.y,fx:r.data.fx||n.data.fx,fy:r.data.fy||n.data.fy,mass:r.data.mass||n.data.mass,size:r.data.size})};m.push(i),v.set(t.id,!0),isNaN(i.data.x)||0===i.data.x||isNaN(i.data.y)||0===i.data.y?(i.data.x=100*Math.random(),i.data.y=100*Math.random()):x=!1,g5(e,[t],e=>{e.id!==t.id&&b.set(e.id,t.id)},"TB",o)});let E=[];if(h.forEach(t=>{let e=b.get(t.source)||t.source,r=b.get(t.target)||t.target;e!==r&&v.has(e)&&v.has(r)&&E.push({id:t.id,source:e,target:r,data:{}})}),null==m?void 0:m.length){if(1===m.length)m[0].data.x=a[0],m[0].data.y=a[1];else{let t=new cI({nodes:m,edges:E}),e=s||new gO;if(x&&ye[e.id]){let e=m.length<100?new g8:new go;yield e.assign(t)}let r=Object.assign({center:a,kg:5,preventOverlap:!0,animate:!1},"force"===e.id?{gravity:1,factor:4,linkDistance:(t,e,r)=>(Math.max(...e.data.size)||32)/2+(Math.max(...r.data.size)||32)/2+200}:{});n=yield yn(e,t,r)}g.forEach(t=>{var e;let r=n.nodes.find(e=>e.id===t.id);if(r){let{x:e,y:n}=r.data;t.data.visited=!0,t.data.x=e,t.data.y=n,c.push({id:t.id,data:{x:e,y:n}})}let{x:i,y:a}=t.data;null===(e=t.data.nodes)||void 0===e||e.forEach(t=>{c.push({id:t.id,data:{x:t.data.x+i,y:t.data.y+a}})})}),g.forEach(({data:t})=>{let{x:e,y:r,visited:n,nodes:i}=t;null==i||i.forEach(t=>{if(!n){let n=c.find(e=>e.id===t.id);n.data.x+=e||0,n.data.y+=r||0}})})}return t&&c.forEach(t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}),{nodes:c,edges:h}})}initVals(t){let e,r,n;let i=Object.assign({},t),{nodeSize:a,spacing:o,comboPadding:s}=t;if(r=(0,ol.default)(o)?()=>o:(0,sI.default)(o)?o:()=>0,i.spacing=r,a){if((0,sI.default)(a))e=t=>{let e=a(t),n=r(t);return gi(t.size)?((t.size[0]>t.size[1]?t.size[0]:t.size[1])+n)/2:((e||32)+n)/2};else if(gi(a)){let t=(a[0]>a[1]?a[0]:a[1])/2;e=e=>t+r(e)/2}else{let t=a/2;e=e=>t+r(e)/2}}else e=t=>{let e=r(t);return t.size?gi(t.size)?((t.size[0]>t.size[1]?t.size[0]:t.size[1])+e)/2:(0,sc.default)(t.size)?((t.size.width>t.size.height?t.size.width:t.size.height)+e)/2:(t.size+e)/2:32+e/2};return i.nodeSize=e,n=(0,ol.default)(s)?()=>s:gi(s)?()=>Math.max.apply(null,s):(0,sI.default)(s)?s:()=>0,i.comboPadding=n,i}getInnerGraphs(t,e,r,n,i,a,o){let{nodeSize:s,comboPadding:l,spacing:u,innerLayout:h}=a,d=h||new go({}),c={center:[0,0],preventOverlap:!0,nodeSpacing:u},f=[],p=t=>{let e=(null==l?void 0:l(t))||10;return gi(e)&&(e=Math.max(...e)),{size:e?[2*e,2*e]:[30,30],padding:e}};return t.getRoots(e).forEach(a=>{o.set(a.id,{id:a.id,data:{nodes:[],size:p(a).size}});let l=Promise.resolve();g5(t,[a],a=>{var u;if(!a.data._isCombo)return;let{size:h,padding:f}=p(a);if(null===(u=t.getChildren(a.id,e))||void 0===u?void 0:u.length){let u=o.get(a.id);o.set(a.id,{id:a.id,data:Object.assign({nodes:[]},null==u?void 0:u.data)});let h=new Map,p=t.getChildren(a.id,e).map(t=>{if(t.data._isCombo)return o.has(t.id)||o.set(t.id,{id:t.id,data:Object.assign({},t.data)}),h.set(t.id,!0),o.get(t.id);let e=r.get(t.id)||n.get(t.id);return h.set(t.id,!0),{id:t.id,data:Object.assign(Object.assign({},e.data),t.data)}}),g={nodes:p,edges:i.filter(t=>h.has(t.source)&&h.has(t.target))},y=1/0;p.forEach(t=>{var e;let{size:r}=t.data;r||(r=(null===(e=o.get(t.id))||void 0===e?void 0:e.data.size)||(null==s?void 0:s(t))||[30,30]),(0,ol.default)(r)&&(r=[r,r]);let[n,i]=r;y>n&&(y=n),y>i&&(y=i),t.data.size=r}),l=l.then(()=>(0,s6.__awaiter)(this,void 0,void 0,function*(){let t=new cI(g);yield yn(d,t,c,!0);let{minX:e,minY:r,maxX:n,maxY:i}=g3(p),s={x:(n+e)/2,y:(i+r)/2};g.nodes.forEach(t=>{t.data.x-=s.x,t.data.y-=s.y});let l=[Math.max(n-e,y)+2*f,Math.max(i-r,y)+2*f];o.get(a.id).data.size=l,o.get(a.id).data.nodes=p}))}else o.set(a.id,{id:a.id,data:Object.assign(Object.assign({},a.data),{size:h})});return!0},"BT",e),f.push(l)}),f}},"compact-box":cY.compactBox,"d3-force":class{constructor(t){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:yc,manyBody:vi,center:yi,collide:yu,radial:va,x:vo,y:vs},this.options={link:{id:t=>t.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},lP(this.options,t),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericLayout(!0,t,e)})}stop(){this.simulation.stop()}tick(t){return this.simulation.tick(t),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(t,e){let r=this.context.nodes.find(e=>e.id===t);r&&e.forEach((t,e)=>{("number"==typeof t||null===t)&&(r[["fx","fy","fz"][e]]=t)})}getOptions(t){var e,r;let n=lP({},this.options,t);return n.collide&&(null===(e=n.collide)||void 0===e?void 0:e.radius)===void 0&&(n.collide=n.collide||{},n.collide.radius=null!==(r=n.nodeSize)&&void 0!==r?r:10),void 0===n.iterations&&(n.link&&void 0===n.link.iterations&&(n.iterations=n.link.iterations),n.collide&&void 0===n.collide.iterations&&(n.iterations=n.collide.iterations)),this.context.options=n,n}genericLayout(t,e,r){var n;return(0,s6.__awaiter)(this,void 0,void 0,function*(){let i=this.getOptions(r),a=e.getAllNodes().map(({id:t,data:e})=>Object.assign(Object.assign({id:t},e),dd(e.data,this.config.inputNodeAttrs))),o=e.getAllEdges().map(t=>Object.assign({},t));Object.assign(this.context,{assign:t,nodes:a,edges:o,graph:e});let s=new Promise(t=>{this.resolver=t}),l=this.setSimulation(i);return l.nodes(a),null===(n=l.force("link"))||void 0===n||n.links(o),s})}getResult(){let{assign:t,nodes:e,edges:r,graph:n}=this.context,i=e.map(t=>({id:t.id,data:Object.assign(Object.assign({},t.data),dd(t,this.config.outputNodeAttrs))})),a=r.map(({id:t,source:e,target:r,data:n})=>({id:t,source:"object"==typeof e?e.id:e,target:"object"==typeof r?r.id:r,data:n}));return t&&i.forEach(t=>n.mergeNodeData(t.id,t.data)),{nodes:i,edges:a}}initSimulation(){return function(t){let e;var r,n=1,i=.001,a=1-Math.pow(.001,1/300),o=0,s=.6,l=new Map,u=y8(c),h=yp("tick","end"),d=(e=1,()=>(e=(1664525*e+0x3c6ef35f)%0x100000000)/0x100000000);function c(){f(),h.call("tick",r),n<i&&(u.stop(),h.call("end",r))}function f(e){var i,u,h=t.length;void 0===e&&(e=1);for(var d=0;d<e;++d)for(n+=(o-n)*a,l.forEach(function(t){t(n)}),i=0;i<h;++i)null==(u=t[i]).fx?u.x+=u.vx*=s:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=s:(u.y=u.fy,u.vy=0);return r}function p(){for(var e,r=0,n=t.length;r<n;++r){if((e=t[r]).index=r,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+r),a=r*vn;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function g(e){return e.initialize&&e.initialize(t,d),e}return null==t&&(t=[]),p(),r={tick:f,restart:function(){return u.restart(c),r},stop:function(){return u.stop(),r},nodes:function(e){return arguments.length?(t=e,p(),l.forEach(g),r):t},alpha:function(t){return arguments.length?(n=+t,r):n},alphaMin:function(t){return arguments.length?(i=+t,r):i},alphaDecay:function(t){return arguments.length?(a=+t,r):+a},alphaTarget:function(t){return arguments.length?(o=+t,r):o},velocityDecay:function(t){return arguments.length?(s=1-t,r):1-s},randomSource:function(t){return arguments.length?(d=t,l.forEach(g),r):d},force:function(t,e){return arguments.length>1?(null==e?l.delete(t):l.set(t,g(e)),r):l.get(t)},find:function(e,r,n){var i,a,o,s,l,u=0,h=t.length;for(null==n?n=1/0:n*=n,u=0;u<h;++u)(o=(i=e-(s=t[u]).x)*i+(a=r-s.y)*a)<n&&(l=s,n=o);return l},on:function(t,e){return arguments.length>1?(h.on(t,e),r):h.on(t)}}}()}setSimulation(t){let e=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=e.on("tick",()=>{var e;return null===(e=t.onTick)||void 0===e?void 0:e.call(t,this.getResult())}).on("end",()=>{var t;return null===(t=this.resolver)||void 0===t?void 0:t.call(this,this.getResult())})),vl(e,this.config.simulationAttrs.map(e=>[e,t[e]])),Object.entries(this.forceMap).forEach(([r,n])=>{if(t[r]){let i=e.force(r);i||(i=n(),e.force(r,i)),vl(i,Object.entries(t[r]))}else e.force(r,null)}),e}},"force-atlas2":class{constructor(t={}){this.options=t,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},vp),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericForceAtlas2Layout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericForceAtlas2Layout(!0,t,e)})}genericForceAtlas2Layout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let n=e.getAllEdges(),i=e.getAllNodes(),a=this.formatOptions(r,i.length),{width:o,height:s,prune:l,maxIteration:u,nodeSize:h,center:d}=a;if(!(null==i?void 0:i.length)||1===i.length)return gt(e,t,d);let c=i.map(t=>p3(t,[o,s])),f=n.filter(t=>{let{source:e,target:r}=t;return e!==r}),p=new cI({nodes:c,edges:f}),g=this.getSizes(p,h);if(this.run(p,e,u,g,t,a),l){for(let t=0;t<f.length;t+=1){let{source:e,target:r}=f[t],n=p.getDegree(e),i=p.getDegree(e);if(n<=1){let t=p.getNode(r);p.mergeNodeData(e,{x:t.data.x,y:t.data.y})}else if(i<=1){let t=p.getNode(e);p.mergeNodeData(r,{x:t.data.x,y:t.data.y})}}let r=Object.assign(Object.assign({},a),{prune:!1,barnesHut:!1});this.run(p,e,100,g,t,r)}return{nodes:c,edges:n}})}getSizes(t,e){let r=t.getAllNodes(),n={};for(let t=0;t<r.length;t+=1){let i=r[t];n[i.id]=p8(e,void 0)(i)}return n}formatOptions(t={},e){let r=Object.assign(Object.assign({},this.options),t),{center:n,width:i,height:a,barnesHut:o,prune:s,maxIteration:l,kr:u,kg:h}=r;return r.width=i||"undefined"==typeof window?i:window.innerWidth,r.height=a||"undefined"==typeof window?a:window.innerHeight,r.center=n||[r.width/2,r.height/2],void 0===o&&e>250&&(r.barnesHut=!0),void 0===s&&e>100&&(r.prune=!0),0!==l||s?0===l&&s&&(r.maxIteration=100,e<=200&&e>100?r.maxIteration=500:e>200&&(r.maxIteration=950)):(r.maxIteration=250,e<=200&&e>100?r.maxIteration=1e3:e>200&&(r.maxIteration=1200)),!u&&(r.kr=50,e>100&&e<=500?r.kr=20:e>500&&(r.kr=1)),!h&&(r.kg=20,e>100&&e<=500?r.kg=10:e>500&&(r.kg=1)),r}run(t,e,r,n,i,a){let{kr:o,barnesHut:s,onTick:l}=a,u=t.getAllNodes(),h=0,d=r,c={},f={},p={};for(let e=0;e<u.length;e+=1){let{data:r,id:n}=u[e];if(c[n]=[0,0],s){let i={id:e,rx:r.x,ry:r.y,mass:1,g:o,degree:t.getDegree(n)};p[n]=new vd(i)}}for(;d>0;)h=this.oneStep(t,{iter:d,preventOverlapIters:50,krPrime:100,sg:h,forces:c,preForces:f,bodies:p,sizes:n},a),d--,null==l||l({nodes:u,edges:e.getAllEdges()});return t}oneStep(t,e,r){let{iter:n,preventOverlapIters:i,krPrime:a,sg:o,preForces:s,bodies:l,sizes:u}=e,{forces:h}=e,{preventOverlap:d,barnesHut:c}=r,f=t.getAllNodes();for(let t=0;t<f.length;t+=1){let{id:e}=f[t];s[e]=[...h[e]],h[e]=[0,0]}return h=this.getAttrForces(t,n,i,u,h,r),h=c&&(d&&n>i||!d)?this.getOptRepGraForces(t,h,l,r):this.getRepGraForces(t,n,i,h,a,u,r),this.updatePos(t,h,s,o,r)}getAttrForces(t,e,r,n,i,a){let{preventOverlap:o,dissuadeHubs:s,mode:l,prune:u}=a,h=t.getAllEdges();for(let a=0;a<h.length;a+=1){let{source:d,target:c}=h[a],f=t.getNode(d),p=t.getNode(c),g=t.getDegree(d),y=t.getDegree(c);if(u&&(g<=1||y<=1))continue;let v=[p.data.x-f.data.x,p.data.y-f.data.y],m=Math.hypot(v[0],v[1]);m=m<1e-4?1e-4:m,v[0]=v[0]/m,v[1]=v[1]/m,o&&e<r&&(m=m-n[d]-n[c]);let b=m,x=b;"linlog"===l&&(x=b=Math.log(1+m)),s&&(b=m/g,x=m/y),o&&e<r&&m<=0?(b=0,x=0):o&&e<r&&m>0&&(b=m,x=m),i[d][0]+=b*v[0],i[c][0]-=x*v[0],i[d][1]+=b*v[1],i[c][1]-=x*v[1]}return i}getOptRepGraForces(t,e,r,n){let{kg:i,center:a,prune:o}=n,s=t.getAllNodes(),l=s.length,u=9e10,h=-9e10,d=9e10,c=-9e10;for(let e=0;e<l;e+=1){let{id:n,data:i}=s[e];!(o&&1>=t.getDegree(n))&&(r[n].setPos(i.x,i.y),i.x>=h&&(h=i.x),i.x<=u&&(u=i.x),i.y>=c&&(c=i.y),i.y<=d&&(d=i.y))}let f=Math.max(h-u,c-d),p=new vc({xmid:(h+u)/2,ymid:(c+d)/2,length:f,massCenter:a,mass:l}),g=new vf(p);for(let e=0;e<l;e+=1){let{id:n}=s[e];!(o&&1>=t.getDegree(n))&&r[n].in(p)&&g.insert(r[n])}for(let n=0;n<l;n+=1){let{id:l,data:u}=s[n],h=t.getDegree(l);if(o&&h<=1)continue;r[l].resetForce(),g.updateForce(r[l]),e[l][0]-=r[l].fx,e[l][1]-=r[l].fy;let d=[u.x-a[0],u.y-a[1]],c=Math.hypot(d[0],d[1]);c=c<1e-4?1e-4:c,d[0]=d[0]/c,d[1]=d[1]/c;let f=i*(h+1);e[l][0]-=f*d[0],e[l][1]-=f*d[1]}return e}getRepGraForces(t,e,r,n,i,a,o){let{preventOverlap:s,kr:l,kg:u,center:h,prune:d}=o,c=t.getAllNodes(),f=c.length;for(let o=0;o<f;o+=1){let p=c[o],g=t.getDegree(p.id);for(let u=o+1;u<f;u+=1){let o=c[u],h=t.getDegree(o.id);if(d&&(g<=1||h<=1))continue;let f=[o.data.x-p.data.x,o.data.y-p.data.y],y=Math.hypot(f[0],f[1]);y=y<1e-4?1e-4:y,f[0]=f[0]/y,f[1]=f[1]/y,s&&e<r&&(y=y-a[p.id]-a[o.id]);let v=l*(g+1)*(h+1)/y;s&&e<r&&y<0?v=i*(g+1)*(h+1):s&&e<r&&0===y?v=0:s&&e<r&&y>0&&(v=l*(g+1)*(h+1)/y),n[p.id][0]-=v*f[0],n[o.id][0]+=v*f[0],n[p.id][1]-=v*f[1],n[o.id][1]+=v*f[1]}let y=[p.data.x-h[0],p.data.y-h[1]],v=Math.hypot(y[0],y[1]);y[0]=y[0]/v,y[1]=y[1]/v;let m=u*(g+1);n[p.id][0]-=m*y[0],n[p.id][1]-=m*y[1]}return n}updatePos(t,e,r,n,i){let{ks:a,tao:o,prune:s,ksmax:l}=i,u=t.getAllNodes(),h=u.length,d=[],c=[],f=0,p=0,g=n;for(let n=0;n<h;n+=1){let{id:i}=u[n],a=t.getDegree(i);if(s&&a<=1)continue;let o=[e[i][0]-r[i][0],e[i][1]-r[i][1]],l=Math.hypot(o[0],o[1]),h=[e[i][0]+r[i][0],e[i][1]+r[i][1]],g=Math.hypot(h[0],h[1]);d[n]=l,c[n]=g/2,f+=(a+1)*d[n],p+=(a+1)*c[n]}let y=g;g=o*p/f,0!==y&&(g=g>1.5*y?1.5*y:g);for(let r=0;r<h;r+=1){let{id:n,data:i}=u[r],o=t.getDegree(n);if(s&&o<=1||(0,ol.default)(i.fx)&&(0,ol.default)(i.fy))continue;let h=a*g/(1+g*Math.sqrt(d[r])),c=Math.hypot(e[n][0],e[n][1]),f=l/(c=c<1e-4?1e-4:c),p=(h=h>f?f:h)*e[n][0],y=h*e[n][1];t.mergeNodeData(n,{x:i.x+p,y:i.y+y})}return g}},circular:class{constructor(t={}){this.options=t,this.id="circular",this.options=Object.assign(Object.assign({},ge),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericCircularLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericCircularLayout(!0,t,e)})}genericCircularLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.options),r),{width:i,height:a,center:o,divisions:s,startAngle:l=0,endAngle:u=2*Math.PI,angleRatio:h,ordering:d,clockwise:c,nodeSpacing:f,nodeSize:p}=n,g=e.getAllNodes(),y=e.getAllEdges(),[v,m,b]=gn(i,a,o),x=null==g?void 0:g.length;if(!x||1===x)return gt(e,t,b);let{radius:E,startRadius:w,endRadius:_}=n;if(f){let t=p5(10,f),e=p4(10,p),r=-1/0;g.forEach(t=>{let n=e(t);r<n&&(r=n)});let n=0;g.forEach((e,i)=>{0===i?n+=r||10:n+=(t(e)||0)+(r||10)}),E=n/(2*Math.PI)}else E||w||_?!w&&_?w=_:w&&!_&&(_=w):E=Math.min(m,v)/2;let S=(u-l)/x*h,k=[];k="topology"===d?gr(e,g):"topology-directed"===d?gr(e,g,!0):"degree"===d?function(t,e){let r=[];return e.forEach((t,e)=>{r.push(p3(t))}),r.sort((e,r)=>t.getDegree(e.id,"both")-t.getDegree(r.id,"both")),r}(e,g):g.map(t=>p3(t));let N=Math.ceil(x/s);for(let t=0;t<x;++t){let e=E;e||null===w||null===_||(e=w+t*(_-w)/(x-1)),e||(e=10+100*t/(x-1));let r=l+t%N*S+2*Math.PI/s*Math.floor(t/N);c||(r=u-t%N*S-2*Math.PI/s*Math.floor(t/N)),k[t].data.x=b[0]+Math.cos(r)*e,k[t].data.y=b[1]+Math.sin(r)*e}return t&&k.forEach(t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}),{nodes:k,edges:y}})}},concentric:go,dagre:vh,dendrogram:cY.dendrogram,fishbone:_Q,force:gO,fruchterman:class{constructor(t={}){this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},vg),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericFruchtermanLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericFruchtermanLayout(!0,t,e)})}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let e=0;e<t;e++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);let e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach(t=>this.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===this.options.dimensions?t.data.z:void 0})),e}genericFruchtermanLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){if(this.running)return;let n=this.formatOptions(r),{dimensions:i,width:a,height:o,center:s,clustering:l,nodeClusterBy:u,maxIteration:h,onTick:d}=n,c=e.getAllNodes(),f=e.getAllEdges();if(!(null==c?void 0:c.length)){let t={nodes:[],edges:f};return this.lastResult=t,t}if(1===c.length){t&&e.mergeNodeData(c[0].id,{x:s[0],y:s[1],z:3===i?s[2]:void 0});let r={nodes:[Object.assign(Object.assign({},c[0]),{data:Object.assign(Object.assign({},c[0].data),{x:s[0],y:s[1],z:3===i?s[2]:void 0})})],edges:f};return this.lastResult=r,r}let p=c.map(t=>p3(t,[a,o])),g=new cI({nodes:p,edges:f}),y={};if(l&&p.forEach(t=>{let e=t.data[u];y[e]||(y[e]={name:e,cx:0,cy:0,count:0})}),this.lastLayoutNodes=p,this.lastLayoutEdges=f,this.lastAssign=t,this.lastGraph=g,this.lastOptions=n,this.lastClusterMap=y,"undefined"==typeof window)return;let v=0;return new Promise(r=>{this.timeInterval=window.setInterval(()=>{if(!this.running){r({nodes:p,edges:f});return}this.runOneStep(g,y,n),t&&p.forEach(({id:t,data:r})=>e.mergeNodeData(t,{x:r.x,y:r.y,z:3===i?r.z:void 0})),null==d||d({nodes:p,edges:f}),++v>=h&&(window.clearInterval(this.timeInterval),r({nodes:p,edges:f}))},0),this.running=!0})})}formatOptions(t={}){let e=Object.assign(Object.assign({},this.options),t),{clustering:r,nodeClusterBy:n}=e,{center:i,width:a,height:o}=e;return e.width=a||"undefined"==typeof window?a:window.innerWidth,e.height=o||"undefined"==typeof window?o:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=r&&!!n,e}runOneStep(t,e,r){let{dimensions:n,height:i,width:a,gravity:o,center:s,speed:l,clustering:u,nodeClusterBy:h,clusterGravity:d}=r,c=i*a,f=Math.sqrt(c)/10,p=t.getAllNodes(),g=c/(p.length+1),y=Math.sqrt(g),v={};if(this.applyCalculate(t,v,y,g),u){for(let t in e)e[t].cx=0,e[t].cy=0,e[t].count=0;for(let t in p.forEach(t=>{let{data:r}=t,n=e[r[h]];(0,ol.default)(r.x)&&(n.cx+=r.x),(0,ol.default)(r.y)&&(n.cy+=r.y),n.count++}),e)e[t].cx/=e[t].count,e[t].cy/=e[t].count;let t=d||o;p.forEach((r,n)=>{let{id:i,data:a}=r;if(!(0,ol.default)(a.x)||!(0,ol.default)(a.y))return;let o=e[a[h]],s=Math.sqrt((a.x-o.cx)*(a.x-o.cx)+(a.y-o.cy)*(a.y-o.cy)),l=y*t;v[i].x-=l*(a.x-o.cx)/s,v[i].y-=l*(a.y-o.cy)/s})}p.forEach((t,e)=>{let{id:r,data:i}=t;if(!(0,ol.default)(i.x)||!(0,ol.default)(i.y))return;let a=.01*y*o;v[r].x-=a*(i.x-s[0]),v[r].y-=a*(i.y-s[1]),3===n&&(v[r].z-=a*(i.z-s[2]))}),p.forEach((e,r)=>{let{id:i,data:a}=e;if((0,ol.default)(a.fx)&&(0,ol.default)(a.fy)){a.x=a.fx,a.y=a.fy,3===n&&(a.z=a.fz);return}if(!(0,ol.default)(a.x)||!(0,ol.default)(a.y))return;let o=Math.sqrt(v[i].x*v[i].x+v[i].y*v[i].y+(3===n?v[i].z*v[i].z:0));if(o>0){let e=Math.min(l/800*f,o);t.mergeNodeData(i,{x:a.x+v[i].x/o*e,y:a.y+v[i].y/o*e,z:3===n?a.z+v[i].z/o*e:void 0})}})}applyCalculate(t,e,r,n){this.calRepulsive(t,e,n),this.calAttractive(t,e,r)}calRepulsive(t,e,r){let n=t.getAllNodes();n.forEach(({data:t,id:i},a)=>{e[i]={x:0,y:0,z:0},n.forEach(({data:n,id:o},s)=>{if(a<=s||!(0,ol.default)(t.x)||!(0,ol.default)(n.x)||!(0,ol.default)(t.y)||!(0,ol.default)(n.y))return;let l=t.x-n.x,u=t.y-n.y,h=3===this.options.dimensions?t.z-n.z:0,d=l*l+u*u+h*h;0===d&&(d=1,l=.01,u=.01,h=.01);let c=r/d,f=l*c,p=u*c,g=h*c;e[i].x+=f,e[i].y+=p,e[o].x-=f,e[o].y-=p,3===this.options.dimensions&&(e[i].z+=g,e[o].z-=g)})})}calAttractive(t,e,r){t.getAllEdges().forEach(n=>{let{source:i,target:a}=n;if(!i||!a||i===a)return;let{data:o}=t.getNode(i),{data:s}=t.getNode(a);if(!(0,ol.default)(s.x)||!(0,ol.default)(o.x)||!(0,ol.default)(s.y)||!(0,ol.default)(o.y))return;let l=s.x-o.x,u=s.y-o.y,h=3===this.options.dimensions?s.z-o.z:0,d=Math.sqrt(l*l+u*u+h*h)/r,c=l*d,f=u*d,p=h*d;e[i].x+=c,e[i].y+=f,e[a].x-=c,e[a].y-=f,3===this.options.dimensions&&(e[i].z+=p,e[a].z-=p)})}},grid:class{constructor(t={}){this.options=t,this.id="grid",this.options=Object.assign(Object.assign({},vy),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericGridLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericGridLayout(!0,t,e)})}genericGridLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},this.options),r),{begin:i=[0,0],condense:a,preventOverlapPadding:o,preventOverlap:s,rows:l,cols:u,nodeSpacing:h,nodeSize:d,width:c,height:f,position:p}=n,{sortBy:g}=n,y=e.getAllNodes(),v=e.getAllEdges(),m=null==y?void 0:y.length;if(!m||1===m)return gt(e,t,i);let b=y.map(t=>p3(t));"id"===g||(0,ou.default)(g)&&void 0!==b[0].data[g]||(g="degree"),"degree"===g?b.sort((t,r)=>e.getDegree(r.id,"both")-e.getDegree(t.id,"both")):"id"===g?b.sort((t,e)=>(0,ol.default)(e.id)&&(0,ol.default)(t.id)?e.id-t.id:`${t.id}`.localeCompare(`${e.id}`)):b.sort((t,e)=>e.data[g]-t.data[g]);let x=c||"undefined"==typeof window?c:window.innerWidth,E=f||"undefined"==typeof window?f:window.innerHeight,w={rows:l,cols:u};if(null!=l&&null!=u)w.rows=l,w.cols=u;else if(null!=l&&null==u)w.rows=l,w.cols=Math.ceil(m/w.rows);else if(null==l&&null!=u)w.cols=u,w.rows=Math.ceil(m/w.cols);else{let t=Math.sqrt(m*E/x);w.rows=Math.round(t),w.cols=Math.round(x/E*t)}if(w.rows=Math.max(w.rows,1),w.cols=Math.max(w.cols,1),w.cols*w.rows>m){let t=vv(w),e=vm(w);(t-1)*e>=m?vv(w,t-1):(e-1)*t>=m&&vm(w,e-1)}else for(;w.cols*w.rows<m;){let t=vv(w),e=vm(w);(e+1)*t>=m?vm(w,e+1):vv(w,t+1)}let _=a?0:x/w.cols,S=a?0:E/w.rows;if(s||h){let t=p5(10,h),r=p4(30,d,!1);b.forEach(n=>{n.data.x&&n.data.y||(n.data.x=0,n.data.y=0);let[i,a]=p6(r(e.getNode(n.id))||30),s=void 0!==t?t(n):o;_=Math.max(_,i+s),S=Math.max(S,a+s)})}let k={},N={row:0,col:0},O={};for(let t=0;t<b.length;t++){let r;let n=b[t];if(p&&(r=p(e.getNode(n.id))),r&&(void 0!==r.row||void 0!==r.col)){let t={row:r.row,col:r.col};if(void 0===t.col)for(t.col=0;vb(k,t);)t.col++;else if(void 0===t.row)for(t.row=0;vb(k,t);)t.row++;O[n.id]=t,vx(k,t)}vw(n,i,_,S,O,w,N,k)}return t&&b.forEach(t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}),{nodes:b,edges:v}})}},indented:cY.indented,mds:g8,mindmap:cY.mindmap,radial:class{constructor(t={}){this.options=t,this.id="radial",this.options=Object.assign(Object.assign({},vT),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericRadialLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericRadialLayout(!0,t,e)})}genericRadialLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let{width:n,height:i,center:a,focusNode:o,unitRadius:s,nodeSize:l,nodeSpacing:u,strictRadial:h,preventOverlap:d,maxPreventOverlapIteration:c,sortBy:f,linkDistance:p=50,sortStrength:g=10,maxIteration:y=1e3}=Object.assign(Object.assign({},this.options),r),v=e.getAllNodes(),m=e.getAllEdges(),b=n||"undefined"==typeof window?n:window.innerWidth,x=i||"undefined"==typeof window?i:window.innerHeight,E=a||[b/2,x/2];if(!(null==v?void 0:v.length)||1===v.length)return gt(e,t,E);let w=v[0];if((0,ou.default)(o)){for(let t=0;t<v.length;t++)if(v[t].id===o){w=v[t];break}}else w=o||v[0];let _=vC(v,w.id),S=g0(g1({nodes:v,edges:m},!1)),k=vI(S,_);vR(S,_,k+1);let N=S[_],O=b-E[0]>E[0]?E[0]:b-E[0],T=x-E[1]>E[1]?E[1]:x-E[1];0===O&&(O=b/2),0===T&&(T=x/2);let M=Math.min(O,T),A=Math.max(...N),C=[],R=s||M/A;N.forEach((t,e)=>{C[e]=t*R});let I=vM(v,S,p,C,R,f,g),P=vA(I),D=v_(p,I,p),L=D.map(([t,e])=>({x:(isNaN(t)?Math.random()*p:t)-D[_][0],y:(isNaN(e)?Math.random()*p:e)-D[_][1]}));this.run(y,L,P,I,C,_),d&&(L=vk(e,{nodes:v,nodeSizeFunc:p8(l,u),positions:L,radii:C,height:x,width:b,strictRadial:!!h,focusIdx:_,iterations:c||200,k:L.length/4.5}));let j=[];return L.forEach((t,e)=>{let r=p3(v[e]);r.data.x=t.x+E[0],r.data.y=t.y+E[1],j.push(r)}),t&&j.forEach(t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})),{nodes:j,edges:m}})}run(t,e,r,n,i,a){for(let o=0;o<=t;o++){let s=o/t;this.oneIteration(s,e,i,n,r,a)}}oneIteration(t,e,r,n,i,a){let o=1-t;e.forEach((s,l)=>{let u=g6(s,{x:0,y:0}),h=0===u?0:1/u;if(l===a)return;let d=0,c=0,f=0;e.forEach((t,e)=>{if(l===e)return;let r=g6(s,t),a=0===r?0:1/r,o=n[e][l];f+=i[l][e],d+=i[l][e]*(t.x+o*(s.x-t.x)*a),c+=i[l][e]*(t.y+o*(s.y-t.y)*a)});let p=0===r[l]?0:1/r[l];f*=o,f+=t*p*p,d*=o,d+=t*p*s.x*h,s.x=d/f,c*=o,c+=t*p*s.y*h,s.y=c/f})}},random:class{constructor(t={}){this.options=t,this.id="random",this.options=Object.assign(Object.assign({},vP),t)}execute(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){return this.genericRandomLayout(!1,t,e)})}assign(t,e){return(0,s6.__awaiter)(this,void 0,void 0,function*(){yield this.genericRandomLayout(!0,t,e)})}genericRandomLayout(t,e,r){return(0,s6.__awaiter)(this,void 0,void 0,function*(){let{center:n,width:i,height:a}=Object.assign(Object.assign({},this.options),r),o=e.getAllNodes(),s=i||"undefined"==typeof window?i:window.innerWidth,l=a||"undefined"==typeof window?a:window.innerHeight,u=n||[s/2,l/2],h=[];return o&&o.forEach(t=>{h.push({id:t.id,data:{x:(Math.random()-.5)*.9*s+u[0],y:(Math.random()-.5)*.9*l+u[1]}})}),t&&h.forEach(t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})),{nodes:h,edges:e.getAllEdges()}})}}},node:{circle:u0,diamond:class extends u1{constructor(t){super(t)}getPoints(t){let[e,r]=this.getSize(t);return[[0,-r/2],[e/2,0],[0,r/2],[-e/2,0]]}},ellipse:u9,hexagon:class extends u1{constructor(t){super(t)}getOuterR(t){return t.outerR||Math.min(...this.getSize(t))/2}getPoints(t){var e;return[[0,e=this.getOuterR(t)],[e*Math.sqrt(3)/2,e/2],[e*Math.sqrt(3)/2,-e/2],[0,-e],[-e*Math.sqrt(3)/2,-e/2],[-e*Math.sqrt(3)/2,e/2]]}getIconStyle(t){let e=super.getIconStyle(t),r=.8*this.getOuterR(t);return!!e&&Object.assign({width:r,height:r},e)}},html:df,image:dg,rect:class extends uQ{constructor(t){super(t)}getKeyStyle(t){let[e,r]=this.getSize(t);return Object.assign(Object.assign({},super.getKeyStyle(t)),{width:e,height:r,x:-e/2,y:-r/2})}getIconStyle(t){let e=super.getIconStyle(t),{width:r,height:n}=this.getShape("key").attributes;return!!e&&Object.assign({width:.8*r,height:.8*n},e)}drawKeyShape(t,e){return this.upsert("key",on.Rect,this.getKeyStyle(t),e)}},star:class extends u1{constructor(t){super(t)}getInnerR(t){return t.innerR||3*this.getOuterR(t)/8}getOuterR(t){return Math.min(...this.getSize(t))/2}getPoints(t){var e,r;return[[0,-(e=this.getOuterR(t))],[(r=this.getInnerR(t))*Math.cos(3*Math.PI/10),-r*Math.sin(3*Math.PI/10)],[e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[r*Math.cos(Math.PI/10),r*Math.sin(Math.PI/10)],[e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[0,r],[-e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[-r*Math.cos(Math.PI/10),r*Math.sin(Math.PI/10)],[-e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[-r*Math.cos(3*Math.PI/10),-r*Math.sin(3*Math.PI/10)]]}getIconStyle(t){let e=super.getIconStyle(t),r=2*this.getInnerR(t)*.8;return!!e&&Object.assign({width:r,height:r},e)}getPortXY(t,e){let{placement:r="top"}=e;return cs(this.getShape("key").getLocalBounds(),r,function(t,e){let r={};return r.top=[0,-t],r.left=[-t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],r["left-bottom"]=[-t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],r.bottom=[0,e],r["right-bottom"]=[t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],r.right=r.default=[t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],r}(this.getOuterR(t),this.getInnerR(t)),!1)}},donut:u3,triangle:dy},palette:{spectral:["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],tableau:["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],oranges:["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],greens:["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],blues:["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"]},theme:{dark:_8,light:_9},plugin:{"bubble-sets":mo,"edge-bundling":mc,"edge-filter-lens":mE,"grid-line":mk,background:vG,contextmenu:md,fisheye:m_,fullscreen:mS,history:mT,hull:mq,legend:bW,minimap:bq,snapline:bZ,timebar:wg,toolbar:ww,tooltip:wT,watermark:wR},transform:{"arrange-draw-order":class extends _L{beforeDraw(t){let{model:e}=this.context,r=t.add.combos,n=t=>{let r=[];return t.forEach((t,n)=>{let i=e.getAncestorsData(n,"combo").map(t=>lg(t)).reverse();r.push([n,t,i.length])}),new Map(r.sort(([,,t],[,,e])=>e-t).map(([t,e])=>[t,e]))};return t.add.combos=n(r),t.update.combos=n(t.update.combos),t}},"collapse-expand-combo":class extends _L{beforeDraw(t,e){if("visibility"===e.stage||!this.context.model.model.hasTreeStructure(sg))return t;let{model:r}=this.context,{add:n,update:i}=t,a=[...t.update.combos.entries(),...t.add.combos.entries()];for(;a.length;){let[e,o]=a.pop();if(uc(o)){let o=r.getDescendantsData(e),{internal:s,external:l}=dF(o.map(lg),t=>r.getRelatedEdgesData(t));o.forEach(e=>{let n=lg(e),i=a.findIndex(([t])=>t===n);-1!==i&&a.splice(i,1),_j(t,"remove",r.getElementType(n),e)}),s.forEach(e=>_j(t,"remove","edge",e)),l.forEach(t=>{var e;let r=lg(t);(null===(e=this.context.element)||void 0===e?void 0:e.getElement(r))?i.edges.set(r,t):n.edges.set(r,t)})}else{let n=r.getChildrenData(e),{edges:i}=dF(n.map(lg),t=>r.getRelatedEdgesData(t));[...n,...i].forEach(e=>{var n;let i=lg(e),o=r.getElementType(i);(null===(n=this.context.element)||void 0===n?void 0:n.getElement(i))?_j(t,"update",o,e):_j(t,"add",o,e),"combo"===o&&a.push([i,e])})}}return t}},"collapse-expand-node":class extends _L{getElement(t){return this.context.element.getElement(t)}handleExpand(t,e){if(_B(e,"add","node",t),uc(t))return;let r=lg(t);_B(e,"add","node",t),this.context.model.getRelatedEdgesData(r,"out").forEach(t=>{_j(e,"add","edge",t)}),this.context.model.getChildrenData(r).forEach(t=>{this.handleExpand(t,e)})}beforeDraw(t){let{graph:e,model:r}=this.context;if(!r.model.hasTreeStructure(sy))return t;let{add:{nodes:n,edges:i},update:{nodes:a}}=t,o=new Map,s=new Map;n.forEach((t,e)=>{uc(t)&&o.set(e,t)}),i.forEach(t=>{if("node"!==e.getElementType(t.source))return;let r=e.getNodeData(t.source);uc(r)&&o.set(t.source,r)}),a.forEach((t,e)=>{let r=this.getElement(e);if(!r)return;let n=r.attributes.collapsed;uc(t)?n||o.set(e,t):n&&s.set(e,t)});let l=new Set;return o.forEach((e,n)=>{r.getDescendantsData(n).forEach(e=>{let n=lg(e);l.has(n)||(_j(t,"remove","node",e),r.getRelatedEdgesData(n).forEach(e=>{_j(t,"remove","edge",e)}),l.add(n))})}),s.forEach((e,n)=>{if(r.getAncestorsData(n,sy).some(uc)){_j(t,"remove","node",e);return}this.handleExpand(e,t)}),t}},"get-edge-actual-ends":class extends _L{beforeDraw(t){let{add:e,update:r}=t,{model:n}=this.context;return[...e.edges.entries(),...r.edges.entries()].forEach(([,t])=>{_z(n,t)}),t}},"map-node-size":_H,"place-radial-labels":_W,"process-parallel-edges":_K,"update-related-edges":class extends _L{beforeDraw(t,e){let{stage:r}=e;if("visibility"===r)return t;let{model:n}=this.context,{update:{nodes:i,edges:a,combos:o}}=t,s=(t,e)=>{n.getRelatedEdgesData(e).forEach(t=>!a.has(lg(t))&&a.set(lg(t),t))};return i.forEach(s),o.forEach(s),t}}},shape:{circle:on.Circle,ellipse:on.Ellipse,group:on.Group,html:on.HTML,image:uH,line:on.Line,path:on.Path,polygon:on.Polygon,polyline:on.Polyline,rect:on.Rect,text:on.Text,label:uB,badge:uz}};on.runtime.enableMassiveParsedStyleAssignOptimization=!0,Object.entries(_7).forEach(([t,e])=>{Object.entries(e).forEach(([e,r])=>{!function(t,e,r,n=!1){let i=sv[t][e];!n&&i?i!==r&&sx.warn(`The extension ${e} of ${t} has been registered before.`):Object.assign(sv[t],{[e]:r})}(t,e,r)})});const St=async t=>{try{let{dataset:e,prefixes:r}=await oe(t),{nodes:n,edges:i}=function({dataset:t,prefixes:e}){let r=new Map,n=[],i=[],a=new Set;function o(t,e){if(r.has(t)){let n=r.get(t);n.data.clusters.includes(e)||n.data.clusters.push(e)}else{let i={id:t,data:{clusters:[e]},style:{size:30,labelText:t}};r.set(t,i),n.push(i)}return r.get(t)}for(let r of t){let t=or(r.subject.value,e),n=or(r.predicate.value,e),s=or(r.object.value,e),l=or(r.graph.value,e)||"default",u=o(t,l),h=o(s,l);if(u.id!==h.id){let t=`${u.id}-${n}-${h.id}`;a.has(t)||(a.add(t),i.push({id:t,source:u.id,predicate:n,target:h.id,style:{labelText:n,labelBackground:!0,endArrow:!0}}))}}return{nodes:n,edges:i}}({dataset:e,prefixes:r}),a=function({nodes:t,edges:e}){let r=t.reduce((t,e)=>{for(let r of e.data.clusters)t[r]||=[],t[r].push(e.id);return t},{}),n=t=>({fill:t,stroke:t,labelFill:"#fff",labelPadding:2,labelBackgroundFill:t,labelBackgroundRadius:5}),i=["#1783FF","#00C9C9","#F08F56","#D580FF","#4CAF50","#FF5722","#2196F3","#9C27B0","#FF9800"];return new _D({container:"container",data:{nodes:t,edges:e},behaviors:["zoom-canvas","drag-canvas","drag-element"],node:{palette:{field:"cluster"}},layout:{type:"force",preventOverlap:!0,linkDistance:e=>{let r=t[0]?.id;return e.source===r||e.target===r?200:80}},plugins:Object.entries(r).map(([t,e],r)=>({key:`hull-${t}`,type:"hull",members:e,labelText:`${t}`,...n(i[r%i.length])})),autoFit:"center",transforms:["process-parallel-edges"]})}({nodes:n,edges:i});document.getElementById("container").innerHTML="",await a.render()}catch(t){Si.innerHTML=t.message}},Se=new URLSearchParams(window.location.search).get("url"),Sr=document.getElementById("urlInput"),Sn=document.getElementById("renderButton"),Si=document.getElementById("message");Se&&(Sr.value=Se,St(Se)),Sn.addEventListener("click",()=>{let t=Sr.value;t?(Si.innerHTML="",St(t)):Si.innerHTML=`
        Add a valid URL pointing to a Trig file. Try this
        <a href="?url=https://raw.githubusercontent.com/cristianvasquez/visualize-named/refs/heads/main/examples/monica.trig">example</a>
      `});</script> </body></html>